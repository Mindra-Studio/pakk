/**
 * PAKK Trained ZSTD Dictionary for Go
 *
 * This is a REAL trained ZSTD dictionary (not just text patterns).
 * Trained using: zstd --train on sample Go files.
 *
 * Size: 524288 bytes
 * Generated: 2026-01-31T18:32:43.805Z
 */

import type { DictionaryMeta } from '../core/types.js';

// Base64-encoded trained ZSTD dictionary
const DICTIONARY_BASE64 = 'N6Qw7P9C1SZAEJgyU3XAwMDAwMDAwMDAwMBAFSw+t1+EtUmMNBWWUhJqrrT51BQCowf/U7ndeVlrm2nllqmtKtFoIxIO2hlUAfMBAAgMi8bj4XA8HBCpuqgHBABBFRyQpZnShvJgKAlyGEZRFELIGGMMMcQYIjMzAxkAAADEdMlTOcmQIQAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACQkJcCAqPSB2CgkJCQluKysKCQkJfQoJCX0KCQlpZiBuID09IDAgewoJCQlnZW9tZWFuc1tqXSA9IG1hdGguSW5mKCsxKQoJCX0gZWxzZSB7CgkJCWdlb21lYW5zW2pdID0gbWF0aC5Qb3cocCwgMS9mbG9hdDY0KG4pKQoJCX0KCX0KCWZtdC5QcmludGYoIiVzXG4iLCBjc3YoImdlb21lYW4iLCBnZW9tZWFucykpCgoJLy8gQWRkIGJlc3QgdGhyZXNob2xkIGFuZCBzbWFsbGVzdCwgbGFyZ2VzdCB3aXRoaW4gMTAlIGFuZCA1JSBvZiBiZXN0LgoJdmFyIGxvMTAsIGxvNSwgYmVzdCwgaGk1LCBoaTEwIGludAoJZm9yIGksIGcgOj0gcmFuZ2UgZ2VvbWVhbnMgewoJCWlmIGcgPCBnZW9tZWFuc1tiZXN0XSB7CgkJCWJlc3QgPSBpCgkJfQoJfQoJbG81ID0gYmVzdAoJZm9yIGxvNSA+IDAgJiYgZ2VvbWVhbnNbbG81LTFdIDw9IDEuMDUgewoJCWxvNS0tCgl9CglsbzEwID0gbG81Cglmb3IgbG8xMCA+IDAgJiYgZ2VvbWVhbnNbbG8xMC0xXSA8PSAxLjEwIHsKCQlsbzEwLS0KCX0KCWhpNSA9IGJlc3QKCWZvciBoaTUrMSA8IGxlbihnZW9tZWFucykgJiYgZ2VvbWVhbnNbaGk1KzFdIDw9IDEuMDUgewoJCWhpNSsrCgl9CgloaTEwID0gaGk1Cglmb3IgaGkxMCsxIDwgbGVuKGdlb21lYW5zKSAmJiBnZW9tZWFuc1toaTEwKzFdIDw9IDEuMTAgewoJCWhpMTArKwoJfQoJZm10LlByaW50ZigibG8xMCUlLCVkXG4iLCB0aHJlc2hvbGRzW2xvMTBdKQoJZm10LlByaW50ZigibG81JSUsJWRcbiIsIHRocmVzaG9sZHNbbG81XSkKCWZtdC5QcmludGYoIm1pbiwlZFxuIiwgdGhyZXNob2xkc1tiZXN0XSkKCWZtdC5QcmludGYoImhpNSUlLCVkXG4iLCB0aHJlc2hvbGRzW2hpNV0pCglmbXQuUHJpbnRmKCJoaTEwJSUsJWRcbiIsIHRocmVzaG9sZHNbaGkxMF0pCgoJc2V0KHRocmVzaG9sZHNbYmVzdF0pCn0KCi8vIGNzdiByZXR1cm5zIGEgc2luZ2xlIGNzdiBsaW5lIHN0YXJ0aW5nIHdpdGggbmFtZSBhbmQgZm9sbG93ZWQgYnkgdGhlIHZhbHVlcy4KLy8gVmFsdWVzIHRoYXQgYXJlIGZsb2F0NjQgK2luZmluaXR5LCBkZW5vdGluZyBtaXNzaW5nIGRhdGEsIGFyZSByZXBsYWNlZCBieSBhbiBlbXB0eSBzdHJpbmcuCmZ1bmMgY3N2W1QgaW50IHwgZmxvYXQ2NF0obmFtZSBzdHJpbmcsIHZhbHVlcyBbXVQpIHN0cmluZyB7CglsaW5lIDo9IFtdc3RyaW5ne25hbWV9Cglmb3IgXywgdiA6PSByYW5nZSB2YWx1ZXMgewoJCWlmIG1hdGguSXNJbmYoZmxvYXQ2NCh2KSwgKzEpIHsKCQkJbD0gc2VlaygwLCBmZCwgb2Zmc2V0LCB3aGVuY2UpCgoJaWYgbmV3b2Zmc2V0ID09IC0xIHsKCQllcnIgPSBOZXdFcnJvcihlKQoJfQoJcmV0dXJuCn0KCmZ1bmMgTWtkaXIocGF0aCBzdHJpbmcsIG1vZGUgdWludDMyKSAoZXJyIGVycm9yKSB7CgkvLyBJZiBwYXRoIGV4aXN0cyBhbmQgaXMgbm90IGEgZGlyZWN0b3J5LCBDcmVhdGUgd2lsbCBmYWlsIHNpbGVudGx5LgoJLy8gV29yayBhcm91bmQgdGhpcyBieSByZWplY3RpbmcgTWtkaXIgaWYgcGF0aCBleGlzdHMuCglzdGF0YnVmIDo9IG1ha2UoW11ieXRlLCBiaXRTaXplMTYpCgkvLyBSZW1vdmUgYW55IHRyYWlsaW5nIHNsYXNoZXMgZnJvbSBwYXRoLCBvdGhlcndpc2UgdGhlIFN0YXQgd2lsbAoJLy8gZmFpbCB3aXRoIEVOT1RESVIuCgluIDo9IGxlbihwYXRoKQoJZm9yIG4gPiAxICYmIHBhdGhbbi0xXSA9PSAnLycgewoJCW4tLQoJfQoJXywgZXJyID0gU3RhdChwYXRoWzA6bl0sIHN0YXRidWYpCglpZiBlcnIgPT0gbmlsIHsKCQlyZXR1cm4gRUVYSVNUCgl9CgoJZmQsIGVyciA6PSBDcmVhdGUocGF0aCwgT19SRE9OTFksIERNRElSfG1vZGUpCgoJaWYgZmQgIT0gLTEgewoJCUNsb3NlKGZkKQoJfQoKCXJldHVybgp9Cgp0eXBlIFdhaXRtc2cgc3RydWN0IHsKCVBpZCAgaW50CglUaW1lIFszXXVpbnQzMgoJTXNnICBzdHJpbmcKfQoKZnVuYyAodyBXYWl0bXNnKSBFeGl0ZWQoKSBib29sICAgeyByZXR1cm4gdHJ1ZSB9CmZ1bmMgKHcgV2FpdG1zZykgU2lnbmFsZWQoKSBib29sIHsgcmV0dXJuIGZhbHNlIH0KCmZ1bmMgKHcgV2FpdG1zZykgRXhpdFN0YXR1cygpIGludCB7CglpZiBsZW4ody5Nc2cpID09IDAgewoJCS8vIGEgbm9ybWFsIGV4aXQgcmV0dXJucyBubyBtZXNzYWdlCgkJcmV0dXJuIDAKCX0KCXJldHVybiAxCn0KCi8vc3lzCWF3YWl0KHMgW11ieXRlKSAobiBpbnQsIGVyciBlcnJvcikKCmZ1bmMgQXdhaXQodyAqV2FpdG1zZykgKGVyciBlcnJvcikgewoJdmFyIGJ1ZiBbNTEyXWJ5dGUKCXZhciBmIFs1XVtdYnl0ZQoKCW4sIGVyciA6PSBhd2FpdChidWZbOl0pCgoJaWYgZXJyICE9IG5pbCB8fCB3ID09IG5pbCB7CgkJcmV0dXJuCgl9CgoJbmYgOj0gMAoJcCA6PSAwCglmb3IgaSA6PSAwOyBpIDwgbiAmJiBuZiA8IGxlbihmKS0xOyBpKysgewoJCWlmIGJ1ZltpXSA9PSAnICcgewoJCQlmW25mXSA9IGJ1ZltwOmldCgkJCXAgPSBpICsgMQoJCQluZisrCgkJfQoJfQoJZltuZl0gPSBidWZbcDpdCgluZisrCgoJaWYgbmYgIT0gbGVuKGYpIHsKCQlyZXR1cm4gTmV3RXJyb3IoImludmFsaWQgd2FpdCBtZXNzYWdlIikKCX0KCXcuUGlkID0gaW50KGF0b2koZlswXSkpCgl3LlRpbWVbMF0gPSB1aW50MzIoYXRvaShmWzFdKSkKCXcuVGltZVsxXSA9IHVpbnQzMihhdG9pKGZbMl0pKQoJdy5UaW1lWzJdID0gdWludDMyKGF0b2koZlszXSkpCgl3Lk1zZyA9IGNzdHJpbmcoZls0XSkKCWlmIHcuTXNnID09ICInJyIgewoJCS8vIGF3YWl0KCkgcmV0dXJucyAnJyBmb3Igbm8gZXJyb3IKCQl3Lk1zZyA9ICIiCgl9CglyZXR1cm4KfQoKZnVuYyBVbm1vdW50KG5hbWUsIG9sZCBzdHJpbmcpIChlcnIgZXJyb3IpIHsKCWlmIGZpeHdkKG5hbWUsIG9sZCkgewoJCWRlZmVyIHJ1bnRpbWUuVW5sb2NrT1NUaHJlYWQoKQoJfQoJb2xkcCwgZXJyIDo9IEJ5dGVQdHJGcm9tU3RyaW5nKG9sZCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCW9sZHB0ciA6PSB1aW50cHRyKHVuc2FmZS5Qb2ludGVyKG9sZHApKQoKCXZhciByMCB1aW50cHRyCgl2YXIgZSBFcnJvclN0cmluZwoKCS8vIGJpbmQoMikgbWFuIHBhZ2U6IElmIG5hbWUgaXMgemVybywgZXZlcnl0aGluZyBib3VuZCBvciBtb3VudGVkIHVwb24gb2xkIGlzIHVuYm91bmQgb3IgdW5tb3VudGVkLgoJaWYgbmFtZSA9PSAiIiB7CgkJcjAsIF8sIGUgPSBTeXNjYWxsKFNZU19VTk1PVU5ULCBfemVybywgb2xkcHRyLCAwKQoJfSBlbHNlIHsKCQluYW1lcCwgZXJ4N2YKCURMVF9JRUVFODAyXzExX1JBRElPX0FWUyAgICAgICAgICA9IDB4YTMKCURMVF9JRUVFODAyXzE1XzQgICAgICAgICAgICAgICAgICA9IDB4YzMKCURMVF9JRUVFODAyXzE1XzRfTElOVVggICAgICAgICAgICA9IDB4YmYKCURMVF9JRUVFODAyXzE1XzRfTk9OQVNLX1BIWSAgICAgICA9IDB4ZDcKCURMVF9JRUVFODAyXzE2X01BQ19DUFMgICAgICAgICAgICA9IDB4YmMKCURMVF9JRUVFODAyXzE2X01BQ19DUFNfUkFESU8gICAgICA9IDB4YzEKCURMVF9JUE1CICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YzcKCURMVF9JUE1CX0xJTlVYICAgICAgICAgICAgICAgICAgICA9IDB4ZDEKCURMVF9JUE5FVCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZTIKCURMVF9JUFY0ICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZTQKCURMVF9JUFY2ICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZTUKCURMVF9JUF9PVkVSX0ZDICAgICAgICAgICAgICAgICAgICA9IDB4N2EKCURMVF9KVU5JUEVSX0FUTTEgICAgICAgICAgICAgICAgICA9IDB4ODkKCURMVF9KVU5JUEVSX0FUTTIgICAgICAgICAgICAgICAgICA9IDB4ODcKCURMVF9KVU5JUEVSX0NIRExDICAgICAgICAgICAgICAgICA9IDB4YjUKCURMVF9KVU5JUEVSX0VTICAgICAgICAgICAgICAgICAgICA9IDB4ODQKCURMVF9KVU5JUEVSX0VUSEVSICAgICAgICAgICAgICAgICA9IDB4YjIKCURMVF9KVU5JUEVSX0ZSRUxBWSAgICAgICAgICAgICAgICA9IDB4YjQKCURMVF9KVU5JUEVSX0dHU04gICAgICAgICAgICAgICAgICA9IDB4ODUKCURMVF9KVU5JUEVSX0lTTSAgICAgICAgICAgICAgICAgICA9IDB4YzIKCURMVF9KVU5JUEVSX01GUiAgICAgICAgICAgICAgICAgICA9IDB4ODYKCURMVF9KVU5JUEVSX01MRlIgICAgICAgICAgICAgICAgICA9IDB4ODMKCURMVF9KVU5JUEVSX01MUFBQICAgICAgICAgICAgICAgICA9IDB4ODIKCURMVF9KVU5JUEVSX01PTklUT1IgICAgICAgICAgICAgICA9IDB4YTQKCURMVF9KVU5JUEVSX1BJQ19QRUVSICAgICAgICAgICAgICA9IDB4YWUKCURMVF9KVU5JUEVSX1BQUCAgICAgICAgICAgICAgICAgICA9IDB4YjMKCURMVF9KVU5JUEVSX1BQUE9FICAgICAgICAgICAgICAgICA9IDB4YTcKCURMVF9KVU5JUEVSX1BQUE9FX0FUTSAgICAgICAgICAgICA9IDB4YTgKCURMVF9KVU5JUEVSX1NFUlZJQ0VTICAgICAgICAgICAgICA9IDB4ODgKCURMVF9KVU5JUEVSX1NUICAgICAgICAgICAgICAgICAgICA9IDB4YzgKCURMVF9KVU5JUEVSX1ZQICAgICAgICAgICAgICAgICAgICA9IDB4YjcKCURMVF9MQVBCX1dJVEhfRElSICAgICAgICAgICAgICAgICA9IDB4Y2YKCURMVF9MQVBEICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4Y2IKCURMVF9MSU4gICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZDQKCURMVF9MSU5VWF9FVkRFViAgICAgICAgICAgICAgICAgICA9IDB4ZDgKCURMVF9MSU5VWF9JUkRBICAgICAgICAgICAgICAgICAgICA9IDB4OTAKCURMVF9MSU5VWF9MQVBEICAgICAgICAgICAgICAgICAgICA9IDB4YjEKCURMVF9MSU5VWF9TTEwgICAgICAgICAgICAgICAgICAgICA9IDB4NzEKCURMVF9MT09QICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NmMKCURMVF9MVEFMSyAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NzIKCURMVF9NRlIgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YjYKCURMVF9NT1NUICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZDMKCURMVF9NUExTICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZGIKCURMVF9NVFAyICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4OGMKCURMVF9NVFAyX1dJVEhfUEhEUiAgICAgICAgICAgICAgICA9IDB4OGIKCURMVF9NVFAzICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4OGQKCURMVF9OVUxMICAgYW5nZXt7MCwgYml0cyAtIDEwfSwgezIqYml0cyArIDEwLCBQYWxsb2NDaHVua1BhZ2VzIC0gKDIqYml0cyArIDEwKX19LAoJCQkJCW1pbjogICAxLAoJCQkJCW1heDogICAxMiwgLy8gTWFrZSBpdCBzbyB0aGF0IG1heCB3b3VsZCBoYXZlIHVzIHRyeSB0byBicmVhayB0aGUgaHVnZSBwYWdlLgoJCQkJCXdhbnQ6ICBCaXRSYW5nZXtiaXRzLCBiaXRzICsgMTB9LAoJCQkJfQoJCQl9CgkJCXRlc3RzWyJQcmVzZXJ2ZUh1Z2VQYWdlVG9wIl0gPSB0ZXN0ewoJCQkJYWxsb2M6IFtdQml0UmFuZ2V7ezAsIFBhbGxvY0NodW5rUGFnZXMgLSBiaXRzfX0sCgkJCQltaW46ICAgMSwKCQkJCW1heDogICAxLCAvLyBFdmVuIG9uZSBwYWdlIHdvdWxkIGJyZWFrIGEgaHVnZSBwYWdlIGluIHRoaXMgY2FzZS4KCQkJCXdhbnQ6ICBCaXRSYW5nZXtQYWxsb2NDaHVua1BhZ2VzIC0gYml0cywgYml0c30sCgkJCX0KCQl9IGVsc2UgaWYgYml0cyA9PSBQYWxsb2NDaHVua1BhZ2VzIHsKCQkJdGVzdHNbIlByZXNlcnZlSHVnZVBhZ2VBbGwiXSA9IHRlc3R7CgkJCQltaW46ICAxLAoJCQkJbWF4OiAgMSwgLy8gRXZlbiBvbmUgcGFnZSB3b3VsZCBicmVhayBhIGh1Z2UgcGFnZSBpbiB0aGlzIGNhc2UuCgkJCQl3YW50OiBCaXRSYW5nZXswLCBQYWxsb2NDaHVua1BhZ2VzfSwKCQkJfQoJCX0gZWxzZSB7CgkJCS8vIFRoZSBodWdlIHBhZ2Ugc2l6ZSBpcyBncmVhdGVyIHRoYW4gcGFsbG9jQ2h1bmtQYWdlcywgc28gaXQgc2hvdWxkCgkJCS8vIGJlIGVmZmVjdGl2ZWx5IGRpc2FibGVkLiBUaGVyZSdzIG5vIHdheSB3ZSBjYW4gcG9zc2libGUgc2NhdmVuZ2UKCQkJLy8gYSBodWdlIHBhZ2Ugb3V0IG9mIHRoaXMgYml0bWFwIGNodW5rLgoJCQl0ZXN0c1siUHJlc2VydmVIdWdlUGFnZU5vbmUiXSA9IHRlc3R7CgkJCQltaW46ICAxLAoJCQkJbWF4OiAgMSwKCQkJCXdhbnQ6IEJpdFJhbmdle1BhbGxvY0NodW5rUGFnZXMgLSAxLCAxfSwKCQkJfQoJCX0KCX0KCWZvciBuYW1lLCB2IDo9IHJhbmdlIHRlc3RzIHsKCQl0LlJ1bihuYW1lLCBmdW5jKHQgKnRlc3RpbmcuVCkgewoJCQliIDo9IG1ha2VQYWxsb2NEYXRhKHYuYWxsb2MsIHYuc2NhdmVuZ2VkKQoJCQlzdGFydCwgc2l6ZSA6PSBiLkZpbmRTY2F2ZW5nZUNhbmRpZGF0ZShQYWxsb2NDaHVua1BhZ2VzLTEsIHYubWluLCB2Lm1heCkKCQkJZ290IDo9IEJpdFJhbmdle3N0YXJ0LCBzaXplfQoJCQlpZiAhKGdvdC5OID09IDAgJiYgdi53YW50Lk4gPT0gMCkgJiYgZ290ICE9IHYud2FudCB7CgkJCQl0LkZhdGFsZigiY2FuZGlkYXRlIG1pc21hdGNoOiBnb3QgJXYsIHdhbnQgJXYiLCBnb3QsIHYud2FudCkKCQkJfQoJCX0pCgl9Cn0KCi8vIFRlc3RzIGVuZC10by1lbmQgc2NhdmVuZ2luZyBvbiBhIHBhZ2VBbGxvYy4KZnVuYyBUZXN0UGFnZUFsbG9jU2NhdmVuZ2UodCAqdGVzdGluZy5UKSB7CglpZiBHT09TID09ICJvcGVuYnNkIiAmJiB0ZXN0aW5nLlNob3J0KCkgewoJCXQuU2tpcCgic2tpcHBpbmcgYmVjYXVzZSB2aXJ0dWFsIG1lbW9yeSBpcyBsaW1pdGVkOyBzZWUgIzM2MjEwIikKCX0KCXR5cGUgdGVzdCBzdHJ1Y3QgewoJCXJlcXVlc3QsIGV4cGVjdCB1aW50cHRyCgl9CgltaW5QYWdlcyA6PSBQaHlzUGFnZVNpemUgLyBQYWdlU2l6ZQoJaWYgbWluUGFnZXMgPCAxIHsKCQltaW5QYWdlcyA9IDEKCX0KCXR5cGUgc2V0dXAgc3RydWN0IHsKCQliZWZvcmVBbGxvYyBtYXBbQ2h1bmtJZHhdW11CaXRSYW5nZQoJCWJlZm9yZVNjYXYgIG1hcFtDaHVua0lkeF1bXUJpdFJhbmdlCgkJZXhwZWN0ICAgICAgW110ZXN0CgkJYWZ0ZXJTY2F2ICAgbWFwW0NodW5rSWR4XVtdQml0UmFuZ2UKCX0KCXRlc3RzIDo9IG1hcFtzdHJpbmddc2V0dXB7CgkJIkFsbEZyZWVVbnNjYXZFeGhhdXN0IjogewoJCQliZWZvcmVBbGxvYzogbWFwW0NodW5rSWR4XVtdQml0UmFuZ2V7CgkJCQlCYXNlQ2h1bmtJZHg6ICAgICB7fSwKCQkJCUJhc2VDaHVua0lkeCArIDE6IHt9LApyc2hhbHMgaW50byBhbiBpbnRlcmZhY2UsIG1hcCwgcG9pbnRlciwgb3Igc2xpY2UKCS8vIGJ5IHNldHRpbmcgdGhhdCBHbyB2YWx1ZSB0byBuaWwuIEJlY2F1c2UgbnVsbCBpcyBvZnRlbiB1c2VkIGluIEpTT04gdG8gbWVhbgoJLy8gYGBub3QgcHJlc2VudCwnJyB1bm1hcnNoYWxpbmcgYSBKU09OIG51bGwgaW50byBhbnkgb3RoZXIgR28gdHlwZSBoYXMgbm8gZWZmZWN0CgkvLyBvbiB0aGUgdmFsdWUgYW5kIHByb2R1Y2VzIG5vIGVycm9yLgoKCWpzb25EYXRhIDo9IFtdYnl0ZShgewoJCQkJIkJvb2wiICAgIDogbnVsbCwKCQkJCSJJbnQiICAgICA6IG51bGwsCgkJCQkiSW50OCIgICAgOiBudWxsLAoJCQkJIkludDE2IiAgIDogbnVsbCwKCQkJCSJJbnQzMiIgICA6IG51bGwsCgkJCQkiSW50NjQiICAgOiBudWxsLAoJCQkJIlVpbnQiICAgIDogbnVsbCwKCQkJCSJVaW50OCIgICA6IG51bGwsCgkJCQkiVWludDE2IiAgOiBudWxsLAoJCQkJIlVpbnQzMiIgIDogbnVsbCwKCQkJCSJVaW50NjQiICA6IG51bGwsCgkJCQkiRmxvYXQzMiIgOiBudWxsLAoJCQkJIkZsb2F0NjQiIDogbnVsbCwKCQkJCSJTdHJpbmciICA6IG51bGwsCgkJCQkiUEJvb2wiOiBudWxsLAoJCQkJIk1hcCI6IG51bGwsCgkJCQkiU2xpY2UiOiBudWxsLAoJCQkJIkludGVyZmFjZSI6IG51bGwsCgkJCQkiUFJhdyI6IG51bGwsCgkJCQkiUFRpbWUiOiBudWxsLAoJCQkJIlBCaWdJbnQiOiBudWxsLAoJCQkJIlBUZXh0IjogbnVsbCwKCQkJCSJQQnVmZmVyIjogbnVsbCwKCQkJCSJQU3RydWN0IjogbnVsbCwKCQkJCSJSYXciOiBudWxsLAoJCQkJIlRpbWUiOiBudWxsLAoJCQkJIkJpZ0ludCI6IG51bGwsCgkJCQkiVGV4dCI6IG51bGwsCgkJCQkiQnVmZmVyIjogbnVsbCwKCQkJCSJTdHJ1Y3QiOiBudWxsCgkJCX1gKQoJbnVsbHMgOj0gTnVsbFRlc3R7CgkJQm9vbDogICAgICB0cnVlLAoJCUludDogICAgICAgMiwKCQlJbnQ4OiAgICAgIDMsCgkJSW50MTY6ICAgICA0LAoJCUludDMyOiAgICAgNSwKCQlJbnQ2NDogICAgIDYsCgkJVWludDogICAgICA3LAoJCVVpbnQ4OiAgICAgOCwKCQlVaW50MTY6ICAgIDksCgkJVWludDMyOiAgICAxMCwKCQlVaW50NjQ6ICAgIDExLAoJCUZsb2F0MzI6ICAgMTIuMSwKCQlGbG9hdDY0OiAgIDEzLjEsCgkJU3RyaW5nOiAgICAiMTQiLAoJCVBCb29sOiAgICAgbmV3KGJvb2wpLAoJCU1hcDogICAgICAgbWFwW3N0cmluZ11zdHJpbmd7fSwKCQlTbGljZTogICAgIFtdc3RyaW5ne30sCgkJSW50ZXJmYWNlOiBuZXcoTXVzdE5vdFVubWFyc2hhbEpTT04pLAoJCVBSYXc6ICAgICAgbmV3KFJhd01lc3NhZ2UpLAoJCVBUaW1lOiAgICAgbmV3KHRpbWUuVGltZSksCgkJUEJpZ0ludDogICBuZXcoYmlnLkludCksCgkJUFRleHQ6ICAgICBuZXcoTXVzdE5vdFVubWFyc2hhbFRleHQpLAoJCVBTdHJ1Y3Q6ICAgbmV3KHN0cnVjdHt9KSwKCQlQQnVmZmVyOiAgIG5ldyhieXRlcy5CdWZmZXIpLAoJCVJhdzogICAgICAgUmF3TWVzc2FnZSgiMTIzIiksCgkJVGltZTogICAgICB0aW1lLlVuaXgoMTIzNDU2Nzg5LCAwKSwKCQlCaWdJbnQ6ICAgICpiaWcuTmV3SW50KDEyMyksCgl9CgoJYmVmb3JlIDo9IG51bGxzLlRpbWUuU3RyaW5nKCkKCgllcnIgOj0gVW5tYXJzaGFsKGpzb25EYXRhLCAmbnVsbHMpCglpZiBlcnIgIT0gbmlsIHsKCQl0LkVycm9yZigiVW5tYXJzaGFsIG9mIG51bGwgdmFsdWVzIGZhaWxlZDogJXYiLCBlcnIpCgl9CglpZiAhbnVsbHMuQm9vbCB8fCBudWxscy5JbnQgIT0gMiB8fCBudWxscy5JbnQ4ICE9IDMgfHwgbnVsbHMuSW50MTYgIT0gNCB8fCBudWxscy5JbnQzMiAhPSA1IHx8IG51bGxzLkludDY0ICE9IDYgfHwKCQludWxscy5VaW50ICE9IDcgfHwgbnVsbHMuVWludDggIT0gOCB8fCBudWxscy5VaW50MTYgIT0gOSB8fCBudWxscy5VaW50MzIgIT0gMTAgfHwgbnVsbHMuVWludDY0ICE9IDExIHx8CgkJbnVsbHMuRmxvYXQzMiAhPSAxMi4xIHx8IG5lbGxvXHhmZndvcmxkIiwgIlwiaGVsbG9cdWZmZmR3b3JsZFwiIn0sCgkJe05hbWUoIiIpLCAiIiwgYCIiYH0sCgkJe05hbWUoIiIpLCAiXHhmZiIsICJcIlx1ZmZmZFwiIn0sCgkJe05hbWUoIiIpLCAiXHhmZlx4ZmYiLCAiXCJcdWZmZmRcdWZmZmRcIiJ9LAoJCXtOYW1lKCIiKSwgImFceGZmYiIsICJcImFcdWZmZmRiXCIifSwKCQl7TmFtZSgiIiksICJceGU2XHg5N1x4YTVceGU2XHg5Y1x4YWNceGZmXHhhYVx4OWUiLCAiXCLml6XmnKxcdWZmZmRcdWZmZmRcdWZmZmRcIiJ9LAoJfQoJZm9yIF8sIHR0IDo9IHJhbmdlIHRlc3RzIHsKCQl0LlJ1bih0dC5OYW1lLCBmdW5jKHQgKnRlc3RpbmcuVCkgewoJCQlnb3QsIGVyciA6PSBNYXJzaGFsKHR0LmluKQoJCQlpZiBzdHJpbmcoZ290KSAhPSB0dC53YW50IHx8IGVyciAhPSBuaWwgewoJCQkJdC5FcnJvcmYoIiVzOiBNYXJzaGFsKCVxKTpcblx0Z290OiAgKCVxLCAldilcblx0d2FudDogKCVxLCBuaWwpIiwgdHQuV2hlcmUsIHR0LmluLCBnb3QsIGVyciwgdHQud2FudCkKCQkJfQoJCX0pCgl9Cn0KCmZ1bmMgVGVzdE1hcnNoYWxOdW1iZXJaZXJvVmFsKHQgKnRlc3RpbmcuVCkgewoJdmFyIG4gTnVtYmVyCglvdXQsIGVyciA6PSBNYXJzaGFsKG4pCglpZiBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsZigiTWFyc2hhbCBlcnJvcjogJXYiLCBlcnIpCgl9Cglnb3QgOj0gc3RyaW5nKG91dCkKCWlmIGdvdCAhPSAiMCIgewoJCXQuRmF0YWxmKCJNYXJzaGFsOiBnb3QgJXMsIHdhbnQgMCIsIGdvdCkKCX0KfQoKZnVuYyBUZXN0TWFyc2hhbEVtYmVkcyh0ICp0ZXN0aW5nLlQpIHsKCXRvcCA6PSAmVG9wewoJCUxldmVsMDogMSwKCQlFbWJlZDA6IEVtYmVkMHsKCQkJTGV2ZWwxYjogMiwKCQkJTGV2ZWwxYzogMywKCQl9LAoJCUVtYmVkMGE6ICZFbWJlZDBhewoJCQlMZXZlbDFhOiA1LAoJCQlMZXZlbDFiOiA2LAoJCX0sCgkJRW1iZWQwYjogJkVtYmVkMGJ7CgkJCUxldmVsMWE6IDgsCgkJCUxldmVsMWI6IDksCgkJCUxldmVsMWM6IDEwLAoJCQlMZXZlbDFkOiAxMSwKCQkJTGV2ZWwxZTogMTIsCgkJfSwKCQlMb29wOiBMb29wewoJCQlMb29wMTogMTMsCgkJCUxvb3AyOiAxNCwKCQl9LAoJCUVtYmVkMHA6IEVtYmVkMHB7CgkJCVBvaW50OiBpbWFnZS5Qb2ludHtYOiAxNSwgWTogMTZ9LAoJCX0sCgkJRW1iZWQwcTogRW1iZWQwcXsKCQkJUG9pbnQ6IFBvaW50e1o6IDE3fSwKCQl9LAoJCWVtYmVkOiBlbWJlZHsKCQkJUTogMTgsCgkJfSwKCX0KCWdvdCwgZXJyIDo9IE1hcnNoYWwodG9wKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbGYoIk1hcnNoYWwgZXJyb3I6ICV2IiwgZXJyKQoJfQoJd2FudCA6PSAie1wiTGV2ZWwwXCI6MSxcIkxldmVsMWJcIjoyLFwiTGV2ZWwxY1wiOjMsXCJMZXZlbDFhXCI6NSxcIkxFVkVMMUJcIjo2LFwiZVwiOntcIkxldmVsMWFcIjo4LFwiTGV2ZWwxYlwiOjksXCJMZXZlbDFjXCI6MTAsXCJMZXZlbDFkXCI6MTEsXCJ4XCI6MTJ9LFwiTG9vcDFcIjoxMyxcIkxvb3AyXCI6MTQsXCJYXCI6MTUsXCJZXCI6MTYsXCJaXCI6MTcsXCJRXCI6MTh9IgoJaWYgc3RyaW5nKGdvdCkgIT0gd2FudCB7CgkJdC5FcnJvcmYoIk1hcnNoYWw6XG5cdGdvdDogICVzXG5cdHdhbnQ6ICVzIiwgZ290LCB3YW50KQoJfQp9CgpmdW5jIGVxdWFsRXJyb3IoYSwgYiBlcnJvcikgYm9vbCB7Cglpc0pTT05FcnJvciA6PSBmdW5jKGVyciBlcnJvcikgYm9vbCB7CgkJc3dpdGNoIGVyci4odHlwZSkgewoJCWNhc2UKCQkJKkludmFsaWRVVEY4RXJyb3IsCgkJCSpJbnZhbGlkVW5tYXJzaGFsRXJyb3IsCgkJCSpNYXJzaGFsZXJFcnJvciwKCQkJKlN5bnRheEVycm9yLAoJCQkqVW5tYXJzaGFsRmllbGRFcnJvciwKCQkJKlVubWFyc2hhbFR5cGVFcnJvciwKCQkJKlVuc3VwcG9ydGVkVHlwZUVycm9yLAoJCQkqVW5zdXBwb3J0ZWRWYWx1ZUVycm9yOgoJCQlyZXR1cm4gdHJ1ZQoJCX0KCQlyZXR1cm4gZmFsc2UKCX0KCglpZiBhID09IDUKCUlGTEFfUURJU0MgICAgICAgICAgPSAweDYKCUlGTEFfU1RBVFMgICAgICAgICAgPSAweDcKCUlGTEFfQ09TVCAgICAgICAgICAgPSAweDgKCUlGTEFfUFJJT1JJVFkgICAgICAgPSAweDkKCUlGTEFfTUFTVEVSICAgICAgICAgPSAweGEKCUlGTEFfV0lSRUxFU1MgICAgICAgPSAweGIKCUlGTEFfUFJPVElORk8gICAgICAgPSAweGMKCUlGTEFfVFhRTEVOICAgICAgICAgPSAweGQKCUlGTEFfTUFQICAgICAgICAgICAgPSAweGUKCUlGTEFfV0VJR0hUICAgICAgICAgPSAweGYKCUlGTEFfT1BFUlNUQVRFICAgICAgPSAweDEwCglJRkxBX0xJTktNT0RFICAgICAgID0gMHgxMQoJSUZMQV9MSU5LSU5GTyAgICAgICA9IDB4MTIKCUlGTEFfTkVUX05TX1BJRCAgICAgPSAweDEzCglJRkxBX0lGQUxJQVMgICAgICAgID0gMHgxNAoJSUZMQV9NQVggICAgICAgICAgICA9IDB4MjYKCVJUX1NDT1BFX1VOSVZFUlNFICAgPSAweDAKCVJUX1NDT1BFX1NJVEUgICAgICAgPSAweGM4CglSVF9TQ09QRV9MSU5LICAgICAgID0gMHhmZAoJUlRfU0NPUEVfSE9TVCAgICAgICA9IDB4ZmUKCVJUX1NDT1BFX05PV0hFUkUgICAgPSAweGZmCglSVF9UQUJMRV9VTlNQRUMgICAgID0gMHgwCglSVF9UQUJMRV9DT01QQVQgICAgID0gMHhmYwoJUlRfVEFCTEVfREVGQVVMVCAgICA9IDB4ZmQKCVJUX1RBQkxFX01BSU4gICAgICAgPSAweGZlCglSVF9UQUJMRV9MT0NBTCAgICAgID0gMHhmZgoJUlRfVEFCTEVfTUFYICAgICAgICA9IDB4ZmZmZmZmZmYKCVJUQV9VTlNQRUMgICAgICAgICAgPSAweDAKCVJUQV9EU1QgICAgICAgICAgICAgPSAweDEKCVJUQV9TUkMgICAgICAgICAgICAgPSAweDIKCVJUQV9JSUYgICAgICAgICAgICAgPSAweDMKCVJUQV9PSUYgICAgICAgICAgICAgPSAweDQKCVJUQV9HQVRFV0FZICAgICAgICAgPSAweDUKCVJUQV9QUklPUklUWSAgICAgICAgPSAweDYKCVJUQV9QUkVGU1JDICAgICAgICAgPSAweDcKCVJUQV9NRVRSSUNTICAgICAgICAgPSAweDgKCVJUQV9NVUxUSVBBVEggICAgICAgPSAweDkKCVJUQV9GTE9XICAgICAgICAgICAgPSAweGIKCVJUQV9DQUNIRUlORk8gICAgICAgPSAweGMKCVJUQV9UQUJMRSAgICAgICAgICAgPSAweGYKCVJUTl9VTlNQRUMgICAgICAgICAgPSAweDAKCVJUTl9VTklDQVNUICAgICAgICAgPSAweDEKCVJUTl9MT0NBTCAgICAgICAgICAgPSAweDIKCVJUTl9CUk9BRENBU1QgICAgICAgPSAweDMKCVJUTl9BTllDQVNUICAgICAgICAgPSAweDQKCVJUTl9NVUxUSUNBU1QgICAgICAgPSAweDUKCVJUTl9CTEFDS0hPTEUgICAgICAgPSAweDYKCVJUTl9VTlJFQUNIQUJMRSAgICAgPSAweDcKCVJUTl9QUk9ISUJJVCAgICAgICAgPSAweDgKCVJUTl9USFJPVyAgICAgICAgICAgPSAweDkKCVJUTl9OQVQgICAgICAgICAgICAgPSAweGEKCVJUTl9YUkVTT0xWRSAgICAgICAgPSAweGIKCVJUTkxHUlBfTk9ORSAgICAgICAgPSAweDAKCVJUTkxHUlBfTElOSyAgICAgICAgPSAweDEKCVJUTkxHUlBfTk9USUZZICAgICAgPSAweDIKCVJUTkxHUlBfTkVJR0ggICAgICAgPSAweDMKCVJUTkxHUlBfVEMgICAgICAgICAgPSAweDQKCVJUTkxHUlBfSVBWNF9JRkFERFIgPSAweDUKCVJUTkxHUlBfSVBWNF9NUk9VVEUgPSAweDYKCVJUTkxHUlBfSVBWNF9ST1VURSAgPSAweDcKCVJUTkxHUlBfSVBWNF9SVUxFICAgPSAweDgKCVJUTkxHUlBfSVBWNl9JRkFERFIgPSAweDkKCVJUTkxHUlBfSVBWNl9NUk9VVEUgPSAweGEKCVJUTkxHUlBfSVBWNl9ST1VURSAgPSAweGIKCVJUTkxHUlBfSVBWNl9JRklORk8gPSAweGMKCVJUTkxHUlBfSVBWNl9QUkVGSVggPSAweDEyCglSVE5MR1JQX0lQVjZfUlVMRSAgID0gMHgxMwoJUlROTEdSUF9ORF9VU0VST1BUICA9IDB4MTQKCVNpemVvZk5sTXNnaGRyICAgICAgPSAweDEwCglTaXplb2ZObE1zZ2VyciAgICAgID0gMHgxNAoJU2l6ZW9mUnRHZW5tc2cgICAgICA9IDB4MQoJU2l6ZW9mTmxBdHRyICBhaWwgaW46Ci8vIFMuR3Vlcm9uIGFuZCBWLktyYXNub3YsICJGYXN0IHByaW1lIGZpZWxkIGVsbGlwdGljLWN1cnZlIGNyeXB0b2dyYXBoeSB3aXRoCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAyNTYtYml0IHByaW1lcyIKLy8gaHR0cHM6Ly9saW5rLnNwcmluZ2VyLmNvbS9hcnRpY2xlLzEwLjEwMDclMkZzMTMzODktMDE0LTAwOTAteAovLyBodHRwczovL2VwcmludC5pYWNyLm9yZy8yMDEzLzgxNi5wZGYKCi8vZ286YnVpbGQgKGFtZDY0IHx8IGFybTY0IHx8IHBwYzY0bGUgfHwgczM5MHgpICYmICFwdXJlZ28KCnBhY2thZ2UgbmlzdGVjCgppbXBvcnQgKAoJImNyeXB0by9pbnRlcm5hbC9maXBzMTQwZGVwcy9ieXRlb3JkZXIiCgkiZXJyb3JzIgoJIm1hdGgvYml0cyIKCSJydW50aW1lIgoJInVuc2FmZSIKKQoKLy8gcDI1NkVsZW1lbnQgaXMgYSBQLTI1NiBiYXNlIGZpZWxkIGVsZW1lbnQgaW4gWzAsIFAtMV0gaW4gdGhlIE1vbnRnb21lcnkKLy8gZG9tYWluICh3aXRoIFIgMsKy4oG14oG2KSBhcyBmb3VyIGxpbWJzIGluIGxpdHRsZS1lbmRpYW4gb3JkZXIgdmFsdWUuCnR5cGUgcDI1NkVsZW1lbnQgWzRddWludDY0CgovLyBwMjU2T25lIGlzIG9uZSBpbiB0aGUgTW9udGdvbWVyeSBkb21haW4uCnZhciBwMjU2T25lID0gcDI1NkVsZW1lbnR7MHgwMDAwMDAwMDAwMDAwMDAxLCAweGZmZmZmZmZmMDAwMDAwMDAsCgkweGZmZmZmZmZmZmZmZmZmZmYsIDB4MDAwMDAwMDBmZmZmZmZmZX0KCnZhciBwMjU2WmVybyA9IHAyNTZFbGVtZW50e30KCi8vIHAyNTZQIGlzIDLCsuKBteKBtiAtIDLCssKy4oG0ICsgMsK54oG5wrIgKyAy4oG54oG2IC0gMSBpbiB0aGUgTW9udGdvbWVyeSBkb21haW4uCnZhciBwMjU2UCA9IHAyNTZFbGVtZW50ezB4ZmZmZmZmZmZmZmZmZmZmZiwgMHgwMDAwMDAwMGZmZmZmZmZmLAoJMHgwMDAwMDAwMDAwMDAwMDAwLCAweGZmZmZmZmZmMDAwMDAwMDF9CgovLyBQMjU2UG9pbnQgaXMgYSBQLTI1NiBwb2ludC4gVGhlIHplcm8gdmFsdWUgc2hvdWxkIG5vdCBiZSBhc3N1bWVkIHRvIGJlIHZhbGlkCi8vIChhbHRob3VnaCBpdCBpcyBpbiB0aGlzIGltcGxlbWVudGF0aW9uKS4KdHlwZSBQMjU2UG9pbnQgc3RydWN0IHsKCS8vIChYOlk6WikgYXJlIEphY29iaWFuIGNvb3JkaW5hdGVzIHdoZXJlIHggPSBYL1rCsiBhbmQgeSA9IFkvWsKzLiBUaGUgcG9pbnQKCS8vIGF0IGluZmluaXR5IGNhbiBiZSByZXByZXNlbnRlZCBieSBhbnkgc2V0IG9mIGNvb3JkaW5hdGVzIHdpdGggWiA9IDAuCgl4LCB5LCB6IHAyNTZFbGVtZW50Cn0KCi8vIE5ld1AyNTZQb2ludCByZXR1cm5zIGEgbmV3IFAyNTZQb2ludCByZXByZXNlbnRpbmcgdGhlIHBvaW50IGF0IGluZmluaXR5LgpmdW5jIE5ld1AyNTZQb2ludCgpICpQMjU2UG9pbnQgewoJcmV0dXJuICZQMjU2UG9pbnR7CgkJeDogcDI1Nk9uZSwgeTogcDI1Nk9uZSwgejogcDI1Nlplcm8sCgl9Cn0KCi8vIFNldEdlbmVyYXRvciBzZXRzIHAgdG8gdGhlIGNhbm9uaWNhbCBnZW5lcmF0b3IgYW5kIHJldHVybnMgcC4KZnVuYyAocCAqUDI1NlBvaW50KSBTZXRHZW5lcmF0b3IoKSAqUDI1NlBvaW50IHsKCXAueCA9IHAyNTZFbGVtZW50ezB4NzllNzMwZDQxOGE5MTQzYywgMHg3NWJhOTVmYzVmZWRiNjAxLAoJCTB4NzlmYjczMmI3NzYyMjUxMCwgMHgxODkwNWY3NmE1Mzc1NWM2fQoJcC55ID0gcDI1NkVsZW1lbnR7MHhkZGYyNTM1N2NlOTU1NjBhLCAweDhiNGFiOGU0YmExOWU0NWMsCgkJMHhkMmU4ODY4OGRkMjFmMzI1LCAweDg1NzFmZjE4MjU4ODVkODV9CglwLnogPSBwMjU2T25lCglyZXR1cm4gcAp9CgovLyBTZXQgc2V0cyBwID0gcSBhbmQgcmV0dXJucyBwLgpmdW5jIChwICpQMjU2UG9pbnQpIFNldChxICpQMjU2UG9pbnQpICpQMjU2UG9pbnQgewoJcC54LCBwLnksIHAueiA9IHEueCwgcS55LCBxLnoKCXJldHVybiBwCn0KCmNvbnN0IHAyNTZFbGVtZW50TGVuZ3RoID0gMzIKY29uc3QgcDI1NlVuY29tIHsKCURhdGEgKk15Q2hhckRhdGEKCUF0dHIgKk15QXR0ciBgeG1sOiIsYXR0ciJgCgoJRGF0YTIgTXlDaGFyRGF0YQoJQXR0cjIgTXlBdHRyIGB4bWw6IixhdHRyImAKfQoKZnVuYyBUZXN0VW5tYXJzaGFsZXIodCAqdGVzdGluZy5UKSB7Cgl4bWwgOj0gYDw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+CgkJPE15U3RydWN0IEF0dHI9ImF0dHIxIiBBdHRyMj0iYXR0cjIiPgoJCTxEYXRhPmhlbGxvIDwhLS0gY29tbWVudCAtLT53b3JsZDwvRGF0YT4KCQk8RGF0YTI+aG93ZHkgPCEtLSBjb21tZW50IC0tPndvcmxkPC9EYXRhMj4KCQk8L015U3RydWN0PgoJYAoKCXZhciBtIE15U3RydWN0CglpZiBlcnIgOj0gVW5tYXJzaGFsKFtdYnl0ZSh4bWwpLCAmbSk7IGVyciAhPSBuaWwgewoJCXQuRmF0YWwoZXJyKQoJfQoKCWlmIG0uRGF0YSA9PSBuaWwgfHwgbS5BdHRyID09IG5pbCB8fCBtLkRhdGEuYm9keSAhPSAiaGVsbG8gd29ybGQiIHx8IG0uQXR0ci5hdHRyICE9ICJhdHRyMSIgfHwgbS5EYXRhMi5ib2R5ICE9ICJob3dkeSB3b3JsZCIgfHwgbS5BdHRyMi5hdHRyICE9ICJhdHRyMiIgewoJCXQuRXJyb3JmKCJtPSUjK3ZcbiIsIG0pCgl9Cn0KCnR5cGUgUGVhIHN0cnVjdCB7CglDb3RlbHlkb24gc3RyaW5nCn0KCnR5cGUgUG9kIHN0cnVjdCB7CglQZWEgYW55IGB4bWw6IlBlYSJgCn0KCi8vIGh0dHBzOi8vZ29sYW5nLm9yZy9pc3N1ZS82ODM2CmZ1bmMgVGVzdFVubWFyc2hhbEludG9JbnRlcmZhY2UodCAqdGVzdGluZy5UKSB7Cglwb2QgOj0gbmV3KFBvZCkKCXBvZC5QZWEgPSBuZXcoUGVhKQoJeG1sIDo9IGA8UG9kPjxQZWE+PENvdGVseWRvbj5HcmVlbiBzdHVmZjwvQ290ZWx5ZG9uPjwvUGVhPjwvUG9kPmAKCWVyciA6PSBVbm1hcnNoYWwoW11ieXRlKHhtbCksIHBvZCkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWxmKCJmYWlsZWQgdG8gdW5tYXJzaGFsICVxOiAldiIsIHhtbCwgZXJyKQoJfQoJcGVhLCBvayA6PSBwb2QuUGVhLigqUGVhKQoJaWYgIW9rIHsKCQl0LkZhdGFsZigidW5tYXJzaGFsZWQgaW50byB3cm9uZyB0eXBlOiBoYXZlICVUIHdhbnQgKlBlYSIsIHBvZC5QZWEpCgl9CgloYXZlLCB3YW50IDo9IHBlYS5Db3RlbHlkb24sICJHcmVlbiBzdHVmZiIKCWlmIGhhdmUgIT0gd2FudCB7CgkJdC5FcnJvcmYoImZhaWxlZCB0byB1bm1hcnNoYWwgaW50byBpbnRlcmZhY2UsIGhhdmUgJXEgd2FudCAlcSIsIGhhdmUsIHdhbnQpCgl9Cn0KCnR5cGUgWCBzdHJ1Y3QgewoJRCBzdHJpbmcgYHhtbDoiLGNvbW1lbnQiYAp9CgovLyBJc3N1ZSAxMTExMi4gVW5tYXJzaGFsIG11c3QgcmVqZWN0IGludmFsaWQgY29tbWVudHMuCmZ1bmMgVGVzdE1hbGZvcm1lZENvbW1lbnQodCAqdGVzdGluZy5UKSB7Cgl0ZXN0RGF0YSA6PSBbXXN0cmluZ3sKCQkiPFg+PCEtLSBhLS0tPjwvWD4iLAoJCSI8WD48IS0tIC0tIC0tPjwvWD4iLAoJCSI8WD48IS0tIGEtLWIgLS0+PC9YPiIsCgkJIjxYPjwhLS0tLS0tPjwvWD4iLAoJfQoJZm9yIGksIHRlc3QgOj0gcmFuZ2UgdGVzdERhdGEgewoJCWRhdGEgOj0gW11ieXRlKHRlc3QpCgkJdiA6PSBuZXcoWCkKCQlpZiBlcnIgOj0gVW5tYXJzaGFsKGRhdGEsIHYpOyBlcnIgPT0gbmlsIHsKCQkJdC5FcnJvcmYoIiVkOiB1bm1hcnNoYWwgc2hvdWxkIHJlamVjdCBpbnZhbGlkIGNvbW1lbnRzIiwgaSkKCQl9Cgl9Cn0KCnR5cGUgSVhGaWVsZCBzdHJ1Y3QgewoJRml2ZSAgICAgICAgaW50ICAgICAgYHhtbDoiZml2ZSJgCglOb3RJbm5lclhNTCBbXXN0cmluZyBgeG1sOiIsaW5uZXJ4bWwiYAp9CgovLyBJc3N1ZSAxNTYwMC4gIixpbm5lcnhtbCIgb24gYSBmaWVsZCB0aGF0IGNhbid0IGhvbGQgaXQuCmZ1bmMgVGVzdEludmFsaWRJbm5lclhNTFR5cGUodCAqdGVzdGluZy5UKSB7Cgl2IDo9IG5ldyhJWEZpZWxkKQoJaWYgZXJyIDo9IFVubWFyc2hhbChbXWJ5dGUoYDx0YWc+PGZpdmU+NTwvZml2ZT48aW5uZXJ0YWcvPmthZ2UKLy8gb24gYWxsIHN5c3RlbXMgYXJlIEludGVycnVwdCAoc2VuZCB0aGUgcHJvY2VzcyBhbiBpbnRlcnJ1cHQpIGFuZAovLyBLaWxsIChmb3JjZSB0aGUgcHJvY2VzcyB0byBleGl0KS4gSW50ZXJydXB0IGlzIG5vdCBpbXBsZW1lbnRlZCBvbgovLyBXaW5kb3dzOyB1c2luZyBpdCB3aXRoIFtvcy5Qcm9jZXNzLlNpZ25hbF0gd2lsbCByZXR1cm4gYW4gZXJyb3IuCnZhciAoCglJbnRlcnJ1cHQgU2lnbmFsID0gc3lzY2FsbC5Ob3RlKCJpbnRlcnJ1cHQiKQoJS2lsbCAgICAgIFNpZ25hbCA9IHN5c2NhbGwuTm90ZSgia2lsbCIpCikKCmZ1bmMgc3RhcnRQcm9jZXNzKG5hbWUgc3RyaW5nLCBhcmd2IFtdc3RyaW5nLCBhdHRyICpQcm9jQXR0cikgKHAgKlByb2Nlc3MsIGVyciBlcnJvcikgewoJc3lzYXR0ciA6PSAmc3lzY2FsbC5Qcm9jQXR0cnsKCQlEaXI6IGF0dHIuRGlyLAoJCUVudjogYXR0ci5FbnYsCgkJU3lzOiBhdHRyLlN5cywKCX0KCglzeXNhdHRyLkZpbGVzID0gbWFrZShbXXVpbnRwdHIsIDAsIGxlbihhdHRyLkZpbGVzKSkKCWZvciBfLCBmIDo9IHJhbmdlIGF0dHIuRmlsZXMgewoJCXN5c2F0dHIuRmlsZXMgPSBhcHBlbmQoc3lzYXR0ci5GaWxlcywgZi5GZCgpKQoJfQoKCXBpZCwgXywgZSA6PSBzeXNjYWxsLlN0YXJ0UHJvY2VzcyhuYW1lLCBhcmd2LCBzeXNhdHRyKQoJaWYgZSAhPSBuaWwgewoJCXJldHVybiBuaWwsICZQYXRoRXJyb3J7T3A6ICJmb3JrL2V4ZWMiLCBQYXRoOiBuYW1lLCBFcnI6IGV9Cgl9CgoJcmV0dXJuIG5ld1BJRFByb2Nlc3MocGlkKSwgbmlsCn0KCmZ1bmMgKHAgKlByb2Nlc3MpIHdyaXRlUHJvY0ZpbGUoZmlsZSBzdHJpbmcsIGRhdGEgc3RyaW5nKSBlcnJvciB7CglmLCBlIDo9IE9wZW5GaWxlKCIvcHJvYy8iK3N0cmNvbnYuSXRvYShwLlBpZCkrIi8iK2ZpbGUsIE9fV1JPTkxZLCAwKQoJaWYgZSAhPSBuaWwgewoJCXJldHVybiBlCgl9CglkZWZlciBmLkNsb3NlKCkKCV8sIGUgPSBmLldyaXRlKFtdYnl0ZShkYXRhKSkKCXJldHVybiBlCn0KCmZ1bmMgKHAgKlByb2Nlc3MpIHNpZ25hbChzaWcgU2lnbmFsKSBlcnJvciB7Cglzd2l0Y2ggcC5waWRTdGF0dXMoKSB7CgljYXNlIHN0YXR1c0RvbmU6CgkJcmV0dXJuIEVyclByb2Nlc3NEb25lCgljYXNlIHN0YXR1c1JlbGVhc2VkOgoJCXJldHVybiBzeXNjYWxsLkVOT0VOVAoJfQoKCWlmIGUgOj0gcC53cml0ZVByb2NGaWxlKCJub3RlIiwgc2lnLlN0cmluZygpKTsgZSAhPSBuaWwgewoJCXJldHVybiBOZXdTeXNjYWxsRXJyb3IoInNpZ25hbCIsIGUpCgl9CglyZXR1cm4gbmlsCn0KCmZ1bmMgKHAgKlByb2Nlc3MpIGtpbGwoKSBlcnJvciB7CglyZXR1cm4gcC5zaWduYWwoS2lsbCkKfQoKZnVuYyAocCAqUHJvY2Vzcykgd2FpdCgpIChwcyAqUHJvY2Vzc1N0YXRlLCBlcnIgZXJyb3IpIHsKCXZhciB3YWl0bXNnIHN5c2NhbGwuV2FpdG1zZwoKCXN3aXRjaCBwLnBpZFN0YXR1cygpIHsKCWNhc2Ugc3RhdHVzUmVsZWFzZWQ6CgkJcmV0dXJuIG5pbCwgRXJySW52YWxpZAoJfQoKCWVyciA9IHN5c2NhbGwuV2FpdFByb2Nlc3MocC5QaWQsICZ3YWl0bXNnKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgTmV3U3lzY2FsbEVycm9yKCJ3YWl0IiwgZXJyKQoJfQoKCXAuZG9SZWxlYXNlKHN0YXR1c0RvbmUpCglwcyA9ICZQcm9jZXNzU3RhdGV7CgkJcGlkOiAgICB3YWl0bXNnLlBpZCwKCQlzdGF0dXM6ICZ3YWl0bXNnLAoJfQoJcmV0dXJuIHBzLCBuaWwKfQoKZnVuYyAocCAqUHJvY2Vzcykgd2l0aEhhbmRsZShfIGZ1bmMoaGFuZGxlIHVpbnRwdHIpKSBlcnJvciB7CglyZXR1cm4gRXJyTm9IYW5kbGUKfQoKZnVuYyBmaW5kUHJvY2VzcyhwaWQgaW50KSAocCAqUHJvY2VzcywgZXJyIGVycm9yKSB7CgkvLyBOT09QIGZvciBQbGFuIDkuCglyZXR1cm4gbmV3UElEUHJvY2VzcyhwaWQpLCBuaWwKfQoKLy8gUHJvY2Vzc1N0YXRlIHN0b3JlcyBpbmZvcm1hdGlvbiBhYm91dCBhIHByb2MsCgl9LCB7CgkJbmFtZTogIk1rZGlyIiwKCQlmOiBmdW5jKHIgKm9zLlJvb3QsIGZpbGVuYW1lIHN0cmluZykgZXJyb3IgewoJCQlyZXR1cm4gci5Na2RpcihmaWxlbmFtZSwgMG83NzcpCgkJfSwKCX19IHsKCQllcnIgOj0gdGVzdC5mKHIsICJ0YXJnZXQiKQoJCXBlLCBvayA6PSBlcnIuKCpvcy5QYXRoRXJyb3IpCgkJaWYgIW9rIHx8IHBlLlBhdGggIT0gInRhcmdldCIgfHwgcGUuRXJyICE9IG9zLkVyckNsb3NlZCB7CgkJCXQuRXJyb3JmKGByLiV2ID0gJXY7IHdhbnQgJlBhdGhFcnJvcntQYXRoOiAidGFyZ2V0IiwgRXJyOiBFcnJDbG9zZWR9YCwgdGVzdC5uYW1lLCBlcnIpCgkJfQoJfQp9CgpmdW5jIFRlc3RSb290Q29uY3VycmVudENsb3NlKHQgKnRlc3RpbmcuVCkgewoJciwgZXJyIDo9IG9zLk9wZW5Sb290KHQuVGVtcERpcigpKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9CgljaCA6PSBtYWtlKGNoYW4gZXJyb3IsIDEpCglnbyBmdW5jKCkgewoJCWRlZmVyIGNsb3NlKGNoKQoJCWZpcnN0IDo9IHRydWUKCQlmb3IgewoJCQlmLCBlcnIgOj0gci5PcGVuRmlsZSgiZmlsZSIsIG9zLk9fUkRXUnxvcy5PX0NSRUFURSwgMG82NjYpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJY2ggPC0gZXJyCgkJCQlyZXR1cm4KCQkJfQoJCQlpZiBmaXJzdCB7CgkJCQljaCA8LSBuaWwKCQkJCWZpcnN0ID0gZmFsc2UKCQkJfQoJCQlmLkNsb3NlKCkKCQkJaWYgcnVudGltZS5HT0FSQ0ggPT0gIndhc20iIHsKCQkJCS8vIFRPRE8oZ28uZGV2L2lzc3VlLzcxMTM0KSBjYW4gbGVhZCB0byBnb3JvdXRpbmUgc3RhcnZhdGlvbi4KCQkJCXJ1bnRpbWUuR29zY2hlZCgpCgkJCX0KCQl9Cgl9KCkKCWlmIGVyciA6PSA8LWNoOyBlcnIgIT0gbmlsIHsKCQl0LkVycm9yZigiT3BlbkZpbGU6ICV2LCB3YW50IHN1Y2Nlc3MiLCBlcnIpCgl9CglyLkNsb3NlKCkKCWlmIGVyciA6PSA8LWNoOyAhZXJyb3JzLklzKGVyciwgb3MuRXJyQ2xvc2VkKSB7CgkJdC5FcnJvcmYoIk9wZW5GaWxlOiAldiwgd2FudCBFcnJDbG9zZWQiLCBlcnIpCgl9Cn0KCi8vIFRlc3RSb290UmFjZVJlbmFtZURpciBhdHRlbXB0cyB0byBlc2NhcGUgYSBSb290IGJ5IHJlbmFtaW5nIGEgcGF0aCBjb21wb25lbnQgbWlkLXBhcnNlLgovLwovLyBXZSBjcmVhdGUgYSBkZWVwbHkgbmVzdGVkIGRpcmVjdG9yeToKLy8KLy8JYmFzZS9hL2EvYS9hLyBbLi4uXSAvYQovLwovLyBBbmQgYSBwYXRoIHRoYXQgZGVzY2VuZHMgaW50byB0aGUgdHJlZSwgdGhlbiByZXR1cm5zIHRvIHRoZSB0b3AgdXNpbmcgLi46Ci8vCi8vCWJhc2UvYS9hL2EvYS8gWy4uLl0gL2EvLi4vLi4vLi4vIFsuLl0gLy4uL2EvZgovLwovLyBXaGlsZSBvcGVuaW5nIHRoaXMgZmlsZSwgd2UgcmVuYW1lIGJhc2UvYS9hIHRvIGJhc2UvYi4KLy8gQSBuYWl2ZSBsb29rdXAgb3BlcmF0aW9uIHdpbGwgcmVzb2x2ZSB0aGUgcGF0aCB0byBiYXNlL2YuCmZ1bmMgVGVzdFJvb3RSYWNlUmVuYW1lRGlyKHQgKnRlc3RpbmcuVCkgewoJZGlyIDo9IHQuVGVtcERpcigpCglyLCBlcnIgOj0gb3MuT3BlblJvb3QoZGlyKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9CglkZWZlciByLkNsb3NlKCkKCgljb25zdCBkZXB0aCA9IDQKCglvcy5Na2RpckFsbChkaXIrIi9iYXNlLyIrc3RyaW5ncy5SZXBlYXQoIi9hIiwgZGVwdGgpLCAwbzc3NykKCglwYXRoIDo9ICJiYXNlLyIgKyBzdHJpbmdzLlJlcGVhdCgiYS8iLCBkZXB0aCkgKyBzdHJpbmdzLlJlcGVhdCgiLi4vIiwgZGVwdGgpICsgImEvZiIKCW9zLldyaXRlRmlsZShkaXIrIi9mIiwgW11ieXRlKCJzZWNyZXQiKSwgMG82NjYpCglvcy5Xcml0ZUZpbGUoZGlyKyIvYmFzZS9hL2YiLCBbXWJ5dGUoInB1YmxpYyIpLCAwbzY2NikKCgkvLyBDb21wdXRlIGhvdyBsb25nIGl0IHRha2VzIHRvIG9wZW4gdGhlIHBhdGggaW4gdGhlIGNvbW1vbiBjYXNlLgoJY29uc3QgdHJpZXMgPSAxMAoJdmFyIHRvdGFlKDIpIGZpbGVzLgoKcGFja2FnZSB0aW1lCgppbXBvcnQgKAoJInN5c2NhbGwiCikKCnZhciBwbGF0Zm9ybVpvbmVTb3VyY2VzIFtdc3RyaW5nIC8vIG5vbmUgb24gUGxhbiA5CgpmdW5jIGlzU3BhY2UociBydW5lKSBib29sIHsKCXJldHVybiByID09ICcgJyB8fCByID09ICdcdCcgfHwgciA9PSAnXG4nCn0KCi8vIENvcGllZCBmcm9tIHN0cmluZ3MgdG8gYXZvaWQgYSBkZXBlbmRlbmN5LgpmdW5jIGZpZWxkcyhzIHN0cmluZykgW11zdHJpbmcgewoJLy8gRmlyc3QgY291bnQgdGhlIGZpZWxkcy4KCW4gOj0gMAoJaW5GaWVsZCA6PSBmYWxzZQoJZm9yIF8sIHJ1bmUgOj0gcmFuZ2UgcyB7CgkJd2FzSW5GaWVsZCA6PSBpbkZpZWxkCgkJaW5GaWVsZCA9ICFpc1NwYWNlKHJ1bmUpCgkJaWYgaW5GaWVsZCAmJiAhd2FzSW5GaWVsZCB7CgkJCW4rKwoJCX0KCX0KCgkvLyBOb3cgY3JlYXRlIHRoZW0uCglhIDo9IG1ha2UoW11zdHJpbmcsIG4pCgluYSA6PSAwCglmaWVsZFN0YXJ0IDo9IC0xIC8vIFNldCB0byAtMSB3aGVuIGxvb2tpbmcgZm9yIHN0YXJ0IG9mIGZpZWxkLgoJZm9yIGksIHJ1bmUgOj0gcmFuZ2UgcyB7CgkJaWYgaXNTcGFjZShydW5lKSB7CgkJCWlmIGZpZWxkU3RhcnQgPj0gMCB7CgkJCQlhW25hXSA9IHNbZmllbGRTdGFydDppXQoJCQkJbmErKwoJCQkJZmllbGRTdGFydCA9IC0xCgkJCX0KCQl9IGVsc2UgaWYgZmllbGRTdGFydCA9PSAtMSB7CgkJCWZpZWxkU3RhcnQgPSBpCgkJfQoJfQoJaWYgZmllbGRTdGFydCA+PSAwIHsgLy8gTGFzdCBmaWVsZCBtaWdodCBlbmQgYXQgRU9GLgoJCWFbbmFdID0gc1tmaWVsZFN0YXJ0Ol0KCX0KCXJldHVybiBhCn0KCmZ1bmMgbG9hZFpvbmVEYXRhUGxhbjkocyBzdHJpbmcpIChsICpMb2NhdGlvbiwgZXJyIGVycm9yKSB7CglmIDo9IGZpZWxkcyhzKQoJaWYgbGVuKGYpIDwgNCB7CgkJaWYgbGVuKGYpID09IDIgJiYgZlswXSA9PSAiR01UIiB7CgkJCXJldHVybiBVVEMsIG5pbAoJCX0KCQlyZXR1cm4gbmlsLCBlcnJCYWREYXRhCgl9CgoJdmFyIHpvbmVzIFsyXXpvbmUKCgkvLyBzdGFuZGFyZCB0aW1lem9uZSBvZmZzZXQKCW8sIGVyciA6PSBhdG9pKGZbMV0pCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnJCYWREYXRhCgl9Cgl6b25lc1swXSA9IHpvbmV7bmFtZTogZlswXSwgb2Zmc2V0OiBvLCBpc0RTVDogZmFsc2V9CgoJLy8gYWx0ZXJuYXRlIHRpbWV6b25lIG9mZnNldAoJbywgZXJyID0gYXRvaShmWzNdKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyQmFkRGF0YQoJfQoJem9uZXNbMV0gPSB6b25le25hbWU6IGZbMl0sIG9mZnNldDogbywgaXNEU1Q6IHRydWV9CgoJLy8gdHJhbnNpdGlvbiB0aW1lIHBhaXJzCgl2YXIgdHggW116b25lVHJhbnMKCWYgPSBmWzQ6XQoJZm9yIGkgOj0gMDsgaSA8IGxlbihmKTsgaSsrIHsKCQl6aSA6PSAwCgkJaWYgaSUyID09IDAgewoJCQl6aSA9IDEKCQl9CgkJdCwgZXJyIDo9IGF0b2koZltpXSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyQmFkRGF0YQoJCX0KCQl0IC09IHpvbmVzWzBdLm9mZnNldAoJCXR4ID0gYXBwZW5kKHR4LCB6b25lVHJhbnN7d2hlbjogaW50NjQodCksIGluZGV4OiB1aW50OCh6aSl9KQoJfQoKCS8vIENvbW1pdHRlZCB0byBzdWNjZWVkLgoJbCA9ICZMb2NhdGlvbnt6b25lOiB6b25lc1s6XSwgdHg6IHR4fQoKCS8vIEZpbGwgaW4gdGhlIGNhY2hlIHdpdGggaW5mb3JtYXRpb24gYWJvdXQgcmlnaHQgbm93LAoJLy8gc2luY2UgdGhhdCB3aWxsIGJlIHRoZSBtb3N0IGNvbW1vbiBsb29rdXAuCglzZWMsIF8sIF8gOj0gcnVudGltZU5vdygpCglmb3IgaSA6PSByYW5nZSB0eCB7CgkJaWYgdHhbaV0ud2hlbiA8PSBzZWMgJiYgKGkrMSA9PSBsZW4odHgpIHx8IHNlYyA8IHR4W2krMV0ud2hlbikgewoJCQlsLmNhY2hlU3RhcnQgPSB0eFtpXS53aGVuCgkJCWwuY2FjaGVFbmQgPSBvbWVnYQoJCQlpZiBpKzEgT01JTlVEIiwKCSJBTU9TV0FQVyIsCgkiQU1PQUREVyIsCgkiQU1PQU5EVyIsCgkiQU1PT1JXIiwKCSJBTU9YT1JXIiwKCSJBTU9NQVhXIiwKCSJBTU9NQVhVVyIsCgkiQU1PTUlOVyIsCgkiQU1PTUlOVVciLAoJIkZMVyIsCgkiRlNXIiwKCSJGQUREUyIsCgkiRlNVQlMiLAoJIkZNVUxTIiwKCSJGRElWUyIsCgkiRk1JTlMiLAoJIkZNQVhTIiwKCSJGU1FSVFMiLAoJIkZNQUREUyIsCgkiRk1TVUJTIiwKCSJGTk1BRERTIiwKCSJGTk1TVUJTIiwKCSJGQ1ZUV1MiLAoJIkZDVlRMUyIsCgkiRkNWVFNXIiwKCSJGQ1ZUU0wiLAoJIkZDVlRXVVMiLAoJIkZDVlRMVVMiLAoJIkZDVlRTV1UiLAoJIkZDVlRTTFUiLAoJIkZTR05KUyIsCgkiRlNHTkpOUyIsCgkiRlNHTkpYUyIsCgkiRk1WWFMiLAoJIkZNVlNYIiwKCSJGTVZYVyIsCgkiRk1WV1giLAoJIkZFUVMiLAoJIkZMVFMiLAoJIkZMRVMiLAoJIkZDTEFTU1MiLAoJIkZMRCIsCgkiRlNEIiwKCSJGQURERCIsCgkiRlNVQkQiLAoJIkZNVUxEIiwKCSJGRElWRCIsCgkiRk1JTkQiLAoJIkZNQVhEIiwKCSJGU1FSVEQiLAoJIkZNQURERCIsCgkiRk1TVUJEIiwKCSJGTk1BREREIiwKCSJGTk1TVUJEIiwKCSJGQ1ZUV0QiLAoJIkZDVlRMRCIsCgkiRkNWVERXIiwKCSJGQ1ZUREwiLAoJIkZDVlRXVUQiLAoJIkZDVlRMVUQiLAoJIkZDVlREV1UiLAoJIkZDVlRETFUiLAoJIkZDVlRTRCIsCgkiRkNWVERTIiwKCSJGU0dOSkQiLAoJIkZTR05KTkQiLAoJIkZTR05KWEQiLAoJIkZNVlhEIiwKCSJGTVZEWCIsCgkiRkVRRCIsCgkiRkxURCIsCgkiRkxFRCIsCgkiRkNMQVNTRCIsCgkiRkxRIiwKCSJGU1EiLAoJIkZBRERRIiwKCSJGU1VCUSIsCgkiRk1VTFEiLAoJIkZESVZRIiwKCSJGTUlOUSIsCgkiRk1BWFEiLAoJIkZTUVJUUSIsCgkiRk1BRERRIiwKCSJGTVNVQlEiLAoJIkZOTUFERFEiLAoJIkZOTVNVQlEiLAoJIkZDVlRXUSIsCgkiRkNWVExRIiwKCSJGQ1ZUU1EiLAoJIkZDVlREUSIsCgkiRkNWVFFXIiwKCSJGQ1ZUUUwiLAoJIkZDVlRRUyIsCgkiRkNWVFFEIiwKCSJGQ1ZUV1VRIiwKCSJGQ1ZUTFVRIiwKCSJGQ1ZUUVdVIiwKCSJGQ1ZUUUxVIiwKCSJGU0dOSlEiLAoJIkZTR05KTlEiLAoJIkZTR05KWFEiLAoJIkZFUVEiLAoJIkZMRVEiLAoJIkZMVFEiLAoJIkZDTEFTU1EiLAoJIkNMV1NQIiwKCSJDTERTUCIsCgkiQ0ZMRFNQIiwKCSJDU1dTUCIsCgkiQ1NEU1AiLAoJIkNGU0RTUCIsCgkiQ0xXIiwKCSJDTEQiLAoJIkNGTEQiLAoJIkNTVyIsCgkiQ1NEIiwKCSJDRlNEIiwKCSJDSiIsCgkiQ0pSIiwKCSJDSkFMUiIsCgkiQ0JFUVoiLAoJIkNCTkVaIiwKCSJDTEkiLAoJIkNMVUkiLAoJIkNBRERJIiwKCSJDQURESVciLAoJIkNBRERJMTZTUCIsCgkiQ0FEREk0U1BOIiwKCSJDU0xMSSIsCgkiQ1NSTEkiLAoJIkNTUkFJIiwKCSJDQU5ESSIsCgkiQ01WIiwKCSJDQUREIiwKCSJDQU5EIiwKCSJDT1IiLAoJIkNYT1IiLAoJIkNTVUIiLAoJIkNBRERXIiwKCSJDU1VCVyIsCgkiQ05PUCIsCgkiQ0VCUkVBSyIsCgkiQUREVVciLAoJIlNIMUFERCIsCgkiU0gxQUREVVciLAoJIlNIMkFERCIsCgkiU0gyQUREVVciLAoJIlNIM0FERCIsCgkiU0gzQUREVVciLAoJIlNMTElVVyIsCgkiQU5ETiIsCgkiT1JOIiwKCSJYTk9SIiwKCSJDTFoiLAoJIkNMWlciLAoJIkNUWiIsCgkiQ1RaVyIsCgkiQ1BPUCIsCgkiQ1BPUFciLAoJIk1BWCIsCgkiTUFYVSIsCgkiTUlOIiwKCSJNSU5VIiwKCSJTRVhUQiIsCgkiU0VYVEgiLAoJIlpFWFRIIiwKCSJST0wiLAoJIlJPTFciLAoJIlJPUiIsCgkiUk9SSSIsCgkiUk9SSVciLAoJIlJPUlciLAoJIk9SQ0IiLAoJIlJFVjgiLAoJIkJDTFIiLAoJIkJDTFJJIiwKCSJCRVhUIiwKCSJCRVhUSSIsCgkiQklOViIsCgkiQklOVkkiLAoJIkJTRVQiLAoJIkJTRVRJIiwKCSJWU0VUVkxJIiwKCSJWU0VUSVZMSSIsCgkiVlNFVFZMIiwKCSJWTEU4ViIsCgkiVkxFMTZWIiwKCSJWTEUzMlYiLAoJIlZMRTY0ViIsCgkiVlNFOFYiLDA0NzQ2YQoJVElPQ01PRFMgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ2ZAoJVElPQ01TRVQgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ2ZAoJVElPQ01fQ0FSICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0MAoJVElPQ01fQ0QgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0MAoJVElPQ01fQ1RTICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMAoJVElPQ01fRFNSICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDAKCVRJT0NNX0RUUiAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJVElPQ01fTEUgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglUSU9DTV9SSSAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglUSU9DTV9STkcgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglUSU9DTV9SVFMgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCVRJT0NNX1NSICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAKCVRJT0NNX1NUICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4OAoJVElPQ05PVFRZICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQ3MQoJVElPQ05YQ0wgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQwZQoJVElPQ09VVFEgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0MDA0NzQ3MwoJVElPQ1BLVCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ3MAoJVElPQ1BLVF9EQVRBICAgICAgICAgICAgICAgICAgICAgID0gMHgwCglUSU9DUEtUX0RPU1RPUCAgICAgICAgICAgICAgICAgICAgPSAweDIwCglUSU9DUEtUX0ZMVVNIUkVBRCAgICAgICAgICAgICAgICAgPSAweDEKCVRJT0NQS1RfRkxVU0hXUklURSAgICAgICAgICAgICAgICA9IDB4MgoJVElPQ1BLVF9JT0NUTCAgICAgICAgICAgICAgICAgICAgID0gMHg0MAoJVElPQ1BLVF9OT1NUT1AgICAgICAgICAgICAgICAgICAgID0gMHgxMAoJVElPQ1BLVF9TVEFSVCAgICAgICAgICAgICAgICAgICAgID0gMHg4CglUSU9DUEtUX1NUT1AgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCVRJT0NSRU1PVEUgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0NjkKCVRJT0NTQlJLICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0N2IKCVRJT0NTQ1RUWSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0NjEKCVRJT0NTRFRSICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0NzkKCVRJT0NTRVRBICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAyYzc0MTQKCVRJT0NTRVRBRiAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAyYzc0MTYKCVRJT0NTRVRBVyAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAyYzc0MTUKCVRJT0NTRVREICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0MWIKCVRJT0NTRVRWRVJBVVRIICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0MWMKCVRJT0NTRkxBR1MgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0NWMKCVRJT0NTSUcgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0NWYKCVRJT0NTUEdSUCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0NzYKCVRJT0NTVEFSVCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0NmUKCVRJT0NTVEFUICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0NjUKCVRJT0NTVE9QICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMDc0NmYKCVRJT0NTVFNUQU1QICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwODc0NWEKCVRJT0NTV0lOU1ogICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwODc0NjcKCVRJT0NVQ05UTCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDc0NjYKCVRJT0NVQ05UTF9DQlJLIGF0ZSkgc3RhcnRMaXN0SXRlbShzICpsaW5lKSBib29sIHsKCXQgOj0gKnMKCW4gOj0gMAoJZm9yIGkgOj0gMDsgaSA8IDM7IGkrKyB7CgkJaWYgIXQudHJpbVNwYWNlKDEsIDEsIGZhbHNlKSB7CgkJCWJyZWFrCgkJfQoJCW4rKwoJfQoJYnVsbGV0IDo9IHQucGVlaygpCgl2YXIgbnVtIGludApTd2l0Y2g6Cglzd2l0Y2ggYnVsbGV0IHsKCWRlZmF1bHQ6CgkJcmV0dXJuIGZhbHNlCgljYXNlICctJywgJyonLCAnKyc6CgkJdC50cmltKGJ1bGxldCkKCQluKysKCWNhc2UgJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknOgoJCWZvciBqIDo9IHQuaTsgOyBqKysgewoJCQlpZiBqID49IGxlbih0LnRleHQpIHsKCQkJCXJldHVybiBmYWxzZQoJCQl9CgkJCWMgOj0gdC50ZXh0W2pdCgkJCWlmIGMgPT0gJy4nIHx8IGMgPT0gJyknIHsKCQkJCS8vIHN1Y2Nlc3MKCQkJCWJ1bGxldCA9IGMKCQkJCWorKwoJCQkJbiArPSBqIC0gdC5pCgkJCQl0LmkgPSBqCgkJCQlicmVhayBTd2l0Y2gKCQkJfQoJCQlpZiBjIDwgJzAnIHx8ICc5JyA8IGMgewoJCQkJcmV0dXJuIGZhbHNlCgkJCX0KCQkJaWYgai10LmkgPj0gOSB7CgkJCQlyZXR1cm4gZmFsc2UKCQkJfQoJCQludW0gPSBudW0qMTAgKyBpbnQoYykgLSAnMCcKCQl9CgoJfQoJaWYgIXQudHJpbVNwYWNlKDEsIDEsIHRydWUpIHsKCQlyZXR1cm4gZmFsc2UKCX0KCW4rKwoJdHQgOj0gdAoJbSA6PSAwCglmb3IgaSA6PSAwOyBpIDwgMyAmJiB0dC50cmltU3BhY2UoMSwgMSwgZmFsc2UpOyBpKysgewoJCW0rKwoJfQoJaWYgIXR0LnRyaW1TcGFjZSgxLCAxLCB0cnVlKSB7CgkJbiArPSBtCgkJdCA9IHR0Cgl9CgoJLy8gcG9pbnQgb2Ygbm8gcmV0dXJuCgoJdmFyIGxpc3QgKmxpc3RCdWlsZGVyCglpZiBjLCBvayA6PSBwLm5leHRCKCkuKCpsaXN0QnVpbGRlcik7IG9rIHsKCQlsaXN0ID0gYwoJfQoJaWYgbGlzdCA9PSBuaWwgfHwgbGlzdC5idWxsZXQgIT0gcnVuZShidWxsZXQpIHsKCQkvLyDigJxXaGVuIHRoZSBmaXJzdCBsaXN0IGl0ZW0gaW4gYSBsaXN0IGludGVycnVwdHMgYSBwYXJhZ3JhcGjigJR0aGF0IGlzLAoJCS8vIHdoZW4gaXQgc3RhcnRzIG9uIGEgbGluZSB0aGF0IHdvdWxkIG90aGVyd2lzZSBjb3VudCBhcwoJCS8vIHBhcmFncmFwaCBjb250aW51YXRpb24gdGV4dOKAlHRoZW4gKGEpIHRoZSBsaW5lcyBMcyBtdXN0CgkJLy8gbm90IGJlZ2luIHdpdGggYSBibGFuayBsaW5lLAoJCS8vIGFuZCAoYikgaWYgdGhlIGxpc3QgaXRlbSBpcyBvcmRlcmVkLCB0aGUgc3RhcnQgbnVtYmVyIG11c3QgYmUgMS7igJ0KCQlpZiBsaXN0ID09IG5pbCAmJiBwLnBhcmEoKSAhPSBuaWwgJiYgKHQuaXNCbGFuaygpIHx8IChidWxsZXQgPT0gJy4nIHx8IGJ1bGxldCA9PSAnKScpICYmIG51bSAhPSAxKSB7CgkJCS8vIEdvbGRtYXJrIGFuZCBEaW5ndXMgYm90aCBzZWVtIHRvIGdldCB0aGlzIHdyb25nCgkJCS8vIChvciB0aGUgd29yZHMgYWJvdmUgZG9uJ3QgbWVhbiB3aGF0IHdlIHRoaW5rIHRoZXkgZG8pLgoJCQkvLyB3aGVuIHRoZSBwYXJhZ3JhcGggdGhhdCBjb3VsZCBiZSBjb250aW51ZWQKCQkJLy8gaXMgaW5zaWRlIGEgYmxvY2sgcXVvdGUuCgkJCS8vIFNlZSB0ZXN0ZGF0YS9leHRyYS50eHQgMTE3Lm1kLgoJCQlwLmNvcm5lciA9IHRydWUKCQkJcmV0dXJuIGZhbHNlCgkJfQoJCWxpc3QgPSAmbGlzdEJ1aWxkZXJ7YnVsbGV0OiBydW5lKGJ1bGxldCksIG51bTogbnVtfQoJCXAuYWRkQmxvY2sobGlzdCkKCX0KCWIgOj0gJml0ZW1CdWlsZGVye2xpc3Q6IGxpc3QsIHdpZHRoOiBuLCBoYXZlQ29udGVudDogIXQuaXNCbGFuaygpfQoJbGlzdC50b2RvID0gZnVuYygpIGxpbmUgewoJCXAuYWRkQmxvY2soYikKCQlsaXN0Lml0ZW0gPSBiCgkJcmV0dXJuIHQKCX0KCXJldHVybiB0cnVlCn0KCi8vIEdpdEh1YiB0YXNrIGxpc3QgZXh0ZW5zaW9uCgpmdW5jIChwICpwYXJzZVN0YXRlKSB0YXNrTGlzdGVzLgoJbnYgOj0gMAoJZm9yIF8sIHZ2IDo9IHJhbmdlIGggewoJCW52ICs9IGxlbih2dikKCX0KCXN2IDo9IG1ha2UoW11zdHJpbmcsIG52KSAvLyBzaGFyZWQgYmFja2luZyBhcnJheSBmb3IgaGVhZGVycycgdmFsdWVzCgloMiA6PSBtYWtlKEhlYWRlciwgbGVuKGgpKQoJZm9yIGssIHZ2IDo9IHJhbmdlIGggewoJCWlmIHZ2ID09IG5pbCB7CgkJCS8vIFByZXNlcnZlIG5pbCB2YWx1ZXMuIFJldmVyc2VQcm94eSBkaXN0aW5ndWlzaGVzCgkJCS8vIGJldHdlZW4gbmlsIGFuZCB6ZXJvLWxlbmd0aCBoZWFkZXIgdmFsdWVzLgoJCQloMltrXSA9IG5pbAoJCQljb250aW51ZQoJCX0KCQluIDo9IGNvcHkoc3YsIHZ2KQoJCWgyW2tdID0gc3ZbOm46bl0KCQlzdiA9IHN2W246XQoJfQoJcmV0dXJuIGgyCn0KCnZhciB0aW1lRm9ybWF0cyA9IFtdc3RyaW5newoJVGltZUZvcm1hdCwKCXRpbWUuUkZDODUwLAoJdGltZS5BTlNJQywKfQoKLy8gUGFyc2VUaW1lIHBhcnNlcyBhIHRpbWUgaGVhZGVyIChzdWNoIGFzIHRoZSBEYXRlOiBoZWFkZXIpLAovLyB0cnlpbmcgZWFjaCBvZiB0aGUgdGhyZWUgZm9ybWF0cyBhbGxvd2VkIGJ5IEhUVFAvMS4xOgovLyBbVGltZUZvcm1hdF0sIFt0aW1lLlJGQzg1MF0sIGFuZCBbdGltZS5BTlNJQ10uCmZ1bmMgUGFyc2VUaW1lKHRleHQgc3RyaW5nKSAodCB0aW1lLlRpbWUsIGVyciBlcnJvcikgewoJZm9yIF8sIGxheW91dCA6PSByYW5nZSB0aW1lRm9ybWF0cyB7CgkJdCwgZXJyID0gdGltZS5QYXJzZShsYXlvdXQsIHRleHQpCgkJaWYgZXJyID09IG5pbCB7CgkJCXJldHVybgoJCX0KCX0KCXJldHVybgp9Cgp2YXIgaGVhZGVyTmV3bGluZVRvU3BhY2UgPSBzdHJpbmdzLk5ld1JlcGxhY2VyKCJcbiIsICIgIiwgIlxyIiwgIiAiKQoKLy8gc3RyaW5nV3JpdGVyIGltcGxlbWVudHMgV3JpdGVTdHJpbmcgb24gYSBXcml0ZXIuCnR5cGUgc3RyaW5nV3JpdGVyIHN0cnVjdCB7Cgl3IGlvLldyaXRlcgp9CgpmdW5jICh3IHN0cmluZ1dyaXRlcikgV3JpdGVTdHJpbmcocyBzdHJpbmcpIChuIGludCwgZXJyIGVycm9yKSB7CglyZXR1cm4gdy53LldyaXRlKFtdYnl0ZShzKSkKfQoKdHlwZSBrZXlWYWx1ZXMgc3RydWN0IHsKCWtleSAgICBzdHJpbmcKCXZhbHVlcyBbXXN0cmluZwp9CgovLyBoZWFkZXJTb3J0ZXIgY29udGFpbnMgYSBzbGljZSBvZiBrZXlWYWx1ZXMgc29ydGVkIGJ5IGtleVZhbHVlcy5rZXkuCnR5cGUgaGVhZGVyU29ydGVyIHN0cnVjdCB7CglrdnMgW11rZXlWYWx1ZXMKfQoKdmFyIGhlYWRlclNvcnRlclBvb2wgPSBzeW5jLlBvb2x7CglOZXc6IGZ1bmMoKSBhbnkgeyByZXR1cm4gbmV3KGhlYWRlclNvcnRlcikgfSwKfQoKLy8gc29ydGVkS2V5VmFsdWVzIHJldHVybnMgaCdzIGtleXMgc29ydGVkIGluIHRoZSByZXR1cm5lZCBrdnMKLy8gc2xpY2UuIFRoZSBoZWFkZXJTb3J0ZXIgdXNlZCB0byBzb3J0IGlzIGFsc28gcmV0dXJuZWQsIGZvciBwb3NzaWJsZQovLyByZXR1cm4gdG8gaGVhZGVyU29ydGVyQ2FjaGUuCmZ1bmMgKGggSGVhZGVyKSBzb3J0ZWRLZXlWYWx1ZXMoZXhjbHVkZSBtYXBbc3RyaW5nXWJvb2wpIChrdnMgW11rZXlWYWx1ZXMsIGhzICpoZWFkZXJTb3J0ZXIpIHsKCWhzID0gaGVhZGVyU29ydGVyUG9vbC5HZXQoKS4oKmhlYWRlclNvcnRlcikKCWlmIGNhcChocy5rdnMpIDwgbGVuKGgpIHsKCQlocy5rdnMgPSBtYWtlKFtda2V5VmFsdWVzLCAwLCBsZW4oaCkpCgl9CglrdnMgPSBocy5rdnNbOjBdCglmb3IgaywgdnYgOj0gcmFuZ2UgaCB7CgkJaWYgIWV4Y2x1ZGVba10gewoJCQlrdnMgPSBhcHBlbmQoa3ZzLCBrZXlWYWx1ZXN7aywgdnZ9KQoJCX0KCX0KCWhzLmt2cyA9IGt2cwoJc2xpY2VzLlNvcnRGdW5jKGhzLmt2cywgZnVuYyhhLCBiIGtleVZhbHVlcykgaW50IHsgcmV0dXJuIHN0cmluZ3MuQ29tcGFyZShhLmtleSwgYi5rZXkpIH0pCglyZXR1cm4ga3ZzLCBocwp9CgovLyBXcml0ZVN1YnNldCB3clNRUlRTCglBRlNRUlRTQ0MKCgkvKiA2NC1iaXQgKi8KCglBQ05UTFpECglBQ05UTFpEQ0MKCUFDTVBXIC8qIENNUCB3aXRoIEw9MCAqLwoJQUNNUFdVCglBQ01QQgoJQUZURElWCglBRlRTUVJUCglBRElWRAoJQURJVkRDQwoJQURJVkRFCglBRElWREVDQwoJQURJVkRFVQoJQURJVkRFVUNDCglBRElWRFZDQwoJQURJVkRWCglBRElWRFUKCUFESVZEVUNDCglBRElWRFVWQ0MKCUFESVZEVVYKCUFFWFRTVwoJQUVYVFNXQ0MKCS8qIEFGQ0ZJVzsgQUZDRklXQ0MgKi8KCUFGQ0ZJRAoJQUZDRklEQ0MKCUFGQ0ZJRFUKCUFGQ0ZJRFVDQwoJQUZDRklEUwoJQUZDRklEU0NDCglBRkNUSUQKCUFGQ1RJRENDCglBRkNUSURaCglBRkNUSURaQ0MKCUFMREFSCglBTU9WRAoJQU1PVkRVCglBTU9WV1oKCUFNT1ZXWlUKCUFNVUxIRAoJQU1VTEhEQ0MKCUFNVUxIRFUKCUFNVUxIRFVDQwoJQU1VTExECglBTVVMTERDQwoJQU1VTExEVkNDCglBTVVMTERWCglBUkZJRAoJQVJMRE1JCglBUkxETUlDQwoJQVJMRElNSQoJQVJMRElNSUNDCglBUkxEQwoJQVJMRENDQwoJQVJMRENSCglBUkxEQ1JDQwoJQVJMRElDUgoJQVJMRElDUkNDCglBUkxEQ0wKCUFSTERDTENDCglBUkxESUNMCglBUkxESUNMQ0MKCUFSTERJQwoJQVJMRElDQ0MKCUFDTFJMU0xESQoJQVJPVEwKCUFST1RMVwoJQVNMQklBCglBU0xCSUUKCUFTTEJNRkVFCglBU0xCTUZFVgoJQVNMQk1URQoJQVNMRAoJQVNMRENDCglBU1JECglBU1JBRAoJQVNSQURDQwoJQVNSRENDCglBRVhUU1dTTEkKCUFFWFRTV1NMSUNDCglBU1REQ0NDCglBVEQKCUFTRVRCCgoJLyogNjQtYml0IHBzZXVkbyBvcGVyYXRpb24gKi8KCUFEV09SRAoJQVJFTUQKCUFSRU1EVQoKCS8qIG1vcmUgNjQtYml0IG9wZXJhdGlvbnMgKi8KCUFIUkZJRAoJQVBPUENOVEQKCUFQT1BDTlRXCglBUE9QQ05UQgoJQUNOVFRaVwoJQUNOVFRaV0NDCglBQ05UVFpECglBQ05UVFpEQ0MKCUFDT1BZCglBUEFTVEVDQwoJQURBUk4KCUFNQURESEQKCUFNQURESERVCglBTUFERExECgoJLyogVmVjdG9yICovCglBTFZFQlgKCUFMVkVIWAoJQUxWRVdYCglBTFZYCglBTFZYTAoJQUxWU0wKCUFMVlNSCglBU1RWRUJYCglBU1RWRUhYCglBU1RWRVdYCglBU1RWWAoJQVNUVlhMCglBVkFORAoJQVZBTkRDCglBVk5BTkQKCUFWT1IKCUFWT1JDCglBVk5PUgoJQVZYT1IKCUFWRVFWCglBVkFERFVNCglBVkFERFVCTQoJQVZBRERVSE0KCUFWQUREVVdNCglBVkFERFVETQoJQVZBRERVUU0KCUFWQUREQ1UKCUFWQUREQ1VRCglBVkFERENVVwoJQVZBRERVUwoJQVZBRERVQlMKCUFWQUREVUhTCglBVkFERFVXUwoJQVZBRERTUwoJQVZBRERTQlMKCUFWQUREU0hTCglBVkFERFNXUwoJQVZBRERFCglBVkFEREVVUU0KCUFWQURERUNVUQoJQVZTVUJVTQoJQVZTVUJVQk0KCUFWU1VCVUhNCglBVlNVQlVXTQoJQVZTVUJVRE0KCUFWU1VCVVFNCglBVlNVQkNVCglBVlNVQkNVUQoJQVZTVUJDVVcKCUFWU1VCVVMKCUFWU1VCVUJTCglBVlNVQlVIUwoJQVZTVUJVV1MKCUFWU1VCU1MKCUFWU1VCU0JTCglBVlNVQlNIUwoJQVZTVUJTV1MKCUFWU1VCRQoJQVZTVUJFVVFNCglBVlNVQkVDVVEKCUFWTVVMRVNCCglBVk1VTE9TQgoJQVZNVUxFVUIKCUFWTVVMT1VCCglBVk1VTEVTSAoJQVZNVUxPU0gKCUFWTVVMRVVICglBVk1VTE9VSAoJQVZNVUxFU1cKCUFWTVVMT1NXCglBVk1VTEVVVwoJQVZNVUxPVVcKCUFWTVVMVVdNCglBVlBNU1VNCglBVlBNU1VNQgoJQVZQTVNVTUgKCUFWUE1TVU1XCglBVlBNU1VNRAoJQVZNU1VNVURNCglBVlIKCUFWUkxCCglBVlJMSAoJQVZSTFcKCUFWUkxECglBVlMKCUFWU0xCCglBVlNMSAoJQVZTTFcKCUFWU0wKCUFWU0xPCglBVlNSQgoJQVZTUkgKCUFWU1JXCglBVlNSCglBVlNSTwoJQVZTTEQKCUFWU1JECglBVlNBCglBVlNSQUIKCUFWU1JBSAoJQVZTUkFXCglBVlNSQUQKCUFWU09JCglBVlNMRE9JCglBVkNMWgoJQVZDTFpCCglBVkNMWkgKCUFWQ0xaVwoJQVZDTFpECglBVlBvZ2YoImdvdCAldjsgd2FudCA8ICV2IiwgZWxhcHNlZCwgbWF4RWxhcHNlZCkKCQkJfQoJCX0pCgl9Cn0KCi8vIElzc3VlIDE4ODA2OiBpdCBzaG91bGQgYWx3YXlzIGJlIHBvc3NpYmxlIHRvIG5ldC5EaWFsIGEKLy8gbmV0Lkxpc3RlbmVyKCkuQWRkcigpLlN0cmluZyB3aGVuIHRoZSBsaXN0ZW4gYWRkcmVzcyB3YXMgIjpuIiwgZXZlbgovLyBpZiB0aGUgbWFjaGluZSBoYXMgaGFsZndheSBjb25maWd1cmVkIElQdjYgc3VjaCB0aGF0IGl0IGNhbiBiaW5kIG9uCi8vICI6OiIgbm90IGNvbm5lY3QgYmFjayB0byB0aGF0IHNhbWUgYWRkcmVzcy4KZnVuYyBUZXN0RGlhbExpc3RlbmVyQWRkcih0ICp0ZXN0aW5nLlQpIHsKCWlmICF0ZXN0YWJsZU5ldHdvcmsoInRjcDQiKSB7CgkJdC5Ta2lwZigic2tpcHBpbmc6IGNhbid0IGxpc3RlbiBvbiB0Y3A0IikKCX0KCgkvLyBUaGUgb3JpZ2luYWwgaXNzdWUgcmVwb3J0IHdhcyBmb3IgbGlzdGVuaW5nIG9uIGp1c3QgIjowIiBvbiBhIHN5c3RlbSB0aGF0CgkvLyBzdXBwb3J0cyBib3RoIHRjcDQgYW5kIHRjcDYgZm9yIGV4dGVybmFsIHRyYWZmaWMgYnV0IG9ubHkgdGNwNCBmb3IgbG9vcGJhY2sKCS8vIHRyYWZmaWMuIEhvd2V2ZXIsIHRoZSBwb3J0IG9wZW5lZCBieSAiOjAiIGlzIGV4dGVybmFsbHktYWNjZXNzaWJsZSwgYW5kIG1heQoJLy8gdHJpZ2dlciBmaXJld2FsbCBhbGVydHMgb3Igb3RoZXJ3aXNlIGJlIG1pc3Rha2VuIGZvciBtYWxpY2lvdXMgYWN0aXZpdHkKCS8vIChzZWUgaHR0cHM6Ly9nby5kZXYvaXNzdWUvNTk0OTcpLiBNb3Jlb3ZlciwgaXQgb2Z0ZW4gZG9lcyBub3QgcmVwcm9kdWNlCgkvLyB0aGUgc2NlbmFyaW8gaW4gdGhlIGlzc3VlLCBpbiB3aGljaCB0aGUgcG9ydCAqY2Fubm90KiBiZSBkaWFsZWQgYXMgdGNwNi4KCS8vCgkvLyBUbyBhZGRyZXNzIGJvdGggb2YgdGhvc2UgcHJvYmxlbXMsIHdlIG9wZW4gYSB0Y3A0LW9ubHkgbG9jYWxob3N0IHBvcnQsIGJ1dAoJLy8gdGhlbiBkaWFsIHRoZSBhZGRyZXNzIHN0cmluZyB0aGF0IHRoZSBsaXN0ZW5lciB3b3VsZCBoYXZlIHJlcG9ydGVkIGZvciBhCgkvLyBkdWFsLXN0YWNrIHBvcnQuCglsbiwgZXJyIDo9IExpc3RlbigidGNwNCIsICJsb2NhbGhvc3Q6MCIpCglpZiBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsKGVycikKCX0KCWRlZmVyIGxuLkNsb3NlKCkKCgl0LkxvZ2YoImxpc3RlbmluZyBvbiAlcSIsIGxuLkFkZHIoKSkKCV8sIHBvcnQsIGVyciA6PSBTcGxpdEhvc3RQb3J0KGxuLkFkZHIoKS5TdHJpbmcoKSkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWwoZXJyKQoJfQoKCS8vIElmIHdlIGhhZCBvcGVuZWQgYSBkdWFsLXN0YWNrIHBvcnQgd2l0aG91dCBhbiBleHBsaWNpdCAibG9jYWxob3N0IiBhZGRyZXNzLAoJLy8gdGhlIExpc3RlbmVyIHdvdWxkIGFyYml0cmFyaWx5IHJlcG9ydCBhbiBlbXB0eSB0Y3A2IGFkZHJlc3MgaW4gaXRzIEFkZHIKCS8vIHN0cmluZy4KCS8vCgkvLyBUaGUgZG9jdW1lbnRhdGlvbiBmb3IgRGlhbCBzYXlzIOKAmGlmIHRoZSBob3N0IGlzIGVtcHR5IG9yIGEgbGl0ZXJhbAoJLy8gdW5zcGVjaWZpZWQgSVAgYWRkcmVzcywgYXMgaW4gIjo4MCIsICIwLjAuMC4wOjgwIiBvciAiWzo6XTo4MCIgZm9yIFRDUCBhbmQKCS8vIFVEUCwgIiIsICIwLjAuMC4wIiBvciAiOjoiIGZvciBJUCwgdGhlIGxvY2FsIHN5c3RlbSBpcyBhc3N1bWVkLuKAmQoJLy8gSW4gIzE4ODA2LCBpdCB3YXMgZGVjaWRlZCB0aGF0IHRoYXQgc2hvdWxkIGluY2x1ZGUgdGhlIGxvY2FsIHRjcDQgaG9zdAoJLy8gZXZlbiBpZiB0aGUgc3RyaW5nIGlzIGluIHRoZSB0Y3A2IGZvcm1hdC4KCWRpYWxBZGRyIDo9ICJbOjpdOiIgKyBwb3J0CgljLCBlcnIgOj0gRGlhbCgidGNwNCIsIGRpYWxBZGRyKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbGYoYERpYWwoInRjcDQiLCAlcSk6ICV2YCwgZGlhbEFkZHIsIGVycikKCX0KCWMuQ2xvc2UoKQoJdC5Mb2dmKGBEWVNfUENJQ09ORklHX0lPQkFTRSAgICAgICAgICAgICA9IDIwMAoJU1lTX01VTFRJUExFWEVSICAgICAgICAgICAgICAgICAgPSAyMDEKCVNZU19HRVRERU5UUzY0ICAgICAgICAgICAgICAgICAgID0gMjAyCglTWVNfUElWT1RfUk9PVCAgICAgICAgICAgICAgICAgICA9IDIwMwoJU1lTX0ZDTlRMNjQgICAgICAgICAgICAgICAgICAgICAgPSAyMDQKCVNZU19NQURWSVNFICAgICAgICAgICAgICAgICAgICAgID0gMjA1CglTWVNfTUlOQ09SRSAgICAgICAgICAgICAgICAgICAgICA9IDIwNgoJU1lTX0dFVFRJRCAgICAgICAgICAgICAgICAgICAgICAgPSAyMDcKCVNZU19US0lMTCAgICAgICAgICAgICAgICAgICAgICAgID0gMjA4CglTWVNfU0VUWEFUVFIgICAgICAgICAgICAgICAgICAgICA9IDIwOQoJU1lTX0xTRVRYQVRUUiAgICAgICAgICAgICAgICAgICAgPSAyMTAKCVNZU19GU0VUWEFUVFIgICAgICAgICAgICAgICAgICAgID0gMjExCglTWVNfR0VUWEFUVFIgICAgICAgICAgICAgICAgICAgICA9IDIxMgoJU1lTX0xHRVRYQVRUUiAgICAgICAgICAgICAgICAgICAgPSAyMTMKCVNZU19GR0VUWEFUVFIgICAgICAgICAgICAgICAgICAgID0gMjE0CglTWVNfTElTVFhBVFRSICAgICAgICAgICAgICAgICAgICA9IDIxNQoJU1lTX0xMSVNUWEFUVFIgICAgICAgICAgICAgICAgICAgPSAyMTYKCVNZU19GTElTVFhBVFRSICAgICAgICAgICAgICAgICAgID0gMjE3CglTWVNfUkVNT1ZFWEFUVFIgICAgICAgICAgICAgICAgICA9IDIxOAoJU1lTX0xSRU1PVkVYQVRUUiAgICAgICAgICAgICAgICAgPSAyMTkKCVNZU19GUkVNT1ZFWEFUVFIgICAgICAgICAgICAgICAgID0gMjIwCglTWVNfRlVURVggICAgICAgICAgICAgICAgICAgICAgICA9IDIyMQoJU1lTX1NDSEVEX1NFVEFGRklOSVRZICAgICAgICAgICAgPSAyMjIKCVNZU19TQ0hFRF9HRVRBRkZJTklUWSAgICAgICAgICAgID0gMjIzCglTWVNfVFVYQ0FMTCAgICAgICAgICAgICAgICAgICAgICA9IDIyNQoJU1lTX1NFTkRGSUxFNjQgICAgICAgICAgICAgICAgICAgPSAyMjYKCVNZU19JT19TRVRVUCAgICAgICAgICAgICAgICAgICAgID0gMjI3CglTWVNfSU9fREVTVFJPWSAgICAgICAgICAgICAgICAgICA9IDIyOAoJU1lTX0lPX0dFVEVWRU5UUyAgICAgICAgICAgICAgICAgPSAyMjkKCVNZU19JT19TVUJNSVQgICAgICAgICAgICAgICAgICAgID0gMjMwCglTWVNfSU9fQ0FOQ0VMICAgICAgICAgICAgICAgICAgICA9IDIzMQoJU1lTX1NFVF9USURfQUREUkVTUyAgICAgICAgICAgICAgPSAyMzIKCVNZU19GQURWSVNFNjQgICAgICAgICAgICAgICAgICAgID0gMjMzCglTWVNfRVhJVF9HUk9VUCAgICAgICAgICAgICAgICAgICA9IDIzNAoJU1lTX0xPT0tVUF9EQ09PS0lFICAgICAgICAgICAgICAgPSAyMzUKCVNZU19FUE9MTF9DUkVBVEUgICAgICAgICAgICAgICAgID0gMjM2CglTWVNfRVBPTExfQ1RMICAgICAgICAgICAgICAgICAgICA9IDIzNwoJU1lTX0VQT0xMX1dBSVQgICAgICAgICAgICAgICAgICAgPSAyMzgKCVNZU19SRU1BUF9GSUxFX1BBR0VTICAgICAgICAgICAgID0gMjM5CglTWVNfVElNRVJfQ1JFQVRFICAgICAgICAgICAgICAgICA9IDI0MAoJU1lTX1RJTUVSX1NFVFRJTUUgICAgICAgICAgICAgICAgPSAyNDEKCVNZU19USU1FUl9HRVRUSU1FICAgICAgICAgICAgICAgID0gMjQyCglTWVNfVElNRVJfR0VUT1ZFUlJVTiAgICAgICAgICAgICA9IDI0MwoJU1lTX1RJTUVSX0RFTEVURSAgICAgICAgICAgICAgICAgPSAyNDQKCVNZU19DTE9DS19TRVRUSU1FICAgICAgICAgICAgICAgID0gMjQ1CglTWVNfQ0xPQ0tfR0VUVElNRSAgICAgICAgICAgICAgICA9IDI0NgoJU1lTX0NMT0NLX0dFVFJFUyAgICAgICAgICAgICAgICAgPSAyNDcKCVNZU19DTE9DS19OQU5PU0xFRVAgICAgICAgICAgICAgID0gMjQ4CglTWVNfU1dBUENPTlRFWFQgICAgICAgICAgICAgICAgICA9IDI0OQoJU1lTX1RHS0lMTHJuIHVudmVpbChwYXRoUHRyLCBmbGFnc1B0cikKfQoKLy8gVW52ZWlsQmxvY2sgYmxvY2tzIGZ1dHVyZSB1bnZlaWwgY2FsbHMuCi8vIEZvciBtb3JlIGluZm9ybWF0aW9uIHNlZSB1bnZlaWwoMikuCmZ1bmMgVW52ZWlsQmxvY2soKSBlcnJvciB7CglpZiBlcnIgOj0gc3VwcG9ydHNVbnZlaWwoKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJcmV0dXJuIHVudmVpbChuaWwsIG5pbCkKfQoKLy8gc3VwcG9ydHNVbnZlaWwgY2hlY2tzIGZvciBhdmFpbGFiaWxpdHkgb2YgdGhlIHVudmVpbCgyKSBzeXN0ZW0gY2FsbCBiYXNlZAovLyBvbiB0aGUgcnVubmluZyBPcGVuQlNEIHZlcnNpb24uCmZ1bmMgc3VwcG9ydHNVbnZlaWwoKSBlcnJvciB7CgltYWosIG1pbiwgZXJyIDo9IG1ham1pbigpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CgoJLy8gdW52ZWlsIGlzIG5vdCBhdmFpbGFibGUgYmVmb3JlIDYuNAoJaWYgbWFqIDwgNiB8fCAobWFqID09IDYgJiYgbWluIDw9IDMpIHsKCQlyZXR1cm4gZm10LkVycm9yZigiY2Fubm90IGNhbGwgVW52ZWlsIG9uIE9wZW5CU0QgJWQuJWQiLCBtYWosIG1pbikKCX0KCglyZXR1cm4gbmlsCn0KLy8gQ29weXJpZ2h0IDIwMDkgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCnBhY2thZ2UgbWF0aAoKLyoKCUZsb2F0aW5nLXBvaW50IGh5cGVyYm9saWMgc2luZSBhbmQgY29zaW5lLgoKCVRoZSBleHBvbmVudGlhbCBmdW5jIGlzIGNhbGxlZCBmb3IgYXJndW1lbnRzCglncmVhdGVyIGluIG1hZ25pdHVkZSB0aGFuIDAuNS4KCglBIHNlcmllcyBpcyB1c2VkIGZvciBhcmd1bWVudHMgc21hbGxlciBpbiBtYWduaXR1ZGUgdGhhbiAwLjUuCgoJQ29zaCh4KSBpcyBjb21wdXRlZCBmcm9tIHRoZSBleHBvbmVudGlhbCBmdW5jIGZvcgoJYWxsIGFyZ3VtZW50cy4KKi8KCi8vIFNpbmggcmV0dXJucyB0aGUgaHlwZXJib2xpYyBzaW5lIG9mIHguCi8vCi8vIFNwZWNpYWwgY2FzZXMgYXJlOgovLwovLwlTaW5oKMKxMCkgPSDCsTAKLy8JU2luaCjCsUluZikgPSDCsUluZgovLwlTaW5oKE5hTikgPSBOYU4KZnVuYyBTaW5oKHggZmxvYXQ2NCkgZmxvYXQ2NCB7CglpZiBoYXZlQXJjaFNpbmggewoJCXJldHVybiBhcmNoU2luaCh4KQoJfQoJcmV0dXJuIHNpbmgoeCkKfQoKZnVuYyBzaW5oKHggZmxvYXQ2NCkgZmxvYXQ2NCB7CgkvLyBUaGUgY29lZmZpY2llbnRzIGFyZSAjMjAyOSBmcm9tIEhhcnQgJiBDaGVuZXkuICgyMC4zNkQpCgljb25zdCAoCgkJUDAgPSAtMC42MzA3NjczNjQwNDk3NzE2OTkxMTg0Nzg3MjUxZSs2CgkJUDEgPSAtMC44OTkxMjcyMDIyMDM5NTA5MzU1Mzk4MDEzNTExZSs1CgkJUDIgPSAtMC4yODk0MjExMzU1OTg5NTYzODA3Mjg0NjYwMzY2ZSs0CgkJUDMgPSAtMC4yNjMwNTYzMjEzMzk3NDk3MDYyODE5NDg5ZSsyCgkJUTAgPSAtMC42MzA3NjczNjQwNDk3NzE2OTkxMjEyMDc3Mjc3ZSs2CgkJUTEgPSAwLjE1MjE1MTczNzg3OTAwMTkwNzA2OTY0ODUxNzZlKzUKCQlRMiA9IC0wLjE3MzY3ODk1MzU1ODIzMzY5OTUzMzQ1MDkxMWUrMwoJKQoKCXNpZ24gOj0gZmFsc2UKCWlmIHggPCAwIHsKCQl4ID0gLXgKCQlzaWduID0gdHJ1ZQoJfQoKCXZhciB0ZW1wIGZsb2F0NjQKCXN3aXRjaCB7CgljYXNlIHggPiAyMToKCQl0ZW1wID0gRXhwKHgpICogMC41CgoJY2FzZSB4ID4gMC41OgoJCWV4IDo9IEV4cCh4KQoJCXRlbXAgPSAoZXggLSAxL2V4KSAqIDAuNQoKCWRlZmF1bHQ6CgkJc3EgOj0geCAqIHgKCQl0ZW1wID0gKCgoUDMqc3ErUDIpKnNxK1AxKSpzcSArIFAwKSAqIHgKCQl0ZW1wID0gdGVtcCAvICgoKHNxK1EyKSpzcStRMSkqc3EgKyBRMCkKCX0KCglpZiBzaWduIHsKCQl0ZW1wID0gLXRlbXAKCX0KbmcgPSBhcHBlbmQocG0ucC5NYXBwaW5nLCBtKQoKCS8vIFVwZGF0ZSBtZW1vaXphdGlvbiB0YWJsZXMuCglwbS5tYXBwaW5nc1tta10gPSBtCgltaSA6PSBtYXBJbmZve20sIDB9CglwbS5tYXBwaW5nc0J5SURbc3JjLklEXSA9IG1pCglyZXR1cm4gbWkKfQoKLy8ga2V5IGdlbmVyYXRlcyBlbmNvZGVkIHN0cmluZ3Mgb2YgTWFwcGluZyB0byBiZSB1c2VkIGFzIGEga2V5IGZvcgovLyBtYXBzLgpmdW5jIChtICpNYXBwaW5nKSBrZXkoKSBtYXBwaW5nS2V5IHsKCS8vIE5vcm1hbGl6ZSBhZGRyZXNzZXMgdG8gaGFuZGxlIGFkZHJlc3Mgc3BhY2UgcmFuZG9taXphdGlvbi4KCS8vIFJvdW5kIHVwIHRvIG5leHQgNEsgYm91bmRhcnkgdG8gYXZvaWQgbWlub3IgZGlzY3JlcGFuY2llcy4KCWNvbnN0IG1hcHNpemVSb3VuZGluZyA9IDB4MTAwMAoKCXNpemUgOj0gbS5MaW1pdCAtIG0uU3RhcnQKCXNpemUgPSBzaXplICsgbWFwc2l6ZVJvdW5kaW5nIC0gMQoJc2l6ZSA9IHNpemUgLSAoc2l6ZSAlIG1hcHNpemVSb3VuZGluZykKCWtleSA6PSBtYXBwaW5nS2V5ewoJCXNpemU6ICAgc2l6ZSwKCQlvZmZzZXQ6IG0uT2Zmc2V0LAoJfQoKCXN3aXRjaCB7CgljYXNlIG0uQnVpbGRJRCAhPSAiIjoKCQlrZXkuYnVpbGRJRE9yRmlsZSA9IG0uQnVpbGRJRAoJY2FzZSBtLkZpbGUgIT0gIiI6CgkJa2V5LmJ1aWxkSURPckZpbGUgPSBtLkZpbGUKCWRlZmF1bHQ6CgkJLy8gQSBtYXBwaW5nIGNvbnRhaW5pbmcgbmVpdGhlciBidWlsZCBJRCBub3IgZmlsZSBuYW1lIGlzIGEgZmFrZSBtYXBwaW5nLiBBCgkJLy8ga2V5IHdpdGggZW1wdHkgYnVpbGRJRE9yRmlsZSBpcyB1c2VkIGZvciBmYWtlIG1hcHBpbmdzIHNvIHRoYXQgdGhleSBhcmUKCQkvLyB0cmVhdGVkIGFzIHRoZSBzYW1lIG1hcHBpbmcgZHVyaW5nIG1lcmdpbmcuCgl9CglyZXR1cm4ga2V5Cn0KCnR5cGUgbWFwcGluZ0tleSBzdHJ1Y3QgewoJc2l6ZSwgb2Zmc2V0ICB1aW50NjQKCWJ1aWxkSURPckZpbGUgc3RyaW5nCn0KCmZ1bmMgKHBtICpwcm9maWxlTWVyZ2VyKSBtYXBMaW5lKHNyYyBMaW5lKSBMaW5lIHsKCWxuIDo9IExpbmV7CgkJRnVuY3Rpb246IHBtLm1hcEZ1bmN0aW9uKHNyYy5GdW5jdGlvbiksCgkJTGluZTogICAgIHNyYy5MaW5lLAoJCUNvbHVtbjogICBzcmMuQ29sdW1uLAoJfQoJcmV0dXJuIGxuCn0KCmZ1bmMgKHBtICpwcm9maWxlTWVyZ2VyKSBtYXBGdW5jdGlvbihzcmMgKkZ1bmN0aW9uKSAqRnVuY3Rpb24gewoJaWYgc3JjID09IG5pbCB7CgkJcmV0dXJuIG5pbAoJfQoJaWYgZiwgb2sgOj0gcG0uZnVuY3Rpb25zQnlJRFtzcmMuSURdOyBvayB7CgkJcmV0dXJuIGYKCX0KCWsgOj0gc3JjLmtleSgpCglpZiBmLCBvayA6PSBwbS5mdW5jdGlvbnNba107IG9rIHsKCQlwbS5mdW5jdGlvbnNCeUlEW3NyYy5JRF0gPSBmCgkJcmV0dXJuIGYKCX0KCWYgOj0gJkZ1bmN0aW9uewoJCUlEOiAgICAgICAgIHVpbnQ2NChsZW4ocG0ucC5GdW5jdGlvbikgKyAxKSwKCQlOYW1lOiAgICAgICBzcmMuTmFtZSwKCQlTeXN0ZW1OYW1lOiBzcmMuU3lzdGVtTmFtZSwKCQlGaWxlbmFtZTogICBzcmMuRmlsZW5hbWUsCgkJU3RhcnRMaW5lOiAgc3JjLlN0YXJ0TGluZSwKCX0KCXBtLmZ1bmN0aW9uc1trXSA9IGYKCXBtLmZ1bmN0aW9uc0J5SURbc3JjLklEXSA9IGYKCXBtLnAuRnVuY3Rpb24gPSBhcHBlbmQocG0ucC5GdW5jdGlvbiwgZikKCXJldHVybiBmCn0KCi8vIGtleSBnZW5lcmF0ZXMgYSBzdHJ1Y3QgdG8gYmUgdXNlZCBhcyBhIGtleSBmb3IgbWFwcy4KZnVuYyAoZiAqRnVuY3Rpb24pIGtleSgpIGZ1bmN0aW9uS2V5IHsKCXJldHVybiBmdW5jdGlvbktleXsKCQlmLlN0YXJ0TGluZSwKCQlmLk5hbWUsCgkJZi5TeXN0ZW1OYW1lLAoJCWYuRmlsZW5hbWUsCgl9Cn0KCnR5cGUgZnVuY3Rpb25LZXkgc3RydWN0IHsKCXN0YXJ0TGluZSAgICAgICAgICAgICAgICAgIGludDY0CgluYW1lLCBzeXN0ZW1OYW1lLCBmaWxlTmEJaWYgYSYoMTw8dWludChpKSkgIT0gMCB7CgkJCQlpZiBpID09IGVuZCsxIHsKCQkJCQllbmQrKwoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCQlzdGFydCA9IGkKCQkJCWVuZCA9IGkKCQkJfSBlbHNlIHsKCQkJCWZsdXNoKCkKCQkJfQoJCX0KCQlmbHVzaCgpCgkJZm10LkZwcmludGYoJmJ1ZiwgIl0iKQoJCXJldHVybiBidWYuU3RyaW5nKCkKCgljYXNlIFJlZ1NoaWZ0OgoJCXJldHVybiBmbXQuU3ByaW50ZigiUiVkJXMkJWQiLCBpbnQoYS5SZWcpLCBwbGFuOVNoaWZ0W2EuU2hpZnRdLCBpbnQoYS5Db3VudCkpCgoJY2FzZSBSZWdTaGlmdFJlZzoKCQlyZXR1cm4gZm10LlNwcmludGYoIlIlZCVzUiVkIiwgaW50KGEuUmVnKSwgcGxhbjlTaGlmdFthLlNoaWZ0XSwgaW50KGEuUmVnQ291bnQpKQoJfQoJcmV0dXJuIHN0cmluZ3MuVG9VcHBlcihhcmcuU3RyaW5nKCkpCn0KCi8vIGNvbnZlcnQgbWVtb3J5IG9wZXJhbmQgZnJvbSBHTlUgc3ludGF4IHRvIFBsYW4gOSBzeW50YXgsIGZvciBleGFtcGxlLAovLyBbcjVdIC0+IChSNSkKLy8gW3I2LCAjNDA4MF0gLT4gMHhmZjAoUjYpCi8vIFtyMiwgcjAsIHJvciAjMV0gLT4gKFIyKShSMEA+MSkKLy8gaW5zdCBbcjIsIC1yMCwgcm9yICMxXSAtPiBJTlNULlUgKFIyKShSMEA+MSkKLy8gaW5wdXQ6Ci8vCi8vCWEgbWVtb3J5IG9wZXJhbmQKLy8KLy8gcmV0dXJuIHZhbHVlczoKLy8KLy8JY29ycmVzcG9uZGluZyBtZW1vcnkgb3BlcmFuZCBpbiBQbGFuIDkgc3ludGF4Ci8vCS5XLy5QLy5VIHN1ZmZpeApmdW5jIG1lbU9wVHJhbnMobWVtIE1lbSkgKHN0cmluZywgc3RyaW5nKSB7CglzdWZmaXggOj0gIiIKCXN3aXRjaCBtZW0uTW9kZSB7CgljYXNlIEFkZHJPZmZzZXQsIEFkZHJMRE06CgkJLy8gbm8gc3VmZml4CgljYXNlIEFkZHJQcmVJbmRleCwgQWRkckxETV9XQjoKCQlzdWZmaXggPSAiLlciCgljYXNlIEFkZHJQb3N0SW5kZXg6CgkJc3VmZml4ID0gIi5QIgoJfQoJb2ZmIDo9ICIiCglpZiBtZW0uT2Zmc2V0ICE9IDAgewoJCW9mZiA9IGZtdC5TcHJpbnRmKCIlI3giLCBtZW0uT2Zmc2V0KQoJfQoJYmFzZSA6PSBmbXQuU3ByaW50ZigiKFIlZCkiLCBpbnQobWVtLkJhc2UpKQoJaW5kZXggOj0gIiIKCWlmIG1lbS5TaWduICE9IDAgewoJCXNpZ24gOj0gIiIKCQlpZiBtZW0uU2lnbiA8IDAgewoJCQlzdWZmaXggKz0gIi5VIgoJCX0KCQlzaGlmdCA6PSAiIgoJCWlmIG1lbS5Db3VudCAhPSAwIHsKCQkJc2hpZnQgPSBmbXQuU3ByaW50ZigiJXMlZCIsIHBsYW45U2hpZnRbbWVtLlNoaWZ0XSwgbWVtLkNvdW50KQoJCX0KCQlpbmRleCA9IGZtdC5TcHJpbnRmKCIoJXNSJWQlcykiLCBzaWduLCBpbnQobWVtLkluZGV4KSwgc2hpZnQpCgl9CglyZXR1cm4gb2ZmICsgYmFzZSArIGluZGV4LCBzdWZmaXgKfQoKdHlwZSBnb0ZQSW5mbyBzdHJ1Y3QgewoJb3AgICAgICAgIE9wCgl0cmFuc0FyZ3MgW11pbnQgIC8vIGluZGV4ZXMgb2YgYXJndW1lbnRzIHdoaWNoIG5lZWQgdHJhbnNmb3JtYXRpb24KCWdudU5hbWUgICBzdHJpbmcgLy8gaW5zdHJ1Y3Rpb24gbmFtZSBpbiBHTlUgc3ludGF4Cglnb05hbWUgICAgc3RyaW5nIC8vIGluc3RydWN0aW9uIG5hbWUgaW4gUGxhbiA5IHN5bnRheAp9Cgp2YXIgZnBJbnN0IFtdZ29GUEluZm8gPSBbXWdvRlBJbmZvewoJe1ZBRERfRVFfRjMyLCBbXWludHsyLCAxLCAwfSwgIlZBREQiLCAiQURERiJ9LAoJe1ZBRERfRVFfRjY0LCBbXWludHsyLCAxLCAwfSwgIlZBREQiLCAiQURERCJ9LAoJe1ZTVUJfRVFfRjMyLCBbXWludHsyLCAxLCAwfSwgIlZTVUIiLCAiU1VCRiJ9LAoJe1ZTVUJfRVFfRjY0LCBbXWludHsyLCAxLCAwfSwgIlZTVUIiLCAiU1VCRCJ9LAoJe1ZNVUxfRVFfRjMyLCBbXWludHsyLCAxLCAwfSwgIlZNVUwiLCAiTVVMRiJ9LAoJe1ZNVUxfRVFfRjY0LCBbXWludHsyLCAxLCAwfSwgIlZNVUwiLCAiTVVMRCJ9LAoJe1ZOTVVMX0VRX0YzMiwgW11pbnR7MiwgMSwgMH0sICJWTk1VTCIsICJObHQgYmVoYXZpb3IgaXMgdG8gZXNjYXBlICYsIDwsIGFuZCA+IHRvIFx1MDAyNiwgXHUwMDNjLCBhbmQgXHUwMDNlCi8vIHRvIGF2b2lkIGNlcnRhaW4gc2FmZXR5IHByb2JsZW1zIHRoYXQgY2FuIGFyaXNlIHdoZW4gZW1iZWRkaW5nIEpTT04gaW4gSFRNTC4KLy8KLy8gSW4gbm9uLUhUTUwgc2V0dGluZ3Mgd2hlcmUgdGhlIGVzY2FwaW5nIGludGVyZmVyZXMgd2l0aCB0aGUgcmVhZGFiaWxpdHkKLy8gb2YgdGhlIG91dHB1dCwgU2V0RXNjYXBlSFRNTChmYWxzZSkgZGlzYWJsZXMgdGhpcyBiZWhhdmlvci4KZnVuYyAoZW5jICpFbmNvZGVyKSBTZXRFc2NhcGVIVE1MKG9uIGJvb2wpIHsKCWVuYy5lc2NhcGVIVE1MID0gb24KfQoKLy8gUmF3TWVzc2FnZSBpcyBhIHJhdyBlbmNvZGVkIEpTT04gdmFsdWUuCi8vIEl0IGltcGxlbWVudHMgW01hcnNoYWxlcl0gYW5kIFtVbm1hcnNoYWxlcl0gYW5kIGNhbgovLyBiZSB1c2VkIHRvIGRlbGF5IEpTT04gZGVjb2Rpbmcgb3IgcHJlY29tcHV0ZSBhIEpTT04gZW5jb2RpbmcuCnR5cGUgUmF3TWVzc2FnZSBbXWJ5dGUKCi8vIE1hcnNoYWxKU09OIHJldHVybnMgbSBhcyB0aGUgSlNPTiBlbmNvZGluZyBvZiBtLgpmdW5jIChtIFJhd01lc3NhZ2UpIE1hcnNoYWxKU09OKCkgKFtdYnl0ZSwgZXJyb3IpIHsKCWlmIG0gPT0gbmlsIHsKCQlyZXR1cm4gW11ieXRlKCJudWxsIiksIG5pbAoJfQoJcmV0dXJuIG0sIG5pbAp9CgovLyBVbm1hcnNoYWxKU09OIHNldHMgKm0gdG8gYSBjb3B5IG9mIGRhdGEuCmZ1bmMgKG0gKlJhd01lc3NhZ2UpIFVubWFyc2hhbEpTT04oZGF0YSBbXWJ5dGUpIGVycm9yIHsKCWlmIG0gPT0gbmlsIHsKCQlyZXR1cm4gZXJyb3JzLk5ldygianNvbi5SYXdNZXNzYWdlOiBVbm1hcnNoYWxKU09OIG9uIG5pbCBwb2ludGVyIikKCX0KCSptID0gYXBwZW5kKCgqbSlbMDowXSwgZGF0YS4uLikKCXJldHVybiBuaWwKfQoKdmFyIF8gTWFyc2hhbGVyID0gKCpSYXdNZXNzYWdlKShuaWwpCnZhciBfIFVubWFyc2hhbGVyID0gKCpSYXdNZXNzYWdlKShuaWwpCgovLyBBIFRva2VuIGhvbGRzIGEgdmFsdWUgb2Ygb25lIG9mIHRoZXNlIHR5cGVzOgovLwovLyAgIC0gW0RlbGltXSwgZm9yIHRoZSBmb3VyIEpTT04gZGVsaW1pdGVycyBbIF0geyB9Ci8vICAgLSBib29sLCBmb3IgSlNPTiBib29sZWFucwovLyAgIC0gZmxvYXQ2NCwgZm9yIEpTT04gbnVtYmVycwovLyAgIC0gW051bWJlcl0sIGZvciBKU09OIG51bWJlcnMKLy8gICAtIHN0cmluZywgZm9yIEpTT04gc3RyaW5nIGxpdGVyYWxzCi8vICAgLSBuaWwsIGZvciBKU09OIG51bGwKdHlwZSBUb2tlbiBhbnkKCmNvbnN0ICgKCXRva2VuVG9wVmFsdWUgPSBpb3RhCgl0b2tlbkFycmF5U3RhcnQKCXRva2VuQXJyYXlWYWx1ZQoJdG9rZW5BcnJheUNvbW1hCgl0b2tlbk9iamVjdFN0YXJ0Cgl0b2tlbk9iamVjdEtleQoJdG9rZW5PYmplY3RDb2xvbgoJdG9rZW5PYmplY3RWYWx1ZQoJdG9rZW5PYmplY3RDb21tYQopCgovLyBhZHZhbmNlIHRva2Vuc3RhdGUgZnJvbSBhIHNlcGFyYXRvciBzdGF0ZSB0byBhIHZhbHVlIHN0YXRlCmZ1bmMgKGRlYyAqRGVjb2RlcikgdG9rZW5QcmVwYXJlRm9yRGVjb2RlKCkgZXJyb3IgewoJLy8gTm90ZTogTm90IGNhbGxpbmcgcGVlayBiZWZvcmUgc3dpdGNoLCB0byBhdm9pZAoJLy8gcHV0dGluZyBwZWVrIGludG8gdGhlIHN0YW5kYXJkIERlY29kZSBwYXRoLgoJLy8gcGVlayBpcyBvbmx5IGNhbGxlZCB3aGVuIHVzaW5nIHRoZSBUb2tlbiBBUEkuCglzd2l0Y2ggZGVjLnRva2VuU3RhdGUgewoJY2FzZSB0b2tlbkFycmF5Q29tbWE6CgkJYywgZXJyIDo9IGRlYy5wZWVrKCkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIGVycgoJCX0KCQlpZiBjICE9ICcsJyB7CgkJCXJldHVybiAmU3ludGF4RXJyb3J7ImV4cGVjdGVkIGNvbW1hIGFmdGVyIGFycmF5IGVsZW1lbnQiLCBkZWMuSW5wdXRPZmZzZXQoKX0KCQl9CgkJZGVjLnNjYW5wKysKCQlkZW5hbC9hc2FuIgoJImlvIgoJIml0ZXIiCgkibWF0aCIKCSJtYXRoL3JhbmQiCgkic2xpY2VzIgoJInN0cmNvbnYiCgkuICJzdHJpbmdzIgoJInRlc3RpbmciCgkidW5pY29kZSIKCSJ1bmljb2RlL3V0ZjgiCgkidW5zYWZlIgopCgpmdW5jIGNvbGxlY3QodCAqdGVzdGluZy5ULCBzZXEgaXRlci5TZXFbc3RyaW5nXSkgW11zdHJpbmcgewoJb3V0IDo9IHNsaWNlcy5Db2xsZWN0KHNlcSkKCW91dDEgOj0gc2xpY2VzLkNvbGxlY3Qoc2VxKQoJaWYgIXNsaWNlcy5FcXVhbChvdXQsIG91dDEpIHsKCQl0LkZhdGFsZigiaW5jb25zaXN0ZW50IHNlcTpcbiVzXG4lcyIsIG91dCwgb3V0MSkKCX0KCXJldHVybiBvdXQKfQoKdHlwZSBMaW5lc1Rlc3Qgc3RydWN0IHsKCWEgc3RyaW5nCgliIFtdc3RyaW5nCn0KCnZhciBsaW5lc1Rlc3RzID0gW11MaW5lc1Rlc3R7Cgl7YTogImFiY1xuYWJjXG4iLCBiOiBbXXN0cmluZ3siYWJjXG4iLCAiYWJjXG4ifX0sCgl7YTogImFiY1xyXG5hYmMiLCBiOiBbXXN0cmluZ3siYWJjXHJcbiIsICJhYmMifX0sCgl7YTogImFiY1xyXG4iLCBiOiBbXXN0cmluZ3siYWJjXHJcbiJ9fSwKCXthOiAiXG5hYmMiLCBiOiBbXXN0cmluZ3siXG4iLCAiYWJjIn19LAoJe2E6ICJcbmFiY1xuXG4iLCBiOiBbXXN0cmluZ3siXG4iLCAiYWJjXG4iLCAiXG4ifX0sCn0KCmZ1bmMgVGVzdExpbmVzKHQgKnRlc3RpbmcuVCkgewoJZm9yIF8sIHMgOj0gcmFuZ2UgbGluZXNUZXN0cyB7CgkJcmVzdWx0IDo9IHNsaWNlcy5Db2xsZWN0KExpbmVzKHMuYSkpCgkJaWYgIXNsaWNlcy5FcXVhbChyZXN1bHQsIHMuYikgewoJCQl0LkVycm9yZihgc2xpY2VzLkNvbGxlY3QoTGluZXMoJXEpKSA9ICVxOyB3YW50ICVxYCwgcy5hLCByZXN1bHQsIHMuYikKCQl9Cgl9Cn0KCnZhciBhYmNkID0gImFiY2QiCnZhciBmYWNlcyA9ICLimLrimLvimLkiCnZhciBjb21tYXMgPSAiMSwyLDMsNCIKdmFyIGRvdHMgPSAiMS4uLi4yLi4uLjMuLi4uNCIKCnR5cGUgSW5kZXhUZXN0IHN0cnVjdCB7CglzICAgc3RyaW5nCglzZXAgc3RyaW5nCglvdXQgaW50Cn0KCnZhciBpbmRleFRlc3RzID0gW11JbmRleFRlc3R7Cgl7IiIsICIiLCAwfSwKCXsiIiwgImEiLCAtMX0sCgl7IiIsICJmb28iLCAtMX0sCgl7ImZvIiwgImZvbyIsIC0xfSwKCXsiZm9vIiwgImZvbyIsIDB9LAoJeyJvb2ZvZm9vZm9vbyIsICJmIiwgMn0sCgl7Im9vZm9mb29mb29vIiwgImZvbyIsIDR9LAoJeyJiYXJmb29iYXJmb28iLCAiZm9vIiwgM30sCgl7ImZvbyIsICIiLCAwfSwKCXsiZm9vIiwgIm8iLCAxfSwKCXsiYWJjQUJDYWJjIiwgIkEiLCAzfSwKCXsianJ6bTZqamhvcmltZ2xsanJlYTR3M3JsZ29zdHMwdzJnaWExN2hubzJ0ZDRxZDFqeiIsICJqeiIsIDQ3fSwKCXsiZWtrdWs1b2Z0NGVxMG9jcGFja25od291aWMxdXVhNDZ1bngxMmwzN25pb3E5d2Jwbm9jcWtzNiIsICJrczYiLCA1Mn0sCgl7Ijk5OWYyeG1pbXVuYnV5ZXc1dnJrbGE5Y3B3aG14YW44bzk4ZWMiLCAiOThlYyIsIDMzfSwKCXsiOWxwdDlyOThpMDRrOGJ6NmM2ZHNydGhiOTZiaGkiLCAiOTZiaGkiLCAyNH0sCgl7IjU1dTU1OGVxZmFvZDJyMmd1NDJ4eHN1NjMxeGYwem9iczU4NDB2bCIsICI1ODQwdmwiLCAzM30sCgkvLyBjYXNlcyB3aXRoIG9uZSBieXRlIHN0cmluZ3MgLSB0ZXN0IHNwZWNpYWwgY2FzZSBpbiBJbmRleCgpCgl7IiIsICJhIiwgLTF9LAoJeyJ4IiwgImEiLCAtMX0sCgl7IngiLCAieCIsIDB9LAoJeyJhYmMiLCAiYSIsIDB9LAoJeyJhYmMiLCAiYiIsIDF9LAoJeyJhYmMiLCAiYyIsIDJ9LAoJeyJhYmMiLCAieCIsIC0xfSwKCS8vIHRlc3Qgc3BlY2lhbCBjYXNlcyBpbiBJbmRleCgpIGZvciBzaG9ydCBzdHJpbmdzCgl7IiIsICJhYiIsIC0xfSwKCXsiYmMiLCAiYWIiLCAtMX0sCgl7ImFiIiwgImFiIiwgMH0sCgl7InhhYiIsICJhYiIsIDF9LAoJeyJ4YWIiWzoyXSwgImFiIiwgLTF9LAoJeyIiLCAiYWJjIiwgLTF9LAoJeyJ4YmMiLCAgKGggKk11bHRpSGFuZGxlcikgSGFuZGxlKGN0eCBjb250ZXh0LkNvbnRleHQsIHIgUmVjb3JkKSBlcnJvciB7Cgl2YXIgZXJycyBbXWVycm9yCglmb3IgaSA6PSByYW5nZSBoLm11bHRpIHsKCQlpZiBoLm11bHRpW2ldLkVuYWJsZWQoY3R4LCByLkxldmVsKSB7CgkJCWlmIGVyciA6PSBoLm11bHRpW2ldLkhhbmRsZShjdHgsIHIuQ2xvbmUoKSk7IGVyciAhPSBuaWwgewoJCQkJZXJycyA9IGFwcGVuZChlcnJzLCBlcnIpCgkJCX0KCQl9Cgl9CglyZXR1cm4gZXJyb3JzLkpvaW4oZXJycy4uLikKfQoKZnVuYyAoaCAqTXVsdGlIYW5kbGVyKSBXaXRoQXR0cnMoYXR0cnMgW11BdHRyKSBIYW5kbGVyIHsKCWhhbmRsZXJzIDo9IG1ha2UoW11IYW5kbGVyLCAwLCBsZW4oaC5tdWx0aSkpCglmb3IgaSA6PSByYW5nZSBoLm11bHRpIHsKCQloYW5kbGVycyA9IGFwcGVuZChoYW5kbGVycywgaC5tdWx0aVtpXS5XaXRoQXR0cnMoYXR0cnMpKQoJfQoJcmV0dXJuICZNdWx0aUhhbmRsZXJ7bXVsdGk6IGhhbmRsZXJzfQp9CgpmdW5jIChoICpNdWx0aUhhbmRsZXIpIFdpdGhHcm91cChuYW1lIHN0cmluZykgSGFuZGxlciB7CgloYW5kbGVycyA6PSBtYWtlKFtdSGFuZGxlciwgMCwgbGVuKGgubXVsdGkpKQoJZm9yIGkgOj0gcmFuZ2UgaC5tdWx0aSB7CgkJaGFuZGxlcnMgPSBhcHBlbmQoaGFuZGxlcnMsIGgubXVsdGlbaV0uV2l0aEdyb3VwKG5hbWUpKQoJfQoJcmV0dXJuICZNdWx0aUhhbmRsZXJ7bXVsdGk6IGhhbmRsZXJzfQp9Ci8vIENvcHlyaWdodCAyMDA5IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIG1hdGgKCi8vIHBvdzEwdGFiIHN0b3JlcyB0aGUgcHJlLWNvbXB1dGVkIHZhbHVlcyAxMCoqaSBmb3IgaSA8IDMyLgp2YXIgcG93MTB0YWIgPSBbLi4uXWZsb2F0NjR7CgkxZTAwLCAxZTAxLCAxZTAyLCAxZTAzLCAxZTA0LCAxZTA1LCAxZTA2LCAxZTA3LCAxZTA4LCAxZTA5LAoJMWUxMCwgMWUxMSwgMWUxMiwgMWUxMywgMWUxNCwgMWUxNSwgMWUxNiwgMWUxNywgMWUxOCwgMWUxOSwKCTFlMjAsIDFlMjEsIDFlMjIsIDFlMjMsIDFlMjQsIDFlMjUsIDFlMjYsIDFlMjcsIDFlMjgsIDFlMjksCgkxZTMwLCAxZTMxLAp9CgovLyBwb3cxMHBvc3RhYjMyIHN0b3JlcyB0aGUgcHJlLWNvbXB1dGVkIHZhbHVlIGZvciAxMCoqKGkqMzIpIGF0IGluZGV4IGkuCnZhciBwb3cxMHBvc3RhYjMyID0gWy4uLl1mbG9hdDY0ewoJMWUwMCwgMWUzMiwgMWU2NCwgMWU5NiwgMWUxMjgsIDFlMTYwLCAxZTE5MiwgMWUyMjQsIDFlMjU2LCAxZTI4OCwKfQoKLy8gcG93MTBuZWd0YWIzMiBzdG9yZXMgdGhlIHByZS1jb21wdXRlZCB2YWx1ZSBmb3IgMTAqKigtaSozMikgYXQgaW5kZXggaS4KdmFyIHBvdzEwbmVndGFiMzIgPSBbLi4uXWZsb2F0NjR7CgkxZS0wMCwgMWUtMzIsIDFlLTY0LCAxZS05NiwgMWUtMTI4LCAxZS0xNjAsIDFlLTE5MiwgMWUtMjI0LCAxZS0yNTYsIDFlLTI4OCwgMWUtMzIwLAp9CgovLyBQb3cxMCByZXR1cm5zIDEwKipuLCB0aGUgYmFzZS0xMCBleHBvbmVudGlhbCBvZiBuLgovLwovLyBTcGVjaWFsIGNhc2VzIGFyZToKLy8KLy8JUG93MTAobikgPSAgICAwIGZvciBuIDwgLTMyMwovLwlQb3cxMChuKSA9ICtJbmYgZm9yIG4gPiAzMDgKZnVuYyBQb3cxMChuIGludCkgZmxvYXQ2NCB7CglpZiAwIDw9IG4gJiYgbiA8PSAzMDggewoJCXJldHVybiBwb3cxMHBvc3RhYjMyW3VpbnQobikvMzJdICogcG93MTB0YWJbdWludChuKSUzMl0KCX0KCglpZiAtMzIzIDw9IG4gJiYgbiA8IDAgewoJCXJldHVybiBwb3cxMG5lZ3RhYjMyW3VpbnQoLW4pLzMyXSAvIHBvdzEwdGFiW3VpbnQoLW4pJTMyXQoJfQoKCS8vIG4gPCAtMzIzIHx8IDMwOCA8IG4KCWlmIGMiLCAibG9nLnNob3dzaWduYXR1cmU9ZmFsc2UiLCAibG9nIiwgIi0tbm8tZGVjb3JhdGUiLCAiLW4xIiwgIi0tZm9ybWF0PWZvcm1hdDolSCAlY3QgJUQiLCAiLS1lbmQtb2Ytb3B0aW9ucyIsIHJldiwgIi0tIikKCWlmIGVyciAhPSBuaWwgewoJCS8vIFJldHVybiBpbmZvIHdpdGggT3JpZ2luLlJlcG9TdW0gaWYgcG9zc2libGUgdG8gYWxsb3cgY2FjaGluZyBvZiBuZWdhdGl2ZSBsb29rdXAuCgkJdmFyIGluZm8gKlJldkluZm8KCQlpZiByZWZzLCBlcnIgOj0gci5sb2FkUmVmcyhjdHgpOyBlcnIgPT0gbmlsIHsKCQkJaW5mbyA9IHIudW5rbm93blJldmlzaW9uSW5mbyhyZWZzKQoJCX0KCQlyZXR1cm4gaW5mbywgJlVua25vd25SZXZpc2lvbkVycm9ye1JldjogcmV2fQoJfQoJZiA6PSBzdHJpbmdzLkZpZWxkcyhzdHJpbmcob3V0KSkKCWlmIGxlbihmKSA8IDIgewoJCXJldHVybiBuaWwsIGZtdC5FcnJvcmYoInVuZXhwZWN0ZWQgcmVzcG9uc2UgZnJvbSBnaXQgbG9nOiAlcSIsIG91dCkKCX0KCWhhc2ggOj0gZlswXQoJaWYgc3RyaW5ncy5IYXNQcmVmaXgoaGFzaCwgdmVyc2lvbikgewoJCXZlcnNpb24gPSBoYXNoIC8vIGV4dGVuZCB0byBmdWxsIGhhc2gKCX0KCXQsIGVyciA6PSBzdHJjb252LlBhcnNlSW50KGZbMV0sIDEwLCA2NCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGZtdC5FcnJvcmYoImludmFsaWQgdGltZSBmcm9tIGdpdCBsb2c6ICVxIiwgb3V0KQoJfQoKCWluZm8gOj0gJlJldkluZm97CgkJT3JpZ2luOiAmT3JpZ2luewoJCQlWQ1M6ICAiZ2l0IiwKCQkJVVJMOiAgci5yZW1vdGVVUkwsCgkJCUhhc2g6IGhhc2gsCgkJfSwKCQlOYW1lOiAgICBoYXNoLAoJCVNob3J0OiAgIHIuc2hvcnRlbk9iamVjdEhhc2goaGFzaCksCgkJVGltZTogICAgdGltZS5Vbml4KHQsIDApLlVUQygpLAoJCVZlcnNpb246IGhhc2gsCgl9CglpZiAhc3RyaW5ncy5IYXNQcmVmaXgoaGFzaCwgcmV2KSB7CgkJaW5mby5PcmlnaW4uUmVmID0gcmV2Cgl9CgoJLy8gQWRkIHRhZ3MuIE91dHB1dCBsb29rcyBsaWtlOgoJLy8JZWRlNDU4ZGY3Y2QwZmRjYTUyMGRmMTlhMzMxNTgwODZhOGE2OGU4MSAxNTIzOTk0MjAyIEhFQUQgLT4gbWFzdGVyLCB0YWc6IHYxLjIuNC1hbm5vdGF0ZWQsIHRhZzogdjEuMi4zLCBvcmlnaW4vbWFzdGVyLCBvcmlnaW4vSEVBRAoJZm9yIGkgOj0gMjsgaSA8IGxlbihmKTsgaSsrIHsKCQlpZiBmW2ldID09ICJ0YWc6IiB7CgkJCWkrKwoJCQlpZiBpIDwgbGVuKGYpIHsKCQkJCWluZm8uVGFncyA9IGFwcGVuZChpbmZvLlRhZ3MsIHN0cmluZ3MuVHJpbVN1ZmZpeChmW2ldLCAiLCIpKQoJCQl9CgkJfQoJfQoKCS8vIEdpdCAyLjQ3LjEgZG9lcyBub3Qgc2VuZCB0aGUgdGFncyBkdXJpbmcgc2hhbGxvdyBjbG9uZSBhbnltb3JlCgkvLyAocGVyaGFwcyB0aGUgZXhhY3QgdmVyc2lvbiB0aGF0IGNoYW5nZWQgYmVoYXZpb3IgaXMgYW4gZWFybGllciBvbmUpLAoJLy8gc28gd2UgaGF2ZSB0byBhbHNvIGFkZCB0YWdzIGZyb20gdGhlIHJlZnMgbGlzdCB3ZSBmZXRjaGVkIHdpdGggbHMtcmVtb3RlLgoJaWYgcmVmcywgZXJyIDo9IHIubG9hZFJlZnMoY3R4KTsgZXJyID09IG5pbCB7CgkJZm9yIHJlZiwgaCA6PSByYW5nZSByZWZzIHsKCQkJaWYgaCA9PSBoYXNoIHsKCQkJCWlmIHRhZywgZm91bmQgOj0gc3RyaW5ncy5DdXRQcmVmaXgocmVmLCAicmVmcy90YWdzLyIpOyBmb3VuZCB7CgkJCQkJaW5mby5UYWdzID0gYXBwZW5kKGluZm8uVGFncywgdGFnKQoJCQkJfQoJCQl9CgkJfQoJfQoJc2xpY2VzLlNvcnQoaW5mby5UYWdzKQoJaW5mby5UYWdzID0gc2xpY2VzLkNvbXBhY3QoaW5mby5UYWdzKQoKCS8vIFVzZWQgaGFzaCBhcyBpbmZvLlZlcnNpb24gYWJvdmUuCgkvLyBVc2UgY2FsbGVyJ3Mgc3VnZ2VzdGVkIHZlcnNpb24gaWYgaXQgYXBwZWFycyBpbiB0aGUgdGFnIGxpc3QKCS8vIChmaWx0ZXJzIG91dCBicmFuY2ggbmFtZXMsIEhFQUQpLgoJZm8wMDAwMDgwMEEsCgkweDgwMDAwMDAwODAwMDAwMEEsCgkweDgwMDAwMDAwODAwMDgwODEsCgkweDgwMDAwMDAwMDAwMDgwODAsCgkweDAwMDAwMDAwODAwMDAwMDEsCgkweDgwMDAwMDAwODAwMDgwMDgsCn0KCnZhciAoCgkvLyBUZW1wb3JhcnkgcmVnaXN0ZXJzCglyVDEgR1BQaHlzaWNhbCA9IFJBWAoKCS8vIFJvdW5kIHZhcnMKCXJwU3RhdGUgPSBNZW17QmFzZTogUkRJfQoJcnBTdGFjayA9IE1lbXtCYXNlOiBSU1B9CgoJckRhID0gUkJYCglyRGUgPSBSQ1gKCXJEaSA9IFJEWAoJckRvID0gUjgKCXJEdSA9IFI5CgoJckJhID0gUjEwCglyQmUgPSBSMTEKCXJCaSA9IFIxMgoJckJvID0gUjEzCglyQnUgPSBSMTQKCglyQ2EgPSBSU0kKCXJDZSA9IFJCUAoJckNpID0gckJpCglyQ28gPSByQm8KCXJDdSA9IFIxNQopCgpjb25zdCAoCglfYmEgPSBpb3RhICogOAoJX2JlCglfYmkKCV9ibwoJX2J1CglfZ2EKCV9nZQoJX2dpCglfZ28KCV9ndQoJX2thCglfa2UKCV9raQoJX2tvCglfa3UKCV9tYQoJX21lCglfbWkKCV9tbwoJX211Cglfc2EKCV9zZQoJX3NpCglfc28KCV9zdQopCgpmdW5jIG1haW4oKSB7CgkvLyBodHRwczovL2dpdGh1Yi5jb20vbW1jbG91Z2hsaW4vYXZvL2lzc3Vlcy80NTAKCW9zLlNldGVudigiR09PUyIsICJsaW51eCIpCglvcy5TZXRlbnYoIkdPQVJDSCIsICJhbWQ2NCIpCgoJUGFja2FnZSgiY3J5cHRvL2ludGVybmFsL2ZpcHMxNDAvc2hhMyIpCglDb25zdHJhaW50RXhwcigiIXB1cmVnbyIpCglrZWNjYWtGMTYwMCgpCglHZW5lcmF0ZSgpCn0KCmZ1bmMgTU9WUV9SQklfUkNFKCkgeyBNT1ZRKHJCaSwgckNlKSB9CmZ1bmMgWE9SUV9SVDFfUkNBKCkgeyBYT1JRKHJUMSwgckNhKSB9CmZ1bmMgWE9SUV9SVDFfUkNFKCkgeyBYT1JRKHJUMSwgckNlKSB9CmZ1bmMgWE9SUV9SQkFfUkNVKCkgeyBYT1JRKHJCYSwgckN1KSB9CmZ1bmMgWE9SUV9SQkVfUkNVKCkgeyBYT1JRKHJCZSwgckN1KSB9CmZ1bmMgWE9SUV9SRFVfUkNVKCkgeyBYT1JRKHJEdSwgckN1KSB9CmZ1bmMgWE9SUV9SREFfUkNBKCkgeyBYT1JRKHJEYSwgckNhKSB9CmZ1bmMgWE9SUV9SREVfUkNFKCkgeyBYT1JRKHJEZSwgckNlKSB9Cgp0eXBlIEFyZ01hY3JvIGZ1bmMoKQoKZnVuYyBtS2VjY2FrUm91bmQoCglpU3RhdGUsIG9TdGF0ZSBNZW0sCglyYyBVNjQsCglCX1JCSV9SQ0UsIEdfUlQxX1JDQSwgR19SVDFfUkNFLCBHX1JCQV9SQ1UsCglLX1JUMV9SQ0EsIEtfUlQxX1JDRSwgS19SQkFfUkNVLCBNX1JUMV9SQ0EsCglNX1JUMV9SQ0UsIE1fUkJFX1JDVSwgU19SRFVfUkNVLCBTX1JEQV9SQ0EsCglTX1JERV9SQ0UgQXJnTWFjcm8sCikgewoJQ29tbWVudCgiUHJlcGFyZSByb3VuZCIpCglNT1ZRKHJDZSwgckRhKQoJUk9MUShJbW0oMSksIHJEYSkKCglNT1ZRKGlTdGF0ZS5PZmZzZXQoX2JpKSwgckNpKQoJWE9SUShpU3RhdGUuT2Zmc2V0KF9naSksIHJEaSkKCVhPUlEockN1LCByRGEpCglYT1JRKGlTdGF0ZS5PZmZzZXQoX2tpKSwgckNpKQoJWE9SUShpU3RhdGUuT2Zmc2V0KF9taSksIHJEaSkKCVhPUlEockRpLCByQ2kpCgoJTU9WUShyQ2ksIHJEZSkKCVJPTFEoSW1tKDEpLCByRGUpCgoJTU9WUShpU3RhdGUuT2Zmc2V0KF9ibyksIHJDbykKCVhPUlEoaVN0YXRlLk9mZnNldChfZ28pLCByRG8pCglYT1JRKHJDYSwgckRlKQoJWE9SUShpU3RhdGUuT2Zmc2V0KF9rbyksIHJDbykKCVhPUlEoaVN0YXRlLk9mZnNldChfbW8pLCByRG8pCglYT1JRKHJEbywgckNvKQoKCU1PVlEockNvLCByRGkpCglST0xRKEltbSgxKSwgckRpKQoKCU1PVlEockN1LCByRG8pCglYT1JRKHJDZSwgckRpKQoJUk9MUShJbW0oMSksIHJEbykKCglNT1ZRKHJDYSwgckR1KQoJWE9SUShyQ2ksIHJEbykKCVJPTFEoSW1tKDEpLCByRHUpCgoJQ29tbWVudCgiUmVzdWx0IGIiKQoJTU9WUShpU3RhdGUuT2Zmc2V0KF9iYSksIHJCYSkKCU1PVlEoaVN0YXRlLk9mZnNldChfZ2UpLCByQmUpCglYT1JRKHJDbywgckR1IENTTUFHSUNfQ09ERURJUkVDVE9SWSwKCQlsZW5ndGg6ICAgICAgIHVpbnQzMihzeikgLSAoc3VwZXJCbG9iU2l6ZSArIGJsb2JTaXplKSwKCQl2ZXJzaW9uOiAgICAgIDB4MjA0MDAsCgkJZmxhZ3M6ICAgICAgICAweDIwMDAyLCAvLyBhZGhvYyB8IGxpbmtlclNpZ25lZAoJCWhhc2hPZmZzZXQ6ICAgdWludDMyKGhhc2hPZmYpLAoJCWlkZW50T2Zmc2V0OiAgdWludDMyKGlkT2ZmKSwKCQluQ29kZVNsb3RzOiAgIHVpbnQzMihuaGFzaGVzKSwKCQljb2RlTGltaXQ6ICAgIHVpbnQzMihjb2RlU2l6ZSksCgkJaGFzaFNpemU6ICAgICBoYXNoLlNpemUzMiwKCQloYXNoVHlwZTogICAgIENTX0hBU0hUWVBFX1NIQTI1NiwKCQlwYWdlU2l6ZTogICAgIHVpbnQ4KHBhZ2VTaXplQml0cyksCgkJZXhlY1NlZ0Jhc2U6ICB1aW50NjQodGV4dE9mZiksCgkJZXhlY1NlZ0xpbWl0OiB1aW50NjQodGV4dFNpemUpLAoJfQoJaWYgaXNNYWluIHsKCQljZGlyLmV4ZWNTZWdGbGFncyA9IENTX0VYRUNTRUdfTUFJTl9CSU5BUlkKCX0KCglvdXRwIDo9IG91dAoJb3V0cCA9IHNiLnB1dChvdXRwKQoJb3V0cCA9IGJsb2IucHV0KG91dHApCglvdXRwID0gY2Rpci5wdXQob3V0cCkKCgkvLyBlbWl0IHRoZSBpZGVudGlmaWVyCglvdXRwID0gcHV0cyhvdXRwLCBbXWJ5dGUoaWQrIlwwMDAiKSkKCgkvLyBlbWl0IGhhc2hlcwoJdmFyIGJ1ZiBbcGFnZVNpemVdYnl0ZQoJcCA6PSAwCglmb3IgcCA8IGludChjb2RlU2l6ZSkgewoJCW4sIGVyciA6PSBpby5SZWFkRnVsbChkYXRhLCBidWZbOl0pCgkJaWYgZXJyID09IGlvLkVPRiB7CgkJCWJyZWFrCgkJfQoJCWlmIGVyciAhPSBuaWwgJiYgZXJyICE9IGlvLkVyclVuZXhwZWN0ZWRFT0YgewoJCQlwYW5pYyhlcnIpCgkJfQoJCWlmIHArbiA+IGludChjb2RlU2l6ZSkgewoJCQluID0gaW50KGNvZGVTaXplKSAtIHAKCQl9CgkJcCArPSBuCgkJYiA6PSBzaGEyNTYuU3VtMjU2KGJ1Zls6bl0pCgkJb3V0cCA9IHB1dHMob3V0cCwgYls6XSkKCX0KfQovLyBlcnJvcmNoZWNrCgovLyBDb3B5cmlnaHQgMjAxMSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gVmVyaWZ5IHRoYXQgaWxsZWdhbCBjb252ZXJzaW9ucyBpbnZvbHZpbmcgc3RyaW5ncyBhcmUgZGV0ZWN0ZWQuCi8vIERvZXMgbm90IGNvbXBpbGUuCgpwYWNrYWdlIG1haW4KCnR5cGUgVGJ5dGUgW11ieXRlCnR5cGUgVHJ1bmUgW11ydW5lCnR5cGUgVGludDY0IFtdaW50NjQKdHlwZSBUc3RyaW5nIHN0cmluZwoKZnVuYyBtYWluKCkgewoJcyA6PSAiaGVsbG8iCglzYiA6PSBbXWJ5dGUoImhlbGxvIikKCXNyIDo9IFtdcnVuZSgiaGVsbG8iKQoJc2kgOj0gW11pbnQ2NHsnaCcsICdlJywgJ2wnLCAnbCcsICdvJ30KCgl0cyA6PSBUc3RyaW5nKHMpCgl0c2IgOj0gVGJ5dGUoc2IpCgl0c3IgOj0gVHJ1bmUoc3IpCgl0c2kgOj0gVGludDY0KHNpKQoKCV8gPSBzdHJpbmcocykKCV8gPSBbXWJ5dGUocykKCV8gPSBbXXJ1bmUocykKCV8gPSBbXWludDY0KHMpIC8vIEVSUk9SICJjYW5ub3QgY29udmVydC4qXFtcXWludDY0fGludmFsaWQgdHlwZSBjb252ZXJzaW9uIgoJXyA9IFRzdHJpbmcocykKCV8gPSBUYnl0ZShzKQoJXyA9IFRydW5lKHMpCglfID0gVGludDY0KHMpIC8vIEVSUk9SICJjYW5ub3QgY29udmVydC4qVGludDY0fGludmFsaWQgdHlwZSBjb252ZXJzaW9uIgoKCV8gPSBzdHJpbmcoc2IpCglfID0gW11ieXRlKHNiKQoJXyA9IFtdcnVuZShzYikgIC8vIEVSUk9SICJjYW5ub3QgY29udmVydC4qXFtcXXJ1bmV8aW52YWxpZCB0eXBlIGNvbnZlcnNpb24iCglfID0gW11pbnQ2NChzYikgLy8gUElPQ1NNUlUgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ1MgoJUFBQSU9DU05QTU9ERSAgICAgICAgICAgICAgICAgICAgPSAweDgwMDg3NDRiCglQUFBJT0NTUEFTUyAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwODc0NDcKCVBQUElPQ1NSQVNZTkNNQVAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ1NAoJUFBQSU9DU1hBU1lOQ01BUCAgICAgICAgICAgICAgICAgPSAweDgwMjA3NDRmCglQUFBJT0NVTkJSSURHRUNIQU4gICAgICAgICAgICAgICA9IDB4MjAwMDc0MzQKCVBQUElPQ1hGRVJVTklUICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQ0ZQoJUFJfU0VUX1BUUkFDRVJfQU5ZICAgICAgICAgICAgICAgPSAweGZmZmZmZmZmCglQVFBfQ0xPQ0tfR0VUQ0FQUyAgICAgICAgICAgICAgICA9IDB4NDA1MDNkMDEKCVBUUF9DTE9DS19HRVRDQVBTMiAgICAgICAgICAgICAgID0gMHg0MDUwM2QwYQoJUFRQX0VOQUJMRV9QUFMgICAgICAgICAgICAgICAgICAgPSAweDgwMDQzZDA0CglQVFBfRU5BQkxFX1BQUzIgICAgICAgICAgICAgICAgICA9IDB4ODAwNDNkMGQKCVBUUF9FWFRUU19SRVFVRVNUICAgICAgICAgICAgICAgID0gMHg4MDEwM2QwMgoJUFRQX0VYVFRTX1JFUVVFU1QyICAgICAgICAgICAgICAgPSAweDgwMTAzZDBiCglQVFBfTUFTS19DTEVBUl9BTEwgICAgICAgICAgICAgICA9IDB4MjAwMDNkMTMKCVBUUF9NQVNLX0VOX1NJTkdMRSAgICAgICAgICAgICAgID0gMHg4MDA0M2QxNAoJUFRQX1BFUk9VVF9SRVFVRVNUICAgICAgICAgICAgICAgPSAweDgwMzgzZDAzCglQVFBfUEVST1VUX1JFUVVFU1QyICAgICAgICAgICAgICA9IDB4ODAzODNkMGMKCVBUUF9QSU5fU0VURlVOQyAgICAgICAgICAgICAgICAgID0gMHg4MDYwM2QwNwoJUFRQX1BJTl9TRVRGVU5DMiAgICAgICAgICAgICAgICAgPSAweDgwNjAzZDEwCglQVFBfU1lTX09GRlNFVCAgICAgICAgICAgICAgICAgICA9IDB4ODM0MDNkMDUKCVBUUF9TWVNfT0ZGU0VUMiAgICAgICAgICAgICAgICAgID0gMHg4MzQwM2QwZQoJUFRSQUNFX0dFVEZQUkVHUyAgICAgICAgICAgICAgICAgPSAweGUKCVBUUkFDRV9HRVRfVEhSRUFEX0FSRUEgICAgICAgICAgID0gMHgxOQoJUFRSQUNFX0dFVF9USFJFQURfQVJFQV8zMjY0ICAgICAgPSAweGM0CglQVFJBQ0VfR0VUX1dBVENIX1JFR1MgICAgICAgICAgICA9IDB4ZDAKCVBUUkFDRV9PTERTRVRPUFRJT05TICAgICAgICAgICAgID0gMHgxNQoJUFRSQUNFX1BFRUtEQVRBXzMyNjQgICAgICAgICAgICAgPSAweGMxCglQVFJBQ0VfUEVFS1RFWFRfMzI2NCAgICAgICAgICAgICA9IDB4YzAKCVBUUkFDRV9QT0tFREFUQV8zMjY0ICAgICAgICAgICAgID0gMHhjMwoJUFRSQUNFX1BPS0VURVhUXzMyNjQgICAgICAgICAgICAgPSAweGMyCglQVFJBQ0VfU0VURlBSRUdTICAgICAgICAgICAgICAgICA9IDB4ZgoJUFRSQUNFX1NFVF9USFJFQURfQVJFQSAgICAgICAgICAgPSAweDFhCglQVFJBQ0VfU0VUX1dBVENIX1JFR1MgICAgICAgICAgICA9IDB4ZDEKCVJMSU1JVF9BUyAgICAgICAgICAgICAgICAgICAgICAgID0gMHg2CglSTElNSVRfTUVNTE9DSyAgICAgICAgICAgICAgICAgICA9IDB4OQoJUkxJTUlUX05PRklMRSAgICAgICAgICAgICAgICAgICAgPSAweDUKCVJMSU1JVF9OUFJPQyAgICAgICAgICAgICAgICAgICAgID0gMHg4CglSTElNSVRfUlNTICAgICAgICAgICAgICAgICAgICAgICA9IDB4NwoJUk5EQURERU5UUk9QWSAgICAgICAgICAgICAgICAgICAgPSAweDgwMDg1MjAzCglSTkRBRERUT0VOVENOVCAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDUyMDEKCVJORENMRUFSUE9PTCAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNTIwNgoJUk5ER0VURU5UQ05UICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ1MjAwCglSTkRHRVRQT09MICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAwODUyMDIKCVJORFJFU0VFRENSTnNOY2xvc2Uoc3RhdGUgKlJlc1N0YXRlKSB7CglzeXNjYWxsX3N5c2NhbGwoYWJpLkZ1bmNQQ0FCSTAobGlicmVzb2x2X3Jlc185X25jbG9zZV90cmFtcG9saW5lKSwKCQl1aW50cHRyKHVuc2FmZS5Qb2ludGVyKHN0YXRlKSksCgkJMCwgMCkKfQoKLy9nbzpjZ29faW1wb3J0X2R5bmFtaWMgbGlicmVzb2x2X3Jlc185X25zZWFyY2ggcmVzXzlfbnNlYXJjaCAiL3Vzci9saWIvbGlicmVzb2x2LjkuZHlsaWIiCmZ1bmMgbGlicmVzb2x2X3Jlc185X25zZWFyY2hfdHJhbXBvbGluZSgpCgpmdW5jIFJlc05zZWFyY2goc3RhdGUgKlJlc1N0YXRlLCBkbmFtZSAqYnl0ZSwgY2xhc3MsIHR5cCBpbnQsIGFucyAqYnl0ZSwgYW5zbGVuIGludCkgKGludCwgZXJyb3IpIHsKCXIxLCBfLCBlcnJubyA6PSBzeXNjYWxsX3N5c2NhbGw2KGFiaS5GdW5jUENBQkkwKGxpYnJlc29sdl9yZXNfOV9uc2VhcmNoX3RyYW1wb2xpbmUpLAoJCXVpbnRwdHIodW5zYWZlLlBvaW50ZXIoc3RhdGUpKSwKCQl1aW50cHRyKHVuc2FmZS5Qb2ludGVyKGRuYW1lKSksCgkJdWludHB0cihjbGFzcyksCgkJdWludHB0cih0eXApLAoJCXVpbnRwdHIodW5zYWZlLlBvaW50ZXIoYW5zKSksCgkJdWludHB0cihhbnNsZW4pKQoJaWYgZXJybm8gIT0gMCB7CgkJcmV0dXJuIDAsIGVycm5vCgl9CglyZXR1cm4gaW50KGludDMyKHIxKSksIG5pbAp9Ci8vIENvZGUgZ2VuZXJhdGVkIGJ5IHJ1bm5pbmcgImdvIGdlbmVyYXRlIiBpbiBnb2xhbmcub3JnL3gvdGV4dC4gRE8gTk9UIEVESVQuCgpwYWNrYWdlIGJpZGkKCi8vIENsYXNzIGlzIHRoZSBVbmljb2RlIEJpRGkgY2xhc3MuIEVhY2ggcnVuZSBoYXMgYSBzaW5nbGUgY2xhc3MuCnR5cGUgQ2xhc3MgdWludAoKY29uc3QgKAoJTCAgICAgICBDbGFzcyA9IGlvdGEgLy8gTGVmdFRvUmlnaHQKCVIgICAgICAgICAgICAgICAgICAgIC8vIFJpZ2h0VG9MZWZ0CglFTiAgICAgICAgICAgICAgICAgICAvLyBFdXJvcGVhbk51bWJlcgoJRVMgICAgICAgICAgICAgICAgICAgLy8gRXVyb3BlYW5TZXBhcmF0b3IKCUVUICAgICAgICAgICAgICAgICAgIC8vIEV1cm9wZWFuVGVybWluYXRvcgoJQU4gICAgICAgICAgICAgICAgICAgLy8gQXJhYmljTnVtYmVyCglDUyAgICAgICAgICAgICAgICAgICAvLyBDb21tb25TZXBhcmF0b3IKCUIgICAgICAgICAgICAgICAgICAgIC8vIFBhcmFncmFwaFNlcGFyYXRvcgoJUyAgICAgICAgICAgICAgICAgICAgLy8gU2VnbWVudFNlcGFyYXRvcgoJV1MgICAgICAgICAgICAgICAgICAgLy8gV2hpdGVTcGFjZQoJT04gICAgICAgICAgICAgICAgICAgLy8gT3RoZXJOZXV0cmFsCglCTiAgICAgICAgICAgICAgICAgICAvLyBCb3VuZGFyeU5ldXRyYWwKCU5TTSAgICAgICAgICAgICAgICAgIC8vIE5vbnNwYWNpbmdNYXJrCglBTCAgICAgICAgICAgICAgICAgICAvLyBBcmFiaWNMZXR0ZXIKCUNvbnRyb2wgICAgICAgICAgICAgIC8vIENvbnRyb2wgTFJPIC0gUERJCgoJbnVtQ2xhc3MKCglMUk8gLy8gTGVmdFRvUmlnaHRPdmVycmlkZQoJUkxPIC8vIFJpZ2h0VG9MZWZ0T3ZlcnJpZGUKCUxSRSAvLyBMZWZ0VG9SaWdodEVtYmVkZGluZwoJUkxFIC8vIFJpZ2h0VG9MZWZ0RW1iZWRkaW5nCglQREYgLy8gUG9wRGlyZWN0aW9uYWxGb3JtYXQKCUxSSSAvLyBMZWZ0VG9SaWdodElzb2xhdGUKCVJMSSAvLyBSaWdodFRvTGVmdElzb2xhdGUKCUZTSSAvLyBGaXJzdFN0cm9uZ0lzb2xhdGUKCVBESSAvLyBQb3BEaXJlY3Rpb25hbElzb2xhdGUKCgl1bmtub3duQ2xhc3MgPSBeQ2xhc3MoMCkKKQoKLy8gQSB0cmllIGVudHJ5IGhhcyB0aGUgZm9sbG93aW5nIGJpdHM6Ci8vIDcuLjUgIFhPUiBtYXNrIGZvciBicmFja2V0cwovLyA0ICAgICAxOiBCcmFja2V0IG9wZW4sIDA6IEJyYWNrZXQgY2xvc2UKLy8gMy4uMCAgQ2xhc3MgdHlwZQoKY29uc3QgKAoJb3Blbk1hc2sgICAgID0gMHgxMAoJeG9yTWFza1NoaWZ0ID0gNQopCi8vIENvcHlyaWdodCAyMDE0IFRoZSAgbmV3IFRMUyBzZXJ2ZXIgc2lkZSBjb25uZWN0aW9uIHVzaW5nIFFVSUNUcmFuc3BvcnQgYXMgdGhlCi8vIHVuZGVybHlpbmcgdHJhbnNwb3J0LiBUaGUgY29uZmlnIGNhbm5vdCBiZSBuaWwuCi8vCi8vIFRoZSBjb25maWcncyBNaW5WZXJzaW9uIG11c3QgYmUgYXQgbGVhc3QgVExTIDEuMy4KZnVuYyBRVUlDU2VydmVyKGNvbmZpZyAqUVVJQ0NvbmZpZykgKlFVSUNDb25uIHsKCXJldHVybiBuZXdRVUlDQ29ubihTZXJ2ZXIobmlsLCBjb25maWcuVExTQ29uZmlnKSwgY29uZmlnKQp9CgpmdW5jIG5ld1FVSUNDb25uKGNvbm4gKkNvbm4sIGNvbmZpZyAqUVVJQ0NvbmZpZykgKlFVSUNDb25uIHsKCWNvbm4ucXVpYyA9ICZxdWljU3RhdGV7CgkJc2lnbmFsYzogICAgICAgICAgICAgbWFrZShjaGFuIHN0cnVjdHt9KSwKCQlibG9ja2VkYzogICAgICAgICAgICBtYWtlKGNoYW4gc3RydWN0e30pLAoJCWVuYWJsZVNlc3Npb25FdmVudHM6IGNvbmZpZy5FbmFibGVTZXNzaW9uRXZlbnRzLAoJfQoJY29ubi5xdWljLmV2ZW50cyA9IGNvbm4ucXVpYy5ldmVudEFycls6MF0KCXJldHVybiAmUVVJQ0Nvbm57CgkJY29ubjogY29ubiwKCX0KfQoKLy8gU3RhcnQgc3RhcnRzIHRoZSBjbGllbnQgb3Igc2VydmVyIGhhbmRzaGFrZSBwcm90b2NvbC4KLy8gSXQgbWF5IHByb2R1Y2UgY29ubmVjdGlvbiBldmVudHMsIHdoaWNoIG1heSBiZSByZWFkIHdpdGggW1FVSUNDb25uLk5leHRFdmVudF0uCi8vCi8vIFN0YXJ0IG11c3QgYmUgY2FsbGVkIGF0IG1vc3Qgb25jZS4KZnVuYyAocSAqUVVJQ0Nvbm4pIFN0YXJ0KGN0eCBjb250ZXh0LkNvbnRleHQpIGVycm9yIHsKCWlmIHEuY29ubi5xdWljLnN0YXJ0ZWQgewoJCXJldHVybiBxdWljRXJyb3IoZXJyb3JzLk5ldygidGxzOiBTdGFydCBjYWxsZWQgbW9yZSB0aGFuIG9uY2UiKSkKCX0KCXEuY29ubi5xdWljLnN0YXJ0ZWQgPSB0cnVlCglpZiBxLmNvbm4uY29uZmlnLk1pblZlcnNpb24gPCBWZXJzaW9uVExTMTMgewoJCXJldHVybiBxdWljRXJyb3IoZXJyb3JzLk5ldygidGxzOiBDb25maWcgTWluVmVyc2lvbiBtdXN0IGJlIGF0IGxlYXN0IFRMUyAxLjMiKSkKCX0KCWdvIHEuY29ubi5IYW5kc2hha2VDb250ZXh0KGN0eCkKCWlmIF8sIG9rIDo9IDwtcS5jb25uLnF1aWMuYmxvY2tlZGM7ICFvayB7CgkJcmV0dXJuIHEuY29ubi5oYW5kc2hha2VFcnIKCX0KCXJldHVybiBuaWwKfQoKLy8gTmV4dEV2ZW50IHJldHVybnMgdGhlIG5leHQgZXZlbnQgb2NjdXJyaW5nIG9uIHRoZSBjb25uZWN0aW9uLgovLyBJdCByZXR1cm5zIGFuIGV2ZW50IHdpdGggYSBLaW5kIG9mIFtRVUlDTm9FdmVudF0gd2hlbiBubyBldmVudHMgYXJlIGF2YWlsYWJsZS4KZnVuYyAocSAqUVVJQ0Nvbm4pIE5leHRFdmVudCgpIFFVSUNFdmVudCB7CglxcyA6PSBxLmNvbm4ucXVpYwoJaWYgbGFzdCA6PSBxcy5uZXh0RXZlbnQgLSAxOyBsYXN0ID49IDAgJiYgbGVuKHFzLmV2ZW50c1tsYXN0XS5EYXRhKSA+IDAgewoJCS8vIFdyaXRlIG92ZXIgc29tZSBvZiB0aGUgcHJldmlvdXMgZXZlbnQncyBkYXRhLAoJCS8vIHRvIGNhdGNoIGNhbGxlcnMgZXJyb25lb3VzbHkgcmV0YWluaW5nIGl0LgoJCXFzLmV2ZW50c1tsYXN0XS5EYXRhWzBdID0gMAoJfQoJaWYgcXMubmV4dEV2ZW50ID49IGxlbihxcy5ldmVudHMpICYmIHFzLndhaXRpbmdGb3JEcmFpbiB7CgkJcXMud2FpdGluZ0ZvckRyYWluID0gZmFsc2UKCQk8LXFzLnNpZ25hbGMKCQk8LXFzLmJsb2NrZWRjCgl9CglpZiBlcnIgOj0gcS5jb25uLmhhbmRzaGFrZUVycjsgZXJyICE9IG5pbCB7CgkJaWYgcXMuZXJyb3JSZXR1cm5lZCB7CgkJCXJldHVybiBRVUlDRXZlbnR7S2luZDogUVVJQ05vRXZlbnR9CgkJfQoJCXFzLmVycm9yUmV0dXJuZWQgPSB0cnVlCgkJcXMuZXZlbnRzID0gbmlsCgkJcXMubmV4dEV2ZW50ID0gMAoJCXJldHVybiBRVUlDRXZlbnR7S2luZDogUVVJQ0Vycm9yRXZlbnQsIEVycjogcS5jbzB4ODA1CglFVEhFUlRZUEVfWDc1ICAgICAgICAgICAgICAgICAgICAgPSAweDgwMQoJRVRIRVJUWVBFX1hOU1NNICAgICAgICAgICAgICAgICAgID0gMHg5MDAxCglFVEhFUlRZUEVfWFRQICAgICAgICAgICAgICAgICAgICAgPSAweDgxN2QKCUVUSEVSX0FERFJfTEVOICAgICAgICAgICAgICAgICAgICA9IDB4NgoJRVRIRVJfQ1JDX0xFTiAgICAgICAgICAgICAgICAgICAgID0gMHg0CglFVEhFUl9DUkNfUE9MWV9CRSAgICAgICAgICAgICAgICAgPSAweDRjMTFkYjYKCUVUSEVSX0NSQ19QT0xZX0xFICAgICAgICAgICAgICAgICA9IDB4ZWRiODgzMjAKCUVUSEVSX0hEUl9MRU4gICAgICAgICAgICAgICAgICAgICA9IDB4ZQoJRVRIRVJfTUFYX0xFTiAgICAgICAgICAgICAgICAgICAgID0gMHg1ZWUKCUVUSEVSX01BWF9MRU5fSlVNQk8gICAgICAgICAgICAgICA9IDB4MjMzYQoJRVRIRVJfTUlOX0xFTiAgICAgICAgICAgICAgICAgICAgID0gMHg0MAoJRVRIRVJfUFBQT0VfRU5DQVBfTEVOICAgICAgICAgICAgID0gMHg4CglFVEhFUl9UWVBFX0xFTiAgICAgICAgICAgICAgICAgICAgPSAweDIKCUVUSEVSX1ZMQU5fRU5DQVBfTEVOICAgICAgICAgICAgICA9IDB4NAoJRVZGSUxUX0FJTyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglFVkZJTFRfUFJPQyAgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCUVWRklMVF9SRUFEICAgICAgICAgICAgICAgICAgICAgICA9IDB4MAoJRVZGSUxUX1NJR05BTCAgICAgICAgICAgICAgICAgICAgID0gMHg1CglFVkZJTFRfU1lTQ09VTlQgICAgICAgICAgICAgICAgICAgPSAweDcKCUVWRklMVF9USU1FUiAgICAgICAgICAgICAgICAgICAgICA9IDB4NgoJRVZGSUxUX1ZOT0RFICAgICAgICAgICAgICAgICAgICAgID0gMHgzCglFVkZJTFRfV1JJVEUgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUVWX0FERCAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJRVZfQ0xFQVIgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMAoJRVZfREVMRVRFICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglFVl9ESVNBQkxFICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgKCUVWX0VOQUJMRSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NAoJRVZfRU9GICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDAwCglFVl9FUlJPUiAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDAKCUVWX0ZMQUcxICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwMAoJRVZfT05FU0hPVCAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMAoJRVZfU1lTRkxBR1MgICAgICAgICAgICAgICAgICAgICAgID0gMHhmMDAwCglFWFRBICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDRiMDAKCUVYVEFUVFJfQ01EX1NUQVJUICAgICAgICAgICAgICAgICA9IDB4MQoJRVhUQVRUUl9DTURfU1RPUCAgICAgICAgICAgICAgICAgID0gMHgyCglFWFRBVFRSX05BTUVTUEFDRV9TWVNURU0gICAgICAgICAgPSAweDIKCUVYVEFUVFJfTkFNRVNQQUNFX1VTRVIgICAgICAgICAgICA9IDB4MQoJRVhUQiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg5NjAwCglFWFRQUk9DICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMAoJRkRfQ0xPRVhFQyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglGRF9TRVRTSVpFICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMAoJRkxVU0hPICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDAwMDAKCUZfQ0xPU0VNICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YQoJRl9EVVBGRCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgwCglGX0RVUEZEX0NMT0VYRUMgICAgICAgICAgICAgICAgICAgPSAweGMKCUZfRlNDVEwgICAgICAgICAgICAgICAgICAgICAgICAgICA9IC0weDgwMDAwMDAwCglGX0ZTRElSTUFTSyBjKGIgKmNyeXB0b2J5dGUuQnVpbGRlcikgewoJCQkJYi5BZGRCeXRlcyhleHRCeXRlcykKCQkJfSkKCQl9Cgl9KQoKCXJldHVybiBiLkJ5dGVzKCkKfQoKZnVuYyAobSAqY2xpZW50SGVsbG9Nc2cpIG1hcnNoYWwoKSAoW11ieXRlLCBlcnJvcikgewoJcmV0dXJuIG0ubWFyc2hhbE1zZyhmYWxzZSkKfQoKLy8gbWFyc2hhbFdpdGhvdXRCaW5kZXJzIHJldHVybnMgdGhlIENsaWVudEhlbGxvIHRocm91Z2ggdGhlCi8vIFByZVNoYXJlZEtleUV4dGVuc2lvbi5pZGVudGl0aWVzIGZpZWxkLCBhY2NvcmRpbmcgdG8gUkZDIDg0NDYsIFNlY3Rpb24KLy8gNC4yLjExLjIuIE5vdGUgdGhhdCBtLnBza0JpbmRlcnMgbXVzdCBiZSBzZXQgdG8gc2xpY2VzIG9mIHRoZSBjb3JyZWN0IGxlbmd0aC4KZnVuYyAobSAqY2xpZW50SGVsbG9Nc2cpIG1hcnNoYWxXaXRob3V0QmluZGVycygpIChbXWJ5dGUsIGVycm9yKSB7CgliaW5kZXJzTGVuIDo9IDIgLy8gdWludDE2IGxlbmd0aCBwcmVmaXgKCWZvciBfLCBiaW5kZXIgOj0gcmFuZ2UgbS5wc2tCaW5kZXJzIHsKCQliaW5kZXJzTGVuICs9IDEgLy8gdWludDggbGVuZ3RoIHByZWZpeAoJCWJpbmRlcnNMZW4gKz0gbGVuKGJpbmRlcikKCX0KCgl2YXIgZnVsbE1lc3NhZ2UgW11ieXRlCglpZiBtLm9yaWdpbmFsICE9IG5pbCB7CgkJZnVsbE1lc3NhZ2UgPSBtLm9yaWdpbmFsCgl9IGVsc2UgewoJCXZhciBlcnIgZXJyb3IKCQlmdWxsTWVzc2FnZSwgZXJyID0gbS5tYXJzaGFsKCkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyCgkJfQoJfQoJcmV0dXJuIGZ1bGxNZXNzYWdlWzpsZW4oZnVsbE1lc3NhZ2UpLWJpbmRlcnNMZW5dLCBuaWwKfQoKLy8gdXBkYXRlQmluZGVycyB1cGRhdGVzIHRoZSBtLnBza0JpbmRlcnMgZmllbGQuIFRoZSBzdXBwbGllZCBiaW5kZXJzIG11c3QgaGF2ZQovLyB0aGUgc2FtZSBsZW5ndGggYXMgdGhlIGN1cnJlbnQgbS5wc2tCaW5kZXJzLgpmdW5jIChtICpjbGllbnRIZWxsb01zZykgdXBkYXRlQmluZGVycyhwc2tCaW5kZXJzIFtdW11ieXRlKSBlcnJvciB7CglpZiBsZW4ocHNrQmluZGVycykgIT0gbGVuKG0ucHNrQmluZGVycykgewoJCXJldHVybiBlcnJvcnMuTmV3KCJ0bHM6IGludGVybmFsIGVycm9yOiBwc2tCaW5kZXJzIGxlbmd0aCBtaXNtYXRjaCIpCgl9Cglmb3IgaSA6PSByYW5nZSBtLnBza0JpbmRlcnMgewoJCWlmIGxlbihwc2tCaW5kZXJzW2ldKSAhPSBsZW4obS5wc2tCaW5kZXJzW2ldKSB7CgkJCXJldHVybiBlcnJvcnMuTmV3KCJ0bHM6IGludGVybmFsIGVycm9yOiBwc2tCaW5kZXJzIGxlbmd0aCBtaXNtYXRjaCIpCgkJfQoJfQoJbS5wc2tCaW5kZXJzID0gcHNrQmluZGVycwoKCXJldHVybiBuaWwKfQoKZnVuYyAobSAqY2xpZW50SGVsbG9Nc2cpIHVubWFyc2hhbChkYXRhIFtdYnl0ZSkgYm9vbCB7CgkqbSA9IGNsaWVudEhlbGxvTXNne29yaWdpbmFsOiBkYXRhfQoJcyA6PSBjcnlwdG9ieXRlLlN0cmluZyhkYXRhKQoKCWlmICFzLlNraXAoNCkgfHwgLy8gbWVzc2FnZSB0eXBlIGFuZCB1aW50MjQgbGVuZ3RoIGZpZWxkCgkJIXMuUmVhZFVpbnQxNigmbS52ZXJzKSB8fCAhcy5SZWFkQnl0ZXMoJm0ucmFuZG9tLCAzMikgfHwKCQkhcmVhZFVpbnQ4TGVuZ3RoUHJlZml4ZWQoJnMsICZtLnNlc3Npb25JZCkgewoJCXJldHVybiBmYWxzZQoJfQoKCXZhciBjaXBoZXJTdWl0ZXMgY3J5cHRvYnl0ZS5TdHJpbmcKCWlmICFzLlJlYWRVaW50MTZMZW5ndGhQcmVmaXhlZCgmY2lwaGVyU3VpdGVzKSB7CgkJcmV0dXJuIGZhbHNlCgl9CgltLmNpcGhlclN1aXRlcyA9IFtddWludDE2e30KCW0uc2VjdXJlUmVuZWdvdGlhdGlvblN1cHBvcnRlZCA9IGZhbHNlCglmb3IgIWNpcGhlclN1aXRlcy5FbXB0eSgpIHsKCQl2YXIgc3VpdGUgdWludDE2CgkJaWYgIWNpcGhlclN1aXRlcy5SZWFkVWludDE2KCZzdWl0ZSkgewoJCQlyZXR1cm4gZmFsc2UKCQl9CgkJaWYgc3VpdGUgPT0gc2NzdlJlbmVnZXMgW10qdG9rZW4uRmlsZQoJZm9yIHJhbmdlIDI1MDAwIHsKCQlmaWxlcyA9IGFwcGVuZChmaWxlcywgZnNldC5BZGRGaWxlKCIiLCAtMSwgMTAwMDApKQoJfQoJdG9rZW4uU2h1ZmZsZShybmcsIGZpbGVzKQoKCS8vIGNob29zZSByZXR1cm5zIG4gcmFuZG9tIGZpbGVzLgoJY2hvb3NlIDo9IGZ1bmMobiBpbnQpIFtdKnRva2VuLkZpbGUgewoJCXJlcyA6PSBtYWtlKFtdKnRva2VuLkZpbGUsIG4pCgkJZm9yIGkgOj0gcmFuZ2UgcmVzIHsKCQkJcmVzW2ldID0gZmlsZXNbcmFuZC5JbnROKG4pXQoJCX0KCQlyZXR1cm4gZmlsZXNbOm5dCgl9CgoJLy8gTWVhc3VyZSB0aGUgY29zdCBvZgljcmVhdGluZyBhIEZpbGVTZXQgd2l0aCBhIGxhcmdlIG51bWJlcgoJLy8gb2YgZmlsZXMgYWRkZWQgaW4gc21hbGwgaGFuZGZ1bHMsIHdpdGggc29tZSBvdmVybGFwLgoJLy8gVGhpcyBjYXNlIGlzIGNyaXRpY2FsIHRvIGdvcGxzLgoJYi5SdW4oInNlcXVlbmNlIiwgZnVuYyhiICp0ZXN0aW5nLkIpIHsKCQlmb3IgYi5Mb29wKCkgewoJCQliLlN0b3BUaW1lcigpCgkJCWZzZXQyIDo9IHRva2VuLk5ld0ZpbGVTZXQoKQoJCQlmc2V0Mi5BZGRFeGlzdGluZ0ZpbGVzKGZpbGVzWzoxMDAwMF0uLi4pCgkJCWIuU3RhcnRUaW1lcigpCgoJCQlmb3IgcmFuZ2UgMTAwMCB7CgkJCQlmc2V0Mi5BZGRFeGlzdGluZ0ZpbGVzKGNob29zZSgxMCkuLi4pIC8vIGFib3V0IG9uZSBwYWNrYWdlCgkJCX0KCQl9Cgl9KQp9Ci8vIENvcHlyaWdodCAyMDA5IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIGlyCgppbXBvcnQgKAoJImNtZC9jb21waWxlL2ludGVybmFsL2Jhc2UiCgkiY21kL2NvbXBpbGUvaW50ZXJuYWwvdHlwZXMiCgkiY21kL2ludGVybmFsL3NyYyIKKQoKLy8gQ2FsbGluZyBUeXBlTm9kZSBjb252ZXJ0cyBhICp0eXBlcy5UeXBlIHRvIGEgTm9kZSBzaGVsbC4KCi8vIEEgdHlwZU5vZGUgaXMgYSBOb2RlIHdyYXBwZXIgZm9yIHR5cGUgdC4KdHlwZSB0eXBlTm9kZSBzdHJ1Y3QgewoJbWluaU5vZGUKCXR5cCAqdHlwZXMuVHlwZQp9CgpmdW5jIG5ld1R5cGVOb2RlKHR5cCAqdHlwZXMuVHlwZSkgKnR5cGVOb2RlIHsKCW4gOj0gJnR5cGVOb2Rle3R5cDogdHlwfQoJbi5wb3MgPSBzcmMuTm9YUG9zCgluLm9wID0gT1RZUEUKCW4uU2V0VHlwZWNoZWNrKDEpCglyZXR1cm4gbgp9CgpmdW5jIChuICp0eXBlTm9kZSkgVHlwZSgpICp0eXBlcy5UeXBlIHsgcmV0dXJuIG4udHlwIH0KZnVuYyAobiAqdHlwZU5vZGUpIFN5bSgpICp0eXBlcy5TeW0gICB7IHJldHVybiBuLnR5cC5TeW0oKSB9CgovLyBUeXBlTm9kZSByZXR1cm5zIHRoZSBOb2RlIHJlcHJlc2VudGluZyB0aGUgdHlwZSB0LgpmdW5jIFR5cGVOb2RlKHQgKnR5cGVzLlR5cGUpIE5vZGUgewoJaWYgbiA6PSB0Lk9iaigpOyBuICE9IG5pbCB7CgkJaWYgbi5UeXBlKCkgIT0gdCB7CgkJCWJhc2UuRmF0YWxmKCJ0eXBlIHNrZXc6ICV2IGhhcyB0eXBlICV2LCBidXQgZXhwZWN0ZWQgJXYiLCBuLCBuLlR5cGUoKSwgdCkKCQl9CgkJcmV0dXJuIG4uKCpOYW1lKQoJfQoJcmV0dXJuIG5ld1R5cGVOb2RlKHQpCn0KCi8vIEEgRHluYW1pY1R5cGUgcmVwcmVzZW50cyBhIHR5cGUgZXhwcmVzc2lvbiB3aG9zZSBleGFjdCB0eXBlIG11c3QgYmUKLy8gY29tcHV0ZWQgZHluYW1pY2FsbHkuCi8vCi8vIFRPRE8oYWRvbm92YW4pOiBJIHRoaW5rICJkeW5hbWljIiBpcyBhIG1pc25vbWVyIGhlcmU7IGl0J3MgcmVhbGx5IGEKLy8gdHlwZSB3aXRoIGZyZWUgdHlwZSBwYXJhbWV0ZXJzIHRoYXQgbmVlZHMgdG8gYmUgaW5zdGFudGlhdGVkIHRvIG9idGFpbgovLyBhIGdyb3VuZCB0eXBlIGZvciB3aGljaCBhbiBydHlwZSBjYW4gZXhpc3QuCnR5cHBlZCBpbiBHYWxvaXMgQ291bnRlcgovLyBNb2RlLCB3aXRoIHJhbmRvbWx5LWdlbmVyYXRlZCBub25jZXMuIFRoZSBjaXBoZXIgbXVzdCBoYXZlIGJlZW4gY3JlYXRlZCBieQovLyBbY3J5cHRvL2Flcy5OZXdDaXBoZXJdLgovLwovLyBJdCBnZW5lcmF0ZXMgYSByYW5kb20gOTYtYml0IG5vbmNlLCB3aGljaCBpcyBwcmVwZW5kZWQgdG8gdGhlIGNpcGhlcnRleHQgYnkgU2VhbCwKLy8gYW5kIGlzIGV4dHJhY3RlZCBmcm9tIHRoZSBjaXBoZXJ0ZXh0IGJ5IE9wZW4uIFRoZSBOb25jZVNpemUgb2YgdGhlIEFFQUQgaXMgemVybywKLy8gd2hpbGUgdGhlIE92ZXJoZWFkIGlzIDI4IGJ5dGVzICh0aGUgY29tYmluYXRpb24gb2Ygbm9uY2Ugc2l6ZSBhbmQgdGFnIHNpemUpLgovLwovLyBBIGdpdmVuIGtleSBNVVNUIE5PVCBiZSB1c2VkIHRvIGVuY3J5cHQgbW9yZSB0aGFuIDJeMzIgbWVzc2FnZXMsIHRvIGxpbWl0IHRoZQovLyByaXNrIG9mIGEgcmFuZG9tIG5vbmNlIGNvbGxpc2lvbiB0byBuZWdsaWdpYmxlIGxldmVscy4KZnVuYyBOZXdHQ01XaXRoUmFuZG9tTm9uY2UoY2lwaGVyIEJsb2NrKSAoQUVBRCwgZXJyb3IpIHsKCWMsIG9rIDo9IGNpcGhlci4oKmFlcy5CbG9jaykKCWlmICFvayB7CgkJcmV0dXJuIG5pbCwgZXJyb3JzLk5ldygiY2lwaGVyOiBOZXdHQ01XaXRoUmFuZG9tTm9uY2UgcmVxdWlyZXMgYWVzLkJsb2NrIikKCX0KCWcsIGVyciA6PSBnY20uTmV3KGMsIGdjbVN0YW5kYXJkTm9uY2VTaXplLCBnY21UYWdTaXplKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CglyZXR1cm4gZ2NtV2l0aFJhbmRvbU5vbmNle2d9LCBuaWwKfQoKdHlwZSBnY21XaXRoUmFuZG9tTm9uY2Ugc3RydWN0IHsKCSpnY20uR0NNCn0KCmZ1bmMgKGcgZ2NtV2l0aFJhbmRvbU5vbmNlKSBOb25jZVNpemUoKSBpbnQgewoJcmV0dXJuIDAKfQoKZnVuYyAoZyBnY21XaXRoUmFuZG9tTm9uY2UpIE92ZXJoZWFkKCkgaW50IHsKCXJldHVybiBnY21TdGFuZGFyZE5vbmNlU2l6ZSArIGdjbVRhZ1NpemUKfQoKZnVuYyAoZyBnY21XaXRoUmFuZG9tTm9uY2UpIFNlYWwoZHN0LCBub25jZSwgcGxhaW50ZXh0LCBhZGRpdGlvbmFsRGF0YSBbXWJ5dGUpIFtdYnl0ZSB7CglpZiBsZW4obm9uY2UpICE9IDAgewoJCXBhbmljKCJjcnlwdG8vY2lwaGVyOiBub24tZW1wdHkgbm9uY2UgcGFzc2VkIHRvIEdDTVdpdGhSYW5kb21Ob25jZSIpCgl9CgoJcmV0LCBvdXQgOj0gc2xpY2VGb3JBcHBlbmQoZHN0LCBnY21TdGFuZGFyZE5vbmNlU2l6ZStsZW4ocGxhaW50ZXh0KStnY21UYWdTaXplKQoJaWYgYWxpYXMuSW5leGFjdE92ZXJsYXAob3V0LCBwbGFpbnRleHQpIHsKCQlwYW5pYygiY3J5cHRvL2NpcGhlcjogaW52YWxpZCBidWZmZXIgb3ZlcmxhcCBvZiBvdXRwdXQgYW5kIGlucHV0IikKCX0KCWlmIGFsaWFzLkFueU92ZXJsYXAob3V0LCBhZGRpdGlvbmFsRGF0YSkgewoJCXBhbmljKCJjcnlwdG8vY2lwaGVyOiBpbnZhbGlkIGJ1ZmZlciBvdmVybGFwIG9mIG91dHB1dCBhbmQgYWRkaXRpb25hbCBkYXRhIikKCX0KCW5vbmNlID0gb3V0WzpnY21TdGFuZGFyZE5vbmNlU2l6ZV0KCWNpcGhlcnRleHQgOj0gb3V0W2djbVN0YW5kYXJkTm9uY2VTaXplOl0KCgkvLyBUaGUgQUVBRCBpbnRlcmZhY2UgYWxsb3dzIHVzaW5nIHBsYWludGV4dFs6MF0gb3IgY2lwaGVydGV4dFs6MF0gYXMgZHN0LgoJLy8KCS8vIFRoaXMgaXMga2luZCBvZiBhIHByb2JsZW0gd2hlbiB0cnlpbmcgdG8gcHJlcGVuZCBvciB0cmltIGEgbm9uY2UsIGJlY2F1c2UgdGhlCgkvLyBhY3R1YWwgQUVTLUdDVFIgYmxvY2tzIGVuZCB1cCBvdmVybGFwcGluZyBidXQgbm90IGV4YWN0bHkuCgkvLwoJLy8gSW4gT3Blbiwgd2Ugd3JpdGUgdGhlIG91dHB1dCAqYmVmb3JlKiB0aGUgaW5wdXQsIHNvIHVubGVzcyB3ZSBkbyBzb21ldGhpbmcKCS8vIHdlaXJkIGxpa2Ugd29ya2luZyB0aHJvdWdoIGEgY2h1bmsgb2YgYmxvY2sgYmRlXU5vZGVNYXAsIGxlbihwcm9mLlNhbXBsZSkpCglmb3IgXywgc2FtcGxlIDo9IHJhbmdlIHByb2YuU2FtcGxlIHsKCQl2YXIgdywgZHcgaW50NjQKCQl3ID0gby5TYW1wbGVWYWx1ZShzYW1wbGUuVmFsdWUpCgkJaWYgby5TYW1wbGVNZWFuRGl2aXNvciAhPSBuaWwgewoJCQlkdyA9IG8uU2FtcGxlTWVhbkRpdmlzb3Ioc2FtcGxlLlZhbHVlKQoJCX0KCQlpZiBkdyA9PSAwICYmIHcgPT0gMCB7CgkJCWNvbnRpbnVlCgkJfQoJCXZhciBwYXJlbnQgKk5vZGUKCQlsYWJlbHMgOj0gam9pbkxhYmVscyhzYW1wbGUpCgkJLy8gR3JvdXAgdGhlIHNhbXBsZSBmcmFtZXMsIGJhc2VkIG9uIGEgcGVyLW5vZGUgbWFwLgoJCWZvciBpIDo9IGxlbihzYW1wbGUuTG9jYXRpb24pIC0gMTsgaSA+PSAwOyBpLS0gewoJCQlsIDo9IHNhbXBsZS5Mb2NhdGlvbltpXQoJCQlsaW5lcyA6PSBsLkxpbmUKCQkJaWYgbGVuKGxpbmVzKSA9PSAwIHsKCQkJCWxpbmVzID0gW11wcm9maWxlLkxpbmV7e319IC8vIENyZWF0ZSBlbXB0eSBsaW5lIHRvIGluY2x1ZGUgbG9jYXRpb24gaW5mby4KCQkJfQoJCQlmb3IgbGlkeCA6PSBsZW4obGluZXMpIC0gMTsgbGlkeCA+PSAwOyBsaWR4LS0gewoJCQkJbm9kZU1hcCA6PSBwYXJlbnROb2RlTWFwW3BhcmVudF0KCQkJCWlmIG5vZGVNYXAgPT0gbmlsIHsKCQkJCQlub2RlTWFwID0gbWFrZShOb2RlTWFwKQoJCQkJCXBhcmVudE5vZGVNYXBbcGFyZW50XSA9IG5vZGVNYXAKCQkJCX0KCQkJCW4gOj0gbm9kZU1hcC5maW5kT3JJbnNlcnRMaW5lKGwsIGxpbmVzW2xpZHhdLCBvKQoJCQkJaWYgbiA9PSBuaWwgewoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCQluLmFkZFNhbXBsZShkdywgdywgbGFiZWxzLCBzYW1wbGUuTnVtTGFiZWwsIHNhbXBsZS5OdW1Vbml0LCBvLkZvcm1hdFRhZywgZmFsc2UpCgkJCQlpZiBwYXJlbnQgIT0gbmlsIHsKCQkJCQlwYXJlbnQuQWRkVG9FZGdlRGl2KG4sIGR3LCB3LCBmYWxzZSwgbGlkeCAhPSBsZW4obGluZXMpLTEpCgkJCQl9CgkJCQlwYXJlbnQgPSBuCgkJCX0KCQl9CgkJaWYgcGFyZW50ICE9IG5pbCB7CgkJCXBhcmVudC5hZGRTYW1wbGUoZHcsIHcsIGxhYmVscywgc2FtcGxlLk51bUxhYmVsLCBzYW1wbGUuTnVtVW5pdCwgby5Gb3JtYXRUYWcsIHRydWUpCgkJfQoJfQoKCW5vZGVzIDo9IG1ha2UoTm9kZXMsIDAsIGxlbihwcm9mLkxvY2F0aW9uKSkKCWZvciBfLCBubSA6PSByYW5nZSBwYXJlbnROb2RlTWFwIHsKCQlub2RlcyA9IGFwcGVuZChub2Rlcywgbm0ubm9kZXMoKS4uLikKCX0KCXJldHVybiBzZWxlY3ROb2Rlc0ZvckdyYXBoKG5vZGVzLCBvLkRyb3BOZWdhdGl2ZSkKfQoKLy8gU2hvcnRlbkZ1bmN0aW9uTmFtZSByZXR1cm5zIGEgc2hvcnRlbmVkIHZlcnNpb24gb2YgYSBmdW5jdGlvbidzIG5hbWUuCmZ1bmMgU2hvcnRlbkZ1bmN0aW9uTmFtZShmIHN0cmluZykgc3RyaW5nIHsKCWYgPSBjcHBBbm9ueW1vdXNQcmVmaXhSZWdFeHAuUmVwbGFjZUFsbFN0cmluZyhmLCAiIikKCWYgPSBnb1ZlclJlZ0V4cC5SZXBsYWNlQWxsU3RyaW5nKGYsIGAkezF9JHsyfWApCglmb3IgXywgcmUgOj0gcmFuZ2UgW10qcmVnZXhwLlJlZ2V4cHtnb1JlZ0V4cCwgamF2YVJlZ0V4cCwgY3BwUmVnRXhwfSB7CgkJaWYgbWF0Y2hlcyA6PSByZS5GaW5kU3RyaW5nU3VibWF0Y2goZik7IGxlbihtYXRjaGVzKSA+PSAyIHsKCQkJcmV0dXJuIHN0cmluZ3MuSm9pbihtYXRjaGVzWzE6XSwgIiIpCgkJfQoJfQoJcmV0dXJuIGYKfQoKLy8gVHJpbVRyZWUgdHJpbXMgYSBHcmFwaCBpbiBmb3Jlc3QgZm9ybSwga2VlcGluZyBvbmx5IHRoZSBub2RlcyBpbiBrZXB0LiBUaGlzCi8vIHdpbGwgbm90IHdvcmsgY29ycmVjdGx5IGlmIGV2ZW4gYSBzaW5nbGUgbm9kZSBoYXMgbXVsdGlwbGUgcGFyZW50cy4KZnVuYyAoZyAqR3JhcGgpIFRyaW1UcmVlKGtlcHQgTm9kZVB0clNldCkgewoJLy8gQ3JlYXRlcyBhIG5ldyBsaXN0IG9mIG5vZGVzCglvbGROb2RlcyAoMCkKZmxvYXQzMigwKWAsCgkJfSwKCQl7CgkJCWRlc2M6ICJ2YXJpb3VzIHR5cGVzIiwKCQkJaW46IGBnbyB0ZXN0IGZ1enogdjEKaW50KC0yMykKaW50OCgtMikKaW50NjQoMjM0MjQyNSkKdWludCgxKQp1aW50MTYoMjM0KQp1aW50MzIoMzUyMzQyKQp1aW50NjQoMTIzKQpydW5lKCfFkycpCmJ5dGUoJ0snKQpieXRlKCfDvycpCltdYnl0ZSgiaGVsbG/CvyIpCltdYnl0ZSgiYSIpCmJvb2wodHJ1ZSkKc3RyaW5nKCJoZWxsb1xceGJkXFx4YjI9XFx4YmMg4oyYIikKZmxvYXQ2NCgtMTIuNSkKZmxvYXQzMigyLjUpYCwKCQl9LAoJCXsKCQkJZGVzYzogImZsb2F0IGVkZ2UgY2FzZXMiLAoJCQkvLyBUaGUgdHdvIElFRUUgNzU0IGJpdCBwYXR0ZXJucyB1c2VkIGZvciB0aGUgbWF0aC5GbG9hdHs2NCwzMn1mcm9tYml0cwoJCQkvLyBlbmNvZGluZ3MgYXJlIG5vbi1tYXRoLk5BTiBxdWlldC1OYU4gdmFsdWVzLiBTaW5jZSB0aGV5IGFyZSBub3QgZXF1YWwKCQkJLy8gdG8gbWF0aC5OYU4oKSwgdGhleSBzaG91bGQgYmUgcmUtZW5jb2RlZCB0byB0aGVpciBiaXQgcGF0dGVybnMuIFRoZXkKCQkJLy8gYXJlLCByZXNwZWN0aXZlbHk6CgkJCS8vICAgKiBtYXRoLkZsb2F0NjRiaXRzKG1hdGguTmFOKCkpKzEKCQkJLy8gICAqIG1hdGguRmxvYXQzMmJpdHMoZmxvYXQzMihtYXRoLk5hTigpKSkrMQoJCQlpbjogYGdvIHRlc3QgZnV6eiB2MQpmbG9hdDMyKC0wKQpmbG9hdDY0KC0wKQpmbG9hdDMyKCtJbmYpCmZsb2F0MzIoLUluZikKZmxvYXQzMihOYU4pCmZsb2F0NjQoK0luZikKZmxvYXQ2NCgtSW5mKQpmbG9hdDY0KE5hTikKbWF0aC5GbG9hdDY0ZnJvbWJpdHMoMHg3ZmY4MDAwMDAwMDAwMDAyKQptYXRoLkZsb2F0MzJmcm9tYml0cygweDdmYzAwMDAxKWAsCgkJfSwKCQl7CgkJCWRlc2M6ICJpbnQgdmFyaWF0aW9ucyIsCgkJCS8vIEFsdGhvdWdoIHdlIGFyYml0cmFyaWx5IGNob29zZSBkZWZhdWx0IGludGVnZXIgYmFzZXMgKDAgb3IgMTYpLCB3ZSBtYXkKCQkJLy8gd2FudCB0byBjaGFuZ2UgdGhvc2UgYXJiaXRyYXJ5IGNob2ljZXMgaW4gdGhlIGZ1dHVyZSBhbmQgc2hvdWxkIG5vdAoJCQkvLyBicmVhayB0aGUgcGFyc2VyLiBWZXJpZnkgdGhhdCBpbnRlZ2VycyBpbiB0aGUgb3Bwb3NpdGUgYmFzZXMgc3RpbGwKCQkJLy8gcGFyc2UgY29ycmVjdGx5LgoJCQlpbjogYGdvIHRlc3QgZnV6eiB2MQppbnQoMHgwKQppbnQzMigweDQxKQppbnQ2NCgweGZmZmZmZmZmZikKdWludDMyKDB4Y2FmZWYwMGQpCnVpbnQ2NCgweGZmZmZmZmZmZmZmZmZmZmYpCnVpbnQ4KDBiMDAwMDAwMCkKYnl0ZSgweDApCmJ5dGUoJ1wwMDAnKQpieXRlKCdcdTAwMDAnKQpieXRlKCdcJycpCm1hdGguRmxvYXQ2NGZyb21iaXRzKDkyMjExMjAyMzcwNDEwOTA1NjIpCm1hdGguRmxvYXQzMmZyb21iaXRzKDIxNDMyODkzNDUpYCwKCQkJd2FudDogYGdvIHRlc3QgZnV6eiB2MQppbnQoMCkKcnVuZSgnQScpCmludDY0KDY4NzE5NDc2NzM1KQp1aW50MzIoMzQwNTcwNTIyOSkKdWludDY0KDE4NDQ2NzQ0MDczNzA5NTUxNjE1KQpieXRlKCdceDAwJykKYnl0ZSgnXHgwMCcpCmJ5dGUoJ1x4MDAnKQpieXRlKCdceDAwJykKYnl0ZSgnXCcnKQptYXRoLkZsb2F0NjRmcm9tYml0cygweDdmZjgwMDAwMDAwMDAwMDIpCm1hdGguRmxvYXQzMmZyb21iaXRzKDB4N2ZjMDAwMDEpYCwKCQl9LAoJCXsKCQkJZGVzYzogInJ1bmUgdmFsaWRhdGlvbiIsCgkJCWluOiBgZ28gdGVzdCBmdXp6IHYxCnJ1bmUoMCkKcnVuZSgweDQxKQpydW5lKC0xKQpydW5lKDB4ZmZmZCkKcnVuZSgweGQ4MDApCnJ1bmUoMHgxMGZmZmYpCnJ1bmUoMHgxMTAwMDApCmAsCgkJCXdhbnQ6IGBnbyB0ZXN0IGZ1enogdjEKcnVuZSgnXHgwMCcpCnJ1bmUoJ0EnKQppbnQzMigtMSkKcnVuZSgn77+9JykKaW50MzIoNTUyOTYpCnJ1bmUoJ1xVMDAxMGZmZmYnKQppbnQzMigxMTE0MTEyKWAsCgkJfSwKCQl7CgkJCWRlc2M6ICJpbnQgb3ZlcmZsb3ciLAoJCQkJCWxhc3QuZW5kID0gbCArIDEKCQkJCWxhc3QuZmxhdCArPSBmbi5mbGF0CgkJCQlsYXN0LmN1bSArPSBmbi5jdW0KCQkJCWZ1bmNzW2xlbihmdW5jcyktMV0gPSBsYXN0CgkJCQljb250aW51ZQoJCQl9CgkJfQoKCQkvLyBBZGQgbmV3IGZ1bmN0aW9uLgoJCWZ1bmNzID0gYXBwZW5kKGZ1bmNzLCBmbikKCX0KCgkvLyBFeHBhbmQgZnVuY3Rpb24gYm91bmRhcmllcyB0byBzaG93IG5laWdoYm9yaG9vZC4KCWNvbnN0IGV4cGFuZCA9IDUKCWZvciBpLCBmIDo9IHJhbmdlIGZ1bmNzIHsKCQlpZiBpID09IDAgewoJCQkvLyBFeHRlbmQgYmFja3dhcmRzLCBzdG9wcGluZyBhdCBsaW5lIG51bWJlciAxLCBidXQgZG8gbm90IGRpc3R1cmIgMAoJCQkvLyBzaW5jZSB0aGF0IGlzIGEgc3BlY2lhbCBsaW5lIG51bWJlciB0aGF0IGNhbiBzaG93IHVwIHdoZW4gYWRkcjJsaW5lCgkJCS8vIGNhbm5vdCBkZXRlcm1pbmUgdGhlIHJlYWwgbGluZSBudW1iZXIuCgkJCWlmIGYuYmVnaW4gPiBleHBhbmQgewoJCQkJZi5iZWdpbiAtPSBleHBhbmQKCQkJfSBlbHNlIGlmIGYuYmVnaW4gPiAxIHsKCQkJCWYuYmVnaW4gPSAxCgkJCX0KCQl9IGVsc2UgewoJCQkvLyBGaW5kIGdhcCBmcm9tIHByZWRlY2Vzc29yIGFuZCBkaXZpZGUgYmV0d2VlbiBwcmVkZWNlc3NvciBhbmQgZi4KCQkJaGFsZkdhcCA6PSBtaW4oKGYuYmVnaW4tZnVuY3NbaS0xXS5lbmQpLzIsIGV4cGFuZCkKCQkJZnVuY3NbaS0xXS5lbmQgKz0gaGFsZkdhcAoJCQlmLmJlZ2luIC09IGhhbGZHYXAKCQl9CgkJZnVuY3NbaV0gPSBmCgl9CgoJLy8gQWxzbyBleHRlbmQgdGhlIGVuZGluZyBwb2ludCBvZiB0aGUgbGFzdCBmdW5jdGlvbi4KCWlmIGxlbihmdW5jcykgPiAwIHsKCQlmdW5jc1tsZW4oZnVuY3MpLTFdLmVuZCArPSBleHBhbmQKCX0KCglyZXR1cm4gZnVuY3MKfQoKLy8gb2JqZWN0RmlsZSByZXR1cm4gdGhlIG9iamVjdCBmb3IgdGhlIHNwZWNpZmllZCBtYXBwaW5nLCBvcGVuaW5nIGl0IGlmIG5lY2Vzc2FyeS4KLy8gSXQgcmV0dXJucyBuaWwgb24gZXJyb3IuCmZ1bmMgKHNwICpzb3VyY2VQcmludGVyKSBvYmplY3RGaWxlKG0gKnByb2ZpbGUuTWFwcGluZykgcGx1Z2luLk9iakZpbGUgewoJaWYgbSA9PSBuaWwgewoJCXJldHVybiBuaWwKCX0KCWlmIG9iamVjdCwgb2sgOj0gc3Aub2JqZWN0c1ttLkZpbGVdOyBvayB7CgkJcmV0dXJuIG9iamVjdCAvLyBNYXkgYmUgbmlsIGlmIHdlIGRldGVjdGVkIGFuIGVycm9yIGVhcmxpZXIuCgl9CglvYmplY3QsIGVyciA6PSBzcC5vYmplY3RUb29sLk9wZW4obS5GaWxlLCBtLlN0YXJ0LCBtLkxpbWl0LCBtLk9mZnNldCwgbS5LZXJuZWxSZWxvY2F0aW9uU3ltYm9sKQoJaWYgZXJyICE9IG5pbCB7CgkJb2JqZWN0ID0gbmlsCgl9CglzcC5vYmplY3RzW20uRmlsZV0gPSBvYmplY3QgLy8gQ2FjaGUgZXZlbiBvbiBlcnJvci4KCXJldHVybiBvYmplY3QKfQoKLy8gbWFrZVdlYkxpc3RMaW5lIHJldHVybnMgdGhlIGNvbnRlbnRzIG9mIGEgc2luZ2xlIGxpbmUgaW4gYSB3ZWIgbGlzdGluZy4gVGhpcyBpbmNsdWRlcwovLyB0aGUgc291cmNlIGxpbmUgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGFzc2VtYmx5LgpmdW5jIG1ha2VXZWJMaXN0TGluZShsaW5lTm8gaW50LCBmbGF0LCBjdW0gaW50NjQsIGxpbmVDb250ZW50cyBzdHJpbmcsCglhc3NlbWJseSBbXWFzc2VtYmx5SW5zdHJ1Y3Rpb24sIHJlYWRlciAqc291cmNlUmVhZGVyLCBycHQgKlJlcG9ydCkgV2ViTGlzdExpbmUgewoJbGluZSA6PSBXZWJMaXN0TGluZXsKCQlTcmNMaW5lOiAgICBsaW5lQ29udGVudHMsCgkJTGluZTogICAgICAgbGluZU5vLAoJCUZsYXQ6ICAgICAgIHZhbHVlT3JEb3QoZmxhdCwgcnB0KSwKCQlDdW11bGF0aXZlOiB2YWx1ZU9yRG90KGN1bSwgcnB0KSwKCX0KCglpZiBsZW4oYXNzZW1ibHkpID09IDAgewoJCWxpbmUuSFRNTENsYXNzID0gIm5vcCIKCQlyZXR1cm4gbGluZQoJfQoKCW5lc3RlZEluZm8gOi1nY2MtZXhwb3J0LWhlYWRlci1wcm9sb2ciCgojaWZuZGVmIEdPX0NHT19QUk9MT0dVRV9ICiNkZWZpbmUgR09fQ0dPX1BST0xPR1VFX0gKCnR5cGVkZWYgc2lnbmVkIGNoYXIgR29JbnQ4Owp0eXBlZGVmIHVuc2lnbmVkIGNoYXIgR29VaW50ODsKdHlwZWRlZiBzaG9ydCBHb0ludDE2Owp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IEdvVWludDE2Owp0eXBlZGVmIGludCBHb0ludDMyOwp0eXBlZGVmIHVuc2lnbmVkIGludCBHb1VpbnQzMjsKdHlwZWRlZiBsb25nIGxvbmcgR29JbnQ2NDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcgR29VaW50NjQ7CnR5cGVkZWYgR29JbnRHT0lOVEJJVFMgR29JbnQ7CnR5cGVkZWYgR29VaW50R09JTlRCSVRTIEdvVWludDsKdHlwZWRlZiBzaXplX3QgR29VaW50cHRyOwp0eXBlZGVmIGZsb2F0IEdvRmxvYXQzMjsKdHlwZWRlZiBkb3VibGUgR29GbG9hdDY0OwojaWZkZWYgX01TQ19WRVIKI2lmICFkZWZpbmVkKF9fY3BsdXNwbHVzKSB8fCBfTVNWQ19MQU5HIDw9IDIwMTQwMkwKI2luY2x1ZGUgPGNvbXBsZXguaD4KdHlwZWRlZiBfRmNvbXBsZXggR29Db21wbGV4NjQ7CnR5cGVkZWYgX0Rjb21wbGV4IEdvQ29tcGxleDEyODsKI2Vsc2UKI2luY2x1ZGUgPGNvbXBsZXg+CnR5cGVkZWYgc3RkOjpjb21wbGV4PGZsb2F0PiBHb0NvbXBsZXg2NDsKdHlwZWRlZiBzdGQ6OmNvbXBsZXg8ZG91YmxlPiBHb0NvbXBsZXgxMjg7CiNlbmRpZgojZWxzZQp0eXBlZGVmIGZsb2F0IF9Db21wbGV4IEdvQ29tcGxleDY0Owp0eXBlZGVmIGRvdWJsZSBfQ29tcGxleCBHb0NvbXBsZXgxMjg7CiNlbmRpZgoKLyoKICBzdGF0aWMgYXNzZXJ0aW9uIHRvIG1ha2Ugc3VyZSB0aGUgZmlsZSBpcyBiZWluZyB1c2VkIG9uIGFyY2hpdGVjdHVyZQogIGF0IGxlYXN0IHdpdGggbWF0Y2hpbmcgc2l6ZSBvZiBHb0ludC4KKi8KdHlwZWRlZiBjaGFyIF9jaGVja19mb3JfR09JTlRCSVRTX2JpdF9wb2ludGVyX21hdGNoaW5nX0dvSW50W3NpemVvZih2b2lkKik9PUdPSU5UQklUUy84ID8gMTotMV07CgojaWZuZGVmIEdPX0NHT19HT1NUUklOR19UWVBFREVGCnR5cGVkZWYgX0dvU3RyaW5nXyBHb1N0cmluZzsKI2VuZGlmCnR5cGVkZWYgdm9pZCAqR29NYXA7CnR5cGVkZWYgdm9pZCAqR29DaGFuOwp0eXBlZGVmIHN0cnVjdCB7IHZvaWQgKnQ7IHZvaWQgKnY7IH0gR29JbnRlcmZhY2U7CnR5cGVkZWYgc3RydWN0IHsgdm9pZCAqZGF0YTsgR29JbnQgbGVuOyBHb0ludCBjYXA7IH0gR29TbGljZTsKCiNlbmRpZgoKLyogRW5kIG9mIGJvaWxlcnBsYXRlIGNnbyBwcm9sb2d1ZS4gICovCgojaWZkZWYgX19jcGx1c3BsdXMKZXh0ZXJuICJDIiB7CiNlbmRpZgpgCgovLyBnY2NFeHBvcnRIZWFkZXJFcGlsb2cgZ29lcyBhdCB0aGUgZW5kIG9mIHRoZSBnZW5lcmF0ZWQgaGVhZGVyIGZpbGUuCmNvbnN0IGdjY0V4cG9ydEhlYWRlckVwaWxvZyA9IGAKI2lmZGVmIF9fY3BsdXNwbHVzCn0KI2VuZGlmCmAKCi8vIGdjY2dvRXhwb3J0RmlsZVByb2xvZyBpcyB3cml0dGVuIHRvIHRoZSBfY2dvX2V4cG9ydC5jIGZpbGUgd2hlbgovLyB1c2luZyBnY2Nnby4KLy8gV2UgdXNlIHdlYWsgZGVjbGFyYXRpb25zLCBhbmQgdGVzdCB0aGUgYWRkcmVzc2VzLCBzbyB0aGF0IHRoaXMgY29kZQovLyB3b3JrcyB3aXRoIG9sZGVyIHZlcnNpb25zIG9mIGdjY2dvLgpjb25zdCBnY2Nnb0V4cG9ydEZpbGVQcm9sb2cgPSBgCiNsaW5lIDEgImNnby1nY2Nnby1leHBvcnQtZmlsZS1wcm9sb2ciCmV4dGVybiBfQm9vbCBydW50aW1lX2lzY2dvIF9fYXR0cmlidXRlX18gKCh3ZWFrKSk7CgpzdGF0aWMgdm9pZCBHb0luaXQodm9pZCkgX19hdHRyaWJ1dGVfXyAoKGNvbnN0cnVjdG9yKSk7CnN0YXRpYyB2b2lkIEdvSW5pdCh2b2lkKSB7CglpZigmcnVudGltZV9pc2NnbykKCQlydW50aW1lX2lzY2dvID0gMTsKfQoKZXh0ZXJuIHNpemVfdCBfY2dvX3dhaXRfcnVudGltZV9pbml0X2RvbmUodm9pZGxnYW1UWzE0XSkpKQoJCQlwIDo9IHoqcDEgLSAoVHQgLSB3KihwMit5KnAzKSkKCQkJbGdhbW1hICs9IChUZiArIHApCgkJY2FzZSAyOgoJCQlwMSA6PSB5ICogKF9sZ2FtVVswXSArIHkqKF9sZ2FtVVsxXSt5KihfbGdhbVVbMl0reSooX2xnYW1VWzNdK3kqKF9sZ2FtVVs0XSt5Kl9sZ2FtVVs1XSkpKSkpCgkJCXAyIDo9IDEgKyB5KihfbGdhbVZbMV0reSooX2xnYW1WWzJdK3kqKF9sZ2FtVlszXSt5KihfbGdhbVZbNF0reSpfbGdhbVZbNV0pKSkpCgkJCWxnYW1tYSArPSAoLTAuNSp5ICsgcDEvcDIpCgkJfQoJY2FzZSB4IDwgODogLy8gMiA8PSB4IDwgOAoJCWkgOj0gaW50KHgpCgkJeSA6PSB4IC0gZmxvYXQ2NChpKQoJCXAgOj0geSAqIChfbGdhbVNbMF0gKyB5KihfbGdhbVNbMV0reSooX2xnYW1TWzJdK3kqKF9sZ2FtU1szXSt5KihfbGdhbVNbNF0reSooX2xnYW1TWzVdK3kqX2xnYW1TWzZdKSkpKSkpCgkJcSA6PSAxICsgeSooX2xnYW1SWzFdK3kqKF9sZ2FtUlsyXSt5KihfbGdhbVJbM10reSooX2xnYW1SWzRdK3kqKF9sZ2FtUls1XSt5Kl9sZ2FtUls2XSkpKSkpCgkJbGdhbW1hID0gMC41KnkgKyBwL3EKCQl6IDo9IDEuMCAvLyBMZ2FtbWEoMStzKSA9IExvZyhzKSArIExnYW1tYShzKQoJCXN3aXRjaCBpIHsKCQljYXNlIDc6CgkJCXogKj0gKHkgKyA2KQoJCQlmYWxsdGhyb3VnaAoJCWNhc2UgNjoKCQkJeiAqPSAoeSArIDUpCgkJCWZhbGx0aHJvdWdoCgkJY2FzZSA1OgoJCQl6ICo9ICh5ICsgNCkKCQkJZmFsbHRocm91Z2gKCQljYXNlIDQ6CgkJCXogKj0gKHkgKyAzKQoJCQlmYWxsdGhyb3VnaAoJCWNhc2UgMzoKCQkJeiAqPSAoeSArIDIpCgkJCWxnYW1tYSArPSBMb2coeikKCQl9CgljYXNlIHggPCBUd281ODogLy8gOCA8PSB4IDwgMioqNTgKCQl0IDo9IExvZyh4KQoJCXogOj0gMSAvIHgKCQl5IDo9IHogKiB6CgkJdyA6PSBfbGdhbVdbMF0gKyB6KihfbGdhbVdbMV0reSooX2xnYW1XWzJdK3kqKF9sZ2FtV1szXSt5KihfbGdhbVdbNF0reSooX2xnYW1XWzVdK3kqX2xnYW1XWzZdKSkpKSkKCQlsZ2FtbWEgPSAoeC0wLjUpKih0LTEpICsgdwoJZGVmYXVsdDogLy8gMioqNTggPD0geCA8PSBJbmYKCQlsZ2FtbWEgPSB4ICogKExvZyh4KSAtIDEpCgl9CglpZiBuZWcgewoJCWxnYW1tYSA9IG5hZGogLSBsZ2FtbWEKCX0KCXJldHVybgp9CgovLyBzaW5QaSh4KSBpcyBhIGhlbHBlciBmdW5jdGlvbiBmb3IgbmVnYXRpdmUgeApmdW5jIHNpblBpKHggZmxvYXQ2NCkgZmxvYXQ2NCB7Cgljb25zdCAoCgkJVHdvNTIgPSAxIDw8IDUyIC8vIDB4NDMzMDAwMDAwMDAwMDAwMCB+NC41MDM2ZSsxNQoJCVR3bzUzID0gMSA8PCA1MyAvLyAweDQzNDAwMDAwMDAwMDAwMDAgfjkuMDA3MmUrMTUKCSkKCWlmIHggPCAwLjI1IHsKCQlyZXR1cm4gLVNpbihQaSAqIHgpCgl9CgoJLy8gYXJndW1lbnQgcmVkdWN0aW9uCgl6IDo9IEZsb29yKHgpCgl2YXIgbiBpbnQKCWlmIHogIT0geCB7IC8vIGluZXhhY3QKCQl4ID0gTW9kKHgsIDIpCgkJbiA9IGludCh4ICogNCkKCX0gZWxzZSB7CgkJaWYgeCA+PSBUd281MyB7IC8vIHggbXVzdCBiZSBldmVuCgkJCXggPSAwCgkJCW4gPSAwCgkJfSBlbHNlIHsKCQkJaWYgeCA8IFR3bzUyIHsKCQkJCXogPSB4ICsgVHdvNTIgLy8gZXhhY3QKCQkJfQoJCQluID0gaW50KDEgJiBGbG9hdDY0Yml0cyh6KSkKCQkJeCA9IGZsb2F0NjQobikKCQkJbiA8PD0gMgoJCX0KCX0KCXN3aXRjaCBuIHsKCWNhc2UgMDoKCQl4ID0gU2luKFBpICogeCkKCWNhc2UgMSwgMjoKCQl4ID0gQ29zKFBpICogKDAuNSAtIHgpKQoJY2FzZSAzLCA0OgoJCXggPSBTaW4oUGkgKiAoMSAtIHgpKQoJY2FzZSA1LCA2OgoJCXggPSAtQ29zKFBpICogKHggLSAxLjUpKQoJZGVmYXVsdDoKCQl4ID0gU2luKFBpICogKHggLSAyKSkKCX0KCXJldHVybiAteAp9Ci8vIGVycm9yY2hlY2sgLTAgLWQ9c3NhL2NoZWNrX2JjZS9kZWJ1Zz0zCgovL2dvOmJ1aWxkIGFtZDY0ICYmICFnY2Z1aWxkIGZha2V0aW1lICYmICF3aW5kb3dzCgovLyBGYWtldGltZSBpc24ndCBjdXJyZW50bHkgc3VwcG9ydGVkIG9uIFdpbmRvd3MuIFRoaXMgd291bGQgcmVxdWlyZQovLyBtb2RpZnlpbmcgc3lzY2FsbC5Xcml0ZSB0byBjYWxsIHN5c2NhbGwuZmFrZXRpbWVXcml0ZSwKLy8gdHJhbnNsYXRpbmcgdGhlIFN0ZG91dCBhbmQgU3RkZXJyIGhhbmRsZXMgaW50byBGRHMgMSBhbmQgMi4KLy8gKFNlZSBDTCAxOTI3MzkgUFMgMy4pCgpwYWNrYWdlIHJ1bnRpbWUKCmltcG9ydCAidW5zYWZlIgoKLy8gZmFrZXRpbWUgaXMgdGhlIHNpbXVsYXRlZCB0aW1lIGluIG5hbm9zZWNvbmRzIHNpbmNlIDE5NzAgZm9yIHRoZQovLyBwbGF5Z3JvdW5kLgp2YXIgZmFrZXRpbWUgaW50NjQgPSAxMjU3ODk0MDAwMDAwMDAwMDAwCgp2YXIgZmFrZXRpbWVTdGF0ZSBzdHJ1Y3QgewoJbG9jayBtdXRleAoKCS8vIGxhc3RmYWtldGltZSBpcyB0aGUgbGFzdCBmYWtldGltZSB2YWx1ZSB3cml0dGVuIHRvIGZkIDEgb3IgMi4KCWxhc3RmYWtldGltZSBpbnQ2NAoKCS8vIGxhc3RmZCBpcyB0aGUgZmQgdG8gd2hpY2ggbGFzdGZha2V0aW1lIHdhcyB3cml0dGVuLgoJLy8KCS8vIFN1YnNlcXVlbnQgd3JpdGVzIHRvIHRoZSBzYW1lIGZkIG1heSB1c2UgdGhlIHNhbWUKCS8vIHRpbWVzdGFtcCwgYnV0IHRoZSB0aW1lc3RhbXAgbXVzdCBpbmNyZWFzZSBpZiB0aGUgZmQKCS8vIGNoYW5nZXMuCglsYXN0ZmQgdWludHB0cgp9CgovL2dvOmxpbmtuYW1lIG5hbm90aW1lCi8vZ286bm9zcGxpdApmdW5jIG5hbm90aW1lKCkgaW50NjQgewoJcmV0dXJuIGZha2V0aW1lCn0KCi8vZ286bGlua25hbWUgdGltZV9ub3cgdGltZS5ub3cKZnVuYyB0aW1lX25vdygpIChzZWMgaW50NjQsIG5zZWMgaW50MzIsIG1vbm8gaW50NjQpIHsKCXJldHVybiBmYWtldGltZSAvIDFlOSwgaW50MzIoZmFrZXRpbWUgJSAxZTkpLCBmYWtldGltZQp9CgovLyB3cml0ZSBpcyBsaWtlIHRoZSBVbml4IHdyaXRlIHN5c3RlbSBjYWxsLgovLyBXZSBoYXZlIHRvIGF2b2lkIHdyaXRlIGJhcnJpZXJzIHRvIGF2b2lkIHBvdGVudGlhbCBkZWFkbG9jawovLyBvbiB3cml0ZSBjYWxscy4KLy8KLy9nbzpub3dyaXRlYmFycmllcnJlYwpmdW5jIHdyaXRlKGZkIHVpbnRwdHIsIHAgdW5zYWZlLlBvaW50ZXIsIG4gaW50MzIpIGludDMyIHsKCWlmICEoZmQgPT0gMSB8fCBmZCA9PSAyKSB7CgkJLy8gRG8gYW4gb3JkaW5hcnkgd3JpdGUuCgkJcmV0dXJuIHdyaXRlMShmZCwgcCwgbikKCX0KCgkvLyBXcml0ZSB3aXRoIHRoZSBwbGF5YmFjayBoZWFkZXIuCgoJLy8gRmlyc3QsIGxvY2sgdG8gYXZvaWQgaW50ZXJsZWF2aW5nIHdyaXRlcy4KCWxvY2soJmZha2V0aW1lU3RhdGUubG9jaykKCgkvLyBJZiB0aGUgY3VycmVudCBmZCBkb2Vzbid0IG1hdGNoIHRoZSBmZCBvZiB0aGUgcHJldmlvdXMgd3JpdGUsCgkvLyBlbnN1cmUgdGhhdCB0aGUgdGltZXN0YW1wIGlzIHN0cmljdGx5IGdyZWF0ZXIuIFRoYXQgd2F5LCB3ZSBjYW4KCS8vIHJlY292ZXIgdGhlIG9yaWdpbmFsIG9yZGVyIGV2ZW4gaWYgd2UgcmVhZCB0aGUgZmRzIHNlcGFyYXRlbHkuCgl0IDo9IGZha2V0aW1lU3RhdGUubGFzdGZha2V0aW1lCglpZiBmZCAhPSBmYWtldGltZVN0YXRlLmxhc3RmZCB7CgkJdCsrCgkJZmFrZXRpbWVTdGF0ZS5sYXN0ZmQgPSBmZAoJfQoJaWYgZmFrZXRpbWUgPiB0IHsKCQl0ID0gZmFrZXRpbWUKCX0KCWZha2V0aW1lU3RhdGUubGFzdGZha2V0aW1lID0gdAoKCS8vIFBsYXliYWNrIGhlYWRlcjogMCAwIFAgQiA8OC1ieXRlIHRpbWU+IDw0LWJ5dGUgZGF0YSBsZW5ndGg+IChiaWcgZW5kaWFuKQoJdmFyIGJ1ZiBbNCArIDggKyA0XWJ5dGUKCWJ1ZlsyXSA9ICdQJwoJYnVmWzNdID0gJ0InCgl0dSA6PSB1aW50NjQodCkKCWJ1Zls0XSA9IGJ5dGUodHUgPj4gKDcgKiA4KSkKCWJ1Zls1XSA9IGJ5dGUodHUgPj4gKDYgKiA4KSkKCWJ1Zls2XSA9IGJ5dGUodHUgPj4gKDUgZXMuCglraW5kTm9Qb2xsCikKCi8vIG5ld0ZpbGUgaXMgbGlrZSBOZXdGaWxlLCBidXQgaWYgY2FsbGVkIGZyb20gT3BlbkZpbGUgb3IgUGlwZQovLyAoYXMgcGFzc2VkIGluIHRoZSBraW5kIHBhcmFtZXRlcikgaXQgdHJpZXMgdG8gYWRkIHRoZSBmaWxlIHRvCi8vIHRoZSBydW50aW1lIHBvbGxlci4KZnVuYyBuZXdGaWxlKGZkIGludCwgbmFtZSBzdHJpbmcsIGtpbmQgbmV3RmlsZUtpbmQsIG5vbkJsb2NraW5nIGJvb2wpICpGaWxlIHsKCWYgOj0gJkZpbGV7JmZpbGV7CgkJcGZkOiBwb2xsLkZEewoJCQlTeXNmZDogICAgICAgICBmZCwKCQkJSXNTdHJlYW06ICAgICAgdHJ1ZSwKCQkJWmVyb1JlYWRJc0VPRjogdHJ1ZSwKCQl9LAoJCW5hbWU6ICAgICAgICBuYW1lLAoJCXN0ZG91dE9yRXJyOiBmZCA9PSAxIHx8IGZkID09IDIsCgl9fQoKCXBvbGxhYmxlIDo9IGtpbmQgPT0ga2luZE9wZW5GaWxlIHx8IGtpbmQgPT0ga2luZFBpcGUgfHwga2luZCA9PSBraW5kU29jayB8fCBub25CbG9ja2luZwoKCS8vIFRoaW5ncyBsaWtlIHJlZ3VsYXIgZmlsZXMgYW5kIEZJRk9zIGluIGtxdWV1ZSBvbiAqQlNEL0RhcndpbgoJLy8gbWF5IG5vdCB3b3JrIHByb3Blcmx5IChvciBhY2N1cmF0ZWx5IGFjY29yZGluZyB0byBpdHMgbWFudWFsKS4KCS8vIEFzIGEgcmVzdWx0LCB3ZSBzaG91bGQgYXZvaWQgYWRkaW5nIHRob3NlIHRvIHRoZSBrcXVldWUtYmFzZWQKCS8vIG5ldHBvbGxlci4gQ2hlY2sgb3V0ICMxOTA5MywgIzI0MTY0LCBhbmQgIzY2MjM5IGZvciBtb3JlIGNvbnRleHRzLgoJLy8KCS8vIElmIHRoZSBmZCB3YXMgcGFzc2VkIHRvIHVzIHZpYSBhbnkgcGF0aCBvdGhlciB0aGFuIE9wZW5GaWxlLAoJLy8gd2UgYXNzdW1lIHRob3NlIGNhbGxlcnMga25vdyB3aGF0IHRoZXkgd2VyZSBkb2luZywgc28gd2Ugd29uJ3QKCS8vIHBlcmZvcm0gdGhpcyBjaGVjayBhbmQgYWxsb3cgaXQgdG8gYmUgYWRkZWQgdG8gdGhlIGtxdWV1ZS4KCWlmIGtpbmQgPT0ga2luZE9wZW5GaWxlIHsKCQlzd2l0Y2ggcnVudGltZS5HT09TIHsKCQljYXNlICJkYXJ3aW4iLCAiaW9zIiwgImRyYWdvbmZseSIsICJmcmVlYnNkIiwgIm5ldGJzZCIsICJvcGVuYnNkIjoKCQkJdmFyIHN0IHN5c2NhbGwuU3RhdF90CgkJCWVyciA6PSBpZ25vcmluZ0VJTlRSKGZ1bmMoKSBlcnJvciB7CgkJCQlyZXR1cm4gc3lzY2FsbC5Gc3RhdChmZCwgJnN0KQoJCQl9KQoJCQl0eXAgOj0gc3QuTW9kZSAmIHN5c2NhbGwuU19JRk1UCgkJCS8vIERvbid0IHRyeSB0byB1c2Uga3F1ZXVlIHdpdGggcmVndWxhciBmaWxlcyBvbiAqQlNEcy4KCQkJLy8gT24gRnJlZUJTRCBhIHJlZ3VsYXIgZmlsZSBpcyBhbHdheXMKCQkJLy8gcmVwb3J0ZWQgYXMgcmVhZHkgZm9yIHdyaXRpbmcuCgkJCS8vIE9uIERyYWdvbmZseSwgTmV0QlNEIGFuZCBPcGVuQlNEIHRoZSBmZCBpcyBzaWduYWxlZAoJCQkvLyBvbmx5IG9uY2UgYXMgcmVhZHkgKGJvdGggcmVhZCBhbmQgd3JpdGUpLgoJCQkvLyBJc3N1ZSAxOTA5My4KCQkJLy8gQWxzbyBkb24ndCBhZGQgZGlyZWN0b3JpZXMgdG8gdGhlIG5ldHBvbGxlci4KCQkJaWYgZXJyID09IG5pbCAmJiAodHlwID09IHN5c2NhbGwuU19JRlJFRyB8fCB0eXAgPT0gc3lzY2FsbC5TX0lGRElSKSB7CgkJCQlwb2xsYWJsZSA9IGZhbHNlCgkJCX0KCgkJCS8vIEluIGFkZGl0aW9uIHRvIHRoZSBiZWhhdmlvciBkZXNjcmliZWQgYWJvdmUgZm9yIHJlZ3VsYXIgZmlsZXMsCgkJCS8vIG9uIERhcndpbiwga3F1ZXVlIGRvZXMgbm90IHdvcmsgcHJvcGVybHkgd2l0aCBmaWZvczoKCQkJLy8gY2xvc2luZyB0aGUgbGFzdCB3cml0ZXIgZG9lcyBub3QgY2F1c2UgYSBrcXVldWUgZXZlbnQKCQkJLy8gZm9yIGFueSByZWFkZXJzLiBTZWUgaXNzdWUgIzI0MTY0LgoJCQlpZiAocnVudGltZS5HT09TID09ICJkYXJ3aW4iIHx8IHJ1bnRpbWUuR09PUyA9PSAiaW9zIikgJiYgdHlwID09IHN5c2NhbGwuU19JRklGTyB7CglydCBhbmFseXNpcyB3aXRoIEhfSSA9ICVzIiwgSF9JKQoJCW91dCwgZXJyID0gdGVzdGVudi5Db21tYW5kKHQsCgkJCSJkb2NrZXIiLCAicnVuIiwgIi0tcm0iLCAiLXYiLCBmbXQuU3ByaW50ZigiJXM6JXMiLCBwd2QsIHB3ZCksICItdyIsIHB3ZCwKCQkJIm5pc3Qtc3A4MDAtOTBiIiwgImVhX3Jlc3RhcnQiLCByZXN0YXJ0U2FtcGxlc05hbWUsICI4IiwgSF9JLAoJCSkuQ29tYmluZWRPdXRwdXQoKQoJCWlmIGVyciAhPSBuaWwgewoJCQl0LkZhdGFsZigiZWFfcmVzdGFydCBmYWlsZWQ6ICV2XG4lcyIsIGVyciwgb3V0KQoJCX0KCQl0LkxvZ2YoIlxuJXMiLCBvdXQpCgl9Cn0KCnZhciBOSVNUU1A4MDA5MEJEb2NrZXJmaWxlID0gYApGUk9NIHVidW50dToyNC4wNApSVU4gYXB0LWdldCB1cGRhdGUgJiYgYXB0LWdldCBpbnN0YWxsIC15IGJ1aWxkLWVzc2VudGlhbCBnaXQgXAogICAgbGliYnoyLWRldiBsaWJkaXZzdWZzb3J0LWRldiBsaWJqc29uY3BwLWRldiBsaWJnbXAtZGV2IGxpYm1wZnItZGV2IGxpYnNzbC1kZXYgXAogICAgJiYgcm0gLXJmIC92YXIvbGliL2FwdC9saXN0cy8qClJVTiBnaXQgY2xvbmUgLS1kZXB0aCAxIGh0dHBzOi8vZ2l0aHViLmNvbS91c25pc3Rnb3YvU1A4MDAtOTBCX0VudHJvcHlBc3Nlc3NtZW50LmdpdApSVU4gY2QgU1A4MDAtOTBCX0VudHJvcHlBc3Nlc3NtZW50ICYmIGdpdCBjaGVja291dCA4OTI0ZjE1OGM5N2U3YjgwNWUwZjk1MjQ3NDAzYWQ0YzQ0YjljZDZmCldPUktESVIgLi9TUDgwMC05MEJfRW50cm9weUFzc2Vzc21lbnQvY3BwLwpSVU4gbWFrZSBhbGwKUlVOIGNkIHNlbGZ0ZXN0ICYmIC4vc2VsZnRlc3QKUlVOIGNwIGVhX25vbl9paWQgZWFfcmVzdGFydCAvdXNyL2xvY2FsL2Jpbi8KYAoKdmFyIG1lbW9yeSBlbnRyb3B5LlNjcmF0Y2hCdWZmZXIKCi8vIHNhbXBsZXNPclRyeUFnYWluIGNhbGxzIGVudHJvcHkuU2FtcGxlcyB1cCB0byAxMCB0aW1lcyB1bnRpbCBpdCBzdWNjZWVkcy4KLy8gU2FtcGxlcyBoYXMgYSBub24tbmVnbGlnaWJsZSBjaGFuY2Ugb2YgZmFpbGluZyB0aGUgaGVhbHRoIHRlc3RzLCBhcyByZXF1aXJlZAovLyBieSBTUCA4MDAtOTBCLgpmdW5jIHNhbXBsZXNPclRyeUFnYWluKHQgKnRlc3RpbmcuVCwgc2FtcGxlcyBbXXVpbnQ4KSB7Cgl0LkhlbHBlcigpCglmb3IgcmFuZ2UgMTAgewoJCWlmIGVyciA6PSBlbnRyb3B5LlNhbXBsZXMoc2FtcGxlcywgJm1lbW9yeSk7IGVyciAhPSBuaWwgewoJCQl0LkxvZ2YoImVudHJvcHkuU2FtcGxlcygpIGZhaWxlZDogJXYiLCBlcnIpCgkJCWNvbnRpbnVlCgkJfQoJCXJldHVybgoJfQoJdC5GYXRhbCgiZW50cm9weS5TYW1wbGVzKCkgZmFpbGVkIDEwIHRpbWVzIGluIGEgcm93IikKfQoKZnVuYyBUZXN0RW50cm9weVNIQTM4NCh0ICp0ZXN0aW5nLlQpIHsKCXZhciBpbnB1dCBbMTAyNF11aW50OAoJZm9yIGkgOj0gcmFuZ2UgaW5wdXQgewoJCWlucHV0W2ldID0gdWludDgoaSkKCX0KCXdhbnQgOj0gc2hhNTEyLlN1bTM4NChpbnB1dFs6XSkKCWdvdCA6PSBlbnRyb3B5LlNIQTM4NCgmaW5wdXQpCglpZiBnb3QgIT0gd2FudCB7CgkJdC5FcnJvcmYoIlNIQTM4NCgpID0gJXgsIHdhbnQgJXgiLCBnb3QsIHdhbnQpCgl9CgoJZm9yIGwgOj0gcmFuZ2UgMTAyNCozICsgMSB7CgkJaW5wdXQgOj0gbWFrZShbXWJ5dGUsIGwpCgkJcmFuZC5SZWFkKGlucHV0KQoJCXdhbnQgOj0gc2hhNTEyLlN1bTM4NChpbnB1dCkKCQlnb3QgOj0gZW50cm9weS5UZXN0aW5nT25seVNIQTM4NChpbnB1dCkKCQlpZiBnb3QgIT0gd2FudCB7CgkJCXQuRXJyb3JmKCJUZXN0aW5nT25seVNIQTM4NCglZCBieXRlcykgPSAleCwgd2FudCAleCIsIGwsIGdvdCwgd2FudCkKCQl9Cgl9Cn0KCmZ1bmMgVGVzdEVudHJvcHlSZXBldGl0aW9uQ291bnRUZXN0KHQgKnRlc3RpbmcuVCkgewoJZ29vZCA6PSBieXRlcy5SZXBlYXQoYXBwZW5kKGJ5dGVzLlJlcGVhdChbXXVpbnQ4ezQyfSwgNDApLCAxKSwgMTAwQ05UX09WRVJMT0FEX0ZMVVNIICAgICAgICAgICAgICAgPSAweDYKCUxPQ0tfRVggICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJTE9DS19OQiAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglMT0NLX1NIICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUxPQ0tfVU4gICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4OAoJTUFEVl9ET05UTkVFRCAgICAgICAgICAgICAgICAgICAgID0gMHg0CglNQURWX0ZSRUUgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDYKCU1BRFZfTk9STUFMICAgICAgICAgICAgICAgICAgICAgICA9IDB4MAoJTUFEVl9SQU5ET00gICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglNQURWX1NFUVVFTlRJQUwgICAgICAgICAgICAgICAgICAgPSAweDIKCU1BRFZfU1BBQ0VBVkFJTCAgICAgICAgICAgICAgICAgICA9IDB4NQoJTUFEVl9XSUxMTkVFRCAgICAgICAgICAgICAgICAgICAgID0gMHgzCglNQVBfQU5PTiAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMDAKCU1BUF9DT1BZICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NAoJTUFQX0ZJTEUgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgwCglNQVBfRklYRUQgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglNQVBfRkxBR01BU0sgICAgICAgICAgICAgICAgICAgICAgPSAweDFmZjcKCU1BUF9IQVNTRU1BUEhPUkUgICAgICAgICAgICAgICAgICA9IDB4MjAwCglNQVBfSU5IRVJJVCAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglNQVBfSU5IRVJJVF9DT1BZICAgICAgICAgICAgICAgICAgPSAweDEKCU1BUF9JTkhFUklUX0RPTkFURV9DT1BZICAgICAgICAgICA9IDB4MwoJTUFQX0lOSEVSSVRfTk9ORSAgICAgICAgICAgICAgICAgID0gMHgyCglNQVBfSU5IRVJJVF9TSEFSRSAgICAgICAgICAgICAgICAgPSAweDAKCU1BUF9OT0VYVEVORCAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAwCglNQVBfTk9SRVNFUlZFICAgICAgICAgICAgICAgICAgICAgPSAweDQwCglNQVBfUFJJVkFURSAgICAgICAgICAgICAgICAgICAgICAgPSAweDIKCU1BUF9SRU5BTUUgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAKCU1BUF9TSEFSRUQgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJTUFQX1RSWUZJWEVEICAgICAgICAgICAgICAgICAgICAgID0gMHg0MDAKCU1DTF9DVVJSRU5UICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJTUNMX0ZVVFVSRSAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglNU0dfQkNBU1QgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMAoJTVNHX0NNU0dfQ0xPRVhFQyAgICAgICAgICAgICAgICAgID0gMHg4MDAKCU1TR19DVFJVTkMgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAKCU1TR19ET05UUk9VVEUgICAgICAgICAgICAgICAgICAgICA9IDB4NAoJTVNHX0RPTlRXQUlUICAgICAgICAgICAgICAgICAgICAgID0gMHg4MAoJTVNHX0VPUiAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4CglNU0dfTUNBU1QgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMAoJTVNHX05PU0lHTkFMICAgICAgICAgICAgICAgICAgICAgID0gMHg0MDAKCU1TR19PT0IgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJTVNHX1BFRUsgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglNU0dfVFJVTkMgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglNU0dfV0FJVEFMTCAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwCglNU19BU1lOQyAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCU1TX0lOVkFMSURBVEUgICAgICAgICAgICAgICAgICAgICA9IDB4NAoJTVNfU1lOQyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglOQU1FX01BWCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGZmCglORVRfUlRfRFVNUCAgIHRhbCgicGFyc2UgZXJyb3I6IiwgZXJyKQoJfQoJdmFyIGIgYnl0ZXMuQnVmZmVyCgllcnIgPSB0bXBsLkV4ZWN1dGUoJmIsIDUpIC8vIDUgaXMgb3V0IG9mIHJhbmdlIGluZGV4aW5nICJoaSIKCWlmIGVyciA9PSBuaWwgewoJCXQuRmF0YWwoImV4cGVjdGVkIGVycm9yIikKCX0KCWNvbnN0IHdhbnQgPSBgdGVtcGxhdGU6IHRvcDo3OjIwOiBleGVjdXRpbmcgInRocmVlIiBhdCA8aW5kZXggImhpIiAkPjogZXJyb3IgY2FsbGluZyBpbmRleDogaW5kZXggb3V0IG9mIHJhbmdlOiA1YAoJZ290IDo9IGVyci5FcnJvcigpCglpZiBnb3QgIT0gd2FudCB7CgkJdC5FcnJvcmYoImV4cGVjdGVkXG4lcVxuZ290XG4lcSIsIHdhbnQsIGdvdCkKCX0KfQoKdHlwZSBDdXN0b21FcnJvciBzdHJ1Y3R7fQoKZnVuYyAoKkN1c3RvbUVycm9yKSBFcnJvcigpIHN0cmluZyB7IHJldHVybiAiaGV5byAhIiB9CgovLyBDaGVjayB0aGF0IGEgY3VzdG9tIGVycm9yIGNhbiBiZSByZXR1cm5lZC4KZnVuYyBUZXN0RXhlY0Vycm9yX0N1c3RvbUVycm9yKHQgKnRlc3RpbmcuVCkgewoJZmFpbGluZ0Z1bmMgOj0gZnVuYygpIChzdHJpbmcsIGVycm9yKSB7CgkJcmV0dXJuICIiLCAmQ3VzdG9tRXJyb3J7fQoJfQoJdG1wbCA6PSBNdXN0KE5ldygidG9wIikuRnVuY3MoRnVuY01hcHsKCQkiZXJyIjogZmFpbGluZ0Z1bmMsCgl9KS5QYXJzZSgie3sgZXJyIH19IikpCgoJdmFyIGIgYnl0ZXMuQnVmZmVyCgllcnIgOj0gdG1wbC5FeGVjdXRlKCZiLCBuaWwpCgoJaWYgXywgb2sgOj0gZXJyb3JzLkFzVHlwZVsqQ3VzdG9tRXJyb3JdKGVycik7ICFvayB7CgkJdC5GYXRhbGYoImV4cGVjdGVkIGN1c3RvbSBlcnJvcjsgZ290ICVzIiwgZXJyKQoJfQp9CgpmdW5jIFRlc3RKU0VzY2FwaW5nKHQgKnRlc3RpbmcuVCkgewoJdGVzdENhc2VzIDo9IFtdc3RydWN0IHsKCQlpbiwgZXhwIHN0cmluZwoJfXsKCQl7YGFgLCBgYWB9LAoJCXtgJ2Zvb2AsIGBcJ2Zvb2B9LAoJCXtgR28gImp1bXAiIFxgLCBgR28gXCJqdW1wXCIgXFxgfSwKCQl7YFl1a2loaXJvIHNheXMgIuS7iuaXpeOBr+S4lueVjCJgLCBgWXVraWhpcm8gc2F5cyBcIuS7iuaXpeOBr+S4lueVjFwiYH0sCgkJeyJ1bnByaW50YWJsZSBcdUZGRkUiLCBgdW5wcmludGFibGUgXHVGRkZFYH0sCgkJe2A8aHRtbD5gLCBgXHUwMDNDaHRtbFx1MDAzRWB9LAoJCXtgbm8gPSBpbiBhdHRyaWJ1dGVzYCwgYG5vIFx1MDAzRCBpbiBhdHRyaWJ1dGVzYH0sCgkJe2AmI3gyNzsgZG9lcyBub3QgYmVjb21lIEhUTUwgZW50aXR5YCwgYFx1MDAyNiN4Mjc7IGRvZXMgbm90IGJlY29tZSBIVE1MIGVudGl0eWB9LAoJfQoJZm9yIF8sIHRjIDo9IHJhbmdlIHRlc3RDYXNlcyB7CgkJcyA6PSBKU0VzY2FwZVN0cmluZyh0Yy5pbikKCQlpZiBzICE9IHRjLmV4cCB7CgkJCXQuRXJyb3JmKCJKUyBlc2NhcGluZyBbJXNdIGdvdCBbJXNdIHdhbnQgWyVzXSIsIHRjLmluLCBzLCB0Yy5leHApCgkJfQoJfQp9CgovLyBBIG5pY2UgZXhhbXBsZTogd2FsayBhIGJpbmFyeSB0cmVlLgoKdHlwZSBUcmVlIHN0cnVjdCB7CglWYWwgICAgICAgICBpbnQKCUxlZnQsIFJpZ2h0ICpUcmVlCn0KCi8vIFVzZSBkaWZmZXJlbnQgZGVsaW1pdGVycyB0byB0ZXN0IFNldC5EZWxpbXMuCi8vIEFsc28gdGVzdCB0aGUgdHJpbW1pbmcgb2YgbGVhZGluZyBhbmQgdHJhaWxpbmcgc3BhY2VzLgpjb25zdCB0cmVlVGVtcGxhdGUgPSBgCgkoLSBkZWZpbmUgInRyZWUiIC0pCglbCgkJKC0gLlZhbCAtKQoJCSgtIHdpdGggLkxlZnQgLSkKCQkJKHRlbXBsYXRlICJ0cmVlIiAuIC0pCgkJKC0gZW5kIC0pCgkJKC0gd2l0aCAuUmlnaHQgLSkKCQkJKC0gdGVtcGxhdGUgInRyZWUiIC4gLSkKCQkoLSBlbmQgLSkKCV0KCSgtIGVuZCAtKQpgCgpmdW5jIFRlc3RUcmVlKHQgKnRlc3RpbmcuVCkgewoJdmFyIHRyZWUgPSAmVHJlZXsKCQkxLAoJCSZUcmVlewoJCQkyLCAmVHJlZXsKCQkJCTMsCgkJCQkmVHJlZXsKCQkJCQk0LCBlZyA9IG91dAoJCS8vIExXU1lOQyAtIEFzc3VtaW5nIHNoYXJlZCBkYXRhIG5vdCB3cml0ZS10aHJvdWdoLXJlcXVpcmVkIG5vcgoJCS8vIGNhY2hpbmctaW5oaWJpdGVkLiBTZWUgQXBwZW5kaXggQi4yLjEuMSBpbiB0aGUgSVNBIDIuMDdiLgoJCS8vIElmIHRoZSBvcGVyYXRpb24gaXMgYSBDQVMtUmVsZWFzZSwgdGhlbiBzeW5jaHJvbml6YXRpb24gaXMgbm90IG5lY2Vzc2FyeS4KCQlpZiB2LkF1eEludCAhPSAwIHsKCQkJcGx3c3luYzIgOj0gcy5Qcm9nKHBwYzY0LkFMV1NZTkMpCgkJCXBsd3N5bmMyLlRvLlR5cGUgPSBvYmouVFlQRV9OT05FCgkJCXAyLlRvLlNldFRhcmdldChwbHdzeW5jMikKCQl9IGVsc2UgewoJCQkvLyBkb25lIChsYWJlbCkKCQkJcDYgOj0gcy5Qcm9nKG9iai5BTk9QKQoJCQlwMi5Uby5TZXRUYXJnZXQocDYpCgkJfQoKCWNhc2Ugc3NhLk9wUFBDNjRMb3dlcmVkUHViQmFycmllcjoKCQkvLyBMV1NZTkMKCQlzLlByb2codi5PcC5Bc20oKSkKCgljYXNlIHNzYS5PcFBQQzY0TG93ZXJlZEdldENsb3N1cmVQdHI6CgkJLy8gQ2xvc3VyZSBwb2ludGVyIGlzIFIxMSAoYWxyZWFkeSkKCQlzc2FnZW4uQ2hlY2tMb3dlcmVkR2V0Q2xvc3VyZVB0cih2KQoKCWNhc2Ugc3NhLk9wUFBDNjRMb3dlcmVkR2V0Q2FsbGVyU1A6CgkJLy8gY2FsbGVyJ3MgU1AgaXMgRml4ZWRGcmFtZVNpemUgYmVsb3cgdGhlIGFkZHJlc3Mgb2YgdGhlIGZpcnN0IGFyZwoJCXAgOj0gcy5Qcm9nKHBwYzY0LkFNT1ZEKQoJCXAuRnJvbS5UeXBlID0gb2JqLlRZUEVfQUREUgoJCXAuRnJvbS5PZmZzZXQgPSAtYmFzZS5DdHh0LkFyY2guRml4ZWRGcmFtZVNpemUKCQlwLkZyb20uTmFtZSA9IG9iai5OQU1FX1BBUkFNCgkJcC5Uby5UeXBlID0gb2JqLlRZUEVfUkVHCgkJcC5Uby5SZWcgPSB2LlJlZygpCgoJY2FzZSBzc2EuT3BQUEM2NExvd2VyZWRHZXRDYWxsZXJQQzoKCQlwIDo9IHMuUHJvZyhvYmouQUdFVENBTExFUlBDKQoJCXAuVG8uVHlwZSA9IG9iai5UWVBFX1JFRwoJCXAuVG8uUmVnID0gdi5SZWcoKQoKCWNhc2Ugc3NhLk9wUFBDNjRMb3dlcmVkUm91bmQzMkYsIHNzYS5PcFBQQzY0TG93ZXJlZFJvdW5kNjRGOgoJCS8vIGlucHV0IGlzIGFscmVhZHkgcm91bmRlZAoKCWNhc2Ugc3NhLk9wTG9hZFJlZzoKCQlsb2FkT3AgOj0gbG9hZEJ5VHlwZSh2LlR5cGUpCgkJcCA6PSBzLlByb2cobG9hZE9wKQoJCXNzYWdlbi5BZGRyQXV0bygmcC5Gcm9tLCB2LkFyZ3NbMF0pCgkJcC5Uby5UeXBlID0gb2JqLlRZUEVfUkVHCgkJcC5Uby5SZWcgPSB2LlJlZygpCgoJY2FzZSBzc2EuT3BTdG9yZVJlZzoKCQlzdG9yZU9wIDo9IHN0b3JlQnlUeXBlKHYuVHlwZSkKCQlwIDo9IHMuUHJvZyhzdG9yZU9wKQoJCXAuRnJvbS5UeXBlID0gb2JqLlRZUEVfUkVHCgkJcC5Gcm9tLlJlZyA9IHYuQXJnc1swXS5SZWcoKQoJCXNzYWdlbi5BZGRyQXV0bygmcC5UbywgdikKCgljYXNlIHNzYS5PcEFyZ0ludFJlZywgc3NhLk9wQXJnRmxvYXRSZWc6CgkJLy8gVGhlIGFzc2VtYmxlciBuZWVkcyB0byB3cmFwIHRoZSBlbnRyeSBzYWZlcG9pbnQvc3RhY2sgZ3Jvd3RoIGNvZGUgd2l0aCBzcGlsbC91bnNwaWxsCgkJLy8gVGhlIGxvb3Agb25seSBydW5zIG9uY2UuCgkJZm9yIF8sIGEgOj0gcmFuZ2Ugdi5CbG9jay5GdW5jLlJlZ0FyZ3MgewoJCQkvLyBQYXNzIHRoZSBzcGlsbC91bnNwaWxsIGluZm9ybWF0aW9uIGFsb25nIHRvIHRoZSBhc3NlbWJsZXIsIG9mZnNldCBieSBzaXplIG9mCgkJCS8vIHRoZSBzYXZlZCBMUiBzbG90LgoJCQlhZGRyIDo9IHNzYWdlbi5TcGlsbFNsb3RBZGRyKGEsIHBwYzY0LlJFR1NQLCBiYXNlLkN0eHQuQXJjaC5GaXhlZEZyYW1lU2l6ZSkKCQkJcy5GdW5jSW5mbygpLkFkZFNwaWxsKAoJCQkJb2JqLlJlZ1NwaWxse1JlZzogYS5SZWcsIEFkZHI6IGFkZHIsIFVuc3BpbGw6IGxvYWRCeVR5cGUoYS5UeXBlKSwgU3BpbGw6IHN0b3JlQnlUeXBlKGEuVHlwZSl9KQoJCX0KCQl2LkJsIG1hdGgKCi8vIE1hdGhlbWF0aWNhbCBjb25zdGFudHMuCmNvbnN0ICgKCUUgICA9IDIuNzE4MjgxODI4NDU5MDQ1MjM1MzYwMjg3NDcxMzUyNjYyNDk3NzU3MjQ3MDkzNjk5OTU5NTc0OTY2OTY3NjMgLy8gaHR0cHM6Ly9vZWlzLm9yZy9BMDAxMTEzCglQaSAgPSAzLjE0MTU5MjY1MzU4OTc5MzIzODQ2MjY0MzM4MzI3OTUwMjg4NDE5NzE2OTM5OTM3NTEwNTgyMDk3NDk0NDU5IC8vIGh0dHBzOi8vb2Vpcy5vcmcvQTAwMDc5NgoJUGhpID0gMS42MTgwMzM5ODg3NDk4OTQ4NDgyMDQ1ODY4MzQzNjU2MzgxMTc3MjAzMDkxNzk4MDU3NjI4NjIxMzU0NDg2MiAvLyBodHRwczovL29laXMub3JnL0EwMDE2MjIKCglTcXJ0MiAgID0gMS40MTQyMTM1NjIzNzMwOTUwNDg4MDE2ODg3MjQyMDk2OTgwNzg1Njk2NzE4NzUzNzY5NDgwNzMxNzY2Nzk3NCAvLyBodHRwczovL29laXMub3JnL0EwMDIxOTMKCVNxcnRFICAgPSAxLjY0ODcyMTI3MDcwMDEyODE0Njg0ODY1MDc4NzgxNDE2MzU3MTY1Mzc3NjEwMDcxMDE0ODAxMTU3NTA3OTMxIC8vIGh0dHBzOi8vb2Vpcy5vcmcvQTAxOTc3NAoJU3FydFBpICA9IDEuNzcyNDUzODUwOTA1NTE2MDI3Mjk4MTY3NDgzMzQxMTQ1MTgyNzk3NTQ5NDU2MTIyMzg3MTI4MjEzODA3NzkgLy8gaHR0cHM6Ly9vZWlzLm9yZy9BMDAyMTYxCglTcXJ0UGhpID0gMS4yNzIwMTk2NDk1MTQwNjg5NjQyNTI0MjI0NjE3Mzc0OTE0OTE3MTU2MDgwNDE4NDAwOTYyNDg2MTY2NDAzOCAvLyBodHRwczovL29laXMub3JnL0ExMzkzMzkKCglMbjIgICAgPSAwLjY5MzE0NzE4MDU1OTk0NTMwOTQxNzIzMjEyMTQ1ODE3NjU2ODA3NTUwMDEzNDM2MDI1NTI1NDEyMDY4MDAwOSAvLyBodHRwczovL29laXMub3JnL0EwMDIxNjIKCUxvZzJFICA9IDEgLyBMbjIKCUxuMTAgICA9IDIuMzAyNTg1MDkyOTk0MDQ1Njg0MDE3OTkxNDU0Njg0MzY0MjA3NjAxMTAxNDg4NjI4NzcyOTc2MDMzMzI3OTAgLy8gaHR0cHM6Ly9vZWlzLm9yZy9BMDAyMzkyCglMb2cxMEUgPSAxIC8gTG4xMAopCgovLyBGbG9hdGluZy1wb2ludCBsaW1pdCB2YWx1ZXMuCi8vIE1heCBpcyB0aGUgbGFyZ2VzdCBmaW5pdGUgdmFsdWUgcmVwcmVzZW50YWJsZSBieSB0aGUgdHlwZS4KLy8gU21hbGxlc3ROb256ZXJvIGlzIHRoZSBzbWFsbGVzdCBwb3NpdGl2ZSwgbm9uLXplcm8gdmFsdWUgcmVwcmVzZW50YWJsZSBieSB0aGUgdHlwZS4KY29uc3QgKAoJTWF4RmxvYXQzMiAgICAgICAgICAgICA9IDB4MXAxMjcgKiAoMSArICgxIC0gMHgxcC0yMykpIC8vIDMuNDAyODIzNDY2Mzg1Mjg4NTk4MTE3MDQxODM0ODQ1MTY5MjU0NDBlKzM4CglTbWFsbGVzdE5vbnplcm9GbG9hdDMyID0gMHgxcC0xMjYgKiAweDFwLTIzICAgICAgICAgICAgLy8gMS40MDEyOTg0NjQzMjQ4MTcwNzA5MjM3Mjk1ODMyODk5MTYxMzEyODBlLTQ1CgoJTWF4RmxvYXQ2NCAgICAgICAgICAgICA9IDB4MXAxMDIzICogKDEgKyAoMSAtIDB4MXAtNTIpKSAvLyAxLjc5NzY5MzEzNDg2MjMxNTcwODE0NTI3NDIzNzMxNzA0MzU2Nzk4MDcwZSszMDgKCVNtYWxsZXN0Tm9uemVyb0Zsb2F0NjQgPSAweDFwLTEwMjIgKiAweDFwLTUyICAgICAgICAgICAgLy8gNC45NDA2NTY0NTg0MTI0NjU0NDE3NjU2ODc5Mjg2ODIyMTM3MjM2NTA1OTgwZS0zMjQKKQoKLy8gSW50ZWdlciBsaW1pdCB2YWx1ZXMuCmNvbnN0ICgKCWludFNpemUgPSAzMiA8PCAoXnVpbnQoMCkgPj4gNjMpIC8vIDMyIG9yIDY0CgoJTWF4SW50ICAgID0gMTw8KGludFNpemUtMSkgLSAxICAvLyBNYXhJbnQzMiBvciBNYXhJbnQ2NCBkZXBlbmRpbmcgb24gaW50U2l6ZS4KCU1pbkludCAgICA9IC0xIDw8IChpbnRTaXplIC0gMSkgLy8gTWluSW50MzIgb3IgTWluSW50NjQgZGVwZW5kaW5nIG9uIGludFNpemUuCglNYXhJbnQ4ICAgPSAxPDw3IC0gMSAgICAgICAgICAgIC8vIDEyNwoJTWluSW50OCAgID0gLTEgPDwgNyAgICAgICAgICAgICAvLyAtMTI4CglNYXhJbnQxNiAgPSAxPDwxNSAtIHgyMDAwMAoJUlRGX0NMT05FRCAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDAwMAoJUlRGX0NMT05JTkcgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDAKCVJURl9DT05ORUNURUQgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwMDAwCglSVEZfRE9ORSAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwCglSVEZfRFlOQU1JQyAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglSVEZfRk1BU0sgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDExMGZjMDgKCVJURl9HQVRFV0FZICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJUlRGX0hPU1QgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglSVEZfTExJTkZPICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMAoJUlRGX0xPQ0FMICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwMDAKCVJURl9NT0RJRklFRCAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAKCVJURl9NUEFUSCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAwMDAKCVJURl9NUExTICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAwMDAwCglSVEZfTVVMVElDQVNUICAgICAgICAgICAgICAgICAgICAgPSAweDIwMAoJUlRGX1BFUk1BTkVOVF9BUlAgICAgICAgICAgICAgICAgID0gMHgyMDAwCglSVEZfUFJPVE8xICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDAKCVJURl9QUk9UTzIgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAwMAoJUlRGX1BST1RPMyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwCglSVEZfUkVKRUNUICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgKCVJURl9TVEFUSUMgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwCglSVEZfVVAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCVJURl9VU0VUUkFJTEVSUyAgICAgICAgICAgICAgICAgICA9IDB4ODAwMAoJUlRNXzgwMjExSU5GTyAgICAgICAgICAgICAgICAgICAgID0gMHgxNQoJUlRNX0FERCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglSVE1fQkZEICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEyCglSVE1fQ0hBTkdFICAgICAgICAgICAgICAgICAgICAgICAgPSAweDMKCVJUTV9DSEdBRERSQVRUUiAgICAgICAgICAgICAgICAgICA9IDB4MTQKCVJUTV9ERUxBRERSICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZAoJUlRNX0RFTEVURSAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglSVE1fREVTWU5DICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglSVE1fR0VUICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCVJUTV9JRkFOTk9VTkNFICAgICAgICAgICAgICAgICAgICA9IDB4ZgoJUlRNX0lGSU5GTyAgICAgICAgICAgICAgICAgICAgICAgID0gMHhlCglSVE1fSU5WQUxJREFURSAgICAgICAgICAgICAgICAgICAgPSAweDExCglSVE1fTE9TSU5HICAgICAgICAgICAgICAgICAgICAgICAgPSAweDUKCVJUTV9NQVhTSVpFICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwCglSVE1fTUlTUyAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDcKCVJUTV9ORVdBRERSICAgICAgICAgICAgICAgICAgICAgICA9IDB4YwoJUlRNX1BST1BPU0FMICAgICAgICAgICAgICAgICAgICAgID0gMHgxMwoJUlRNX1JFRElSRUNUICAgICAgICAgICAgICAgICAgICAgID0gMHg2CglSVE1fUkVTT0xWRSAgICAgICAgICAgICAgICAgICAgICAgPSAweGIKCVJUTV9TT1VSQ0UgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTYKCVJUTV9WRVJTSU9OICAgICAgICAgICAgICAgICAgICAgICA9IDB4NQoJUlRWX0VYUElSRSAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglSVFZfSE9QQ09VTlQgICAgICAgICAgICAgICAgICAgICAgPSAweDIKCVJUVl9NVFUgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJUlRWX1JQSVBFIE9ubHkgd29ya3Mgb24gc3lzdGVtcyB3aXRoIHN5c2NhbGwuQ2xvc2UuCi8vIFdlIG5lZWQgYSBmYXN0IHN5c3RlbSBjYWxsIHRvIHByb3Zva2UgdGhlIHJhY2UsCi8vIGFuZCBDbG9zZSgtMSkgaXMgbmVhcmx5IHVuaXZlcnNhbGx5IGZhc3QuCgovL2dvOmJ1aWxkIGFpeCB8fCBkYXJ3aW4gfHwgZHJhZ29uZmx5IHx8IGZyZWVic2QgfHwgbGludXggfHwgbmV0YnNkIHx8IG9wZW5ic2QgfHwgcGxhbjkKCnBhY2thZ2UgcnVudGltZV90ZXN0CgppbXBvcnQgKAoJInJ1bnRpbWUiCgkic3luYyIKCSJzeW5jL2F0b21pYyIKCSJzeXNjYWxsIgoJInRlc3RpbmciCikKCmZ1bmMgVGVzdEdvcm91dGluZVByb2ZpbGUodCAqdGVzdGluZy5UKSB7CgkvLyBHb3JvdXRpbmVQcm9maWxlIHVzZWQgdG8gdXNlIHRoZSB3cm9uZyBzdGFydGluZyBzcCBmb3IKCS8vIGdvcm91dGluZXMgY29taW5nIG91dCBvZiBzeXN0ZW0gY2FsbHMsIGNhdXNpbmcgcG9zc2libGUKCS8vIGNyYXNoZXMuCglkZWZlciBydW50aW1lLkdPTUFYUFJPQ1MocnVudGltZS5HT01BWFBST0NTKDEwMCkpCgoJdmFyIHN0b3AgdWludDMyCglkZWZlciBhdG9taWMuU3RvcmVVaW50MzIoJnN0b3AsIDEpIC8vIGluIGNhc2Ugb2YgcGFuaWMKCgl2YXIgd2cgc3luYy5XYWl0R3JvdXAKCWZvciBpIDo9IDA7IGkgPCA0OyBpKysgewoJCXdnLkFkZCgxKQoJCWdvIGZ1bmMoKSB7CgkJCWZvciBhdG9taWMuTG9hZFVpbnQzMigmc3RvcCkgPT0gMCB7CgkJCQlzeXNjYWxsLkNsb3NlKC0xKQoJCQl9CgkJCXdnLkRvbmUoKQoJCX0oKQoJfQoKCW1heCA6PSAxMDAwMAoJaWYgdGVzdGluZy5TaG9ydCgpIHsKCQltYXggPSAxMDAKCX0KCXN0ayA6PSBtYWtlKFtdcnVudGltZS5TdGFja1JlY29yZCwgMTI4KQoJZm9yIG4gOj0gMDsgbiA8IG1heDsgbisrIHsKCQlfLCBvayA6PSBydW50aW1lLkdvcm91dGluZVByb2ZpbGUoc3RrKQoJCWlmICFvayB7CgkJCXQuRmF0YWxmKCJHb3JvdXRpbmVQcm9maWxlIGZhaWxlZCIpCgkJfQoJfQoKCS8vIElmIHRoZSBwcm9ncmFtIGRpZG4ndCBjcmFzaCwgd2UgcGFzc2VkLgoJYXRvbWljLlN0b3JlVWludDMyKCZzdG9wLCAxKQoJd2cuV2FpdCgpCn0KLy8gQ29weXJpZ2h0IDIwMjMgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCi8vZ286YnVpbGQgIXB1cmVnbwoKcGFja2FnZSBtYXBoYXNoCgppbXBvcnQgKAoJImludGVybmFsL2FiaSIKCSJpbnRlcm5hbC9ydW50aW1lL21hcHMiCgkidW5zYWZlIgopCgpjb25zdCBwdXJlZ28gPSBmYWxzZQoKLy9nbzpsaW5rbmFtZSBydW50aW1lX3JhbmQgcnVudGltZS5yYW5kCmZ1bmMgcnVudGltZV9yYW5kKCkgdWludDY0CgovL2dvOmxpbmtuYW1lIHJ1bnRpbWVfbWVtaGFzaCBydW50aW1lLm1lbWhhc2gKLy9nbzpub2VzY2FwZQpmdW5jIHJ1bnRpbWVfbWVtaGFzaChwIHVuc2FmZS5Qb2ludGVyLCBzZWVkLCBzIHVpbnRwdHIpIHVpbnRwdHIKCmZ1bmMgcnRoYXNoKGJ1ZiBbXWJ5dGUsIHNlZWQgdWludDY0KSB1aW50NjQgewoJaWYgbGVuKGJ1ZikgPT0gMCB7CgkJcmV0dXJuIHNlZWQKCX0KCWxlbiA6PSBsZW4oYnVmKQoJLy8gVGhlIHJ1bnRpbWUgaGFzaGVyIG9ubHkgd29ya3Mgb24gdWludHB0ci4gRm9yIDY0LWJpdAoJLy8gYXJjaGl0ZWN0dXJlcywgd2UgdXNlIHRoZSBoYXNoZXIgZGlyZWN0bHkuIE90aGVyd2lzZSwKCS8vIHdlIHVzZSB0d28gcGFyYWxsZWwgaGFzaGVycyBvbiB0aGUgbG93ZXIgYW5kIHVwcGVyIDMyIGJpdHMuCglpZiBtYXBzLlVzZTY0Qml0SGFzaCB7CgkJcmV0dXJuIHVpbnQ2NChydW50aW1lX21lbWhhc2godW5zYWZlLlBvaW50ZXIoJmJ1ZlswXSksIHVpbnRwdHIoc2VlZCksIHVpbnRwdHIobGVuKSkpCgl9CglsbyBGT1JNX3JlZl9hZGRyLCBEV19DTFNfUkVGRVJFTkNFLCAwLCB2LlR5cGUpIC8vIERXX0FUX3R5cGUKCQl9CgoJCWlmIHYuQ2xvc3VyZU9mZnNldCA+IDAgewoJCQlwdXRhdHRyKGN0eHQsIHMuSW5mbywgYWJicmV2LCBEV19GT1JNX3VkYXRhLCBEV19DTFNfQ09OU1RBTlQsIHYuQ2xvc3VyZU9mZnNldCwgbmlsKSAvLyBEV19BVF9nb19jbG9zdXJlX29mZnNldAoJCX0KCX0KCglpZiB3aXRoTG9jbGlzdCB7CgkJcHV0YXR0cihjdHh0LCBzLkluZm8sIGFiYnJldiwgRFdfRk9STV9zZWNfb2Zmc2V0LCBEV19DTFNfUFRSLCBjdHh0LlNpemUocy5Mb2MpLCBzLkxvYykgLy8gRFdfQVRfbG9jYXRpb24KCQl2LlB1dExvY2F0aW9uTGlzdChzLkxvYywgcy5TdGFydFBDKQoJfSBlbHNlIHsKCQlsb2MgOj0gZW5jYnVmWzowXQoJCXN3aXRjaCB7CgkJY2FzZSB2LldpdGhMb2NsaXN0OgoJCQlicmVhayAvLyBubyBsb2NhdGlvbgoJCWNhc2Ugdi5TdGFja09mZnNldCA9PSAwOgoJCQlsb2MgPSBhcHBlbmQobG9jLCBEV19PUF9jYWxsX2ZyYW1lX2NmYSkKCQlkZWZhdWx0OgoJCQlsb2MgPSBhcHBlbmQobG9jLCBEV19PUF9mYnJlZykKCQkJbG9jID0gQXBwZW5kU2xlYjEyOChsb2MsIGludDY0KHYuU3RhY2tPZmZzZXQpKQoJCX0KCQlwdXRhdHRyKGN0eHQsIHMuSW5mbywgYWJicmV2LCBEV19GT1JNX2Jsb2NrMSwgRFdfQ0xTX0JMT0NLLCBpbnQ2NChsZW4obG9jKSksIGxvYykgLy8gRFdfQVRfbG9jYXRpb24KCX0KCgkvLyBWYXIgaGFzIG5vIGNoaWxkcmVuID0+IG5vIHRlcm1pbmF0b3IKfQoKLy8gYnlDaGlsZEluZGV4Q21wIGNvbXBhcmVzIHR3byAqZHdhcmYuVmFyIGJ5IGNoaWxkIGluZGV4LgpmdW5jIGJ5Q2hpbGRJbmRleENtcChhLCBiICpWYXIpIGludCB7IHJldHVybiBjbXAuQ29tcGFyZShhLkNoaWxkSW5kZXgsIGIuQ2hpbGRJbmRleCkgfQoKLy8gSXNEV0FSRkVuYWJsZWRPbkFJWExkIHJldHVybnMgdHJ1ZSBpZiBEV0FSRiBpcyBwb3NzaWJsZSBvbiB0aGUKLy8gY3VycmVudCBleHRsZC4KLy8gQUlYIGxkIGRvZXNuJ3Qgc3VwcG9ydCBEV0FSRiB3aXRoIC1ibm9vYmpyZW9yZGVyIHdpdGggdmVyc2lvbgovLyBwcmlvciB0byA3LjIuMi4KZnVuYyBJc0RXQVJGRW5hYmxlZE9uQUlYTGQoZXh0bGQgW11zdHJpbmcpIChib29sLCBlcnJvcikgewoJbmFtZSwgYXJncyA6PSBleHRsZFswXSwgZXh0bGRbMTpdCglhcmdzID0gYXBwZW5kKGFyZ3MsICItV2wsLVYiKQoJb3V0LCBlcnIgOj0gZXhlYy5Db21tYW5kKG5hbWUsIGFyZ3MuLi4pLkNvbWJpbmVkT3V0cHV0KCkKCWlmIGVyciAhPSBuaWwgewoJCS8vIFRoZSBub3JtYWwgb3V0cHV0IHNob3VsZCBkaXNwbGF5IGxkIHZlcnNpb24gYW5kCgkJLy8gdGhlbiBmYWlscyBiZWNhdXNlICIubWFpbiIgaXMgbm90IGRlZmluZWQ6CgkJLy8gbGQ6IDA3MTEtMzE3IEVSUk9SOiBVbmRlZmluZWQgc3ltYm9sOiAubWFpbgoJCWlmICFieXRlcy5Db250YWlucyhvdXQsIFtdYnl0ZSgiMDcxMS0zMTciKSkgewoJCQlyZXR1cm4gZmFsc2UsIGZtdC5FcnJvcmYoIiVzIC1XbCwtViBmYWlsZWQ6ICV2XG4lcyIsIGV4dGxkLCBlcnIsIG91dCkKCQl9Cgl9CgkvLyBnY2MgLVdsLC1WIG91dHB1dCBzaG91bGQgYmU6CgkvLyAgIC91c3IvYmluL2xkOiBMRCBYLlguWChkYXRlKQoJLy8gICAuLi4KCW91dCA9IGJ5dGVzLlRyaW1QcmVmaXgob3V0LCBbXWJ5dGUoIi91c3IvYmluL2xkOiBMRCAiKSkKCXZlcnMgOj0gc3RyaW5nKGJ5dGVzLlNwbGl0KG91dCwgW11ieXRlKCIoIikpWzBdKQoJc3VidmVycyA6PSBzdHJpbmdzLlNwbGl0KHZlcnMsICIuIikKCWlmIGxlbihzdWJ2ZXJzKSAhPSAzIHsKCQlyZXR1cm4gZmFsc2UsIGZtdC5FcnJvcmYoImNhbm5vdCBwYXJzZSAlcyAtV2wsLVYgKCVzKTogJXZcbiIsIGV4dGxkLCBvdXQsIGVycikKCX0KCWlmIHYsIGVyciA6PSBzdHJjb252LkF0b2koc3VidmVyc1swXSk7IGVyciAhPSBuaWwgfHwgdiA8IDcgewoJb2NhbHMuTikpICAgICAgICAvLyBudW1iZXIgb2YgYml0cyBpbiBlYWNoIGJpdG1hcAoKCWZvciBfLCBsaXZlIDo9IHJhbmdlIGx2LnN0YWNrTWFwcyB7CgkJYXJncy5DbGVhcigpCgkJbG9jYWxzLkNsZWFyKCkKCgkJbHYucG9pbnRlck1hcChsaXZlLCBsdi52YXJzLCBhcmdzLCBsb2NhbHMpCgoJCWFvZmYgPSBvYmp3LkJpdFZlYygmYXJnc1N5bVRtcCwgYW9mZiwgYXJncykKCQlsb2ZmID0gb2Jqdy5CaXRWZWMoJmxpdmVTeW1UbXAsIGxvZmYsIGxvY2FscykKCX0KCgkvLyBUaGVzZSBzeW1ib2xzIHdpbGwgYmUgYWRkZWQgdG8gQ3R4dC5EYXRhIGJ5IGFkZEdDTG9jYWxzCgkvLyBhZnRlciBwYXJhbGxlbCBjb21waWxhdGlvbiBpcyBkb25lLgoJcmV0dXJuIGJhc2UuQ3R4dC5HQ0xvY2Fsc1N5bShhcmdzU3ltVG1wLlApLCBiYXNlLkN0eHQuR0NMb2NhbHNTeW0obGl2ZVN5bVRtcC5QKQp9CgovLyBFbnRyeSBwb2ludGVyIGZvciBDb21wdXRlIGFuYWx5c2lzLiBTb2x2ZXMgZm9yIHRoZSBDb21wdXRlIG9mCi8vIHBvaW50ZXIgdmFyaWFibGVzIGluIHRoZSBmdW5jdGlvbiBhbmQgZW1pdHMgYSBydW50aW1lIGRhdGEKLy8gc3RydWN0dXJlIHJlYWQgYnkgdGhlIGdhcmJhZ2UgY29sbGVjdG9yLgovLyBSZXR1cm5zIGEgbWFwIGZyb20gR0Mgc2FmZSBwb2ludHMgdG8gdGhlaXIgY29ycmVzcG9uZGluZyBzdGFjayBtYXAgaW5kZXgsCi8vIGFuZCBhIG1hcCB0aGF0IGNvbnRhaW5zIGFsbCBpbnB1dCBwYXJhbWV0ZXJzIHRoYXQgbWF5IGJlIHBhcnRpYWxseSBsaXZlLgpmdW5jIENvbXB1dGUoY3VyZm4gKmlyLkZ1bmMsIGYgKnNzYS5GdW5jLCBzdGtwdHJzaXplIGludDY0LCBwcCAqb2Jqdy5Qcm9ncywgcmV0TGl2ZW5lc3MgYm9vbCkgKE1hcCwgbWFwWyppci5OYW1lXWJvb2wsICpMaXZlbmVzcykgewoJLy8gQ29uc3RydWN0IHRoZSBnbG9iYWwgbGl2ZW5lc3Mgc3RhdGUuCgl2YXJzLCBpZHggOj0gZ2V0dmFyaWFibGVzKGN1cmZuKQoJbHYgOj0gbmV3bGl2ZW5lc3MoY3VyZm4sIGYsIHZhcnMsIGlkeCwgc3RrcHRyc2l6ZSkKCgkvLyBSdW4gdGhlIGRhdGFmbG93IGZyYW1ld29yay4KCWx2LnByb2xvZ3VlKCkKCWx2LnNvbHZlKCkKCWx2LmVwaWxvZ3VlKCkKCWlmIGJhc2UuRmxhZy5MaXZlID4gMCB7CgkJbHYuc2hvd2xpdmUobmlsLCBsdi5zdGFja01hcHNbMF0pCgkJZm9yIF8sIGIgOj0gcmFuZ2UgZi5CbG9ja3MgewoJCQlmb3IgXywgdmFsIDo9IHJhbmdlIGIuVmFsdWVzIHsKCQkJCWlmIGlkeCA6PSBsdi5saXZlbmVzc01hcC5HZXQodmFsKTsgaWR4LlN0YWNrTWFwVmFsaWQoKSB7CgkJCQkJbHYuc2hvd2xpdmUodmFsLCBsdi5zdGFja01hcHNbaWR4XSkKCQkJCX0KCQkJfQoJCX0KCX0KCWlmIGJhc2UuRmxhZy5MaXZlID49IDIgewoJCWx2LnByaW50RGVidWcoKQoJfQoKCS8vIFVwZGF0ZSB0aGUgZnVuY3Rpb24gY2FjaGUuCgl7CgkJY2FjaGUgOj0gZi5DYWNoZS5MaXZlbmVzcy4oKmxpdmVuZXNzRnVuY0NhY2hlKQoJCWlmIGNhcChsdi5iZSkgPCAyMDAwIHsgLy8gVGhyZXNob2xkIGZyb20gc3NhLkNhY2hlIHNsaWNlcy4KCQkJY2xlYXIobHYuYmUpCgkJCWNhY2hlLmJlID0gbHYuYmUKCQl9CgkJaWYgbGVuKGx2LmxpdmVuZXNzTWFwLlZhbHMpIDwgMjAwMCB7CgkJCWNhY2hlLmxpdmVuZXNzTWFwID0gbHYubGl2ZW5lc3NNYXAKCQl9Cgl9CgoJLy8gRW1pdCB0aGUgbGl2ZSBwb2ludGVyIG1hcCBkYXRhIHN0cnVjdHVyZXMKCWxzIDo9IGN1cmZuLkxTeW0KCWZuaW5mbyA6PSBscy5GdW5jKCkKCWZuaW5mby5HQ0FyZ3MsIGZuaW5mby5HQ0xvY2FscyA9IGx2LmVtaXQoKQoKCXAgOj0gcHAuUHJvZyhvYmouQUZVTkNEQVRBKQoJcC5Gcm9tLlNldENvbnN0KHJ0YWJpLkZVTkNEQVRBX0FyZ3NQb2ludGVyTWFwcykKCXAuVG8uVHlwZSA9IG9iai5UWVBFX01FTQoJcC5Uby5OYW1lID0gb2JqLk5BTUVfRVhURVJOCglwLlRvLlN5bSA9IGZuaW5mby5HQ0FyZ3MKCglwID0gcHAubG9jayBJRCBpIGlzIGFuIHVuc2FmZS1wb2ludAoJLy8gKHByZWVtcHRpb24gaXMgbm90IGFsbG93ZWQgb24gYW55IGVuZC1vZi1ibG9jawoJLy8gaW5zdHJ1Y3Rpb25zKS4gT25seSB2YWxpZCBpZiAhYWxsVW5zYWZlLgoJdW5zYWZlQmxvY2tzIGJpdHZlYy5CaXRWZWMKCgkvLyBBbiBhcnJheSB3aXRoIGEgYml0IHZlY3RvciBmb3IgZWFjaCBzYWZlIHBvaW50IGluIHRoZQoJLy8gY3VycmVudCBCbG9jayBkdXJpbmcgbGl2ZW5lc3MuZXBpbG9ndWUuIEluZGV4ZWQgaW4gVmFsdWUKCS8vIG9yZGVyIGZvciB0aGF0IGJsb2NrLiBBZGRpdGlvbmFsbHksIGZvciB0aGUgZW50cnkgYmxvY2sKCS8vIGxpdmV2YXJzWzBdIGlzIHRoZSBlbnRyeSBiaXRtYXAuIGxpdmVuZXNzLmNvbXBhY3QgbW92ZXMKCS8vIHRoZXNlIHRvIHN0YWNrTWFwcy4KCWxpdmV2YXJzIFtdYml0dmVjLkJpdFZlYwoKCS8vIGxpdmVuZXNzTWFwIG1hcHMgZnJvbSBzYWZlIHBvaW50cyAoaS5lLiwgQ0FMTHMpIHRvIHRoZWlyCgkvLyBsaXZlbmVzcyBtYXAgaW5kZXhlcy4KCWxpdmVuZXNzTWFwIE1hcAoJc3RhY2tNYXBTZXQgYnZlY1NldAoJc3RhY2tNYXBzICAgW11iaXR2ZWMuQml0VmVjCgoJY2FjaGUgcHJvZ2VmZmVjdHNjYWNoZQoKCS8vIHBhcnRMaXZlQXJncyBpbmNsdWRlcyBpbnB1dCBhcmd1bWVudHMgKFBQQVJBTSkgdGhhdCBtYXkKCS8vIGJlIHBhcnRpYWxseSBsaXZlLiBUaGF0IGlzLCBpdCBpcyBjb25zaWRlcmVkIGxpdmUgYmVjYXVzZQoJLy8gYSBwYXJ0IG9mIGl0IGlzIHVzZWQsIGJ1dCB3ZSBtYXkgbm90IGluaXRpYWxpemUgYWxsIHBhcnRzLgoJcGFydExpdmVBcmdzIG1hcFsqaXIuTmFtZV1ib29sCgoJZG9DbG9iYmVyICAgICBib29sIC8vIFdoZXRoZXIgdG8gY2xvYmJlciBkZWFkIHN0YWNrIHNsb3RzIGluIHRoaXMgZnVuY3Rpb24uCglub0Nsb2JiZXJBcmdzIGJvb2wgLy8gRG8gbm90IGNsb2JiZXIgZnVuY3Rpb24gYXJndW1lbnRzCgoJLy8gdHJlYXQgImRlYWQiIHdyaXRlcyBhcyBlcXVpdmFsZW50IHRvIHJlYWRzIGR1cmluZyB0aGUgYW5hbHlzaXM7CgkvLyB1c2VkIG9ubHkgZHVyaW5nIGxpdmVuZXNzIGFuYWx5c2lzIGZvciBzdGFjayBzbG90IG1lcmdpbmcgKGRvZXNuJ3QKCS8vIG1ha2Ugc2Vuc2UgZm9yIHN0YWNrbWFwIGFuYWx5c2lzKS4KCWNvbnNlcnZhdGl2ZVdyaXRlcyBib29sCn0KCi8vIE1hcCBtYXBzIGZyb20gKnNzYS5WYWx1ZSB0byBTdGFja01hcEluZGV4LgovLyBBbHNvIGtlZXBzIHRyYWNrIG9mIHVuc2FmZSBzc2EuVmFsdWVzIGFuZCBzc2EuQmxvY2tzLgovLyAodW5zYWZlID0gY2FuJ3QgYmUgaW50ZXJydXB0ZWQgZHVyaW5nIEdDLikKdHlwZSBNYXAgc3RydWN0IHsKCVZhbHMgICAgICAgICBtYXBbc3NhLklEXW9iancuU3RhY2tNYXBJbmRleAoJVW5zYWZlVmFscyAgIG1hcFtzc2EuSURdYm9vbAoJVW5zYWZlQmxvY2tzIG1hcFtzc2EuSURdYm9vbAoJLy8gVGhlIHNldCBvZiBsaXZlLCBwb2ludGVyLWNvbnRhaW5pbmcgdmFyaWFibGVzIGF0IHRoZSBEZWZlclJldHVybgoJLy8gY2FsbCAob25seSBzZXQgd2hlbiBvcGVuLWNvZGVkIGRlZmVycyBhcmUgdXNlZCkuCglEZWZlclJldHVybiBvYmp3LlN0YWNrTWFwSW5kZXgKfQoKZnVuYyAobSAqTWFwKSByZXNldCgpIHsKCWlmIG0uVmFscyA9PSBuaWwgewoJCW0uVmFscyA9IG1ha2UobWFwW3NzYS5JRF1vYmp3LlN0YWNrTWFwSW5kZXgpCgkJbS5VbnNhZmVWYWxzID0gbWFrZShtYXBbc3NhLklEXWJvb2wpCgkJbS5VbnNhZmVCbG9ja3MgPSBtYWtlKG1hcFtzc2EuSURdYm9vbCkKCX0gZWxzZSB7CgkJY2xlYXIobS5WYWxzKQoJCWNsZWFyKG0uVW5zYWZlVmFscykKCQljbGVhcihtLlVuc2FmZUJsb2NrcykKCX0KCW0uRGVmZXJSZXR1cm4gPSBvYmp3LlN0YWNrTWFwRG9udENhcmUKfQoKZnVuYyAobSAqTWFwKSBzZXQodiAqc3NhLlZhbHVlLCBpIG9iancuU3RhY2tNYXBJbmRleCkgewoJbS5WYWxzW3YuSURdIGUgYW4gdW50eXBlZCB0eXBlICh0aG9zZSB0eXBlcwptYXkgY2hhbmdlIG9uIHRoZSB3YXkgdXAgaW4gdGhlIGV4cHJlc3Npb24gdHJlZSkuIFVzdWFsbHkgdGhlc2UgYXJlIGNvbnN0YW50cywKYnV0IHRoZSByZXN1bHRzIG9mIGNvbXBhcmlzb25zIG9yIG5vbi1jb25zdGFudCBzaGlmdHMgb2YgdW50eXBlZCBjb25zdGFudHMKbWF5IGFsc28gYmUgdW50eXBlZCwgYnV0IG5vdCBjb25zdGFudC4KClVudHlwZWQgZXhwcmVzc2lvbnMgbWF5IGV2ZW50dWFsbHkgYmVjb21lIGZ1bGx5IHR5cGVkIChpLmUuLCBub3QgdW50eXBlZCksCnR5cGljYWxseSB3aGVuIHRoZSB2YWx1ZSBpcyBhc3NpZ25lZCB0byBhIHZhcmlhYmxlLCBvciBpcyB1c2VkIG90aGVyd2lzZS4KVGhlIHVwZGF0ZUV4cHJUeXBlIG1ldGhvZCBpcyB1c2VkIHRvIHJlY29yZCB0aGlzIGZpbmFsIHR5cGUgYW5kIHVwZGF0ZQp0aGUgcmVjb3JkZWQgdHlwZXM6IHRoZSB0eXBlLWNoZWNrZWQgZXhwcmVzc2lvbiB0cmVlIGlzIGFnYWluIHRyYXZlcnNlZCBkb3duLAphbmQgdGhlIG5ldyB0eXBlIGlzIHByb3BhZ2F0ZWQgYXMgbmVlZGVkLiBVbnR5cGVkIGNvbnN0YW50IGV4cHJlc3Npb24gdmFsdWVzCnRoYXQgYmVjb21lIGZ1bGx5IHR5cGVkIG11c3Qgbm93IGJlIHJlcHJlc2VudGFibGUgYnkgdGhlIGZ1bGwgdHlwZSAoY29uc3RhbnQKc3ViLWV4cHJlc3Npb24gdHJlZXMgYXJlIGxlZnQgYWxvbmUgZXhjZXB0IGZvciB0aGVpciByb290cykuIFRoaXMgbWVjaGFuaXNtCmVuc3VyZXMgdGhhdCBhIGNsaWVudCBzZWVzIHRoZSBhY3R1YWwgKHJ1bi10aW1lKSB0eXBlIGFuIHVudHlwZWQgdmFsdWUgd291bGQKaGF2ZS4gSXQgYWxzbyBwZXJtaXRzIHR5cGUtY2hlY2tpbmcgb2YgbGhzIHNoaWZ0IG9wZXJhbmRzICJhcyBpZiB0aGUgc2hpZnQKd2VyZSBub3QgcHJlc2VudCI6IHdoZW4gdXBkYXRlRXhwclR5cGUgdmlzaXRzIGFuIHVudHlwZWQgbGhzIHNoaWZ0IG9wZXJhbmQKYW5kIGFzc2lnbnMgaXQgaXQncyBmaW5hbCB0eXBlLCB0aGF0IHR5cGUgbXVzdCBiZSBhbiBpbnRlZ2VyIHR5cGUsIGFuZCBhCmNvbnN0YW50IGxocyBtdXN0IGJlIHJlcHJlc2VudGFibGUgYXMgYW4gaW50ZWdlci4KCldoZW4gYW4gZXhwcmVzc2lvbiBnZXRzIGl0cyBmaW5hbCB0eXBlLCBlaXRoZXIgb24gdGhlIHdheSBvdXQgZnJvbSByYXdFeHByLApvbiB0aGUgd2F5IGRvd24gaW4gdXBkYXRlRXhwclR5cGUsIG9yIGF0IHRoZSBlbmQgb2YgdGhlIHR5cGUgY2hlY2tlciBydW4sCnRoZSB0eXBlIChhbmQgY29uc3RhbnQgdmFsdWUsIGlmIGFueSkgaXMgcmVjb3JkZWQgdmlhIEluZm8uVHlwZXMsIGlmIHByZXNlbnQuCiovCgp0eXBlIG9wUHJlZGljYXRlcyBtYXBbc3ludGF4Lk9wZXJhdG9yXWZ1bmMoVHlwZSkgYm9vbAoKdmFyIHVuYXJ5T3BQcmVkaWNhdGVzIG9wUHJlZGljYXRlcwoKZnVuYyBpbml0KCkgewoJLy8gU2V0dGluZyB1bmFyeU9wUHJlZGljYXRlcyBpbiBpbml0IGF2b2lkcyBkZWNsYXJhdGlvbiBjeWNsZXMuCgl1bmFyeU9wUHJlZGljYXRlcyA9IG9wUHJlZGljYXRlc3sKCQlzeW50YXguQWRkOiBhbGxOdW1lcmljLAoJCXN5bnRheC5TdWI6IGFsbE51bWVyaWMsCgkJc3ludGF4LlhvcjogYWxsSW50ZWdlciwKCQlzeW50YXguTm90OiBhbGxCb29sZWFuLAoJfQp9CgpmdW5jIChjaGVjayAqQ2hlY2tlcikgb3AobSBvcFByZWRpY2F0ZXMsIHggKm9wZXJhbmQsIG9wIHN5bnRheC5PcGVyYXRvcikgYm9vbCB7CglpZiBwcmVkIDo9IG1bb3BdOyBwcmVkICE9IG5pbCB7CgkJaWYgIXByZWQoeC50eXApIHsKCQkJY2hlY2suZXJyb3JmKHgsIFVuZGVmaW5lZE9wLCBpbnZhbGlkT3ArIm9wZXJhdG9yICVzIG5vdCBkZWZpbmVkIG9uICVzIiwgb3AsIHgpCgkJCXJldHVybiBmYWxzZQoJCX0KCX0gZWxzZSB7CgkJY2hlY2suZXJyb3JmKHgsIEludmFsaWRTeW50YXhUcmVlLCAidW5rbm93biBvcGVyYXRvciAlcyIsIG9wKQoJCXJudCAxIn0sCgl7aW50KDEpLCAiaW50IDEifSwKCXtJbnQoaW50KDIpKSwgIm1haW4uSW50IEludD0yIn0sCgl7aW50KEludCgzKSksICJpbnQgMyJ9LAoJe1sxXWludHsyfSwgIlsxXWludCBbMl0ifSwKCXtpby5SZWFkZXIoaW8uUmVhZFdyaXRlcihpby5SZWFkV3JpdGVTZWVrZXIobmlsKSkpLCAiPG5pbD4gPG5pbD4ifSwKCXtpby5SZWFkZXIoaW8uUmVhZFdyaXRlcihpby5SZWFkV3JpdGVTZWVrZXIoJlJXU3t9KSkpLCAiKm1haW4uUldTIHJ3cyJ9LAoJe21ha2VSV1MoKSwgIiptYWluLlJXUyByd3MifSwKCXttYXBbc3RyaW5nXXN0cmluZ3siaGVyZSI6ICJ0aGVyZSJ9LCAibWFwW3N0cmluZ11zdHJpbmcgbWFwW2hlcmU6dGhlcmVdIn0sCgl7Y2hhbiBib29sKG5pbCksICJjaGFuIGJvb2wgPG5pbD4ifSwKCXt1bnNhZmUuUG9pbnRlcih1aW50cHRyKDApKSwgInVuc2FmZS5Qb2ludGVyIDxuaWw+In0sCgl7KCpieXRlKShuaWwpLCAiKnVpbnQ4IDxuaWw+In0sCgl7aW8uV3JpdGVyKCgqb3MuRmlsZSkobmlsKSksICIqb3MuRmlsZSA8bmlsPiJ9LAoJeyhpbnRlcmZhY2V7fSkoaW8uV3JpdGVyKCgqb3MuRmlsZSkobmlsKSkpLCAiKm9zLkZpbGUgPG5pbD4ifSwKCXtmbXQuU3RyaW5nZXIoU3RydW5nZXIoKCgqSW50KShuaWwpKSkpLCAiKm1haW4uSW50IDxuaWw+In0sCn0KCnR5cGUgSW50IGludAoKZnVuYyAoaSBJbnQpIFN0cmluZygpIHN0cmluZyB7IHJldHVybiBmbXQuU3ByaW50ZigiSW50PSVkIiwgaSkgfQpmdW5jIChpIEludCkgU3RydW5nKCkgICAgICAgIHt9Cgp0eXBlIFN0cnVuZ2VyIGludGVyZmFjZSB7CglmbXQuU3RyaW5nZXIKCVN0cnVuZygpCn0KCi8vIFRlc3QgY29ycmVjdCBjb25zdHJ1Y3Rpb24gb2Ygc3RhdGljIG5vbi1lbXB0eSBpbnRlcmZhY2UgdmFsdWVzCnZhciBpZmFjZXMgPSBbLi4uXXN0cnVjdCB7Cgl4IGZtdC5TdHJpbmdlcgoJcyBzdHJpbmcKfXsKCXtuaWwsICI8bmlsPiA8bmlsPiAlIXMoPG5pbD4pIn0sCgl7SW50KDMpLCAibWFpbi5JbnQgMyBJbnQ9MyJ9LAoJe0ludChpbnQoSW50KDQpKSksICJtYWluLkludCA0IEludD00In0sCgl7U3RydW5nZXIoSW50KDUpKSwgIm1haW4uSW50IDUgSW50PTUifSwKCXttYWtlU3RyaW5nZXIoKSwgIiptYWluLlJXUyAmbWFpbi5SV1N7fSByd3MifSwKCXtmbXQuU3RyaW5nZXIobmlsKSwgIjxuaWw+IDxuaWw+ICUhcyg8bmlsPikifSwKCXsoKlJXUykobmlsKSwgIiptYWluLlJXUyAoKm1haW4uUldTKShuaWwpIHJ3cyJ9LAp9CgovLyBUZXN0IGNvcnJlY3QgaGFuZGxpbmcgb2YgZGlyZWN0IGludGVyZmFjZSB2YWx1ZXMKdmFyICgKCW9uZSAgaW50ICAgICAgICAgPSAxCglpcHRyIGludGVyZmFjZXt9ID0gJm9uZQoJY2xvcyBpbnQKCWYgICAgaW50ZXJmYWNle30gPSBmdW5jKCkgeyBjbG9zKysgfQoJZGVlcCBpbnRlcmZhY2V7fSA9IFsxXXN0cnVjdHsgYSAqWzJdYnl0ZSB9e3thOiAmWzJdYnl0ZXsneicsICd3J319fQoJY2ggICBpbnRlcmZhY2V7fSA9IG1ha2UoY2hhbiBib29sLCAxKQopCgpmdW5jIG1haW4oKSB7Cgl2YXIgZmFpbCBib29sCglmb3IgaSwgdGVzdCA6PSByYW5nZSBlZmFjZXMgewoJCXMgOj0gZm10LlNwcmludGYoIiVbMV1UICVbMV12IiwgdGVzdC54KQoJCWlmIHMgIT0gdGVzdC5zIHsKCQkJZm10LlByaW50ZigiZWZhY2UoJWQpPSVxIHdhbnQgJXFcbiIsIGksIHMsIHRlc3QucykKCQkJZmFpbCA9IHRydWUKCQl9Cgl9CgoJZm9yIGksIHRlc3QgOj0gcmFuZ2UgaWZhY2VzIHsKCQlzIDo9IGZtdC5TcHJpbnRmKCIlWzFdVCAlI1sxXXYgJVsxXXMiLCB0ZXN0LngpCgkJaWYgcyAhPSB0ZXN0LnMgewoJCQlmbXQuUHJpbnRmKCJpZmFjZSglZCk9JXEgd2FudCAlcVxuIiwgaSwgcywgdGVzdC5zKQoJCQlmYWlsID0gdHJ1ZQoJCX0KCX0KCglpZiBnb3QgOj0gKihpcHRyLigqaW50KSk7IGdvdCAhPSAxIHsKCQlmbXQuUHJpbnRmKCJiYWQgaW50IHB0ciAlZFxuIiwgZ290KQoJCWZhNzI2MzAxY2E4NzkxNGRjOTU2ZDNlOCIpfSwKCXsiY3JjNjQiLCBmdW5jKCkgaGFzaC5IYXNoIHsgcmV0dXJuIGNyYzY0Lk5ldyhjcmM2NC5NYWtlVGFibGUoY3JjNjQuSVNPKSkgfSwgZnJvbUhleCgiNjM3MjYzMDI3M2JhODQ4NGJiY2Q1ZGVmNWQ1MWM4M2M1ODE2OTViZSIpfSwKCXsiZm52MzIiLCBmdW5jKCkgaGFzaC5IYXNoIHsgcmV0dXJuIGZudi5OZXczMigpIH0sIGZyb21IZXgoIjY2NmU3NjAxNzFiYTNkNzciKX0sCgl7ImZudjMyYSIsIGZ1bmMoKSBoYXNoLkhhc2ggeyByZXR1cm4gZm52Lk5ldzMyYSgpIH0sIGZyb21IZXgoIjY2NmU3NjAyNzQzOWY4NmYiKX0sCgl7ImZudjY0IiwgZnVuYygpIGhhc2guSGFzaCB7IHJldHVybiBmbnYuTmV3NjQoKSB9LCBmcm9tSGV4KCI2NjZlNzYwM2NjNjRlMGU5NzY5MmM2MzciKX0sCgl7ImZudjY0YSIsIGZ1bmMoKSBoYXNoLkhhc2ggeyByZXR1cm4gZm52Lk5ldzY0YSgpIH0sIGZyb21IZXgoIjY2NmU3NjA0YzUyMmFmOWIwZGVkZTY2ZiIpfSwKCXsiZm52MTI4IiwgZnVuYygpIGhhc2guSGFzaCB7IHJldHVybiBmbnYuTmV3MTI4KCkgfSwgZnJvbUhleCgiNjY2ZTc2MDU2MTU4N2E3MGEwZjY2ZDc5ODFkYzk4MGUyY2FiYmFmNyIpfSwKCXsiZm52MTI4YSIsIGZ1bmMoKSBoYXNoLkhhc2ggeyByZXR1cm4gZm52Lk5ldzEyOGEoKSB9LCBmcm9tSGV4KCI2NjZlNzYwNmE5NTU4MDJiMDEzNmNiNjc2MjJiNDYxZDlmOTFlNmZmIil9LAoJeyJtZDUiLCBtZDUuTmV3LCBmcm9tSGV4KCI2ZDY0MzUwMWE5MWIwMDIzMDA3YWExNDc0MGEzOTc5MjEwYjVmMDI0YzBjMWMyYzNjNGM1YzZjN2M4YzljYWNiY2NjZGNlY2ZkMGQxZDJkM2Q0ZDVkNmQ3ZDhkOWRhZGJkY2RkZGVkZmUwZTFlMmUzZTRlNWU2ZTdlOGU5ZWFlYmVjZWRlZWVmZjBmMWYyZjNmNGY1ZjZmN2Y4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY5Iil9LAoJeyJzaGExIiwgc2hhMS5OZXcsIGZyb21IZXgoIjczNjg2MTAxNmRhZDVhY2I0ZGMwMDM5NTJmN2EwYjM1MmVlNTUzN2VjMzgxYTIyOGMwYzFjMmMzYzRjNWM2YzdjOGM5Y2FjYmNjY2RjZWNmZDBkMWQyZDNkNGQ1ZDZkN2Q4ZDlkYWRiZGNkZGRlZGZlMGUxZTJlM2U0ZTVlNmU3ZThlOWVhZWJlY2VkZWVlZmYwZjFmMmYzZjRmNWY2ZjdmODAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBmOSIpfSwKCXsic2hhMjI0Iiwgc2hhMjU2Lk5ldzIyNCwgZnJvbUhleCgiNzM2ODYxMDJmOGI5MmZjMDQ3YzliNGQ4MmYwMWE2MzcwODQxMjc3YjdhMGQ5MjEwODQ0MDE3OGM4M2RiODU1YThlNjZjMmQ5YzBjMWMyYzNjNGM1YzZjN2M4YzljYWNiY2NjZGNlY2ZkMGQxZDJkM2Q0ZDVkNmQ3ZDhkOWRhZGJkY2RkZGVkZmUwZTFlMmUzZTRlNWU2ZTdlOGU5ZWFlYmVjZWRlZWVmZjBmMWYyZjNmNGY1ZjZmN2Y4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY5Iil9LAoJeyJzaGEyNTYiLCBzaGEyNTYuTmV3LCBmcm9tSGV4KCI3MzY4NjEwMzJiZWQ2OGI5OTk4N2NhZTQ4MTgzYjJiMDQ5ZDM5M2QwMDUwODY4ZTRlOGJhMzczMGU5MTEyYjA4NzY1OTI5YjdjMGMxYzJjM2M0YzVjNmM3YzhjOWNhY2JjY2NkY2VjZmQwZDFkMmQzZDRkNWQ2ZDdkOGQ5ZGFkYmRjZGRkZWRmZTBlMWUyZTNlNGU1ZTZlN2U4ZTllYWViZWNlZGVlZWZmMGYxZjJmM2Y0ZjVmNmY3ZjgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZjkiKX0sCgl7InNoYTM4NCIsIHNoYTUxMi5OZXczODQsIGZyb21IZXgoIjczNjg2MTA0NmYxNjY0ZDIxM2RkODAyZjdjNDdiYzUwNjM3Y2Y5MzU5MjU3MGEyYjg2OTU4MzkxNDhiZjM4MzQxYzZlYWNkMDUzMjY0NTJlZjFjYmU2NGQ5MGYxZWY3M2JiNWFjN2QyODAzNTY1NDY3ZDBkZGIxMGM1ZWUzZmMwNTBmOWYwYzE4MDgxODI4Mzg0ODU4Njg3ODg4OThhOGI4YzhkOGU4ZjkwOTE5MjkzOTQ5NTk2OTc5ODk5OWE5YjljOWQ5ZTlmYTBhMWEyYTNhNGE1YTZhN2E4YTlhYWFiYWNhZGFlYWZiMGIxYjJiM2I0YjViNmI3YjhiOWJhYmMgKGEgQSkgdHJpcGxlKHggc3RyaW5nLCB5IGludCkgc3RyaW5nIHsKCXEgOj0gYS5zCglpZiB5ID09IDk5ODg3NyB7CgkJYS5zID0geAoJfQoJciA6PSBhLnMgKyBhLnMKCXJldHVybiBxICsgcgp9Cgp0eXBlIG1ldGhvZHMgc3RydWN0IHsKCW0xIGZ1bmMoYSAqQSwgeCBzdHJpbmcsIHkgaW50KSBzdHJpbmcKCW0yIGZ1bmMoYSAqQSwgeCBzdHJpbmcsIHkgaW50KSBzdHJpbmcKfQoKLy8gTm93IGEgZnVuY3Rpb24gdGhhdCBtYWtlcyByZWZlcmVuY2VzIHRvIHRoZSBtZXRob2RzIHZpYSBwb2ludGVycywKLy8gd2hpY2ggc2hvdWxkIHRyaWdnZXIgdGhlIHdyYXBwZXIgZ2VuZXJhdGlvbi4KZnVuYyBQKGEgKkEsIG1zICptZXRob2RzKSB7CglpZiBhICE9IG5pbCB7CgkJZGVmZXIgZnVuYygpIHsgcHJpbnRsbigiZG9uZSIpIH0oKQoJfQoJcHJpbnRsbihtcy5tMShhLCAiYSIsIDIpKQoJcHJpbnRsbihtcy5tMihhLCAiYiIsIDMpKQp9CgpmdW5jIEcoeCAqQSwgbiBpbnQpIHsKCWlmIG4gPD0gMCB7CgkJcHJpbnRsbihuKQoJCXJldHVybgoJfQoJLy8gQWRkcmVzcy10YWtlbiBsb2NhbCBvZiB0eXBlIEEsIHdoaWNoIHdpbGwgaW5zdXJlIHRoYXQgdGhlCgkvLyBjb21waWxlcidzIHdyaXRlVHlwZSgpIHJvdXRpbmUgd2lsbCBjcmVhdGUgYSBtZXRob2Qgd3JhcHBlci4KCXZhciBhLCBiIEEKCWEubmV4dCA9IHgKCWEucHJldiA9ICZiCgl4ID0gJmEKCUcoeCwgbi0yKQp9Cgp2YXIgTSBtZXRob2RzCgpmdW5jIEYoKSB7CglNLm0xID0gKCpBKS5kb3VibGUKCU0ubTIgPSAoKkEpLnRyaXBsZQoJRyhuaWwsIDEwMCkKfQovLyAtZmFrZUltcG9ydEMKCi8vIENvcHlyaWdodCAyMDE1IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIGltcG9ydEMKCmltcG9ydCAiQyIKaW1wb3J0IF8gLyogRVJST1IgYGNhbm5vdCByZW5hbWUgaW1wb3J0ICJDImAgKi8gIkMiCmltcG9ydCBmb28gLyogRVJST1IgYGNhbm5vdCByZW5hbWUgaW1wb3J0ICJDImAgKi8gIkMiCmltcG9ydCAuIC8qIEVSUk9SIGBjYW5ub3QgcmVuYW1lIGltcG9ydCAiQyJgICovICJDIgoKLy8gVGVzdCBjYXNlcyBleHRyYWN0ZWQgZnJvbSBpc3N1ZSAjMjIwOTAuCgppbXBvcnQgInVuc2FmZSIKCmNvbnN0IF8gQy5pbnQgPSAweGZmIC8vIG5vIGVycm9yIGR1ZSB0byBpbnZhbGlkIGNvbnN0YW50IHR5cGUKCnR5cGUgVCBzdHJ1Y3QgewoJTmFtZSAgICBzdHJpbmcKCU9yZGluYWwgaW50Cn0KCmZ1bmMgXyhhcmdzIFtdVCkgewoJdmFyIHMgc3RyaW5nCglmb3IgaSwgdiA6PSByYW5nZSBhcmdzIHsKCQljbmFtZSA6PSBDLkNTdHJpbmcodi5OYW1lKQoJCWFyZ3NbaV0uT3JkaW5hbCA9IGludChDLnNxbGl0ZTNfYmluZF9wYXJhbWV0ZXJfaW5kZXgocywgY25hbWUpKSAvLyBubyBlcnJvciBkdWUgdG8gaSBub3QgYmVpbmcgInVzZWQiCgkJQy5mcmVlKHVuc2FmZS5Qb2ludGVyKGNuYW1lKSkKCX0KfQoKdHlwZSBDVHlwZSBDLlR5cGUKCmNvbnN0IF8gQ1R5cGUgPSBDLlggLy8gbm8gZXJyb3IgZHVlIHRvIGludmFsaWQgY29uc3RhbnQgdHlwZQpjb25zdCBfID0gQy5YCgovLyBUZXN0IGNhc2VzIGV4dHJhY3RlZCBmcm9tIGlzc3VlICMyMzcxMi4KCmZ1bmMgXygpIHsKCXZhciBhIFtDLkFycmF5TGVuZ3RoXWJ5dGUKCV8gPSBhWzBdIC8vIG5vIGluZGV4IG91dCBvZiBib3VuZHMgZXJyb3IgaGVyZQp9CgovLyBBZGRpdGlvbmFsIHRlc3RzIHRvIHZlcmlmeSBmaXggZm9yICMyMzcxMi4KCmZ1bmMgXygpIHsKCXZhciBhIFtDLkFycmF5TGVuZ3RoMV1ieXRlCglfID0gMSAvIGxlbihhKSAvLyBubyBkaXZpc2lvbiBieSB6ZXJvIGVycm9yIGhlcmUgYW5kIGJlbG93CglfID0gMSAvIGNhcChhKQoJXyA9IHVpbnQodW5lcnNlIGVkZ2UgbG9va3Vwcy4KCXR5cGUgZWRnZSBzdHJ1Y3QgewoJCWZyb20sIHRvIGxvYWRlci5TeW0KCX0KCXZhciBlZGdlcyBbXWVkZ2UKCgkvLyBMaXN0IG9mIHBhY2thZ2VzIHRoYXQgYXJlIHJlYWR5IHRvIHNjaGVkdWxlLiBXZSB1c2UgYSBsZXhpY29ncmFwaGljCgkvLyBvcmRlcmVkIGhlYXAgdG8gcGljayB0aGUgbGV4aWNhbGx5IGVhcmxpZXN0IHVuaW5pdGlhbGl6ZWQgYnV0CgkvLyBpbml0aXRhbGl6ZWFibGUgcGFja2FnZSBhdCBlYWNoIHN0ZXAuCgl2YXIgaCBsZXhIZWFwCgoJLy8gbSBtYXBzIGZyb20gYW4gaW5pdHRhc2sgc3ltYm9sIGZvciBwYWNrYWdlIHAgdG8gdGhlIG51bWJlciBvZgoJLy8gcCdzIGRpcmVjdCBpbXBvcnRzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gc2NoZWR1bGVkLgoJbSA6PSBtYXBbbG9hZGVyLlN5bV1pbnR7fQoKCS8vIEZpbmQgYWxsIHJlYWNoYWJsZSBpbml0dGFzayByZWNvcmRzIGZyb20gdGhlIHJvb3RzLgoJLy8gS2VlcCB0cmFjayBvZiB0aGUgZGVwZW5kZW5jeSBlZGdlcyBiZXR3ZWVuIHRoZW0gaW4gZWRnZXMuCgkvLyBLZWVwIHRyYWNrIG9mIGhvdyBtYW55IGltcG9ydHMgZWFjaCBwYWNrYWdlIGhhcyBpbiBtLgoJLy8gcSBpcyB0aGUgbGlzdCBvZiBmb3VuZCBidXQgbm90IHlldCBleHBsb3JlZCBwYWNrYWdlcy4KCXZhciBxIFtdbG9hZGVyLlN5bQoJZm9yIF8sIHAgOj0gcmFuZ2Ugcm9vdHMgewoJCW1bcF0gPSAwCgkJcSA9IGFwcGVuZChxLCBwKQoJfQoJZm9yIGxlbihxKSA+IDAgewoJCXggOj0gcVtsZW4ocSktMV0KCQlxID0gcVs6bGVuKHEpLTFdCgkJcmVsb2NzIDo9IGxkci5SZWxvY3MoeCkKCQluIDo9IHJlbG9jcy5Db3VudCgpCgkJbmRlcHMgOj0gMAoJCWZvciBpIDo9IDA7IGkgPCBuOyBpKysgewoJCQlyIDo9IHJlbG9jcy5BdChpKQoJCQlpZiByLlR5cGUoKSAhPSBvYmphYmkuUl9JTklUT1JERVIgewoJCQkJY29udGludWUKCQkJfQoJCQluZGVwcysrCgkJCXMgOj0gci5TeW0oKQoJCQllZGdlcyA9IGFwcGVuZChlZGdlcywgZWRnZXtmcm9tOiB4LCB0bzogc30pCgkJCWlmIF8sIG9rIDo9IG1bc107IG9rIHsKCQkJCWNvbnRpbnVlIC8vIGFscmVhZHkgZm91bmQKCQkJfQoJCQlxID0gYXBwZW5kKHEsIHMpCgkJCW1bc10gPSAwIC8vIG1hcmsgYXMgZm91bmQKCQl9CgkJbVt4XSA9IG5kZXBzCgkJaWYgbmRlcHMgPT0gMCB7CgkJCWgucHVzaChsZHIsIHgpCgkJfQoJfQoKCS8vIFNvcnQgZWRnZXMgc28gd2UgY2FuIGxvb2sgdGhlbSB1cCBieSBlZGdlIGRlc3RpbmF0aW9uLgoJc29ydC5TbGljZShlZGdlcywgZnVuYyhpLCBqIGludCkgYm9vbCB7CgkJcmV0dXJuIGVkZ2VzW2ldLnRvIDwgZWRnZXNbal0udG8KCX0pCgoJLy8gRmlndXJlIG91dCB0aGUgc2NoZWR1bGUuCglzY2hlZCA6PSBsZHIuTWFrZVN5bWJvbEJ1aWxkZXIoc3ltTmFtZSkKCXNjaGVkLlNldFR5cGUoc3ltLlNOT1BUUkRBVEEpIC8vIENvdWxkIGJlIFNST0RBVEEsIGJ1dCBzZWUgaXNzdWUgNTg4NTcuCglmb3IgIWguZW1wdHkoKSB7CgkJLy8gUGljayB0aGUgbGV4aWNvZ3JhcGhpY2FsbHkgZmlyc3QgaW5pdGlhbGl6YWJsZSBwYWNrYWdlLgoJCXMgOj0gaC5wb3AobGRyKQoKCQkvLyBBZGQgcyB0byB0aGUgc2NoZWR1bGUuCgkJaWYgbGRyLlN5bVNpemUocykgPiA4IHsKCQkJLy8gTm90ZTogZG9uJ3QgYWRkIHMgaWYgaXQgaGFzIG5vIGZ1bmN0aW9ucyB0byBydW4uIFdlIG5lZWQKCQkJLy8gcyBkdXJpbmcgbGlua2luZyB0byBjb21wdXRlIGFuIG9yZGVyaW5nLCBidXQgdGhlIHJ1bnRpbWUKCQkJLy8gZG9lc24ndCBuZWVkIHRvIGtub3cgYWJvdXQgaXQuIEFib3V0IDEvMiBvZiBzdGRsaWIgcGFja2FnZXMKCQkJLy8gZml0IGluIHRoaXMgYnVja2V0LgoJCQlzY2hlZC5BZGRBZGRyKGN0eHQuQXJjaCwgcykKCQl9CgoJCS8vIEZpbmQgYWxsIGluY29taW5nIGVkZ2VzIGludG8gcy4KCQlhIDo9IHNvcnQuU2VhcmNoKGxlbihlZGdlcyksbyIKCSJsb2ciCgkibmV0IgoJIm5ldC9odHRwIgoJXyAibmV0L2h0dHAvcHByb2YiIC8vIFJlcXVpcmVkIHRvIHVzZSBwcHJvZgoJIm9zIgoJInNsaWNlcyIKCSJzeW5jL2F0b21pYyIKCSJ0ZXh0L3RhYndyaXRlciIKCSJ0aW1lIgopCgpjb25zdCB1c2FnZU1lc3NhZ2UgPSAiIiArCglgVXNhZ2Ugb2YgJ2dvIHRvb2wgdHJhY2UnOgpHaXZlbiBhIHRyYWNlIGZpbGUgcHJvZHVjZWQgYnkgJ2dvIHRlc3QnOgoJZ28gdGVzdCAtdHJhY2U9dHJhY2Uub3V0IHBrZwoKT3BlbiBhIHdlYiBicm93c2VyIGRpc3BsYXlpbmcgdHJhY2U6CglnbyB0b29sIHRyYWNlIFtmbGFnc10gW3BrZy50ZXN0XSB0cmFjZS5vdXQKCkdlbmVyYXRlIGEgcHByb2YtbGlrZSBwcm9maWxlIGZyb20gdGhlIHRyYWNlOgogICAgZ28gdG9vbCB0cmFjZSAtcHByb2Y9VFlQRSBbcGtnLnRlc3RdIHRyYWNlLm91dAoKW3BrZy50ZXN0XSBhcmd1bWVudCBpcyByZXF1aXJlZCBmb3IgdHJhY2VzIHByb2R1Y2VkIGJ5IEdvIDEuNiBhbmQgYmVsb3cuCkdvIDEuNyBkb2VzIG5vdCByZXF1aXJlIHRoZSBiaW5hcnkgYXJndW1lbnQuCgpTdXBwb3J0ZWQgcHJvZmlsZSB0eXBlcyBhcmU6CiAgICAtIG5ldDogbmV0d29yayBibG9ja2luZyBwcm9maWxlCiAgICAtIHN5bmM6IHN5bmNocm9uaXphdGlvbiBibG9ja2luZyBwcm9maWxlCiAgICAtIHN5c2NhbGw6IHN5c2NhbGwgYmxvY2tpbmcgcHJvZmlsZQogICAgLSBzY2hlZDogc2NoZWR1bGVyIGxhdGVuY3kgcHJvZmlsZQoKRmxhZ3M6CgktaHR0cD1hZGRyOiBIVFRQIHNlcnZpY2UgYWRkcmVzcyAoZS5nLiwgJzo2MDYwJykKCS1wcHJvZj10eXBlOiBwcmludCBhIHBwcm9mLWxpa2UgcHJvZmlsZSBpbnN0ZWFkCgktZD1tb2RlOiBwcmludCBkZWJ1ZyBpbmZvIGFuZCBleGl0IChtb2Rlczogd2lyZSwgcGFyc2VkLCBmb290cHJpbnQpCgpOb3RlIHRoYXQgd2hpbGUgdGhlIHZhcmlvdXMgcHJvZmlsZXMgYXZhaWxhYmxlIHdoZW4gbGF1bmNoaW5nCidnbyB0b29sIHRyYWNlJyB3b3JrIG9uIGV2ZXJ5IGJyb3dzZXIsIHRoZSB0cmFjZSB2aWV3ZXIgaXRzZWxmCih0aGUgJ3ZpZXcgdHJhY2UnIHBhZ2UpIGNvbWVzIGZyb20gdGhlIENocm9tZS9DaHJvbWl1bSBwcm9qZWN0CmFuZCBpcyBvbmx5IGFjdGl2ZWx5IHRlc3RlZCBvbiB0aGF0IGJyb3dzZXIuCmAKCnZhciAoCglodHRwRmxhZyAgPSBmbGFnLlN0cmluZygiaHR0cCIsICJsb2NhbGhvc3Q6MCIsICJIVFRQIHNlcnZpY2UgYWRkcmVzcyAoZS5nLiwgJzo2MDYwJykiKQoJcHByb2ZGbGFnID0gZmxhZy5TdHJpbmcoInBwcm9mIiwgIiIsICJwcmludCBhIHBwcm9mLWxpa2UgcHJvZmlsZSBpbnN0ZWFkIikKCWRlYnVnRmxhZyA9IGZsYWcuU3RyaW5nKCJkIiwgIiIsICJwcmludCBkZWJ1ZyBpbmZvIGFuZCBleGl0IChtb2Rlczogd2lyZSwgcGFyc2VkLCBmb290cHJpbnQpIikKCgkvLyBUaGUgYmluYXJ5IGZpbGUgbmFtZSwgbGVmdCBoZXJlIGZvciBzZXJ2ZVNWR1Byb2ZpbGUuCglwcm9ncmFtQmluYXJ5IHN0cmluZwoJdHJhY2VGaWxlICAgICBzdHJpbmcKKQoKZnVuYyBtYWluKCkgewoJY291bnRlci5PcGVuKCkKCWZsYWcuVXNhZ2UgPSBmdW5jKCkgewoJCWZtdC5GcHJpbnQob3MuU3RkZXJyLCB1c2FnZU1lc3NhZ2UpCgkJb3MuRXhpdCgyKQoJfQoJZmxhZy5QYXJzZSgpCgljb3VudGVyLkluYygidHJhY2UvaW52b2NhdGlvbnMiKQoJY291bnRlci5Db3VudEZsYWdzKCJ0cmFjZS9mbGFnOiIsICpmbGFnLkNvbW1hbmRMaW5lKQoKCS8vIEdvIDEuNyB0cmFjZXMgZW1iZWQgc3ltYm9sIGluZm8gYW5kIGRvZXMgbm90IHJlcXVpcmUgdGhlIGJpbmFyeS4KCS8vIEJ1dCB3ZSBvcHRpb25hbGx5IGFjY2VwdCBiaW5hcnkgYXMgZmlyc3QgYXJnIGZvciBHbyAxLjUgdHJhY2VzLgoJc3dpdGNoIGZsYWcuTkFyZygpIHsKCWNhc2UgMToKCQl0cmFjZUZpbGUgPSBmbGFnLkFyZygwKQoJY2FzZSAyOgoJCXByb2dyYW1CaW5hcnkgPSBmbGhhdCBvdXIgSXNTcGFjZSBhZ3JlZXMgd2l0aCB1bmljb2RlLklzU3BhY2UuCmZ1bmMgVGVzdElzU3BhY2UodCAqVCkgewoJbiA6PSAwCglmb3IgciA6PSBydW5lKDApOyByIDw9IHVuaWNvZGUuTWF4UnVuZTsgcisrIHsKCQlpZiBpc1NwYWNlKHIpICE9IHVuaWNvZGUuSXNTcGFjZShyKSB7CgkJCXQuRXJyb3JmKCJJc1NwYWNlKCVVKT0ldCBpbmNvcnJlY3QiLCByLCBpc1NwYWNlKHIpKQoJCQluKysKCQkJaWYgbiA+IDEwIHsKCQkJCXJldHVybgoJCQl9CgkJfQoJfQp9CgpmdW5jIFRlc3RTcGxpdFJlZ2V4cCh0ICpUKSB7CglyZXMgOj0gZnVuYyhzIC4uLnN0cmluZykgZmlsdGVyTWF0Y2ggeyByZXR1cm4gc2ltcGxlTWF0Y2gocykgfQoJYWx0IDo9IGZ1bmMobSAuLi5maWx0ZXJNYXRjaCkgZmlsdGVyTWF0Y2ggeyByZXR1cm4gYWx0ZXJuYXRpb25NYXRjaChtKSB9Cgl0ZXN0Q2FzZXMgOj0gW11zdHJ1Y3QgewoJCXBhdHRlcm4gc3RyaW5nCgkJcmVzdWx0ICBmaWx0ZXJNYXRjaAoJfXsKCQkvLyBDb3JyZWN0IHBhdHRlcm5zCgkJLy8gSWYgYSByZWdleHAgcGF0dGVybiBpcyBjb3JyZWN0LCBhbGwgc3BsaXQgcmVnZXhwcyBuZWVkIHRvIGJlIGNvcnJlY3QKCQkvLyBhcyB3ZWxsLgoJCXsiIiwgcmVzKCIiKX0sCgkJeyIvIiwgcmVzKCIiLCAiIil9LAoJCXsiLy8iLCByZXMoIiIsICIiLCAiIil9LAoJCXsiQSIsIHJlcygiQSIpfSwKCQl7IkEvQiIsIHJlcygiQSIsICJCIil9LAoJCXsiQS9CLyIsIHJlcygiQSIsICJCIiwgIiIpfSwKCQl7Ii9BL0IvIiwgcmVzKCIiLCAiQSIsICJCIiwgIiIpfSwKCQl7IltBXS8oQikiLCByZXMoIltBXSIsICIoQikiKX0sCgkJeyJbL10vWy9dIiwgcmVzKCJbL10iLCAiWy9dIil9LAoJCXsiWy9dL1s6L10iLCByZXMoIlsvXSIsICJbOi9dIil9LAoJCXsiL10iLCByZXMoIiIsICJdIil9LAoJCXsiXS8iLCByZXMoIl0iLCAiIil9LAoJCXsiXS9bL10iLCByZXMoIl0iLCAiWy9dIil9LAoJCXtgKFspL11bKF0pYCwgcmVzKGAoWykvXVsoXSlgKX0sCgkJeyJbKF0vWyldIiwgcmVzKCJbKF0iLCAiWyldIil9LAoKCQl7IkEvQnxDL0QiLCBhbHQocmVzKCJBIiwgIkIiKSwgcmVzKCJDIiwgIkQiKSl9LAoKCQkvLyBGYXVsdHkgcGF0dGVybnMKCQkvLyBFcnJvcnMgaW4gb3JpZ2luYWwgc2hvdWxkIHByb2R1Y2UgYXQgbGVhc3Qgb25lIGZhdWx0eSByZWdleHAgaW4gcmVzdWx0cy4KCQl7IikvIiwgcmVzKCIpLyIpfSwKCQl7IikvKC8pIiwgcmVzKCIpLygiLCAiKSIpfSwKCQl7ImFbLyliIiwgcmVzKCJhWy8pYiIpfSwKCQl7IigvXSIsIHJlcygiKC9dIil9LAoJCXsiKC8iLCByZXMoIigvIil9LAoJCXsiWy9dL1svIiwgcmVzKCJbL10iLCAiWy8iKX0sCgkJe2BccHsvfWAsIHJlcyhgXHB7YCwgIn0iKX0sCgkJe2BccC9gLCByZXMoYFxwYCwgIiIpfSwKCQl7YFtbOi86XV1gLCByZXMoYFtbOi86XV1gKX0sCgl9Cglmb3IgXywgdGMgOj0gcmFuZ2UgdGVzdENhc2VzIHsKCQlhIDo9IHNwbGl0UmVnZXhwKHRjLnBhdHRlcm4pCgkJaWYgIXJlZmxlY3QuRGVlcEVxdWFsKGEsIHRjLnJlc3VsdCkgewoJCQl0LkVycm9yZigic3BsaXRSZWdleHAoJXEpID0gJSN2OyB3YW50ICUjdiIsIHRjLnBhdHRlcm4sIGEsIHRjLnJlc3VsdCkKCQl9CgoJCS8vIElmIHRoZXJlIGlzIGFueSBlcnJvciBpbiB0aGUgcGF0dGVybiwgb25lIG9mIHRoZSByZXR1cm5lZCBzdWJwYXR0ZXJucwoJCS8vIG5lZWRzIHRvIGhhdmUgYW4gZXJyb3IgYXMgd2VsbC4KCQlpZiBfLCBlcnIgOj0gcmVnZXhwLkNvbXBpbGUodGMucGF0dGVybik7IGVyciAhPSBuaWwgewoJCQlvayA6PSB0cnVlCgkJCWlmIGVyciA6PSBhLnZlcmlmeSgiIiwgcmVnZXhwLk1hdGNoU3RyaW5nKTsgZXJyICE9IG5pbCB7CgkJCQlvayA9IGZhbHNlCgkJCX0KCQkJaWYgb2sgewoJCQkJdC5FcnJvcmYoIiVzOiBleHBlY3RlZCBlcnJvciBpbiBhbnkgb2YgJXEiLCB0Yy5wYXR0ZXJuLCBhKQoJCXIgcDFSNSA9IFs2XWZsb2F0NjR7CgkxLjMxOTkwNTE5NTU2MjQzNTIyNzQ5ZS0xMSwgLy8gMHgzREFEMDY2N0RBRTFDQTdECgkxLjE3MTg3NDkzMTkwNjE0MDk3NjM4ZS0wMSwgLy8gMHgzRkJERkZGRkUyQzEwMDQzCgk2LjgwMjc1MTI3ODY4NDMyODcxNzM2ZSswMCwgLy8gMHg0MDFCMzYwNDZFNjMxNUUzCgkxLjA4MzA4MTgyOTkwMTg5MTA5NzczZSswMiwgLy8gMHg0MDVCMTNCOTQ1MjYwMkVECgk1LjE3NjM2MTM5NTMzMTk5NzUyODA1ZSswMiwgLy8gMHg0MDgwMkQxNkQwNTJENjQ5Cgk1LjI4NzE1MjAxMzYzMzM3NTQxODA3ZSswMiwgLy8gMHg0MDgwODVCOEJCN0UwQ0I3Cn0KdmFyIHAxUzUgPSBbNV1mbG9hdDY0ewoJNS45MjgwNTk4NzIyMTEzMTMzMTkyMWUrMDEsIC8vIDB4NDA0REEzRUFBOEFGNjMzRAoJOS45MTQwMTQxODczMzYxNDM3Nzc0M2UrMDIsIC8vIDB4NDA4RUZCMzYxQjA2NjcwMQoJNS4zNTMyNjY5NTI5MTQ4Nzk3NjY0N2UrMDMsIC8vIDB4NDBCNEU5NDQ1NzA2QjZGQgoJNy44NDQ2OTAzMTc0OTU1MTIzMTc2OWUrMDMsIC8vIDB4NDBCRUE0QjBCOEE1QkIxNQoJMS41MDQwNDY4ODgxMDM2MTA2MjY3OWUrMDMsIC8vIDB4NDA5NzgwMzAwMzZGNUU1MQp9CgovLyBmb3IgeCBpbls0LjU0NTMsMi44NTcxXSA9IDEvWzAuMjE5OSwwLjM1MDAxXQp2YXIgcDFSMyA9IFs2XWZsb2F0NjR7CgkzLjAyNTAzOTE2MTM3MzczNjE4MDI0ZS0wOSwgLy8gMHgzRTI5RkMyMUE3QUQ5RURECgkxLjE3MTg2ODY1NTY3MjUzNTkyNDkxZS0wMSwgLy8gMHgzRkJERkZGNTVCMjFEMTdCCgkzLjkzMjk3NzUwMDMzMzE1NjQwNjUwZSswMCwgLy8gMHg0MDBGNzZCQ0U4NUVBRDhBCgkzLjUxMTk0MDM1NTkxNjM2OTMyNzM2ZSswMSwgLy8gMHg0MDQxOEY0ODlEQTZEMTI5Cgk5LjEwNTUwMTEwNzUwNzgxMjcxOTE4ZSswMSwgLy8gMHg0MDU2QzM4NTREMkMxODM3Cgk0Ljg1NTkwNjg1MTk3MzY0OTE5NjQ1ZSswMSwgLy8gMHg0MDQ4NDc4RjhFQTgzRUU1Cn0KdmFyIHAxUzMgPSBbNV1mbG9hdDY0ewoJMy40NzkxMzA5NTAwMTI1MTUxOTk4OWUrMDEsIC8vIDB4NDA0MTY1NDlBMTM0MDY5QwoJMy4zNjc2MjQ1ODc0NzgyNTc0Njc0MWUrMDIsIC8vIDB4NDA3NTBDMzMwN0YxQTc1RgoJMS4wNDY4NzEzOTk3NTc3NTEzMDU1MWUrMDMsIC8vIDB4NDA5MDVCN0M1MDM3RDUyMwoJOC45MDgxMTM0NjM5ODI1NjQzMjYyMmUrMDIsIC8vIDB4NDA4QkQ2N0RBMzJFMzFFOQoJMS4wMzc4NzkzMjQzOTYzOTI3NzUwNGUrMDIsIC8vIDB4NDA1OUYyNkQ3QzJFRUQ1Mwp9CgovLyBmb3IgeCBpbiBbMi44NTcwLDJdID0gMS9bMC4zNDk5LDAuNV0KdmFyIHAxUjIgPSBbNl1mbG9hdDY0ewoJMS4wNzcxMDgzMDEwNjg3Mzc0MzA4MmUtMDcsIC8vIDB4M0U3Q0U5RDRGNjU1NDRGNAoJMS4xNzE3NjIxOTQ2MjY4MzM0ODA5NGUtMDEsIC8vIDB4M0ZCREZGNDJCRTc2MEQ4MwoJMi4zNjg1MTQ5NjY2NzYwODc4NTE3NGUrMDAsIC8vIDB4NDAwMkYyQjdGOThGQUVDMAoJMS4yMjQyNjEwOTE0ODI2MTIzMjkxN2UrMDEsIC8vIDB4NDAyODdDMzc3RjcxQTk2NAoJMS43NjkzOTcxMTI3MTY4NzcyNzM5MGUrMDEsIC8vIDB4NDAzMUIxQTgxNzdGOEVFMgoJNS4wNzM1MjMxMjU4ODgxODQ5OTI1MGUrMDAsIC8vIDB4NDAxNDRCNDlBNTc0QzFGRQp9CnZhciBwMVMyID0gWzVdZmxvYXQ2NHsKCTIuMTQzNjQ4NTkzNjM4MjE0MDk0ODhlKzAxLCAvLyAweDQwMzU2RkJEOEFENUVDREMKCTEuMjUyOTAyMjcxNjg0MDI3NTEwOTBlKzAyLCAvLyAweDQwNUY1MjkzMTRGOTJDRDUKCTIuMzIyNzY0NjkwNTcxNjI4MTM2NjllKzAyLCAvLyAweDQwNkQwOEQ4RDVBMkRCRDkKCTEuMTc2NzkzNzMyODcxNDcxMDA3NjhlKzAyLCAvLyAweDQwNUQ2QjdBREExODg0QTkKCTguMzY0NjM4OTMzNzE2MTgyODMzNjhlKzAwLCAvLyAweDQwMjBCQUIxRjQ0RTUxOTIKfQoKZnVuYyBwb25lKHggZmx0b2EoaW50KGspKQp9CgovLyBOZXdDaXBoZXIgY3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBbQ2lwaGVyXS4gVGhlIGtleSBhcmd1bWVudCBzaG91bGQgYmUgdGhlCi8vIFJDNCBrZXksIGF0IGxlYXN0IDEgYnl0ZSBhbmQgYXQgbW9zdCAyNTYgYnl0ZXMuCmZ1bmMgTmV3Q2lwaGVyKGtleSBbXWJ5dGUpICgqQ2lwaGVyLCBlcnJvcikgewoJaWYgZmlwczE0MG9ubHkuRW5mb3JjZWQoKSB7CgkJcmV0dXJuIG5pbCwgZXJyb3JzLk5ldygiY3J5cHRvL3JjNDogdXNlIG9mIFJDNCBpcyBub3QgYWxsb3dlZCBpbiBGSVBTIDE0MC1vbmx5IG1vZGUiKQoJfQoJayA6PSBsZW4oa2V5KQoJaWYgayA8IDEgfHwgayA+IDI1NiB7CgkJcmV0dXJuIG5pbCwgS2V5U2l6ZUVycm9yKGspCgl9Cgl2YXIgYyBDaXBoZXIKCWZvciBpIDo9IDA7IGkgPCAyNTY7IGkrKyB7CgkJYy5zW2ldID0gdWludDMyKGkpCgl9Cgl2YXIgaiB1aW50OCA9IDAKCWZvciBpIDo9IDA7IGkgPCAyNTY7IGkrKyB7CgkJaiArPSB1aW50OChjLnNbaV0pICsga2V5W2kla10KCQljLnNbaV0sIGMuc1tqXSA9IGMuc1tqXSwgYy5zW2ldCgl9CglyZXR1cm4gJmMsIG5pbAp9CgovLyBSZXNldCB6ZXJvcyB0aGUga2V5IGRhdGEgYW5kIG1ha2VzIHRoZSBbQ2lwaGVyXSB1bnVzYWJsZS4KLy8KLy8gRGVwcmVjYXRlZDogUmVzZXQgY2FuJ3QgZ3VhcmFudGVlIHRoYXQgdGhlIGtleSB3aWxsIGJlIGVudGlyZWx5IHJlbW92ZWQgZnJvbQovLyB0aGUgcHJvY2VzcydzIG1lbW9yeS4KZnVuYyAoYyAqQ2lwaGVyKSBSZXNldCgpIHsKCWNsZWFyKGMuc1s6XSkKCWMuaSwgYy5qID0gMCwgMAp9CgovLyBYT1JLZXlTdHJlYW0gc2V0cyBkc3QgdG8gdGhlIHJlc3VsdCBvZiBYT1Jpbmcgc3JjIHdpdGggdGhlIGtleSBzdHJlYW0uCi8vIERzdCBhbmQgc3JjIG11c3Qgb3ZlcmxhcCBlbnRpcmVseSBvciBub3QgYXQgYWxsLgpmdW5jIChjICpDaXBoZXIpIFhPUktleVN0cmVhbShkc3QsIHNyYyBbXWJ5dGUpIHsKCWlmIGxlbihzcmMpID09IDAgewoJCXJldHVybgoJfQoJaWYgYWxpYXMuSW5leGFjdE92ZXJsYXAoZHN0WzpsZW4oc3JjKV0sIHNyYykgewoJCXBhbmljKCJjcnlwdG8vcmM0OiBpbnZhbGlkIGJ1ZmZlciBvdmVybGFwIikKCX0KCWksIGogOj0gYy5pLCBjLmoKCV8gPSBkc3RbbGVuKHNyYyktMV0KCWRzdCA9IGRzdFs6bGVuKHNyYyldIC8vIGVsaW1pbmF0ZSBib3VuZHMgY2hlY2sgZnJvbSBsb29wCglmb3IgaywgdiA6PSByYW5nZSBzcmMgewoJCWkgKz0gMQoJCXggOj0gYy5zW2ldCgkJaiArPSB1aW50OCh4KQoJCXkgOj0gYy5zW2pdCgkJYy5zW2ldLCBjLnNbal0gPSB5LCB4CgkJZHN0W2tdID0gdiBeIHVpbnQ4KGMuc1t1aW50OCh4K3kpXSkKCX0KCWMuaSwgYy5qID0gaSwgagp9Ci8vIENvcHlyaWdodCAyMDE5IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgovLyBQYWNrYWdlIHRlcm0gcHJvdmlkZXMgc3VwcG9ydCBmdW5jdGlvbnMgZm9yIGRlYWxpbmcgd2l0aCB0ZXJtaW5hbHMsIGFzCi8vIGNvbW1vbmx5IGZvdW5kIG9uIFVOSVggc3lzdGVtcy4KLy8KLy8gUHV0dGluZyBhIHRlcm1pbmFsIGludG8gcmF3IG1vZGUgaXMgdGhlIG1vc3QgY29tbW9uIHJlcXVpcmVtZW50OgovLwovLwlvbGRTdGF0ZSwgZXJyIDo9IHRlcm0uTWFrZVJhdyhpbnQob3MuU3RkaW4uRmQoKSkpCi8vCWlmIGVyciAhPSBuaWwgewovLwkgICAgICAgIHBhbmljKGVycikKLy8JfQovLwlkZWZlciB0ZXJtLlJlc3RvcmUoaW50KG9zLlN0ZGluLkZkKCkpLCBvbGRTdGF0ZSkKLy8KLy8gTm90ZSB0aGF0IG9uIG5vbi1Vbml4IHN5c3RlbXMgb3MuU3RkaW4uRmQoKSBtYXkgbm90IGJlIDAuCnBhY2thZ2UgdGVybQoKLy8gU3RhdGUgYwkJeyJfX0ZSQU1FX0VORF9fIiwgMSwgMCwgZmFsc2UsIDAsIDE3LCA0MTk1OTY4LCAwLCAiIiwgIiJ9LAoJCQl7Il9fSkNSX0VORF9fIiwgMSwgMCwgZmFsc2UsIDAsIDIwLCA2MjkzMTYwLCAwLCAiIiwgIiJ9LAoJCQl7Il9fZG9fZ2xvYmFsX2N0b3JzX2F1eCIsIDIsIDAsIGZhbHNlLCAwLCAxMywgNDE5NTY4MCwgMCwgIiIsICIifSwKCQkJeyJpbml0ZmluaS5jIiwgNCwgMCwgZmFsc2UsIDAsIDY1NTIxLCAwLCAwLCAiIiwgIiJ9LAoJCQl7ImhlbGxvLmMiLCA0LCAwLCBmYWxzZSwgMCwgNjU1MjEsIDAsIDAsICIiLCAiIn0sCgkJCXsiX0dMT0JBTF9PRkZTRVRfVEFCTEVfIiwgMSwgMiwgZmFsc2UsIDAsIDIzLCA2MjkzNTkyLCAwLCAiIiwgIiJ9LAoJCQl7Il9faW5pdF9hcnJheV9lbmQiLCAwLCAyLCBmYWxzZSwgMCwgMTgsIDYyOTMxMjQsIDAsICIiLCAiIn0sCgkJCXsiX19pbml0X2FycmF5X3N0YXJ0IiwgMCwgMiwgZmFsc2UsIDAsIDE4LCA2MjkzMTI0LCAwLCAiIiwgIiJ9LAoJCQl7Il9EWU5BTUlDIiwgMSwgMiwgZmFsc2UsIDAsIDIxLCA2MjkzMTY4LCAwLCAiIiwgIiJ9LAoJCQl7ImRhdGFfc3RhcnQiLCAzMiwgMCwgZmFsc2UsIDAsIDI0LCA2MjkzNjMyLCAwLCAiIiwgIiJ9LAoJCQl7Il9fbGliY19jc3VfZmluaSIsIDE4LCAwLCBmYWxzZSwgMCwgMTMsIDQxOTU1MjAsIDIsICIiLCAiIn0sCgkJCXsiX3N0YXJ0IiwgMTgsIDAsIGZhbHNlLCAwLCAxMywgNDE5NTI5NiwgMCwgIiIsICIifSwKCQkJeyJfX2dtb25fc3RhcnRfXyIsIDMyLCAwLCBmYWxzZSwgMCwgMCwgMCwgMCwgIiIsICIifSwKCQkJeyJfSnZfUmVnaXN0ZXJDbGFzc2VzIiwgMzIsIDAsIGZhbHNlLCAwLCAwLCAwLCAwLCAiIiwgIiJ9LAoJCQl7InB1dHNAQEdMSUJDXzIuMi41IiwgMTgsIDAsIGZhbHNlLCAwLCAwLCAwLCAzOTYsICIiLCAiIn0sCgkJCXsiX2ZpbmkiLCAxOCwgMCwgZmFsc2UsIDAsIDE0LCA0MTk1NzMyLCAwLCAiIiwgIiJ9LAoJCQl7Il9fbGliY19zdGFydF9tYWluQEBHTElCQ18yLjIuNSIsIDE4LCAwLCBmYWxzZSwgMCwgMCwgMCwgNDUwLCAiIiwgIiJ9LAoJCQl7Il9JT19zdGRpbl91c2VkIiwgMTcsIDAsIGZhbHNlLCAwLCAxNSwgNDE5NTc0OCwgNCwgIiIsICIifSwKCQkJeyJfX2RhdGFfc3RhcnQiLCAxNiwgMCwgZmFsc2UsIDAsIDI0LCA2MjkzNjMyLCAwLCAiIiwgIiJ9LAoJCQl7Il9fZHNvX2hhbmRsZSIsIDE3LCAyLCBmYWxzZSwgMCwgMjQsIDYyOTM2NDAsIDAsICIiLCAiIn0sCgkJCXsiX19saWJjX2NzdV9pbml0IiwgMTgsIDAsIGZhbHNlLCAwLCAxMywgNDE5NTUzNiwgMTM3LCAiIiwgIiJ9LAoJCQl7Il9fYnNzX3N0YXJ0IiwgMTYsIDAsIGZhbHNlLCAwLCA2NTUyMSwgNjI5MzY1NiwgMCwgIiIsICIifSwKCQkJeyJfZW5kIiwgMTYsIDAsIGZhbHNlLCAwLCA2NTUyMSwgNjI5MzY2NCwgMCwgIiIsICIifSwKCQkJeyJfZWRhdGEiLCAxNiwgMCwgZmFsc2UsIDAsIDY1NTIxLCA2MjkzNjU2LCAwLCAiIiwgIiJ9LAoJCQl7Im1haW4iLCAxOCwgMCwgZmFsc2UsIDAsIDEzLCA0MTk1NDgwLCAyNywgIiIsICIifSwKCQkJeyJfaW5pdCIsIDE4LCAwLCBmYWxzZSwgMCwgMTEsIDQxOTUyMjQsIDAsICIiLCAiIn0sCgkJfSwKCX0sCgl7CgkJInRlc3RkYXRhL2hlbGxvLXdvcmxkLWNvcmUuZ3oiLAoJCUZpbGVIZWFkZXJ7RUxGQ0xBU1M2NCwgRUxGREFUQTJMU0IsIEVWX0NVUlJFTlQsIEVMRk9TQUJJX05PTkUsIDB4MCwgYmluYXJ5LkxpdHRsZUVuZGlhbiwgRVRfQ09SRSwgRU1fWDg2XzY0LCAweDB9LAoJCVtdU2VjdGlvbkhlYWRlcnt9LAoJCVtdUHJvZ0hlYWRlcnsKCQkJe1R5cGU6IFBUX05PVEUsIEZsYWdzOiAweDAsIE9mZjogMHgzZjgsIFZhZGRyOiAweDAsIFBhZGRyOiAweDAsIEZpbGVzejogMHg4YWMsIE1lbXN6OiAweDAsIEFsaWduOiAweDB9LAoJCQl7VHlwZTogUFRfTE9BRCwgRmxhZ3M6IFBGX1ggKyBQRl9SLCBPZmY6IDB4MTAwMCwgVmFkZHI6IDB4NDAwMDB4IHx8IChqcyAmJiB3YXNtKSB8fCB3YXNpcDEKCnBhY2thZ2UgcG9sbAoKaW1wb3J0ICgKCSJpbnRlcm5hbC9zdHJjb252IgoJImludGVybmFsL3N5c2NhbGwvdW5peCIKCSJpbyIKCSJzeW5jL2F0b21pYyIKCSJzeXNjYWxsIgopCgovLyBGRCBpcyBhIGZpbGUgZGVzY3JpcHRvci4gVGhlIG5ldCBhbmQgb3MgcGFja2FnZXMgdXNlIHRoaXMgdHlwZSBhcyBhCi8vIGZpZWxkIG9mIGEgbGFyZ2VyIHR5cGUgcmVwcmVzZW50aW5nIGEgbmV0d29yayBjb25uZWN0aW9uIG9yIE9TIGZpbGUuCnR5cGUgRkQgc3RydWN0IHsKCS8vIExvY2sgc3lzZmQgYW5kIHNlcmlhbGl6ZSBhY2Nlc3MgdG8gUmVhZCBhbmQgV3JpdGUgbWV0aG9kcy4KCWZkbXUgZmRNdXRleAoKCS8vIFN5c3RlbSBmaWxlIGRlc2NyaXB0b3IuIEltbXV0YWJsZSB1bnRpbCBDbG9zZS4KCVN5c2ZkIGludAoKCS8vIFBsYXRmb3JtIGRlcGVuZGVudCBzdGF0ZSBvZiB0aGUgZmlsZSBkZXNjcmlwdG9yLgoJU3lzRmlsZQoKCS8vIEkvTyBwb2xsZXIuCglwZCBwb2xsRGVzYwoKCS8vIFNlbWFwaG9yZSBzaWduYWxlZCB3aGVuIGZpbGUgaXMgY2xvc2VkLgoJY3NlbWEgdWludDMyCgoJLy8gTm9uLXplcm8gaWYgdGhpcyBmaWxlIGhhcyBiZWVuIHNldCB0byBibG9ja2luZyBtb2RlLgoJaXNCbG9ja2luZyB1aW50MzIKCgkvLyBXaGV0aGVyIHRoaXMgaXMgYSBzdHJlYW1pbmcgZGVzY3JpcHRvciwgYXMgb3Bwb3NlZCB0byBhCgkvLyBwYWNrZXQtYmFzZWQgZGVzY3JpcHRvciBsaWtlIGEgVURQIHNvY2tldC4gSW1tdXRhYmxlLgoJSXNTdHJlYW0gYm9vbAoKCS8vIFdoZXRoZXIgYSB6ZXJvIGJ5dGUgcmVhZCBpbmRpY2F0ZXMgRU9GLiBUaGlzIGlzIGZhbHNlIGZvciBhCgkvLyBtZXNzYWdlIGJhc2VkIHNvY2tldCBjb25uZWN0aW9uLgoJWmVyb1JlYWRJc0VPRiBib29sCgoJLy8gV2hldGhlciB0aGlzIGlzIGEgZmlsZSByYXRoZXIgdGhhbiBhIG5ldHdvcmsgc29ja2V0LgoJaXNGaWxlIGJvb2wKfQoKLy8gSW5pdCBpbml0aWFsaXplcyB0aGUgRkQuIFRoZSBTeXNmZCBmaWVsZCBzaG91bGQgYWxyZWFkeSBiZSBzZXQuCi8vIFRoaXMgY2FuIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBvbiBhIHNpbmdsZSBGRC4KLy8gVGhlIG5ldCBhcmd1bWVudCBpcyBhIG5ldHdvcmsgbmFtZSBmcm9tIHRoZSBuZXQgcGFja2FnZSAoZS5nLiwgInRjcCIpLAovLyBvciAiZmlsZSIuCi8vIFNldCBwb2xsYWJsZSB0byB0cnVlIGlmIGZkIHNob3VsZCBiZSBtYW5hZ2VkIGJ5IHJ1bnRpbWUgbmV0cG9sbC4KZnVuYyAoZmQgKkZEKSBJbml0KG5ldCBzdHJpbmcsIHBvbGxhYmxlIGJvb2wpIGVycm9yIHsKCWZkLlN5c0ZpbGUuaW5pdCgpCgoJLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSBhYm91dCB0aGUgdmFyaW91cyBuZXR3b3JrIHR5cGVzLgoJaWYgbmV0ID09ICJmaWxlIiB7CgkJZmQuaXNGaWxlID0gdHJ1ZQoJfQoJaWYgIXBvbGxhYmxlIHsKCQlmZC5pc0Jsb2NraW5nID0gMQoJCXJldHVybiBuaWwKCX0KCWVyciA6PSBmZC5wZC5pbml0KGZkKQoJaWYgZXJyICE9IG5pbCB7CgkJLy8gSWYgd2UgY291bGQgbm90IGluaXRpYWxpemUgdGhlIHJ1bnRpbWUgcG9sbGVyLAoJCS8vIGFzc3VtZSB3ZSBhcmUgdXNpbmcgYmxvY2tpbmcgbW9kZS4KCQlmZC5pc0Jsb2NraW5nID0gMQoJfQoJcmV0dXJuIGVycgp9CgovLyBEZXN0cm95IGNsb3NlcyB0aGUgZmlsZSBkZXNjcmlwdG9yLiBUaGlzIGlzIGNhbGxlZCB3aGVuIHRoZXJlIGFyZQovLyBubyByZW1haW5pbmcgcmVmZXJlbmNlcy4KZnVuYyAoZmQgKkZEKSBkZXN0cm95KCkgZXJyb3IgewoJLy8gUG9sbGVyIG1heSB3YW50IHRvIHVucmVnaXN0ZXIgZmQgaW4gcmVhZGluZXNzIG5vdGlmaWNhdGlvbiBtZWNoYW5pc20sCgkvLyBzbyB0aGlzIG11c3QgYmUgZXhlY3V0ZWQgYmVmb3JlIENsb3NlRnVuYy4KCWZkLnBkLmNsb3NlKCkKCgllcnIgOj0gZmQuU3lzRmlsZS5kZXN0cm95KGZkLlN5c2ZkKQoKSm9pbih3b3JrLCAiZ29wYXRoIikKCW11c3Qocy5TZXRlbnYoIkdPUEFUSCIsIGdvcGF0aCkpCglnb3BhdGhTcmMgOj0gZmlsZXBhdGguSm9pbihnb3BhdGgsICJzcmMiKQoJbXVzdChvcy5Na2RpckFsbChnb3BhdGhTcmMsIDA3NzcpKQoJbXVzdChzLkNoZGlyKGdvcGF0aFNyYykpCglyZXR1cm4gdGVsZW1ldHJ5RGlyCn0KCmZ1bmMgc2NyaXB0RW52KHNydiAqdmNzdGVzdC5TZXJ2ZXIsIHNydkNlcnRGaWxlIHN0cmluZykgKFtdc3RyaW5nLCBlcnJvcikgewoJaHR0cFVSTCwgZXJyIDo9IHVybC5QYXJzZShzcnYuSFRUUC5VUkwpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWh0dHBzVVJMLCBlcnIgOj0gdXJsLlBhcnNlKHNydi5IVFRQUy5VUkwpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWVudiA6PSBbXXN0cmluZ3sKCQlwYXRoRW52TmFtZSgpICsgIj0iICsgdGVzdEJpbiArIHN0cmluZyhmaWxlcGF0aC5MaXN0U2VwYXJhdG9yKSArIG9zLkdldGVudihwYXRoRW52TmFtZSgpKSwKCQlob21lRW52TmFtZSgpICsgIj0vbm8taG9tZSIsCgkJIkNDQUNIRV9ESVNBQkxFPTEiLCAvLyBjY2FjaGUgYnJlYWtzIHdpdGggbm9uLWV4aXN0ZW50IEhPTUUKCQkiR09BUkNIPSIgKyBydW50aW1lLkdPQVJDSCwKCQkiVEVTVEdPX0dPSE9TVEFSQ0g9IiArIGdvSG9zdEFyY2gsCgkJIkdPQ0FDSEU9IiArIHRlc3RHT0NBQ0hFLAoJCSJHT0NPVkVSRElSPSIgKyBvcy5HZXRlbnYoIkdPQ09WRVJESVIiKSwKCQkiR09ERUJVRz0iICsgb3MuR2V0ZW52KCJHT0RFQlVHIiksCgkJIkdPRVhFPSIgKyBjZmcuRXhlU3VmZml4LAoJCSJHT0VYUEVSSU1FTlQ9IiArIG9zLkdldGVudigiR09FWFBFUklNRU5UIiksCgkJIkdPT1M9IiArIHJ1bnRpbWUuR09PUywKCQkiVEVTVEdPX0dPSE9TVE9TPSIgKyBnb0hvc3RPUywKCQkiR09QUk9YWT0iICsgcHJveHlVUkwsCgkJIkdPUFJJVkFURT0iLAoJCSJHT1JPT1Q9IiArIHRlc3RHT1JPT1QsCgkJIkdPVFJBQ0VCQUNLPXN5c3RlbSIsCgkJIlRFU1RHT05FVFdPUks9cGFuaWMiLCAvLyBhbGxvdyBvbmx5IGxvY2FsIGNvbm5lY3Rpb25zIGJ5IGRlZmF1bHQ7IHRoZSBbbmV0XSBjb25kaXRpb24gcmVzZXRzIHRoaXMKCQkiVEVTVEdPX0dPUk9PVD0iICsgdGVzdEdPUk9PVCwKCQkiVEVTVEdPX0VYRT0iICsgdGVzdEdvLAoJCSJURVNUR09fVkNTVEVTVF9IT1NUPSIgKyBodHRwVVJMLkhvc3QsCgkJIlRFU1RHT19WQ1NURVNUX1RMU19IT1NUPSIgKyBodHRwc1VSTC5Ib3N0LAoJCSJURVNUR09fVkNTVEVTVF9DRVJUPSIgKyBzcnZDZXJ0RmlsZSwKCQkiVEVTVEdPTkVUV09SSz1wYW5pYyIsIC8vIGNsZWFyZWQgYnkgdGhlIFtuZXRdIGNvbmRpdGlvbgoJCSJHT1NVTURCPSIgKyB0ZXN0U3VtREJWZXJpZmllcktleSwKCQkiR09OT1BST1hZPSIsCgkJIkdPTk9TVU1EQj0iLAoJCSJHT1ZDUz0qOmFsbCIsCgkJImRldm51bGw9IiArIG9zLkRldk51bGwsCgkJImdvdmVyc2lvbj0iICsgZ292ZXIuTG9jYWwoKSwKCQkiQ01ER09fVEVTVF9SVU5fTUFJTj10cnVlIiwKCQkiSEdSQ1BBVEg9IiwKCQkiR09UT09MQ0hBSU49YXV0byIsCgkJIm5ld2xpbmU9XG4iLAoJfQoKCWlmIHRlc3RlbnYuQnVpbGRlcigpICE9ICIiIHx8IG9zLkdldGVudigiR0lUX1RSQUNFX0NVUkwiKSA9PSAiMSIgewoJCS8vIFRvIGhlbHAgZGlhZ25vc2UgaHR0cHM6Ly9nby5kZXYvaXNzdWUvNTI1NDUsCgkJLy8gZW5hYmxlIHRyYWNpbmcgZm9yIEdpdCBIVFRQUyByZXF1ZXN0cy4KCQllbnYgPSBhcHBlbmQoZW52LAoJCQkiR0lUX1RSQUNFX0NVUkw9MSIsCgkJCSJHSVRfVFJBQ0VfQ1VSTF9OT19EQVRBPTEiLAoJCQkiR0lUX1JFREFDVF9DT09LSUVTPW8sU1NPLEdTU09fVWJlcnByb3h5IikKCX0KCWlmIHRlc3RpbmcuU2hvcnQoKSB7CgkJLy8gVkNTIGNvbW1hbmRzIGFyZSBhbHdheXMgc29tZXdoYXQgc2xvdzogdGhleSBlaXRocm4gcHJpdmF0ZUtleUZyb21GSVBTKGN1cnZlLCBwcml2YXRlS2V5KQp9CgovLyBTaWduQVNOMSBzaWducyBhIGhhc2ggKHdoaWNoIHNob3VsZCBiZSB0aGUgcmVzdWx0IG9mIGhhc2hpbmcgYSBsYXJnZXIgbWVzc2FnZSkKLy8gdXNpbmcgdGhlIHByaXZhdGUga2V5LCBwcml2LiBJZiB0aGUgaGFzaCBpcyBsb25nZXIgdGhhbiB0aGUgYml0LWxlbmd0aCBvZiB0aGUKLy8gcHJpdmF0ZSBrZXkncyBjdXJ2ZSBvcmRlciwgdGhlIGhhc2ggd2lsbCBiZSB0cnVuY2F0ZWQgdG8gdGhhdCBsZW5ndGguIEl0Ci8vIHJldHVybnMgdGhlIEFTTi4xIGVuY29kZWQgc2lnbmF0dXJlLgovLwovLyBUaGUgc2lnbmF0dXJlIGlzIHJhbmRvbWl6ZWQuIFNpbmNlIEdvIDEuMjYsIGEgc2VjdXJlIHNvdXJjZSBvZiByYW5kb20gYnl0ZXMKLy8gaXMgYWx3YXlzIHVzZWQsIGFuZCB0aGUgUmVhZGVyIGlzIGlnbm9yZWQgdW5sZXNzIEdPREVCVUc9Y3J5cHRvY3VzdG9tcmFuZD0xCi8vIGlzIHNldC4gVGhpcyBzZXR0aW5nIHdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSBHbyByZWxlYXNlLiBJbnN0ZWFkLCB1c2UKLy8gW3Rlc3RpbmcvY3J5cHRvdGVzdC5TZXRHbG9iYWxSYW5kb21dLgpmdW5jIFNpZ25BU04xKHIgaW8uUmVhZGVyLCBwcml2ICpQcml2YXRlS2V5LCBoYXNoIFtdYnl0ZSkgKFtdYnl0ZSwgZXJyb3IpIHsKCWlmIGJvcmluZy5FbmFibGVkICYmIHJhbmQuSXNEZWZhdWx0UmVhZGVyKHIpIHsKCQliLCBlcnIgOj0gYm9yaW5nUHJpdmF0ZUtleShwcml2KQoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gbmlsLCBlcnIKCQl9CgkJcmV0dXJuIGJvcmluZy5TaWduTWFyc2hhbEVDRFNBKGIsIGhhc2gpCgl9Cglib3JpbmcuVW5yZWFjaGFibGVFeGNlcHRUZXN0cygpCgoJciA9IHJhbmQuQ3VzdG9tUmVhZGVyKHIpCgoJc3dpdGNoIHByaXYuQ3VydmUuUGFyYW1zKCkgewoJY2FzZSBlbGxpcHRpYy5QMjI0KCkuUGFyYW1zKCk6CgkJcmV0dXJuIHNpZ25GSVBTKGVjZHNhLlAyMjQoKSwgcHJpdiwgciwgaGFzaCkKCWNhc2UgZWxsaXB0aWMuUDI1NigpLlBhcmFtcygpOgoJCXJldHVybiBzaWduRklQUyhlY2RzYS5QMjU2KCksIHByaXYsIHIsIGhhc2gpCgljYXNlIGVsbGlwdGljLlAzODQoKS5QYXJhbXMoKToKCQlyZXR1cm4gc2lnbkZJUFMoZWNkc2EuUDM4NCgpLCBwcml2LCByLCBoYXNoKQoJY2FzZSBlbGxpcHRpYy5QNTIxKCkuUGFyYW1zKCk6CgkJcmV0dXJuIHNpZ25GSVBTKGVjZHNhLlA1MjEoKSwgcHJpdiwgciwgaGFzaCkKCWRlZmF1bHQ6CgkJcmV0dXJuIHNpZ25MZWdhY3kocHJpdiwgciwgaGFzaCkKCX0KfQoKZnVuYyBzaWduRklQU1tQIGVjZHNhLlBvaW50W1BdXShjICplY2RzYS5DdXJ2ZVtQXSwgcHJpdiAqUHJpdmF0ZUtleSwgcmFuZCBpby5SZWFkZXIsIGhhc2ggW11ieXRlKSAoW11ieXRlLCBlcnJvcikgewoJaWYgZmlwczE0MG9ubHkuRW5mb3JjZWQoKSAmJiAhZmlwczE0MG9ubHkuQXBwcm92ZWRSYW5kb21SZWFkZXIocmFuZCkgewoJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImNyeXB0by9lY2RzYTogb25seSBjcnlwdG8vcmFuZC5SZWFkZXIgaXMgYWxsb3dlZCBpbiBGSVBTIDE0MC1vbmx5IG1vZGUiKQoJfQoJaywgZXJyIDo9IHByaXZhdGVLZXlUb0ZJUFMoYywgcHJpdikKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJLy8gQWx3YXlzIHVzaW5nIFNIQS01MTIgaW5zdGVhZCBvZiB0aGUgaGFzaCB0aGF0IGNvbXB1dGVkIGhhc2ggaXMKCS8vIHRlY2huaWNhbGx5IGEgdmlvbGF0aW9uIG9mIGRyYWZ0LWlydGYtY2ZyZy1kZXQtc2lncy13aXRoLW5vaXNlLTA0IGJ1dCBpbgoJLy8gb3VyIEFQSSB3ZSBkb24ndCBnZXQgdG8ga25vdyB3aGF0IGl0IHdhcywgYW5kIHRoaXMgaGFzIG5vIHNlY3VyaXR5IGltcGFjdC4KCXNpZywgZXJyIDo9IGVjZHNhLlNpZ24oYywgc2hhNTEyLk5ldywgaywgcmFuZCwgaGFzaCkKCWljdCB0YWcuCi8vIFRoZXJlIG1heSBiZSBhbiAiQW55IGJvb2wiIGZpZWxkLCB3aGljaCB3aWxsIGJlIHNldCBpZiBhbnkgZGVidWcgZmxhZ3MgYXJlIHNldC4KLy8KLy8gVGhlIHJldHVybmVkIGZsYWcgdGFrZXMgYSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBzZXR0aW5ncy4KLy8gRWFjaCBzZXR0aW5nIGlzIG5hbWU9dmFsdWU7IGZvciBpbnRzLCBuYW1lIGlzIHNob3J0IGZvciBuYW1lPTEuCi8vCi8vIElmIGRlYnVnU1NBIGlzIG5vbi1uaWwsIGFueSBkZWJ1ZyBmbGFncyBvZiB0aGUgZm9ybSBzc2EvLi4uIHdpbGwgYmUKLy8gcGFzc2VkIHRvIGRlYnVnU1NBIGZvciBwcm9jZXNzaW5nLgpmdW5jIE5ld0RlYnVnRmxhZyhkZWJ1ZyBhbnksIGRlYnVnU1NBIERlYnVnU1NBKSAqRGVidWdGbGFnIHsKCWZsYWcgOj0gJkRlYnVnRmxhZ3sKCQl0YWI6ICAgICAgbWFrZShtYXBbc3RyaW5nXWRlYnVnRmllbGQpLAoJCWRlYnVnU1NBOiBkZWJ1Z1NTQSwKCX0KCgl2IDo9IHJlZmxlY3QuVmFsdWVPZihkZWJ1ZykuRWxlbSgpCgl0IDo9IHYuVHlwZSgpCglmb3IgaSA6PSAwOyBpIDwgdC5OdW1GaWVsZCgpOyBpKysgewoJCWYgOj0gdC5GaWVsZChpKQoJCXB0ciA6PSB2LkZpZWxkKGkpLkFkZHIoKS5JbnRlcmZhY2UoKQoJCWlmIGYuTmFtZSA9PSAiQ29uY3VycmVudE9rIiB7CgkJCXN3aXRjaCBwdHIgOj0gcHRyLih0eXBlKSB7CgkJCWRlZmF1bHQ6CgkJCQlwYW5pYygiZGVidWcuQ29uY3VycmVudE9rIG11c3QgaGF2ZSB0eXBlIGJvb2wiKQoJCQljYXNlICpib29sOgoJCQkJZmxhZy5jb25jdXJyZW50T2sgPSBwdHIKCQkJfQoJCQljb250aW51ZQoJCX0KCQluYW1lIDo9IHN0cmluZ3MuVG9Mb3dlcihmLk5hbWUpCgkJaGVscCA6PSBmLlRhZy5HZXQoImhlbHAiKQoJCWlmIGhlbHAgPT0gIiIgewoJCQlwYW5pYyhmbXQuU3ByaW50ZigiZGVidWcuJXMgaXMgbWlzc2luZyBoZWxwIHRleHQiLCBmLk5hbWUpKQoJCX0KCQljb25jdXJyZW50IDo9IGYuVGFnLkdldCgiY29uY3VycmVudCIpCgoJCXN3aXRjaCBwdHIuKHR5cGUpIHsKCQlkZWZhdWx0OgoJCQlwYW5pYyhmbXQuU3ByaW50ZigiZGVidWcuJXMgaGFzIGludmFsaWQgdHlwZSAldiAobXVzdCBiZSBpbnQsIHN0cmluZywgb3IgKmJpc2VjdC5NYXRjaGVyKSIsIGYuTmFtZSwgZi5UeXBlKSkKCQljYXNlICppbnQsICpzdHJpbmcsICoqYmlzZWN0Lk1hdGNoZXI6CgkJCS8vIG9rCgkJfQoJCWZsYWcudGFiW25hbWVdID0gZGVidWdGaWVsZHtuYW1lLCBoZWxwLCBjb25jdXJyZW50ID09ICJvayIsIHB0cn0KCX0KCglyZXR1cm4gZmxhZwp9CgpmdW5jIChmICpEZWJ1Z0ZsYWcpIFNldChkZWJ1Z3N0ciBzdHJpbmcpIGVycm9yIHsKCWlmIGRlYnVnc3RyID09ICIiIHsKCQlyZXR1cm4gbmlsCgl9Cglmb3IgbmFtZSA6PSByYW5nZSBzdHJpbmdzLlNwbGl0U2VxKGRlYnVnc3RyLCAiLCIpIHsKCQlpZiBuYW1lID09ICIiIHsKCQkJY29udGludWUKCQl9CgkJLy8gZGlzcGxheSBoZWxwIGFib3V0IHRoZSBkZWJ1ZyBvcHRpb24gaXRzZWxmIGFuZCBxdWl0CgkJaWYgbmFtZSA9PSAiaGVscCIgewoJCQlmbXQuUHJpbnQoZGVidWdIZWxwSGVhZGVyKQoJCQltYXhMZW4sIG5hbWVzIDo9IDAsIFtdc3RyaW5ne30KCQkJaWYgZi5kZWJ1Z1NTQSAhPSBuaWwgewoJCQkJbWF4TGVuID0gbGVuKCJzc2EvaGVscCIpCgkJCX0KCQkJZm9yIG5hbWUgOj0gcmFuZ2UgZi50YWIgewoJCQkJaWYgbGVuKG5hbWUpID4gbWF4TGVuIHsKCQkJCQltYXhMZW4gPSBsZW4obmFtZSkKCQkJCX0KCQkJCW5hbWVzID0gYXBwZW5kKG5hbWVzLCBuYW1lKQoJCQl9CgkJCXNvcnQuU3RyaW5ncyhuYW1lcykKCQkJLy8gSW5kZW50IG11bHRpLWxpbmUgaGVscCBtZXNzYWdlcy4KCQkJbmwgOj0gZm10LlNwcmludGYoIlxuXHQlLSpzXHQiLCBtYXhMZW4sICIiKQoJCQlmb3IgXywgbmFtZSA6PSByYW5nZSBuYW1lcyB7CgkJCQloZWxwIDo9IGYudGFiW25hbWVdLmhlbHAKCQkJCWZtbiBsaWJyYXJ5IGZyb20gdmVyc2lvbiB2NyB0byB2OS4KLy8gaHR0cHM6Ly9naXRodWIuY29tL2xsdm0vbGx2bS1wcm9qZWN0L2Jsb2IvbWFpbi9jb21waWxlci1ydC9saWIvYXNhbi9hc2FuX2luaXRfdmVyc2lvbi5oCi8vIFRoaXMgc3RydWN0dXJlIGRlc2NyaWJlcyBhbiBpbnN0cnVtZW50ZWQgZ2xvYmFsIHZhcmlhYmxlLgovLwovLyBUT0RPOiBJZiBhIGxhdGVyIHZlcnNpb24gb2YgdGhlIEFTYW4gbGlicmFyeSBjaGFuZ2VzIF9fYXNhbl9nbG9iYWwgb3IgX19hc2FuX2dsb2JhbF9zb3VyY2VfbG9jYXRpb24KLy8gc3RydWN0dXJlLCB3ZSBuZWVkIHRvIG1ha2UgdGhlIHNhbWUgY2hhbmdlcy4Kc3RydWN0IF9hc2FuX2dsb2JhbCB7Cgl1aW50cHRyX3QgYmVnOwoJdWludHB0cl90IHNpemU7Cgl1aW50cHRyX3Qgc2l6ZV93aXRoX3JlZHpvbmU7Cgljb25zdCBjaGFyICpuYW1lOwoJY29uc3QgY2hhciAqbW9kdWxlX25hbWU7Cgl1aW50cHRyX3QgaGFzX2R5bmFtaWNfaW5pdDsKCXN0cnVjdCBfYXNhbl9nbG9iYWxfc291cmNlX2xvY2F0aW9uICpsb2NhdGlvbjsKCXVpbnRwdHJfdCBvZHJfaW5kaWNhdG9yOwp9OwoKCmV4dGVybiB2b2lkIF9fYXNhbl9yZWdpc3Rlcl9nbG9iYWxzKHZvaWQqLCBsb25nIGludCk7CgovLyBSZWdpc3RlciBnbG9iYWwgdmFyaWFibGVzLgovLyBUaGUgJ2dsb2JhbHMnIGlzIGFuIGFycmF5IG9mIHN0cnVjdHVyZXMgZGVzY3JpYmluZyAnbicgZ2xvYmFscy4Kdm9pZCBfX2FzYW5fcmVnaXN0ZXJfZ2xvYmFsc19nbyh2b2lkICphZGRyLCB1aW50cHRyX3QgbikgewoJc3RydWN0IF9hc2FuX2dsb2JhbCAqZ2xvYmFscyA9IChzdHJ1Y3QgX2FzYW5fZ2xvYmFsICopKGFkZHIpOwoJX19hc2FuX3JlZ2lzdGVyX2dsb2JhbHMoZ2xvYmFscywgbik7Cn0KKi8KaW1wb3J0ICJDIgovLyBta2Vycm9ycy5zaCAtbTY0Ci8vIENvZGUgZ2VuZXJhdGVkIGJ5IHRoZSBjb21tYW5kIGFib3ZlOyBETyBOT1QgRURJVC4KCi8vIENvZGUgZ2VuZXJhdGVkIGJ5IGNtZC9jZ28gLWdvZGVmczsgRE8gTk9UIEVESVQuCi8vIGNnbyAtZ29kZWZzIC0tIC1tNjQgX2NvbnN0LmdvCgpwYWNrYWdlIHN5c2NhbGwKCmNvbnN0ICgKCUFGX0FQUExFVEFMSyAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAKCUFGX0FSUCAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MWMKCUFGX0JMVUVUT09USCAgICAgICAgICAgICAgICAgICAgICA9IDB4MWYKCUFGX0NDSVRUICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YQoJQUZfQ0hBT1MgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1CglBRl9DTlQgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDE1CglBRl9DT0lQICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDE0CglBRl9EQVRBS0lUICAgICAgICAgICAgICAgICAgICAgICAgPSAweDkKCUFGX0RFQ25ldCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YwoJQUZfRExJICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhkCglBRl9FMTY0ICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDFhCglBRl9FQ01BICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgKCUFGX0hZTElOSyAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZgoJQUZfSUVFRTgwMjExICAgICAgICAgICAgICAgICAgICAgID0gMHgyMAoJQUZfSU1QTElOSyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzCglBRl9JTkVUICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIKCUFGX0lORVQ2ICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTgKCUFGX0lQWCAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTcKCUFGX0lTRE4gICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MWEKCUFGX0lTTyAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NwoJQUZfTEFUICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhlCglBRl9MSU5LICBtYXAgaXQgYW5kIG1hcmsgaXQgYXMgdXNlZCBpbW1lZGlhdGVseS4KCXN5c01hcChyZXNlcnZhdGlvbiwgdG90YWxTaXplLCBwLnN5c1N0YXQsICJwYWdlIHN1bW1hcnkiKQoJc3lzVXNlZChyZXNlcnZhdGlvbiwgdG90YWxTaXplLCB0b3RhbFNpemUpCglwLnN1bW1hcnlNYXBwZWRSZWFkeSArPSB0b3RhbFNpemUKCgkvLyBJdGVyYXRlIG92ZXIgdGhlIHJlc2VydmF0aW9uIGFuZCBjdXQgaXQgdXAgaW50byBzbGljZXMuCgkvLwoJLy8gTWFpbnRhaW4gaSBhcyB0aGUgYnl0ZSBvZmZzZXQgZnJvbSByZXNlcnZhdGlvbiB3aGVyZQoJLy8gdGhlIG5ldyBzbGljZSBzaG91bGQgc3RhcnQuCglmb3IgbCwgc2hpZnQgOj0gcmFuZ2UgbGV2ZWxTaGlmdCB7CgkJZW50cmllcyA6PSAxIDw8IChoZWFwQWRkckJpdHMgLSBzaGlmdCkKCgkJLy8gUHV0IHRoaXMgcmVzZXJ2YXRpb24gaW50byBhIHNsaWNlLgoJCXNsIDo9IG5vdEluSGVhcFNsaWNleygqbm90SW5IZWFwKShyZXNlcnZhdGlvbiksIDAsIGVudHJpZXN9CgkJcC5zdW1tYXJ5W2xdID0gKigqW11wYWxsb2NTdW0pKHVuc2FmZS5Qb2ludGVyKCZzbCkpCgoJCXJlc2VydmF0aW9uID0gYWRkKHJlc2VydmF0aW9uLCB1aW50cHRyKGVudHJpZXMpKnBhbGxvY1N1bUJ5dGVzKQoJfQp9CgovLyBTZWUgbXBhZ2VhbGxvY182NGJpdC5nbyBmb3IgZGV0YWlscy4KZnVuYyAocCAqcGFnZUFsbG9jKSBzeXNHcm93KGJhc2UsIGxpbWl0IHVpbnRwdHIpIHsKCWlmIGJhc2UlcGFsbG9jQ2h1bmtCeXRlcyAhPSAwIHx8IGxpbWl0JXBhbGxvY0NodW5rQnl0ZXMgIT0gMCB7CgkJcHJpbnQoInJ1bnRpbWU6IGJhc2UgPSAiLCBoZXgoYmFzZSksICIsIGxpbWl0ID0gIiwgaGV4KGxpbWl0KSwgIlxuIikKCQl0aHJvdygic3lzR3JvdyBib3VuZHMgbm90IGFsaWduZWQgdG8gcGFsbG9jQ2h1bmtCeXRlcyIpCgl9CgoJLy8gV2FsayB1cCB0aGUgdHJlZSBhbmQgdXBkYXRlIHRoZSBzdW1tYXJ5IHNsaWNlcy4KCWZvciBsIDo9IGxlbihwLnN1bW1hcnkpIC0gMTsgbCA+PSAwOyBsLS0gewoJCS8vIEZpZ3VyZSBvdXQgd2hhdCBwYXJ0IG9mIHRoZSBzdW1tYXJ5IGFycmF5IHRoaXMgbmV3IGFkZHJlc3Mgc3BhY2UgbmVlZHMuCgkJLy8gTm90ZSB0aGF0IHdlIG5lZWQgdG8gYWxpZ24gdGhlIHJhbmdlcyB0byB0aGUgYmxvY2sgd2lkdGggKDE8PGxldmVsQml0c1tsXSkKCQkvLyBhdCB0aGlzIGxldmVsIGJlY2F1c2UgdGhlIGZ1bGwgYmxvY2sgaXMgbmVlZGVkIHRvIGNvbXB1dGUgdGhlIHN1bW1hcnkgZm9yCgkJLy8gdGhlIG5leHQgbGV2ZWwuCgkJbG8sIGhpIDo9IGFkZHJzVG9TdW1tYXJ5UmFuZ2UobCwgYmFzZSwgbGltaXQpCgkJXywgaGkgPSBibG9ja0FsaWduU3VtbWFyeVJhbmdlKGwsIGxvLCBoaSkKCQlpZiBoaSA+IGxlbihwLnN1bW1hcnlbbF0pIHsKCQkJcC5zdW1tYXJ5W2xdID0gcC5zdW1tYXJ5W2xdWzpoaV0KCQl9Cgl9Cn0KCi8vIHN5c0luaXQgaW5pdGlhbGl6ZXMgdGhlIHNjYXZlbmdlSW5kZXgnIGNodW5rcyBhcnJheS4KLy8KLy8gUmV0dXJucyB0aGUgYW1vdW50IG9mIG1lbW9yeSBhZGRlZCB0byBzeXNTdGF0LgpmdW5jIChzICpzY2F2ZW5nZUluZGV4KSBzeXNJbml0KHRlc3QgYm9vbCwgc3lzU3RhdCAqc3lzTWVtU3RhdCkgKG1hcHBlZFJlYWR5IHVpbnRwdHIpIHsKCWlmIHRlc3QgewoJCS8vIFNldCB1cCB0aGUgc2NhdmVuZ2UgaW5kZXggdmlhIHN5c0FsbG9jIHNvIHRoZSB0ZXN0IGNhbiBmcmVlIGl0IGxhdGVyLgoJCXNjYXZJbmRleFNpemUgOj0gdWludHB0cihsZW4oc2NhdmVuZ2VJbmRleEFycmF5KSkgKiB1bnNhZmUuU2l6ZW9mKGF0b21pY1NjYXZDaHVua0RhdGF7fSkKCQlzLmNodW5rcyA9ICgoKlsoMSA8PCBoZWFwQWRkckJpdHMpIC8gcGFsbG9jQ2h1bmtCeXRlc11hdG9taWNTY2F2Q2h1bmtEYXRhKShzeXNBbGxvYyhzY2F2SW5kZXhTaXplLCBzeXNTdGF0LCB2bWFOYW1lUGFnZUFsbG9jSW5kZXgpKSlbOl0KCQltYXBwZTB4YwoJQ1RMX05FVCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglDVExfUVVFUlkgICAgICAgICAgICAgICAgICAgICAgICAgPSAtMHgyCglESU9DQlNGTFVTSCAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMDA2NDc4CglETFRfQTQyOSAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGI4CglETFRfQTY1M19JQ00gICAgICAgICAgICAgICAgICAgICAgPSAweGI5CglETFRfQUlST05FVF9IRUFERVIgICAgICAgICAgICAgICAgPSAweDc4CglETFRfQU9TICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGRlCglETFRfQVBQTEVfSVBfT1ZFUl9JRUVFMTM5NCAgICAgICAgPSAweDhhCglETFRfQVJDTkVUICAgICAgICAgICAgICAgICAgICAgICAgPSAweDcKCURMVF9BUkNORVRfTElOVVggICAgICAgICAgICAgICAgICA9IDB4ODEKCURMVF9BVE1fQ0xJUCAgICAgICAgICAgICAgICAgICAgICA9IDB4MTMKCURMVF9BVE1fUkZDMTQ4MyAgICAgICAgICAgICAgICAgICA9IDB4YgoJRExUX0FVUk9SQSAgICAgICAgICAgICAgICAgICAgICAgID0gMHg3ZQoJRExUX0FYMjUgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzCglETFRfQVgyNV9LSVNTICAgICAgICAgICAgICAgICAgICAgPSAweGNhCglETFRfQkFDTkVUX01TX1RQICAgICAgICAgICAgICAgICAgPSAweGE1CglETFRfQkxVRVRPT1RIX0hDSV9INCAgICAgICAgICAgICAgPSAweGJiCglETFRfQkxVRVRPT1RIX0hDSV9INF9XSVRIX1BIRFIgICAgPSAweGM5CglETFRfQ0FOMjBCICAgICAgICAgICAgICAgICAgICAgICAgPSAweGJlCglETFRfQ0FOX1NPQ0tFVENBTiAgICAgICAgICAgICAgICAgPSAweGUzCglETFRfQ0hBT1MgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDUKCURMVF9DSVNDT19JT1MgICAgICAgICAgICAgICAgICAgICA9IDB4NzYKCURMVF9DX0hETEMgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NjgKCURMVF9DX0hETENfV0lUSF9ESVIgICAgICAgICAgICAgICA9IDB4Y2QKCURMVF9ERUNUICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZGQKCURMVF9ET0NTSVMgICAgICAgICAgICAgICAgICAgICAgICA9IDB4OGYKCURMVF9FQ09ORVQgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NzMKCURMVF9FTjEwTUIgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJRExUX0VOM01CICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglETFRfRU5DICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDZkCglETFRfRVJGICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGM1CglETFRfRVJGX0VUSCAgICAgICAgICAgICAgICAgICAgICAgPSAweGFmCglETFRfRVJGX1BPUyAgICAgICAgICAgICAgICAgICAgICAgPSAweGIwCglETFRfRkNfMiAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGUwCglETFRfRkNfMl9XSVRIX0ZSQU1FX0RFTElNUyAgICAgICAgPSAweGUxCglETFRfRkRESSAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGEKCURMVF9GTEVYUkFZICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZDIKCURMVF9GUkVMQVkgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NmIKCURMVF9GUkVMQVlfV0lUSF9ESVIgICAgICAgICAgICAgICA9IDB4Y2UKCURMVF9HQ09NX1NFUklBTCAgICAgICAgICAgICAgICAgICA9IDB4YWQKCURMVF9HQ09NX1QxRTEgICAgICAgICAgICAgICAgICAgICA9IDB4YWMKCURMVF9HUEZfRiAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YWIKCURMVF9HUEZfVCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YWEKCURMVF9HUFJTX0xMQyAgICAgICAgICAgICAgICAgICAgICA9IDB4YTkKCURMVF9HU01UQVBfQUJJUyAgICAgICAgICAgICAgICAgICA9IDB4ZGEKCURMVF9HU01UQVBfVU0gICAgICAgICAgICAgICAgICAgICA9IDB4ZDkKCURMVF9IRExnIC8vIG9sZCByZXBvcnRzIHRvIHVwbG9hZAoJLy8gcmVsYXRpdmUgbmFtZXMKCXVwbG9hZGVkIG1hcFtzdHJpbmddYm9vbCAvLyByZXBvcnRzIHRoYXQgaGF2ZSBiZWVuIHVwbG9hZGVkCn0KCi8vIGZpbmQgYWxsIHRoZSBmaWxlcyB0aGF0IGxvb2sgbGlrZSBjb3VudGVyIGZpbGVzIG9yIHJlcG9ydHMKLy8gdGhhdCBuZWVkIHRvIGJlIHVwbG9hZGVkLiAoVGhlcmUgbWF5IGJlIHVuZXhwZWN0ZWQgbGVmdG92ZXIgZmlsZXMKLy8gYW5kIHVwbG9hZGluZyBpcyBzdXBwb3NlZCB0byBiZSBpZGVtcG90ZW50LikKZnVuYyAodSAqdXBsb2FkZXIpIGZpbmRXb3JrKCkgd29yayB7Cglsb2NhbGRpciwgdXBsb2FkZGlyIDo9IHUuZGlyLkxvY2FsRGlyKCksIHUuZGlyLlVwbG9hZERpcigpCgl2YXIgYW5zIHdvcmsKCWZpcywgZXJyIDo9IG9zLlJlYWREaXIobG9jYWxkaXIpCglpZiBlcnIgIT0gbmlsIHsKCQl1LmxvZ2dlci5QcmludGYoIkNvdWxkIG5vdCBmaW5kIHdvcms6IGZhaWxlZCB0byByZWFkIGxvY2FsIGRpciAlczogJXYiLCBsb2NhbGRpciwgZXJyKQoJCXJldHVybiBhbnMKCX0KCgltb2RlLCBhc29mIDo9IHUuZGlyLk1vZGUoKQoJdS5sb2dnZXIuUHJpbnRmKCJGaW5kaW5nIHdvcms6IG1vZGUgJXMgYXNvZiAlcyIsIG1vZGUsIGFzb2YpCgoJLy8gY291bnQgZmlsZXMgZW5kIGluIC52MS5jb3VudAoJLy8gcmVwb3J0cyBlbmQgaW4gLmpzb24uIElmIHRoZXkgYXJlIG5vdCB0byBiZSB1cGxvYWRlZCB0aGV5CgkvLyBzdGFydCB3aXRoIGxvY2FsLgoJZm9yIF8sIGZpIDo9IHJhbmdlIGZpcyB7CgkJaWYgc3RyaW5ncy5IYXNTdWZmaXgoZmkuTmFtZSgpLCAiLnYxLmNvdW50IikgewoJCQlmbmFtZSA6PSBmaWxlcGF0aC5Kb2luKGxvY2FsZGlyLCBmaS5OYW1lKCkpCgkJCV8sIGV4cGlyeSwgZXJyIDo9IHUuY291bnRlckRhdGVTcGFuKGZuYW1lKQoJCQlzd2l0Y2ggewoJCQljYXNlIGVyciAhPSBuaWw6CgkJCQl1LmxvZ2dlci5QcmludGYoIkVycm9yIHJlYWRpbmcgZXhwaXJ5IGZvciBjb3VudCBmaWxlICVzOiAldiIsIGZpLk5hbWUoKSwgZXJyKQoJCQljYXNlIGV4cGlyeS5BZnRlcih1LnN0YXJ0VGltZSk6CgkJCQl1LmxvZ2dlci5QcmludGYoIlNraXBwaW5nIGNvdW50IGZpbGUgJXM6IHN0aWxsIGFjdGl2ZSIsIGZpLk5hbWUoKSkKCQkJZGVmYXVsdDoKCQkJCXUubG9nZ2VyLlByaW50ZigiQ29sbGVjdGluZyBjb3VudCBmaWxlICVzIiwgZmkuTmFtZSgpKQoJCQkJYW5zLmNvdW50ZmlsZXMgPSBhcHBlbmQoYW5zLmNvdW50ZmlsZXMsIGZuYW1lKQoJCQl9CgkJfSBlbHNlIGlmIHN0cmluZ3MuSGFzUHJlZml4KGZpLk5hbWUoKSwgImxvY2FsLiIpIHsKCQkJLy8gc2tpcAoJCX0gZWxzZSBpZiBzdHJpbmdzLkhhc1N1ZmZpeChmaS5OYW1lKCksICIuanNvbiIpICYmIG1vZGUgPT0gIm9uIiB7CgkJCS8vIENvbGxlY3QgcmVwb3J0cyB0aGF0IGFyZSByZWFkeSBmb3IgdXBsb2FkLgoJCQlyZXBvcnREYXRlIDo9IHUudXBsb2FkUmVwb3J0RGF0ZShmaS5OYW1lKCkpCgkJCWlmICFhc29mLklzWmVybygpICYmICFyZXBvcnREYXRlLklzWmVybygpIHsKCQkJCS8vIElmIGJvdGggdGhlIG1vZGUgYXNvZiBkYXRlIGFuZCB0aGUgcmVwb3J0IGRhdGUgYXJlIHByZXNlbnQsIGRvIHRoZQoJCQkJLy8gcmlnaHQgdGhpbmcuLi4KCQkJCS8vCgkJCQkvLyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9nb2xhbmcvZ28vaXNzdWVzLzYzMTQyI2lzc3VlY29tbWVudC0xNzM0MDI1MTMwKQoJCQkJaWYgYXNvZi5CZWZvcmUocmVwb3J0RGF0ZSkgewoJCQkJCS8vIE5vdGU6IHNpbmNlIHRoaXMgcmVwb3J0IHdhcyBjcmVhdGVkIGFmdGVyIHRlbGVtZXRyeSB3YXMgZW5hYmxlZCwKCQkJCQkvLyB3ZSBjYW4gb25seSBhc3N1bWUgdGhhdCB0aGUgcHJvY2VzcyB0aGF0IGNyZWF0ZWQgaXQgY2hlY2tlZCB0aGF0CgkJCQkJLy8gdGhlIGNvdW50ZXIgZGF0YSBjb250YWluZWQgdGhlcmVpbiB3YXMgYWwyfS1cZHsyfVRcZHsyfTpcZHsyfTpcZHsyfVwuXGR7M30oWnxbKy1dXGR7Mn06XGR7Mn0pYAoKLy8ganNvblRpbWVSRSBpcyBhIHJlZ2V4cCB0byBtYXRjaCBsb2cgdGltZXN0YW1wcyBmb3IgVGV4dCBoYW5kbGVyLgovLyBUaGlzIGlzIFJGQzMzMzlOYW5vIHdpdGggYW4gYXJiaXRyYXJ5IHN1Yi1zZWNvbmQgcHJlY2lzaW9uLgpjb25zdCBqc29uVGltZVJFID0gYFxkezR9LVxkezJ9LVxkezJ9VFxkezJ9OlxkezJ9OlxkezJ9KFwuXGQrKT8oWnxbKy1dXGR7Mn06XGR7Mn0pYAoKZnVuYyBUZXN0TG9nVGV4dEhhbmRsZXIodCAqdGVzdGluZy5UKSB7CgljdHggOj0gY29udGV4dC5CYWNrZ3JvdW5kKCkKCXZhciBidWYgYnl0ZXMuQnVmZmVyCgoJbCA6PSBOZXcoTmV3VGV4dEhhbmRsZXIoJmJ1ZiwgbmlsKSkKCgljaGVjayA6PSBmdW5jKHdhbnQgc3RyaW5nKSB7CgkJdC5IZWxwZXIoKQoJCWlmIHdhbnQgIT0gIiIgewoJCQl3YW50ID0gInRpbWU9IiArIHRleHRUaW1lUkUgKyAiICIgKyB3YW50CgkJfQoJCWNoZWNrTG9nT3V0cHV0KHQsIGJ1Zi5TdHJpbmcoKSwgd2FudCkKCQlidWYuUmVzZXQoKQoJfQoKCWwuSW5mbygibXNnIiwgImEiLCAxLCAiYiIsIDIpCgljaGVjayhgbGV2ZWw9SU5GTyBtc2c9bXNnIGE9MSBiPTJgKQoKCS8vIEJ5IGRlZmF1bHQsIGRlYnVnIG1lc3NhZ2VzIGFyZSBub3QgcHJpbnRlZC4KCWwuRGVidWcoImJnIiwgSW50KCJhIiwgMSksICJiIiwgMikKCWNoZWNrKCIiKQoKCWwuV2FybigidyIsIER1cmF0aW9uKCJkdXIiLCAzKnRpbWUuU2Vjb25kKSkKCWNoZWNrKGBsZXZlbD1XQVJOIG1zZz13IGR1cj0zc2ApCgoJbC5FcnJvcigiYmFkIiwgImEiLCAxKQoJY2hlY2soYGxldmVsPUVSUk9SIG1zZz1iYWQgYT0xYCkKCglsLkxvZyhjdHgsIExldmVsV2FybisxLCAidyIsIEludCgiYSIsIDEpLCBTdHJpbmcoImIiLCAidHdvIikpCgljaGVjayhgbGV2ZWw9V0FSTlwrMSBtc2c9dyBhPTEgYj10d29gKQoKCWwuTG9nQXR0cnMoY3R4LCBMZXZlbEluZm8rMSwgImEgYiBjIiwgSW50KCJhIiwgMSksIFN0cmluZygiYiIsICJ0d28iKSkKCWNoZWNrKGBsZXZlbD1JTkZPXCsxIG1zZz0iYSBiIGMiIGE9MSBiPXR3b2ApCgoJbC5JbmZvKCJpbmZvIiwgImEiLCBbXUF0dHJ7SW50KCJpIiwgMSl9KQoJY2hlY2soYGxldmVsPUlORk8gbXNnPWluZm8gYS5pPTFgKQoKCWwuSW5mbygiaW5mbyIsICJhIiwgR3JvdXBWYWx1ZShJbnQoImkiLCAxKSkpCgljaGVjayhgbGV2ZWw9SU5GTyBtc2c9aW5mbyBhLmk9MWApCn0KCmZ1bmMgVGVzdENvbm5lY3Rpb25zKHQgKnRlc3RpbmcuVCkgewoJdmFyIGxvZ2J1Ziwgc2xvZ2J1ZiBieXRlcy5CdWZmZXIKCgkvLyBSZXZlcnQgYW55IGNoYW5nZXMgdG8gdGhlIGRlZmF1bHQgbG9nZ2VyLiBUaGlzIGlzIGltcG9ydGFudCBiZWNhdXNlIG90aGVyCgkvLyB0ZXN0cyBtaWdodCBjaGFuZ2UgdGhlIGRlZmF1bHQgbG9nZ2VyIHVzaW5nIFNldERlZmF1bHQuIEFsc28gZW5zdXJlIHdlCgkvLyByZXN0b3JlIHRoZSBkZWZhdWx0IGxvZ2dlciBhdCB0aGUgZW5kIG9mIHRoZSB0ZXN0LgoJY3VycmVudExvZ2dlciA6PSBEZWZhdWx0KCkKCWN1cnJlbnRMb2dXcml0ZXIgOj0gbG9nLldyaXRlcigpCgljdXJyZW50TG9nRmxhZ3MgOj0gbG9nLkZsYWdzKCkKCVNldERlZmF1bHQoTmV3KG5ld0RlZmF1bHRIYW5kbGVyKGxvZ2ludGVybmFsLkRlZmF1bHRPdXRwdXQpKSkKCXQuQ2xlYW51cChmdW5jKCkgewoJCVNldERlZmF1bHQoY3VycmVudExvZ2dlcikKCQlsb2cuU2V0T3V0cHV0KGN1cnJlbnRMb2dXcml0ZXIpCgkJbG9nLlNldEZsYWdzKGN1cnJlbnRMb2dGbGFncykKCX0pCgoJLy8gVGhlIGRlZmF1bHQgc2xvZy5Mb2dnZXIncyBoYW5kbGVyIHVzZXMgdGhlIGxvZyBwYWNrYWdlJ3MgZGVmYXVsdCBvdXRwdXQuCglsb2cuU2V0T3V0cHV0KCZsb2didWYpCglsb2cuU2V0RmxhZ3MobG9nLkxzaG9ydGZpbGUgJl4gbG9nLkxzdGRGbGFncykKCUluZm8odGFudC5TdHJpbmdWYWwodmFsKQoJfQoJcmV0dXJuIG5pbAp9CgovLyBBIHZhbHVlTWFwIG1hcHMgYSBjYXNlIHZhbHVlIChvZiBhIGJhc2ljIEdvIHR5cGUpIHRvIGEgbGlzdCBvZiBwb3NpdGlvbnMKLy8gd2hlcmUgdGhlIHNhbWUgY2FzZSB2YWx1ZSBhcHBlYXJlZCwgdG9nZXRoZXIgd2l0aCB0aGUgY29ycmVzcG9uZGluZyBjYXNlCi8vIHR5cGVzLgovLyBTaW5jZSB0d28gY2FzZSB2YWx1ZXMgbWF5IGhhdmUgdGhlIHNhbWUgInVuZGVybHlpbmciIHZhbHVlIGJ1dCBkaWZmZXJlbnQKLy8gdHlwZXMgd2UgbmVlZCB0byBhbHNvIGNoZWNrIHRoZSB2YWx1ZSdzIHR5cGVzIChlLmcuLCBieXRlKDEpIHZzIG15Qnl0ZSgxKSkKLy8gd2hlbiB0aGUgc3dpdGNoIGV4cHJlc3Npb24gaXMgb2YgaW50ZXJmYWNlIHR5cGUuCnR5cGUgKAoJdmFsdWVNYXAgIG1hcFthbnldW112YWx1ZVR5cGUgLy8gdW5kZXJseWluZyBHbyB2YWx1ZSAtPiB2YWx1ZVR5cGUKCXZhbHVlVHlwZSBzdHJ1Y3QgewoJCXBvcyB0b2tlbi5Qb3MKCQl0eXAgVHlwZQoJfQopCgpmdW5jIChjaGVjayAqQ2hlY2tlcikgY2FzZVZhbHVlcyh4ICpvcGVyYW5kLCB2YWx1ZXMgW11hc3QuRXhwciwgc2VlbiB2YWx1ZU1hcCkgewpMOgoJZm9yIF8sIGUgOj0gcmFuZ2UgdmFsdWVzIHsKCQl2YXIgdiBvcGVyYW5kCgkJY2hlY2suZXhwcihuaWwsICZ2LCBlKQoJCWlmIHgubW9kZSA9PSBpbnZhbGlkIHx8IHYubW9kZSA9PSBpbnZhbGlkIHsKCQkJY29udGludWUgTAoJCX0KCQljaGVjay5jb252ZXJ0VW50eXBlZCgmdiwgeC50eXApCgkJaWYgdi5tb2RlID09IGludmFsaWQgewoJCQljb250aW51ZSBMCgkJfQoJCS8vIE9yZGVyIG1hdHRlcnM6IEJ5IGNvbXBhcmluZyB2IGFnYWluc3QgeCwgZXJyb3IgcG9zaXRpb25zIGFyZSBhdCB0aGUgY2FzZSB2YWx1ZXMuCgkJcmVzIDo9IHYgLy8ga2VlcCBvcmlnaW5hbCB2IHVuY2hhbmdlZAoJCWNoZWNrLmNvbXBhcmlzb24oJnJlcywgeCwgdG9rZW4uRVFMLCB0cnVlKQoJCWlmIHJlcy5tb2RlID09IGludmFsaWQgewoJCQljb250aW51ZSBMCgkJfQoJCWlmIHYubW9kZSAhPSBjb25zdGFudF8gewoJCQljb250aW51ZSBMIC8vIHdlJ3JlIGRvbmUKCQl9CgkJLy8gbG9vayBmb3IgZHVwbGljYXRlIHZhbHVlcwoJCWlmIHZhbCA6PSBnb1ZhbCh2LnZhbCk7IHZhbCAhPSBuaWwgewoJCQkvLyBsb29rIGZvciBkdXBsaWNhdGUgdHlwZXMgZm9yIGEgZ2l2ZW4gdmFsdWUKCQkJLy8gKHF1YWRyYXRpYyBhbGdvcml0aG0sIGJ1dCB0aGVzZSBsaXN0cyB0ZW5kIHRvIGJlIHZlcnkgc2hvcnQpCgkJCWZvciBfLCB2dCA6PSByYW5nZSBzZWVuW3ZhbF0gewoJCQkJaWYgSWRlbnRpY2FsKHYudHlwLCB2dC50eXApIHsKCQkJCQllcnIgOj0gY2hlY2submV3RXJyb3IoRHVwbGljYXRlQ2FzZSkKCQkJCQllcnIuYWRkZigmdiwgImR1cGxpY2F0ZSBjYXNlICVzIGluIGV4cHJlc3Npb24gc3dpdGNoIiwgJnYpCgkJCQkJZXJyLmFkZGYoYXRQb3ModnQucG9zKSwgInByZXZpb3VzIGNhc2UiKQoJCQkJCWVyci5yZXBvcnQoKQoJCQkJCWNvbnRpbnVlIEwKCQkJCX0KCQkJfQoJCQlzZWVuW3ZhbF0gPSBhcHBlbmQoc2Vlblt2YWxdLCB2YWx1ZVR5cGV7di5Qb3MoKSwgdi50eXB9KQoJCX0KCX0KfQoKLy8gaXNOaWwgcmVwb3J0cyB3aGV0aGVyIHRoZSBleHByZXNzaW9uIGUgZGVub3RlcyB0aGUgcHJlZGVjbGFyZWQgdmFsdWUgbmlsLgpmdW5jIChjaGVjayAqQ2hlY2tlcikgaXNOaWwoZSBhc3QuRXhwcikgYm9vbCB7CgkvLyBUaGUgb25seSB3YXkgdG8gZXhwcmVzcyB0aGUgbmlsIHZhbHVlIGlzIGJ5IGxpdGVyYWxseSB3cml0aW5nIG5pbCAocG9zc2libHkgaW4gcGFyZW50aGVzZXMpLgoJaWYgbmFtZSwgXyA6PSBhc3QuVW5wYXJlbihlKS4oKmFzdC5JZGVudCk7IG5hbWUgIT0gbmlsIHsKCQlfLCBvayA6PSBjaGVjay5sb29rdXAobmFtZS5OYW1lKS4oKk5pbCkKCQlyZXR1cm4gb2sKCX0KCXQgewoJRGV2ICAgICAgICAgICAgICAgdWludDY0CglJbm8gICAgICAgICAgICAgICB1aW50NjQKCU1vZGUgICAgICAgICAgICAgIHVpbnQzMgoJTmxpbmsgICAgICAgICAgICAgdWludDMyCglVaWQgICAgICAgICAgICAgICB1aW50MzIKCUdpZCAgICAgICAgICAgICAgIHVpbnQzMgoJUmRldiAgICAgICAgICAgICAgdWludDY0CglYX19wYWQxICAgICAgICAgICB1aW50NjQKCVNpemUgICAgICAgICAgICAgIGludDY0CglCbGtzaXplICAgICAgICAgICBpbnQzMgoJWF9fcGFkMiAgICAgICAgICAgaW50MzIKCUJsb2NrcyAgICAgICAgICAgIGludDY0CglBdGltICAgICAgICAgICAgICBUaW1lc3BlYwoJTXRpbSAgICAgICAgICAgICAgVGltZXNwZWMKCUN0aW0gICAgICAgICAgICAgIFRpbWVzcGVjCglYX19nbGliY19yZXNlcnZlZCBbMl1pbnQzMgp9Cgp0eXBlIFN0YXRmc190IHN0cnVjdCB7CglUeXBlICAgIGludDY0CglCc2l6ZSAgIGludDY0CglCbG9ja3MgIHVpbnQ2NAoJQmZyZWUgICB1aW50NjQKCUJhdmFpbCAgdWludDY0CglGaWxlcyAgIHVpbnQ2NAoJRmZyZWUgICB1aW50NjQKCUZzaWQgICAgRnNpZAoJTmFtZWxlbiBpbnQ2NAoJRnJzaXplICBpbnQ2NAoJRmxhZ3MgICBpbnQ2NAoJU3BhcmUgICBbNF1pbnQ2NAp9Cgp0eXBlIERpcmVudCBzdHJ1Y3QgewoJSW5vICAgIHVpbnQ2NAoJT2ZmICAgIGludDY0CglSZWNsZW4gdWludDE2CglUeXBlICAgdWludDgKCU5hbWUgICBbMjU2XXVpbnQ4CglfICAgICAgWzVdYnl0ZQp9Cgp0eXBlIEZzaWQgc3RydWN0IHsKCVhfX3ZhbCBbMl1pbnQzMgp9Cgp0eXBlIEZsb2NrX3Qgc3RydWN0IHsKCVR5cGUgICBpbnQxNgoJV2hlbmNlIGludDE2CglTdGFydCAgaW50NjQKCUxlbiAgICBpbnQ2NAoJUGlkICAgIGludDMyCglfICAgICAgWzRdYnl0ZQp9Cgp0eXBlIFJhd1NvY2thZGRySW5ldDQgc3RydWN0IHsKCUZhbWlseSB1aW50MTYKCVBvcnQgICB1aW50MTYKCUFkZHIgICBbNF1ieXRlIC8qIGluX2FkZHIgKi8KCVplcm8gICBbOF11aW50OAp9Cgp0eXBlIFJhd1NvY2thZGRySW5ldDYgc3RydWN0IHsKCUZhbWlseSAgIHVpbnQxNgoJUG9ydCAgICAgdWludDE2CglGbG93aW5mbyB1aW50MzIKCUFkZHIgICAgIFsxNl1ieXRlIC8qIGluNl9hZGRyICovCglTY29wZV9pZCB1aW50MzIKfQoKdHlwZSBSYXdTb2NrYWRkclVuaXggc3RydWN0IHsKCUZhbWlseSB1aW50MTYKCVBhdGggICBbMTA4XWludDgKfQoKdHlwZSBSYXdTb2NrYWRkckxpbmtsYXllciBzdHJ1Y3QgewoJRmFtaWx5ICAgdWludDE2CglQcm90b2NvbCB1aW50MTYKCUlmaW5kZXggIGludDMyCglIYXR5cGUgICB1aW50MTYKCVBrdHR5cGUgIHVpbnQ4CglIYWxlbiAgICB1aW50OAoJQWRkciAgICAgWzhddWludDgKfQoKdHlwZSBSYXdTb2NrYWRkck5ldGxpbmsgc3RydWN0IHsKCUZhbWlseSB1aW50MTYKCVBhZCAgICB1aW50MTYKCVBpZCAgICB1aW50MzIKCUdyb3VwcyB1aW50MzIKfQoKdHlwZSBSYXdTb2NrYWRkciBzdHJ1Y3QgewoJRmFtaWx5IHVpbnQxNgoJRGF0YSAgIFsxNF11aW50OAp9Cgp0eXBlIFJhd1NvY2thZGRyQW55IHN0cnVjdCB7CglBZGRyIFJhd1NvY2thZGRyCglQYWQgIFs5Nl11aW50OAp9Cgp0eXBlIF9Tb2NrbGVuIHVpbnQzMgoKdHlwZSBMaW5nZXIgc3RydWN0IHsKCU9ub2ZmICBpbnQzMgoJTGluZ2VyIGludDMyCn0KCnR5cGUgSW92ZWMgc3RydWN0IHsKCUJhc2UgKmJ5dGUKCUxlbiAgdWludDY0Cn0KCnR5cGUgSVBNcmVxIHN0cnVjdCB7CglNdWx0aWFkZHIgWzRdYnl0ZSAvKiBpbl9hZGRyICovCglJbnRlcmZhY2UgWzRdYnl0ZSAvKiBpbl9hZGRyICovCn0KCnR5cGUgSVBNcmVxbiBzdHJ1Y3QgewoJTXVsdGlhZGRyIFs0XWJ5dGUgLyogaW5fYWRkciAqLwoJQWRkcmVzcyAgIFs0XWJ5dGUgLyogaW5fYWRkciAqLwoJSWZpbmRleCAgIGlud2l0aCAiKiAvIiwgd2hpY2ggZG9lcyBub3QKCQkvLyAgICAgdGVybWluYXRlIHRoZSBjb21tZW50CgkJLy8gICAqIHJlcGxhY2UgIjxzY3JpcHQiIGFuZCAiPC9zY3JpcHQiIHdpdGggIlx4M0NzY3JpcHQiIGFuZCAiXHgzQy9zY3JpcHQiCgkJLy8gICAgIChjYXNlIGluc2Vuc2l0aXZlbHkpLCBhbmQgIjwhLS0iIHdpdGggIlx4M0MhLS0iLCB3aGljaCBwcmV2ZW50cwoJCS8vICAgICBjb25mdXNpbmcgc2NyaXB0IGJsb2NrIHRlcm1pbmF0aW9uIHNlbWFudGljcwoJCS8vCgkJLy8gV2UgYWxzbyBwdXQgYSBzcGFjZSBiZWZvcmUgdGhlIGNvbW1lbnQgc28gdGhhdCBpZiBpdCBpcyBmbHVzaCBhZ2FpbnN0CgkJLy8gYSBkaXZpc2lvbiBvcGVyYXRvciBpdCBpcyBub3QgdHVybmVkIGludG8gYSBsaW5lIGNvbW1lbnQ6CgkJLy8gICAgIHgve3t5fX0KCQkvLyB0dXJuaW5nIGludG8KCQkvLyAgICAgeC8vKiBlcnJvciBtYXJzaGFsaW5nIHk6CgkJLy8gICAgICAgICAgc2Vjb25kIGxpbmUgb2YgZXJyb3IgbWVzc2FnZSAqL251bGwKCQllcnJTdHIgOj0gZXJyLkVycm9yKCkKCQllcnJTdHIgPSBzdHJpbmcoc2NyaXB0VGFnUmUuUmVwbGFjZUFsbChbXWJ5dGUoZXJyU3RyKSwgW11ieXRlKGBceDNDJHsxfXNjcmlwdGApKSkKCQllcnJTdHIgPSBzdHJpbmdzLlJlcGxhY2VBbGwoZXJyU3RyLCAiKi8iLCAiKiAvIikKCQllcnJTdHIgPSBzdHJpbmdzLlJlcGxhY2VBbGwoZXJyU3RyLCAiPCEtLSIsIGBceDNDIS0tYCkKCQlyZXR1cm4gZm10LlNwcmludGYoIiAvKiAlcyAqL251bGwgIiwgZXJyU3RyKQoJfQoKCS8vIFRPRE86IG1heWJlIHBvc3QtcHJvY2VzcyBvdXRwdXQgdG8gcHJldmVudCBpdCBmcm9tIGNvbnRhaW5pbmcKCS8vICI8IS0tIiwgIi0tPiIsICI8IVtDREFUQVsiLCAiXV0+Iiwgb3IgIjwvc2NyaXB0IgoJLy8gaW4gY2FzZSBjdXN0b20gbWFyc2hhbGVycyBwcm9kdWNlIG91dHB1dCBjb250YWluaW5nIHRob3NlLgoJLy8gTm90ZTogRG8gbm90IHVzZSBceCBlc2NhcGluZyB0byBzYXZlIGJ5dGVzIGJlY2F1c2UgaXQgaXMgbm90IEpTT04gY29tcGF0aWJsZSBhbmQgdGhpcyBlc2NhcGVyCgkvLyBzdXBwb3J0cyBsZCtqc29uIGNvbnRlbnQtdHlwZS4KCWlmIGxlbihiKSA9PSAwIHsKCQkvLyBJbiwgYHg9eS97ey59fSp6YCBhIGpzb24uTWFyc2hhbGVyIHRoYXQgcHJvZHVjZXMgIiIgc2hvdWxkCgkJLy8gbm90IGNhdXNlIHRoZSBvdXRwdXQgYHg9eS8qemAuCgkJcmV0dXJuICIgbnVsbCAiCgl9CglmaXJzdCwgXyA6PSB1dGY4LkRlY29kZVJ1bmUoYikKCWxhc3QsIF8gOj0gdXRmOC5EZWNvZGVMYXN0UnVuZShiKQoJdmFyIGJ1ZiBzdHJpbmdzLkJ1aWxkZXIKCS8vIFByZXZlbnQgSWRlbnRpZmllck5hbWVzIGFuZCBOdW1lcmljTGl0ZXJhbHMgZnJvbSBydW5uaW5nIGludG8KCS8vIGtleXdvcmRzOiBpbiwgaW5zdGFuY2VvZiwgdHlwZW9mLCB2b2lkCglwYWQgOj0gaXNKU0lkZW50UGFydChmaXJzdCkgfHwgaXNKU0lkZW50UGFydChsYXN0KQoJaWYgcGFkIHsKCQlidWYuV3JpdGVCeXRlKCcgJykKCX0KCXdyaXR0ZW4gOj0gMAoJLy8gTWFrZSBzdXJlIHRoYXQganNvbi5NYXJzaGFsIGVzY2FwZXMgY29kZXBvaW50cyBVKzIwMjggJiBVKzIwMjkKCS8vIHNvIGl0IGZhbGxzIHdpdGhpbiB0aGUgc3Vic2V0IG9mIEpTT04gd2hpY2ggaXMgdmFsaWQgSlMuCglmb3IgaSA6PSAwOyBpIDwgbGVuKGIpOyB7CgkJcnVuZSwgbiA6PSB1dGY4LkRlY29kZVJ1bmUoYltpOl0pCgkJcmVwbCA6PSAiIgoJCWlmIHJ1bmUgPT0gMHgyMDI4IHsKCQkJcmVwbCA9IGBcdTIwMjhgCgkJfSBlbHNlIGlmIHJ1bmUgPT0gMHgyMDI5IHsKCQkJcmVwbCA9IGBcdTIwMjlgCgkJfQoJCWlmIHJlcGwgIT0gIiIgewoJCQlidWYuV3JpdGUoYlt3cml0dGVuOmldKQoJCQlidWYuV3JpdGVTdHJpbmcocmVwbCkKCQkJd3JpdHRlbiA9IGkgKyBuCgkJfQoJCWkgKz0gbgoJfQoJaWYgYnVmLkxlbigpICE9XSpib29sCglCeXRlcyAgICBbXWJ5dGUKCUJ5dGVzUHRyICpbXWJ5dGUKCVMgICAgICAgIHN0cmluZwoJU1B0ciAgICAgKnN0cmluZwoJU3MgICAgICAgW11zdHJpbmcKCVNQdHJzICAgIFtdKnN0cmluZwoJTXlJICAgICAgTXlJbnQKCUNoaWxkICAgIENoaWxkCglDaGlsZHJlbiBbXUNoaWxkCglDaGlsZFB0ciAqQ2hpbGQKCUNoaWxkVG9FbWJlZAp9Cgpjb25zdCAoCgllbXB0eVhNTCA9IGAKPFBhcmVudD4KICAgIDxJPjwvST4KICAgIDxJUHRyPjwvSVB0cj4KICAgIDxJcz48L0lzPgogICAgPElQdHJzPjwvSVB0cnM+CiAgICA8Rj48L0Y+CiAgICA8RlB0cj48L0ZQdHI+CiAgICA8RnM+PC9Gcz4KICAgIDxGUHRycz48L0ZQdHJzPgogICAgPEI+PC9CPgogICAgPEJQdHI+PC9CUHRyPgogICAgPEJzPjwvQnM+CiAgICA8QlB0cnM+PC9CUHRycz4KICAgIDxCeXRlcz48L0J5dGVzPgogICAgPEJ5dGVzUHRyPjwvQnl0ZXNQdHI+CiAgICA8Uz48L1M+CiAgICA8U1B0cj48L1NQdHI+CiAgICA8U3M+PC9Tcz4KICAgIDxTUHRycz48L1NQdHJzPgogICAgPE15ST48L015ST4KICAgIDxDaGlsZD48L0NoaWxkPgogICAgPENoaWxkcmVuPjwvQ2hpbGRyZW4+CiAgICA8Q2hpbGRQdHI+PC9DaGlsZFB0cj4KICAgIDxYPjwvWD4KPC9QYXJlbnQ+CmAKKQoKLy8gZ29sYW5nLm9yZy9pc3N1ZXMvMTM0MTcKZnVuYyBUZXN0VW5tYXJzaGFsRW1wdHlWYWx1ZXModCAqdGVzdGluZy5UKSB7CgkvLyBUZXN0IGZpcnN0IHdpdGggYSB6ZXJvLXZhbHVlZCBkc3QuCgl2IDo9IG5ldyhQYXJlbnQpCglpZiBlcnIgOj0gVW5tYXJzaGFsKFtdYnl0ZShlbXB0eVhNTCksIHYpOyBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsZigiemVybzogVW5tYXJzaGFsIGZhaWxlZDogZ290ICV2IiwgZXJyKQoJfQoKCXpCeXRlcywgekludCwgelN0ciwgekZsb2F0LCB6Qm9vbCA6PSBbXWJ5dGV7fSwgMCwgIiIsIGZsb2F0MzIoMCksIGZhbHNlCgl3YW50IDo9ICZQYXJlbnR7CgkJSVB0cjogICAgICAgICAmekludCwKCQlJczogICAgICAgICAgIFtdaW50e3pJbnR9LAoJCUlQdHJzOiAgICAgICAgW10qaW50eyZ6SW50fSwKCQlGUHRyOiAgICAgICAgICZ6RmxvYXQsCgkJRnM6ICAgICAgICAgICBbXWZsb2F0MzJ7ekZsb2F0fSwKCQlGUHRyczogICAgICAgIFtdKmZsb2F0MzJ7JnpGbG9hdH0sCgkJQlB0cjogICAgICAgICAmekJvb2wsCgkJQnM6ICAgICAgICAgICBbXWJvb2x7ekJvb2x9LAoJCUJQdHJzOiAgICAgICAgW10qYm9vbHsmekJvb2x9LAoJCUJ5dGVzOiAgICAgICAgW11ieXRle30sCgkJQnl0ZXNQdHI6ICAgICAmekJ5dGVzLAoJCVNQdHI6ICAgICAgICAgJnpTdHIsCgkJU3M6ICAgICAgICAgICBbXXN0cmluZ3t6U3RyfSwKCQlTUHRyczogICAgICAgIFtdKnN0cmluZ3smelN0cn0sCgkJQ2hpbGRyZW46ICAgICBbXUNoaWxke3t9fSwKCQlDaGlsZFB0cjogICAgIG5ldyhDaGlsZCksCgkJQ2hpbGRUb0VtYmVkOiBDaGlsZFRvRW1iZWR7fSwKCX0KCWlmICFyZWZsZWN0LkRlZXBFcXVhbCh2LCB3YW50KSB7CgkJdC5GYXRhbGYoInplcm86IFVubWFyc2hhbDpcbmhhdmU6ICAlIyt2XG53YW50OiAlIyt2Iiwgdiwgd2FudCkKCX0KCgkvLyBUZXN0IHdpdGggYSBwcmUtcG9wdWxhdGVkIGRzdC4KCS8vIE11bHRpcGxlIGFkZHJlc3NhYmxlIGNvcGllcywgYXMgcG9pbnRlci10byBmaWVsZHMgd2lsbCByZXBsYWNlIHZhbHVlIGR1cmluZyB1bm1hcnNoYWwuCgl2Qnl0ZXMwLCB2SW50MCwgdlN0cjAsIHZGbG9hdDAsIHZCb29sMCA6PSBbXWJ5dGUoIngiKSwgMSwgIngiLCBmbG9hdDMyKDEpLCB0cnVlCgl2Qnl0ZXMxLCB2SW50MSwgdlN0cjEsIHZGbG9hdDEsIHZCb29sMSA6PSBbXWJ5dGUoIngiKSwgMSwgIngiLCBmbG9hdDMyKDEpLCB0cnVlCgl2SW50MiwgdlN0cjIsIHZGbG9hdDIsIHZCb29sMiA6PSAxLCAieCIsIGZsb2F0MzIoMSksIHRydWUKCXYgPSAmUGFyZW50ewoJCUk6ICAgICAgICAgICAgdkludDAsCgkJSXVlID09ICI/IiB7CgkJCQl2YWwgPSBhcmdzW2FyZ1Bvc10uVmFsdWUKCQkJfSBlbHNlIHsKCQkJCS8vIEFzc2lnbiB2YWx1ZSBmcm9tIGFyZ3VtZW50IHBsYWNlaG9sZGVyIG5hbWUuCgkJCQlpZiB2IDo9IHZhbHVlRnJvbVBsYWNlaG9sZGVyTmFtZShhcmdzLCBzdHJ2YWx1ZVsxOl0pOyB2ICE9IG5pbCB7CgkJCQkJdmFsID0gdgoJCQkJfQoJCQl9CgkJCWFyZ1BvcysrCgkJfSBlbHNlIHsKCQkJdmFsID0gcy5jb2xWYWx1ZVtuXQoJCX0KCQlpZiBkb0luc2VydCB7CgkJCWNvbHNbY29saWR4XSA9IHZhbAoJCX0KCX0KCglpZiBkb0luc2VydCB7CgkJdC5yb3dzID0gYXBwZW5kKHQucm93cywgJnJvd3tjb2xzOiBjb2xzfSkKCX0KCXJldHVybiBkcml2ZXIuUm93c0FmZmVjdGVkKDEpLCBuaWwKfQoKLy8gaG9vayB0byBzaW11bGF0ZSBicm9rZW4gY29ubmVjdGlvbnMKdmFyIGhvb2tRdWVyeUJhZENvbm4gZnVuYygpIGJvb2wKCmZ1bmMgKHMgKmZha2VTdG10KSBRdWVyeShhcmdzIFtdZHJpdmVyLlZhbHVlKSAoZHJpdmVyLlJvd3MsIGVycm9yKSB7CglwYW5pYygiVXNlIFF1ZXJ5Q29udGV4dCIpCn0KCmZ1bmMgKHMgKmZha2VTdG10KSBRdWVyeUNvbnRleHQoY3R4IGNvbnRleHQuQ29udGV4dCwgYXJncyBbXWRyaXZlci5OYW1lZFZhbHVlKSAoZHJpdmVyLlJvd3MsIGVycm9yKSB7CglpZiBzLnBhbmljID09ICJRdWVyeSIgewoJCXBhbmljKHMucGFuaWMpCgl9CglpZiBzLmNsb3NlZCB7CgkJcmV0dXJuIG5pbCwgZXJyQ2xvc2VkCgl9CgoJaWYgcy5jLnN0aWNreUJhZCB8fCAoaG9va1F1ZXJ5QmFkQ29ubiAhPSBuaWwgJiYgaG9va1F1ZXJ5QmFkQ29ubigpKSB7CgkJcmV0dXJuIG5pbCwgZmFrZUVycm9ye01lc3NhZ2U6ICJRdWVyeTogU3RpY2t5IEJhZCIsIFdyYXBwZWQ6IGRyaXZlci5FcnJCYWRDb25ufQoJfQoJaWYgcy5jLmlzRGlydHlBbmRNYXJrKCkgewoJCXJldHVybiBuaWwsIGVyckZha2VDb25uU2Vzc2lvbkRpcnR5Cgl9CgoJZXJyIDo9IGNoZWNrU3Vic2V0VHlwZXMocy5jLmRiLmFsbG93QW55LCBhcmdzKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJcy50b3VjaE1lbSgpCglkYiA6PSBzLmMuZGIKCWlmIGxlbihhcmdzKSAhPSBzLnBsYWNlaG9sZGVycyB7CgkJcGFuaWMoImVycm9yIGluIHBrZyBkYjsgc2hvdWxkIG9ubHkgZ2V0IGhlcmUgaWYgc2l6ZSBpcyBjb3JyZWN0IikKCX0KCglzZXRNUm93cyA6PSBtYWtlKFtdW10qcm93LCAwLCAxKQoJc2V0Q29sdW1ucyA6PSBtYWtlKFtdW11zdHJpbmcsIDAsIDEpCglzZXRDb2xUeXBlIDo9IG1ha2UoW11bXXN0cmluZywgMCwgMSkKCglmb3IgewoJCWRiLm11LkxvY2soKQoJCXQsIG9rIDo9IGRiLnRhYmxlKHMudGFibGUpCgkJZGIubXUuVW5sb2NrKCkKCQlpZiAhb2sgewoJCQlyZXR1cm4gbmlsLCBmbXQuRXJyb3JmKCJmYWtlZGI6IHRhYmxlICVxIGRvZXNuJ3QgZXhpc3QiLCBzLnRhYmxlKQoJCX0KCgkJaWYgcy50YWJsZSA9PSAibWFnaWNxdWVyeSIgewoJCQlpZiBsZW4ocy53aGVyZUNvbCkgPT0gMiAmJiBzLndoZXJlQ29sWzBdLkNvbHVtbiA9PSAib3AiICYmIHMud2hlcmVDb2xbMV0uQ29sdW1uID09ICJtaWxsaXMiIHsKCQkJCWlmIGFyZ3NbMF0uVmFsdWUgPT0gInNsZWVwIiB7CgkJCQkJdGltZS5TbGVlcCh0aW1lLkR1cmF0aW9uKGFyZ3NbMV0uVmFsdWUuKGludDY0KSkgKiB0aW1lLk1pbGxpc2Vjb25kKQoJCQkJfQoJCQl9CgkJfQoJCWlmIHMudGFibGUgPT0gInR4X3N0YXR1cyIgJiYgcy5jb2xOYW1lWzBdID09ICJ0eF9zdGF0dXMiIHsKCQkJdHhTdGF0dXMgOj0gImF1dG9jb21taXQiCgkJCWlmIHMuYy5jdXJyVHggIT0gbmlsIHsKCQkJCXR4U3RhdHVzID0gInRyYW5zYWN0aW9uIgoJCQl9CgkJCWN1cnNvciA6PSAmcm93c0N1cnNvcnsKCQkJCWRiOiAgICAgICAgcy5jLmRiLAoJCQkJcGFyZW50TWVtOiBzLmMsCgkJCQlwb3NSb3c6ICAgIC0xLAoJCQkJcm93czogW11bXSogewoJCVVucXVvdGUoYCJceDQ3aXZlIG1lIGEgXHg3Mm9jaywgXHg3MGFwZXIgYW5kIFx4NzNjaXNzb3JzIGFuZCBceDQ5IHdpbGwgbW92ZSB0aGUgd29ybGQuImApCgl9Cn0KLy8gQ29kZSBnZW5lcmF0ZWQgYnkgInN0cmluZ2VyIC10eXBlIEFsZ0tpbmQgLXRyaW1wcmVmaXggQSBhbGcuZ28iOyBETyBOT1QgRURJVC4KCnBhY2thZ2UgdHlwZXMKCmltcG9ydCAic3RyY29udiIKCmZ1bmMgXygpIHsKCS8vIEFuICJpbnZhbGlkIGFycmF5IGluZGV4IiBjb21waWxlciBlcnJvciBzaWduaWZpZXMgdGhhdCB0aGUgY29uc3RhbnQgdmFsdWVzIGhhdmUgY2hhbmdlZC4KCS8vIFJlLXJ1biB0aGUgc3RyaW5nZXIgY29tbWFuZCB0byBnZW5lcmF0ZSB0aGVtIGFnYWluLgoJdmFyIHggWzFdc3RydWN0e30KCV8gPSB4W0FVTkstMF0KCV8gPSB4W0FOT0VRLTFdCglfID0geFtBTk9BTEctMl0KCV8gPSB4W0FNRU0tM10KCV8gPSB4W0FNRU0wLTRdCglfID0geFtBTUVNOC01XQoJXyA9IHhbQU1FTTE2LTZdCglfID0geFtBTUVNMzItN10KCV8gPSB4W0FNRU02NC04XQoJXyA9IHhbQU1FTTEyOC05XQoJXyA9IHhbQVNUUklORy0xMF0KCV8gPSB4W0FJTlRFUi0xMV0KCV8gPSB4W0FOSUxJTlRFUi0xMl0KCV8gPSB4W0FGTE9BVDMyLTEzXQoJXyA9IHhbQUZMT0FUNjQtMTRdCglfID0geFtBQ1BMWDY0LTE1XQoJXyA9IHhbQUNQTFgxMjgtMTZdCglfID0geFtBU1BFQ0lBTC0xN10KfQoKY29uc3QgX0FsZ0tpbmRfbmFtZSA9ICJVTktOT0VRTk9BTEdNRU1NRU0wTUVNOE1FTTE2TUVNMzJNRU02NE1FTTEyOFNUUklOR0lOVEVSTklMSU5URVJGTE9BVDMyRkxPQVQ2NENQTFg2NENQTFgxMjhTUEVDSUFMIgoKdmFyIF9BbGdLaW5kX2luZGV4ID0gWy4uLl11aW50OHswLCAzLCA3LCAxMiwgMTUsIDE5LCAyMywgMjgsIDMzLCAzOCwgNDQsIDUwLCA1NSwgNjMsIDcwLCA3NywgODMsIDkwLCA5N30KCmZ1bmMgKGkgQWxnS2luZCkgU3RyaW5nKCkgc3RyaW5nIHsKCWlmIGkgPCAwIHx8IGkgPj0gQWxnS2luZChsZW4oX0FsZ0tpbmRfaW5kZXgpLTEpIHsKCQlyZXR1cm4gIkFsZ0tpbmQoIiArIHN0cmNvbnYuRm9ybWF0SW50KGludDY0KGkpLCAxMCkgKyAiKSIKCX0KCXJldHVybiBfQWxnS2luZF9uYW1lW19BbGdLaW5kX2luZGV4W2ldOl9BbGdLaW5kX2luZGV4W2krMV1dCn0KLy8gQ29weXJpZ2h0IDIwMTEgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCnBhY2thZ2Ugc3FsCgppbXBvcnQgKAoJImJ5dGVzIgoJImNvbnRleHQiCgkiZGF0YWJhc2Uvc3FsL2RyaXZlciIKCSJlcnJvcnMiCgkiZm10IgoJImlvIgoJInJlZmxlY3QiCgkic2xpY2VzIgoJInN0cmNvbnYiCgkic3RyaW5ncyIKCSJzeW5jIgoJInRlc3RpbmciCgkidGltZSIKKQoKLy8gZmFrZURyaXZlciBpcyBhIGZha2UgZGF0YWJhc2UgdGhhdCBpbXBsZW1lbnRzIEdvJ3MgZHJpdmVyLkRyaXZlcgovLyBpbnRlcmZhY2UsIGp1c3QgZm9yIHRlc3RpbmcuCi8vCi8vIEl0IHNwZWFrcyBhIHF1ZXJ5IGxhbmd1YWdlIHRoYXQncyBzZW1hbnRpY2FsbHkgc2ltaWxhciB0byBidXQKLy8gc3ludGFjdGljYWxseSBkaWZmZXJlbnQgYW5kIHNpbXBsZXIgdGhhbiBTUUwuICBUaGUgc3ludGF4IGlzIGFzCi8vIGZvbGxvd3M6Ci8vCi8vCVdJUEUKLy8JQ1JFQVRFfDx0YWJsZW5hbWU+fDxjb2w+PTx0eXBlPiw8Y29sPj08dHlwZT4sLi4uCi8vCSAgd2hlcmUgdHlwZXMgYXJlOiAic3RyaW5nIiwgW3VdaW50ezgsMTYsMzIsNjR9LCAiYm9vbCIKLy8JSU5TRVJUfDx0YWJsZW5hbWU+fGNvbD12YWwsY29sMj12YWwyLGNvbDM9PwovLwlTRUxFQ1R8PHRhYmxlbmFtZT58cHJvamVjdGNvbDEscHJvamVjdGNvbDJ8ZmlsdGVyY29sPT8sZmlsdGVyY29sMj0/Ci8vaWwsICZuZXQuT3BFcnJvcnsKCQlPcDogICAiZGlhbC1odHRwIiwKCQlOZXQ6ICBuZXR3b3JrICsgIiAiICsgYWRkcmVzcywKCQlBZGRyOiBuaWwsCgkJRXJyOiAgZXJyLAoJfQp9CgovLyBEaWFsIGNvbm5lY3RzIHRvIGFuIFJQQyBzZXJ2ZXIgYXQgdGhlIHNwZWNpZmllZCBuZXR3b3JrIGFkZHJlc3MuCmZ1bmMgRGlhbChuZXR3b3JrLCBhZGRyZXNzIHN0cmluZykgKCpDbGllbnQsIGVycm9yKSB7Cgljb25uLCBlcnIgOj0gbmV0LkRpYWwobmV0d29yaywgYWRkcmVzcykKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoJcmV0dXJuIE5ld0NsaWVudChjb25uKSwgbmlsCn0KCi8vIENsb3NlIGNhbGxzIHRoZSB1bmRlcmx5aW5nIGNvZGVjJ3MgQ2xvc2UgbWV0aG9kLiBJZiB0aGUgY29ubmVjdGlvbiBpcyBhbHJlYWR5Ci8vIHNodXR0aW5nIGRvd24sIFtFcnJTaHV0ZG93bl0gaXMgcmV0dXJuZWQuCmZ1bmMgKGNsaWVudCAqQ2xpZW50KSBDbG9zZSgpIGVycm9yIHsKCWNsaWVudC5tdXRleC5Mb2NrKCkKCWlmIGNsaWVudC5jbG9zaW5nIHsKCQljbGllbnQubXV0ZXguVW5sb2NrKCkKCQlyZXR1cm4gRXJyU2h1dGRvd24KCX0KCWNsaWVudC5jbG9zaW5nID0gdHJ1ZQoJY2xpZW50Lm11dGV4LlVubG9jaygpCglyZXR1cm4gY2xpZW50LmNvZGVjLkNsb3NlKCkKfQoKLy8gR28gaW52b2tlcyB0aGUgZnVuY3Rpb24gYXN5bmNocm9ub3VzbHkuIEl0IHJldHVybnMgdGhlIFtDYWxsXSBzdHJ1Y3R1cmUgcmVwcmVzZW50aW5nCi8vIHRoZSBpbnZvY2F0aW9uLiBUaGUgZG9uZSBjaGFubmVsIHdpbGwgc2lnbmFsIHdoZW4gdGhlIGNhbGwgaXMgY29tcGxldGUgYnkgcmV0dXJuaW5nCi8vIHRoZSBzYW1lIENhbGwgb2JqZWN0LiBJZiBkb25lIGlzIG5pbCwgR28gd2lsbCBhbGxvY2F0ZSBhIG5ldyBjaGFubmVsLgovLyBJZiBub24tbmlsLCBkb25lIG11c3QgYmUgYnVmZmVyZWQgb3IgR28gd2lsbCBkZWxpYmVyYXRlbHkgY3Jhc2guCmZ1bmMgKGNsaWVudCAqQ2xpZW50KSBHbyhzZXJ2aWNlTWV0aG9kIHN0cmluZywgYXJncyBhbnksIHJlcGx5IGFueSwgZG9uZSBjaGFuICpDYWxsKSAqQ2FsbCB7CgljYWxsIDo9IG5ldyhDYWxsKQoJY2FsbC5TZXJ2aWNlTWV0aG9kID0gc2VydmljZU1ldGhvZAoJY2FsbC5BcmdzID0gYXJncwoJY2FsbC5SZXBseSA9IHJlcGx5CglpZiBkb25lID09IG5pbCB7CgkJZG9uZSA9IG1ha2UoY2hhbiAqQ2FsbCwgMTApIC8vIGJ1ZmZlcmVkLgoJfSBlbHNlIHsKCQkvLyBJZiBjYWxsZXIgcGFzc2VzIGRvbmUgIT0gbmlsLCBpdCBtdXN0IGFycmFuZ2UgdGhhdAoJCS8vIGRvbmUgaGFzIGVub3VnaCBidWZmZXIgZm9yIHRoZSBudW1iZXIgb2Ygc2ltdWx0YW5lb3VzCgkJLy8gUlBDcyB0aGF0IHdpbGwgYmUgdXNpbmcgdGhhdCBjaGFubmVsLiBJZiB0aGUgY2hhbm5lbAoJCS8vIGlzIHRvdGFsbHkgdW5idWZmZXJlZCwgaXQncyBiZXN0IG5vdCB0byBydW4gYXQgYWxsLgoJCWlmIGNhcChkb25lKSA9PSAwIHsKCQkJbG9nLlBhbmljKCJycGM6IGRvbmUgY2hhbm5lbCBpcyB1bmJ1ZmZlcmVkIikKCQl9Cgl9CgljYWxsLkRvbmUgPSBkb25lCgljbGllbnQuc2VuZChjYWxsKQoJcmV0dXJuIGNhbGwKfQoKLy8gQ2FsbCBpbnZva2VzIHRoZSBuYW1lZCBmdW5jdGlvbiwgd2FpdHMgZm9yIGl0IHRvIGNvbXBsZXRlLCBhbmQgcmV0dXJucyBpdHMgZXJyb3Igc3RhdHVzLgpmdW5jIChjbGllbnQgKkNsaWVudCkgQ2FsbChzZXJ2aWNlTWV0aG9kIHN0cmluZywgYXJncyBhbnksIHJlcGx5IGFueSkgZXJyb3IgewoJY2FsbCA6PSA8LWNsaWVudC5HbyhzZXJ2aWNlTWV0aG9kLCBhcmdzLCByZXBseSwgbWFrZShjaGFuICpDYWxsLCAxKSkuRG9uZQoJcmV0dXJuIGNhbGwuRXJyb3IKfQovLyBjZ28gLWdvZGVmcyAtb2JqZGlyPS90bXAvcHBjNjRsZS9jZ28gLS0gLVdhbGwgLVdlcnJvciAtc3RhdGljIC1JL3RtcC9wcGM2NGxlL2luY2x1ZGUgbGludXgvdHlwZXRmKCIlZCIsIHguTGluZSgpKQoJfQoJc3R5bGUsIHBmeCA6PSAiYiIsICIrIgoJaWYgeC5Jc1N0bXQoKSA9PSBQb3NOb3RTdG10IHsKCQlzdHlsZSA9ICJzIiAvLyAvc3RyaWtlIG5vdCBzdXBwb3J0ZWQgaW4gSFRNTDUKCQlwZnggPSAiIgoJfQoJcmV0dXJuIGZtdC5TcHJpbnRmKCI8JXM+JXMlZDwvJXM+Iiwgc3R5bGUsIHBmeCwgeC5MaW5lKCksIHN0eWxlKQp9CgpmdW5jICh4IGxpY28pIGF0Q29sdW1uMSgpIGxpY28gewoJcmV0dXJuIG1ha2VMaWNvKHguTGluZSgpLCAxKS53aXRoSXNTdG10KCkKfQovLyBDb3B5cmlnaHQgMjAxNiBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSBwZW1fdGVzdAoKaW1wb3J0ICgKCSJjcnlwdG8veDUwOSIKCSJlbmNvZGluZy9wZW0iCgkiZm10IgoJImxvZyIKCSJvcyIKKQoKZnVuYyBFeGFtcGxlRGVjb2RlKCkgewoJdmFyIHB1YlBFTURhdGEgPSBbXWJ5dGUoYAotLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLQpNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQWxSdVJuVGhValU4L3Byd1l4YnR5CldQVDlwVVJJM2xic0tNaUI2Rm4vVkhPS0UxM3A0RDh4Z09DQURwZFJhZ2RUNm40ZXRyOWF0ekRLVVN2cE10UjMKQ1A1bm9OYzk3V2lOQ2dnQmpWV2hzN3N6RWU4dWd5cUYyM1h3cEhRNnVWMUxLSDUwbTkyTWJPV2ZDdGpVOXAveApxaE5wUVExQVpocU55NUdldmFwNWs4WHpSbWpTbGROQUZaTVk3WXYzR2krbnlDd0d3cFZ0QlV3aHVMemdORksvCnlEdHcyV2NXbVVVN051QzhRNk1XdlBlYnhWdENmVnAvaVFVNnE2MHl5dDZhR09Ca2hBWDBMcEtBRWhLaWRpeFkKblA5UE5WQnZ4Z3UzWFo0UDM2Z1pWNit1bW1LZEJWbmMzTnF3Qkx1NStDY2RSZHVzbUhQSGQ1cEhmNC8zOFozLwo2cVUyYS9mUHZXemNlVlRFZ1o0N1FqRk1UQ1RtQ3dOdDI5Y3ZpN3paZVF6anR3UWduNGlwTjlOaWJSSC9BeC9xClRiSXpIZnJKMXhhMlJ0ZVdTZEZqd3R4aTlDMjBIVWtqWFNlSTRZbHpRTUgwZlBYNktDRTdhVmVQVE9uQjY5SS8KYTkvcTk2RGlYWmFqd2xwcTN3RmN0cnMxb1hxQnA1RFZyQ0lqOGhVMndOZ0I3THRRMW1DdHNZei8vaGVhaTBLOQpQaEU0WDZoaUUwWW1lQVpqUjB1SGw4TS81YVc5eENvSjcyKzEya0twV0FhMFNGUldMeTZGZWpOWUNZcGt1cFZKCnllY0xrLzRMMVcwbDZqUVFabldFclhaWWUwUE5GY213R1h5MVJlcDgza2ZCUk5LUnk1dHZvY2FsTGx3WExkVWsKQUlVKzJHS2p5VDNpTXV6Wnh4RnhQRk1DQXdFQUFRPT0KLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCmFuZCBzb21lIG1vcmVgKQoKCWJsb2NrLCByZXN0IDo9IHBlbS5EZWNvZGUocHViUEVNRGF0YSkKCWlmIGJsb2NrID09IG5pbCB8fCBibG9jay5UeXBlICE9ICJQVUJMSUMgS0VZIiB7CgkJbG9nLkZhdGFsKCJmYWlsZWQgdG8gZGVjb2RlIFBFTSBibG9jayBjb250YWluaW5nIHB1YmxpYyBrZXkiKQoJfQoKCXB1YiwgZXJyIDo9IHg1MDkuUGFyc2VQS0lYUHVibGljS2V5KGJsb2NrLkJ5dGVzKQoJaWYgZXJyICE9IG5pbCB7CgkJbG9nLkZhdGFsKGVycikKCX0KCglmbXQuUHJpbnRmKCJHb3QgYSAlVCwgd2l0aCByZW1haW5pbmcgZGF0YTogJXEiLCBwdWIsIHJlc3QpCgkvLyBPdXRwdXQ6IEdvdCBhICpyc2EuUHVibGljS2V5LCB3aXRoIHJlbWFpbmluZyBkYXRhOiAiYW5kIHNvbWUgbW9yZSIKfQoKZnVuYyBFeGFtcGxlRW5jb2RlKCkgewoJYmxvY2sgOj0gJnBlbS5CbG9ja3sKCQlUeXBlOiAiTUVTU0FHRSIsCgkJSGVhZGVyczogbWFwW3N0cmluZ11zdHJpbmd7CgkJCSJBbmltYWwiOiAiR29waGVyIiwKCQl9LAoJCUJ5dGVzOiBbXWJ5dGUoInRlc3QiKSwKCX0KCglpZiBlcnIgOj0gcGVtLkVuY29kZShvcy5TdGRvdXQsIGJsb2NrKTsgZXIweDFmCglJRlRfU0lQU0lHICAgICAgICAgICAgICAgICAgICAgICAgPSAweGNjCglJRlRfU0lQVEcgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGNiCglJRlRfU0xJUCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDFjCglJRlRfU01EU0RYSSAgICAgICAgICAgICAgICAgICAgICAgPSAweDJiCglJRlRfU01EU0lDSVAgICAgICAgICAgICAgICAgICAgICAgPSAweDM0CglJRlRfU09ORVQgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDI3CglJRlRfU09ORVRPVkVSSEVBRENIQU5ORUwgICAgICAgICAgPSAweGI5CglJRlRfU09ORVRQQVRIICAgICAgICAgICAgICAgICAgICAgPSAweDMyCglJRlRfU09ORVRWVCAgICAgICAgICAgICAgICAgICAgICAgPSAweDMzCglJRlRfU1JQICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDk3CglJRlRfU1M3U0lHTElOSyAgICAgICAgICAgICAgICAgICAgPSAweDljCglJRlRfU1RBQ0tUT1NUQUNLICAgICAgICAgICAgICAgICAgPSAweDZmCglJRlRfU1RBUkxBTiAgICAgICAgICAgICAgICAgICAgICAgPSAweGIKCUlGVF9UMSAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTIKCUlGVF9URExDICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NzQKCUlGVF9URUxJTksgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YzgKCUlGVF9URVJNUEFEICAgICAgICAgICAgICAgICAgICAgICA9IDB4NWIKCUlGVF9UUjAwOCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YjAKCUlGVF9UUkFOU1BIRExDICAgICAgICAgICAgICAgICAgICA9IDB4N2IKCUlGVF9UVU5ORUwgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODMKCUlGVF9VTFRSQSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MWQKCUlGVF9VU0IgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YTAKCUlGVF9WMTEgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAKCUlGVF9WMzUgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MmQKCUlGVF9WMzYgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDEKCUlGVF9WMzcgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NzgKCUlGVF9WRFNMICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NjEKCUlGVF9WSVJUVUFMSVBBRERSRVNTICAgICAgICAgICAgICA9IDB4NzAKCUlGVF9WSVJUVUFMVEcgICAgICAgICAgICAgICAgICAgICA9IDB4Y2EKCUlGVF9WT0lDRURJRCAgICAgICAgICAgICAgICAgICAgICA9IDB4ZDUKCUlGVF9WT0lDRUVNICAgICAgICAgICAgICAgICAgICAgICA9IDB4NjQKCUlGVF9WT0lDRUVNRkdEICAgICAgICAgICAgICAgICAgICA9IDB4ZDMKCUlGVF9WT0lDRUVOQ0FQICAgICAgICAgICAgICAgICAgICA9IDB4NjcKCUlGVF9WT0lDRUZHREVBTkEgICAgICAgICAgICAgICAgICA9IDB4ZDQKCUlGVF9WT0lDRUZYTyAgICAgICAgICAgICAgICAgICAgICA9IDB4NjUKCUlGVF9WT0lDRUZYUyAgICAgICAgICAgICAgICAgICAgICA9IDB4NjYKCUlGVF9WT0lDRU9WRVJBVE0gICAgICAgICAgICAgICAgICA9IDB4OTgKCUlGVF9WT0lDRU9WRVJDQUJMRSAgICAgICAgICAgICAgICA9IDB4YzYKCUlGVF9WT0lDRU9WRVJGUkFNRVJFTEFZICAgICAgICAgICA9IDB4OTkKCUlGVF9WT0lDRU9WRVJJUCAgICAgICAgICAgICAgICAgICA9IDB4NjgKCUlGVF9YMjEzICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NWQKCUlGVF9YMjUgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NQoJSUZUX1gyNURETiAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglJRlRfWDI1SFVOVEdST1VQICAgICAgICAgICAgICAgICAgPSAweDdhCglJRlRfWDI1TUxQICAgICAgICAgICAgICAgICAgICAgICAgPSAweDc5CglJRlRfWDI1UExFICAgICAgICAgICAgICAgICAgICAgICAgPSAweDI4CglJRlRfWEVUSEVScjBbaiszXSwgcjBbais0XSA9IGIwMCwgYjEwLCBiMjAsIGIzMCwgYjQwCgkJCXIxW2pdLCByMVtqKzFdLCByMVtqKzJdLCByMVtqKzNdLCByMVtqKzRdID0gYjAxLCBiMTEsIGIyMSwgYjMxLCBiNDEKCQkJcjJbal0sIHIyW2orMV0sIHIyW2orMl0sIHIyW2orM10sIHIyW2orNF0gPSBiMDIsIGIxMiwgYjIyLCBiMzIsIGI0MgoJCQlyM1tqXSwgcjNbaisxXSwgcjNbaisyXSwgcjNbaiszXSwgcjNbais0XSA9IGIwMywgYjEzLCBiMjMsIGIzMywgYjQzCgkJCXI0W2pdLCByNFtqKzFdLCByNFtqKzJdLCByNFtqKzNdLCByNFtqKzRdID0gYjA0LCBiMTQsIGIyNCwgYjM0LCBiNDQKCQl9Cgl9CgoJLy8gRG8gdGhlIGZyaW5nZQoJZm9yIDsgaSA8IGxlbihtKTsgaSsrIHsKCQlqIDo9IDAKCQlyIDo9IG1baV0KCQlmb3IgOyBqIDwgaTsgaisrIHsKCQkJdCA6PSByW2pdCgkJCXJbal0gPSBtW2pdW2ldCgkJCW1bal1baV0gPSB0CgkJfQoJfQp9CgovLyB0cmFuc3Bvc2U1YkJsb2NrZWQgaXMganVzdCBsaWtlIHRyYW5zcG9zZTVhQmxvY2tlZAovLyBidXQgcmV3cml0dGVuIHRvIHJlZHVjZSByZWdpc3RlciBwcmVzc3VyZSBpbiB0aGUKLy8gaW5uZXIgbG9vcC4KZnVuYyB0cmFuc3Bvc2U1YkJsb2NrZWQobSBbXVtdaW50MzIpIHsKCWNvbnN0IEIgPSA1CglOIDo9IGxlbihtKQoJaSA6PSAwCglmb3IgOyBpIDw9IGxlbihtKS1COyBpICs9IEIgewoJCXIwLCByMSwgcjIsIHIzLCByNCA6PSBtW2ldLCBtW2krMV0sIG1baSsyXSwgbVtpKzNdLCBtW2krNF0KCQlpZiBsZW4ocjApIDwgTiB8fCBsZW4ocjEpIDwgTiB8fCBsZW4ocjIpIDwgTiB8fCBsZW4ocjMpIDwgTiB8fCBsZW4ocjQpIDwgTiB7CgkJCXBhbmljKCJFYXJseSBib3VuZHMgY2hlY2sgZmFpbHVyZSIpCgkJfQoJCS8vIHRyYW5zcG9zZSBhcm91bmQgZGlhZ29uYWwKCQlkMDEsIGQxMCA6PSByMFtpKzFdLCByMVtpXQoJCWQwMiwgZDIwIDo9IHIwW2krMl0sIHIyW2ldCgkJZDAzLCBkMzAgOj0gcjBbaSszXSwgcjNbaV0KCQlkMDQsIGQ0MCA6PSByMFtpKzRdLCByNFtpXQoJCXIwW2krMV0sIHIxW2ldID0gZDEwLCBkMDEKCQlyMFtpKzJdLCByMltpXSA9IGQyMCwgZDAyCgkJcjBbaSszXSwgcjNbaV0gPSBkMzAsIGQwMwoJCXIwW2krNF0sIHI0W2ldID0gZDQwLCBkMDQKCgkJZDEyLCBkMjEgOj0gcjFbaSsyXSwgcjJbaSsxXQoJCWQxMywgZDMxIDo9IHIxW2krM10sIHIzW2krMV0KCQlkMTQsIGQ0MSA6PSByMVtpKzRdLCByNFtpKzFdCgkJcjFbaSsyXSwgcjJbaSsxXSA9IGQyMSwgZDEyCgkJcjFbaSszXSwgcjNbaSsxXSA9IGQzMSwgZDEzCgkJcjFbaSs0XSwgcjRbaSsxXSA9IGQ0MSwgZDE0CgoJCWQyMywgZDMyIDo9IHIyW2krM10sIHIzW2krMl0KCQlkMjQsIGQ0MiA6PSByMltpKzRdLCByNFtpKzJdCgkJcjJbaSszXSwgcjNbaSsyXSA9IGQzMiwgZDIzCgkJcjJbaSs0XSwgcjRbaSsyXSA9IGQ0MiwgZDI0CgoJCWQzNCwgZDQzIDo9IHIzW2krNF0sIHI0W2krM10KCQlyM1tpKzRdLCByNFtpKzNdID0gZDQzLCBkMzQKCgkJLy8gdHJhbnNwb3NlIGFjcm9zcyBkaWFnb25hbAoJCWogOj0gMAoJCWZvciA7IGogPCBpOyBqICs9IEIgewoJCQlhNCwgYTAsIGExLCBhMiwgYTMgOj0gbVtqKzRdLCBtW2pdLCBtW2orMV0sIG1baisyXSwgbVtqKzNdCgoJCQkvLyBQcm9jZXNzIGNvbHVtbiBpKzQKCQkJdGVtcDAgOj0gYTBbaSs0XQoJCQl0ZW1wMSA6PSBhMVtpKzRdCgkJCXRlbXAyIDo9IGEyW2krNF0KCQkJdGVtcDMgOj0gYTNbaSs0XQoJCQl0ZW1wNCA6PSBhNFtpKzRdCgoJCQlhNFtpKzRdID0gcjRbais0XQoJCQlhMFtpKzRdID0gcjRbal0KCQkJYTFbaSs0XSA9IHI0W2orMV0KCQkJYTJbaSs0XSA9IHI0W2orMl0KCQkJYTNbaSs0XSA9IHI0W2orM10KCgkJCXIwW2orNF0gPSB0ZW1wMAoJCQlyMVtqKzRdID0gdGVtcDEKCQkJcjJbais0XSA9IHRlbXAyCgkJCXIzW2orNF0gPSB0ZW1wMwoJCQlyNFtqKzRdID0gdGVtcDQKCgkJCXVybiBmd2RHb3Rvcwp9CgpmdW5jIHRyaW1UcmFpbGluZ0VtcHR5U3RtdHMobGlzdCBbXVN0bXQpIFtdU3RtdCB7Cglmb3IgaSA6PSBsZW4obGlzdCk7IGkgPiAwOyBpLS0gewoJCWlmIF8sIG9rIDo9IGxpc3RbaS0xXS4oKkVtcHR5U3RtdCk7ICFvayB7CgkJCXJldHVybiBsaXN0WzppXQoJCX0KCX0KCXJldHVybiBuaWwKfQovLyBDb3B5cmlnaHQgMjAyMSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy9nbzpidWlsZCBnb2V4cGVyaW1lbnQucmVnYWJpYXJncwoKcGFja2FnZSByZWZsZWN0X3Rlc3QKCmltcG9ydCAoCgkiaW50ZXJuYWwvYWJpIgoJIm1hdGgiCgkibWF0aC9yYW5kIgoJInJlZmxlY3QiCgkicnVudGltZSIKCSJ0ZXN0aW5nIgoJInRlc3RpbmcvcXVpY2siCikKCi8vIEFzIG9mIGVhcmx5IE1heSAyMDIxIHRoaXMgaXMgbm8gbG9uZ2VyIG5lY2Vzc2FyeSBmb3IgYW1kNjQsCi8vIGJ1dCBpdCByZW1haW5zIGluIGNhc2UgdGhpcyBpcyBuZWVkZWQgZm9yIHRoZSBuZXh0IHJlZ2lzdGVyIGFiaSBwb3J0LgovLyBUT0RPICgxLjE4KSBJZiBlbmFibGluZyByZWdpc3RlciBBQkkgb24gYWRkaXRpb25hbCBhcmNoaXRlY3R1cmVzIHR1cm5zIG91dCBub3QgdG8gbmVlZCB0aGlzLCByZW1vdmUgaXQuCnR5cGUgTWFnaWNMYXN0VHlwZU5hbWVGb3JUZXN0aW5nUmVnaXN0ZXJBQkkgc3RydWN0e30KCmZ1bmMgVGVzdE1ldGhvZFZhbHVlQ2FsbEFCSSh0ICp0ZXN0aW5nLlQpIHsKCS8vIEVuYWJsZSByZWdpc3Rlci1iYXNlZCByZWZsZWN0LkNhbGwgYW5kIGVuc3VyZSB3ZSBkb24ndAoJLy8gdXNlIHBvdGVudGlhbGx5IGluY29ycmVjdCBjYWNoZWQgdmVyc2lvbnMgYnkgY2xlYXJpbmcKCS8vIHRoZSBjYWNoZSBiZWZvcmUgd2Ugc3RhcnQgYW5kIGFmdGVyIHdlJ3JlIGRvbmUuCglkZWZlciByZWZsZWN0LlNldEFyZ1JlZ3MocmVmbGVjdC5TZXRBcmdSZWdzKGFiaS5JbnRBcmdSZWdzLCBhYmkuRmxvYXRBcmdSZWdzLCBhYmkuRWZmZWN0aXZlRmxvYXRSZWdTaXplKSkKCgkvLyBUaGlzIHRlc3QgaXMgc2ltcGxlLiBDYWxsaW5nIGEgbWV0aG9kIHZhbHVlIGludm9sdmVzCgkvLyBwcmV0dHkgbXVjaCBqdXN0IHBsdW1iaW5nIHdoYXRldmVyIGFyZ3VtZW50cyBpbiB3aGljaGV2ZXIKCS8vIGxvY2F0aW9uIHRocm91Z2ggdG8gcmVmbGVjdGNhbGwuIFRoZXkncmUgYWxyZWFkeSBzZXQgdXAKCS8vIGZvciB1cywgc28gdGhlcmUgaXNuJ3QgYSB3aG9sZSBsb3QgdG8gZG8uIExldCdzIGp1c3QKCS8vIG1ha2Ugc3VyZSB0aGF0IHdlIGNhbiBwYXNzIHJlZ2lzdGVyIGFuZCBzdGFjayBhcmd1bWVudHMKCS8vIHRocm91Z2guIFRoZSBleGFjdCBjb21iaW5hdGlvbiBpcyBub3Qgc3VwZXIgaW1wb3J0YW50LgoJbWFrZU1ldGhvZFZhbHVlIDo9IGZ1bmMobWV0aG9kIHN0cmluZykgKCpTdHJ1Y3RXaXRoTWV0aG9kcywgYW55KSB7CgkJcyA6PSBuZXcoU3RydWN0V2l0aE1ldGhvZHMpCgkJdiA6PSByZWZsZWN0LlZhbHVlT2YocykuTWV0aG9kQnlOYW1lKG1ldGhvZCkKCQlyZXR1cm4gcywgdi5JbnRlcmZhY2UoKQoJfQoKCWEwIDo9IFN0cnVjdEZld1JlZ3N7CgkJMTAsIDExLCAxMiwgMTMsCgkJMjAuMCwgMjEuMCwgMjIuMCwgMjMuMCwKCX0KCWExIDo9IFs0XXVpbnQ2NHsxMDAsIDEwMSwgMTAyLCAxMDN9CglhMiA6PSBTdHJ1Y3RGaWxsUmVnc3sKCQkxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LAoJCTEuMCwgMi4wLCAzLjAsIDQuMCwgNS4wLCA2LjAsIDcuMCwgOC4wLCA5LjAsIDEwLjAsIDExLjAsIDEyLjAsIDEzLjAsIDE0LjAsIDE1LjAsCgl9CgoJcywgaSA6PSBtYWtlTWV0aG9kVmFsdWUoIkFsbFJlZ3NDYWxsIikKCWYwIDo9IGkuKGZ1bmMoU3RydWN0RmV3UmVncywgTWFnaWFnZSBwcGM2NAoKaW1wb3J0ICJjbWQvaW50ZXJuYWwvb2JqIgoKLy9nbzpnZW5lcmF0ZSBnbyBydW4gLi4vc3RyaW5nZXIuZ28gLWkgJEdPRklMRSAtbyBhbmFtZXMuZ28gLXAgcHBjNjQKCi8qCiAqIHBvd2VycGMgNjQKICovCmNvbnN0ICgKCU5TTkFNRSA9IDgKCU5TWU0gICA9IDUwCglOUkVHICAgPSAzMiAvKiBudW1iZXIgb2YgZ2VuZXJhbCByZWdpc3RlcnMgKi8KCU5GUkVHICA9IDMyIC8qIG51bWJlciBvZiBmbG9hdGluZyBwb2ludCByZWdpc3RlcnMgKi8KKQoKY29uc3QgKAoJLyogUkJhc2VQUEM2NCA9IDQwOTYgKi8KCS8qIFIwPTQwOTYgLi4uIFIzMT00MTI3ICovCglSRUdfUjAgPSBvYmouUkJhc2VQUEM2NCArIGlvdGEKCVJFR19SMQoJUkVHX1IyCglSRUdfUjMKCVJFR19SNAoJUkVHX1I1CglSRUdfUjYKCVJFR19SNwoJUkVHX1I4CglSRUdfUjkKCVJFR19SMTAKCVJFR19SMTEKCVJFR19SMTIKCVJFR19SMTMKCVJFR19SMTQKCVJFR19SMTUKCVJFR19SMTYKCVJFR19SMTcKCVJFR19SMTgKCVJFR19SMTkKCVJFR19SMjAKCVJFR19SMjEKCVJFR19SMjIKCVJFR19SMjMKCVJFR19SMjQKCVJFR19SMjUKCVJFR19SMjYKCVJFR19SMjcKCVJFR19SMjgKCVJFR19SMjkKCVJFR19SMzAKCVJFR19SMzEKCgkvLyBDUiBiaXRzLiBVc2UgQm9vayAxLCBjaGFwdGVyIDIgbmFtaW5nIGZvciBiaXRzLiBLZWVwIGFsaWduZWQgdG8gMzIKCVJFR19DUjBMVAoJUkVHX0NSMEdUCglSRUdfQ1IwRVEKCVJFR19DUjBTTwoJUkVHX0NSMUxUCglSRUdfQ1IxR1QKCVJFR19DUjFFUQoJUkVHX0NSMVNPCglSRUdfQ1IyTFQKCVJFR19DUjJHVAoJUkVHX0NSMkVRCglSRUdfQ1IyU08KCVJFR19DUjNMVAoJUkVHX0NSM0dUCglSRUdfQ1IzRVEKCVJFR19DUjNTTwoJUkVHX0NSNExUCglSRUdfQ1I0R1QKCVJFR19DUjRFUQoJUkVHX0NSNFNPCglSRUdfQ1I1TFQKCVJFR19DUjVHVAoJUkVHX0NSNUVRCglSRUdfQ1I1U08KCVJFR19DUjZMVAoJUkVHX0NSNkdUCglSRUdfQ1I2RVEKCVJFR19DUjZTTwoJUkVHX0NSN0xUCglSRUdfQ1I3R1QKCVJFR19DUjdFUQoJUkVHX0NSN1NPCgoJLyogQWxpZ24gRlBSIGFuZCBWU1IgdmVjdG9ycyBzdWNoIHRoYXQgd2hlbiBtYXNrZWQgd2l0aCAweDNGIHRoZXkgcHJvZHVjZQoJICAgYW4gZXF1aXZhbGVudCBWU1ggcmVnaXN0ZXIuICovCgkvKiBGMD00MTYwIC4uLiBGMzE9NDE5MSAqLwoJUkVHX0YwCglSRUdfRjEKCVJFR19GMgoJUkVHX0YzCglSRUdfRjQKCVJFR19GNQoJUkVHX0Y2CglSRUdfRjcKCVJFR19GOAoJUkVHX0Y5CglSRUdfRjEwCglSRUdfRjExCglSRUdfRjEyCglSRUdfRjEzCglSRUdfRjE0CglSRUdfRjE1CglSRUdfRjE2CglSRUdfRjE3CglSRUdfRjE4CglSRUdfRjE5CglSRUdfRjIwCglSRUdfRjIxCglSRUdfRjIyCglSRUdfRjIzCglSRUdfRjI0CglSRUdfRjI1CglSRUdfRjI2CglSRUdfRjI3CglSRUdfRjI4CglSRUdfRjI5CglSRUdfRjMwCglSRUdfRjMxCgoJLyogVjA9NDE5MiAuLi4gVjMxPTQyMjMgKi8KCVJFR19WMAoJUkVHX1YxCglSRUdfVjIKCVJFR19WMwoJUkVHX1Y0CglSRUdfVjUKCVJFR19WNgoJUkVHX1Y3CglSRUdfVjgKCVJFR19WOQoJUkVHX1YxMAoJUkVHX1YxMQoJUkVHX1YxMgoJUkVHX1YxMwoJUkVHX1YxNAoJUkVHX1YxNQoJUkVHX1YxNgoJUkVHX1YxNwoJUkVHX1YxOAoJUkVHX1YxOQoJUkVHX1YyMAoJUkVHX1YyMQoJUkVHX1YyMgoJUkVHX1YyMwoJUkVHX1YyNAoJUkVHX1YyNQoJUkVHX1YyNgoJUkVHX1YyNwoJUkVHX1YyOAoJUkVHX1YyOQoJUkVHX1YzMAoJUkVHX1YzMQoKCS8qIFZTMD00MjI0IC4uLiBWUzYzPTQyODcgKi8KCVJFR19WUzAKCVJFR19WUzEKCVJFR19WUzIKCVJFR19WUzMKCVJFR19WUzQKCVJFR19WUzUKCVJFR19WUzYKCVJFR19WUzcKCVJFR19WUzgKCVJFR19WUzkKCVJFR19WUzEwCglSRUdfVlMxMQoJUkVHX1ZTMTIKCVJFR19WUzEzCglSRUdfVlMxNAoJUkVHX1ZTMTUKCVJFR19WUzE2CgluZ1N0cnVjdEFycmF5U3RydWN0ewoJCXM6IFsyXXRlc3RTdHJpbmdTdHJ1Y3R7eyJ5In0sIHsieiJ9fSwKCX0pCgl0ZXN0SGFuZGxlKHQsIHRlc3RTdHJ1Y3R7MC41LCAiMTg0In0pCgl0ZXN0SGFuZGxlKHQsIHRlc3RFZmFjZSgiaGVsbG8iKSkKCXRlc3RIYW5kbGUodCwgdGVzdFplcm9TaXplKHN0cnVjdHt9e30pKQp9CgpmdW5jIHRlc3RIYW5kbGVbVCBjb21wYXJhYmxlXSh0ICp0ZXN0aW5nLlQsIHZhbHVlIFQpIHsKCW5hbWUgOj0gcmVmbGVjdC5UeXBlRm9yW1RdKCkuTmFtZSgpCgl0LlJ1bihmbXQuU3ByaW50ZigiJXMvJSN2IiwgbmFtZSwgdmFsdWUpLCBmdW5jKHQgKnRlc3RpbmcuVCkgewoJCXYwIDo9IE1ha2UodmFsdWUpCgkJdjEgOj0gTWFrZSh2YWx1ZSkKCgkJaWYgdjAuVmFsdWUoKSAhPSB2MS5WYWx1ZSgpIHsKCQkJdC5FcnJvcigidjAuVmFsdWUgIT0gdjEuVmFsdWUiKQoJCX0KCQlpZiB2MC5WYWx1ZSgpICE9IHZhbHVlIHsKCQkJdC5FcnJvcmYoInYwLlZhbHVlIG5vdCAlI3YiLCB2YWx1ZSkKCQl9CgkJaWYgdjAgIT0gdjEgewoJCQl0LkVycm9yKCJ2MCAhPSB2MSIpCgkJfQoKCQlkcmFpbk1hcHNbVF0odCkKCQljaGVja01hcHNGb3IodCwgdmFsdWUpCgl9KQp9CgovLyBkcmFpbk1hcHMgZW5zdXJlcyB0aGF0IHRoZSBpbnRlcm5hbCBtYXBzIGFyZSBkcmFpbmVkLgpmdW5jIGRyYWluTWFwc1tUIGNvbXBhcmFibGVdKHQgKnRlc3RpbmcuVCkgewoJdC5IZWxwZXIoKQoKCWlmIHVuc2FmZS5TaXplb2YoKihuZXcoVCkpKSA9PSAwIHsKCQlyZXR1cm4gLy8gemVyby1zaXplIHR5cGVzIGFyZSBub3QgaW5zZXJ0ZWQuCgl9CglkcmFpbkNsZWFudXBRdWV1ZSh0KQp9CgpmdW5jIGRyYWluQ2xlYW51cFF1ZXVlKHQgKnRlc3RpbmcuVCkgewoJdC5IZWxwZXIoKQoKCXJ1bnRpbWUuR0MoKSAvLyBRdWV1ZSB1cCB0aGUgY2xlYW51cHMuCglydW50aW1lX2Jsb2NrVW50aWxFbXB0eUNsZWFudXBRdWV1ZShpbnQ2NCg1ICogdGltZS5TZWNvbmQpKQp9CgpmdW5jIGNoZWNrTWFwc0ZvcltUIGNvbXBhcmFibGVdKHQgKnRlc3RpbmcuVCwgdmFsdWUgVCkgewoJLy8gTWFudWFsbHkgbG9hZCB0aGUgdmFsdWUgb3V0IG9mIHRoZSBtYXAuCgl0eXAgOj0gYWJpLlR5cGVGb3JbVF0oKQoJYSwgb2sgOj0gdW5pcXVlTWFwcy5Mb2FkKHR5cCkKCWlmICFvayB7CgkJcmV0dXJuCgl9CgltIDo9IGEuKCp1bmlxdWVNYXBbVF0pCglwIDo9IG0uTG9hZCh2YWx1ZSkKCWlmIHAgIT0gbmlsIHsKCQl0LkVycm9yZigidmFsdWUgJXYgc3RpbGwgcmVmZXJlbmNlZCBieSBhIGhhbmRsZSAob3IgdGlueSBibG9jaz8pOiBpbnRlcm5hbCBwb2ludGVyICVwIiwgdmFsdWUsIHApCgl9Cn0KCmZ1bmMgVGVzdE1ha2VDbG9uZXNTdHJpbmdzKHQgKnRlc3RpbmcuVCkgewoJcyA6PSBzdHJpbmdzLkNsb25lKCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIpIC8vIE4uQi4gTXVzdCBiZSBiaWcgZW5vdWdoIHRvIG5vdCBiZSB0aW55LWFsbG9jYXRlZC4KCXJhbiA6PSBtYWtlKGNoYW4gYm9vbCkKCXJ1bnRpbWUuQWRkQ2xlYW51cCh1bnNhZmUuU3RyaW5nRGF0YShzKSwgZnVuYyhjaCBjaGFuIGJvb2wpIHsKCQljaCA8LSB0cnVlCgl9LCByYW4pCgloIDo9IE1ha2UocykKCgkvLyBDbGVhbiB1cCBzIChob3BlZnVsbHkpIGFuZCBydW4gdGhlIGNsZWFudXAuCglydW50aW1lLkdDKCkKCglzZWxlY3QgewoJY2FzZSA8LXRpbWUuQWZ0ZXIoMSAqIHRpbWUuU2Vjb25kKToKCQl0LkZhdGFsKCJzdHJpbmcgd2FzIGltcHJvcGVybHkgcmV0YWluZWQiKQoJY2FzZSA8LXJhbjoKCX0KCXJ1bnRpbWUuS2VlcEFsaXZlKGgpCn0KCmZ1bmMgVGVzdEhhbmRsZVVuc2FmZVN0cmluZyh0ICp0ZXN0aW5nLlQpIHsKCXZhciB0ZXN0RGF0YSBbXXN0cmluZwoJZm9yIGkgOj0gcmFuZ2UgMTAyNCB7CgkJdGVzdERhdGEgPSBhcHBlbmQodGVzdERhdGEsIHN0cmNvbnYuSXRvYShpKSkKCX0KCXZhciBidWYgW11ieXRlCgl2YXIgaGFudHB1dCBmaWxlLgoKV2hlbiB1c2luZyBleHRlcm5hbCBsaW5raW5nLCBlc3BlY2lhbGx5IHdpdGggLWJ1aWxkbW9kZT1waWUsIHdlIGNhbm5vdApwcmVkaWN0IHRoZSBzcGVjaWZpYyBQTFQgaW5kZXggcmVmZXJlbmNlcyB0aGF0IHRoZSBsaW5rZXIgd2lsbCBpbnNlcnQKaW50byB0aGUgRklQUyBjb2RlIHNlY3Rpb25zLCBzbyB3ZSBtdXN0IHJlYWQgdGhlIGZpbmFsIGxpbmtlZCBleGVjdXRhYmxlCmFmdGVyIGV4dGVybmFsIGxpbmtpbmcsIGNvbXB1dGUgdGhlIGhhc2gsIGFuZCB0aGVuIHdyaXRlIGl0IGJhY2sgdG8gdGhlCmV4ZWN1dGFibGUgaW4gdGhlIGdvOmZpcHNpbmZvIHN1bSBmaWVsZC4gW2hvc3RsaW5rZmlwc10gZG9lcyB0aGlzLgpJdCBmaW5kcyBnbzpmaXBzaW5mbyBlYXNpbHkgYmVjYXVzZSB0aGF0IHN5bWJvbCBpcyBnaXZlbiBpdHMgb3duIHNlY3Rpb24KKC5nby5maXBzaW5mbyBvbiBFTEYsIF9fZ29fZmlwc2luZm8gb24gTWFjaC1PKSwgYW5kIHRoZW4gaXQgY2FuIHVzZSB0aGUKc2VjdGlvbnMgZmllbGQgdG8gZmluZCB0aGUgcmVsZXZhbnQgcGFydHMgb2YgdGhlIGV4ZWN1dGFibGUsIGhhc2ggdGhlbSwKYW5kIGZpbGwgaW4gc3VtLgoKQm90aCBbYXNtYmZpcHNdIGFuZCBbaG9zdGxpbmtmaXBzXSBuZWVkIHRoZSBzYW1lIGhhc2ggY2FsY3VsYXRpb24gY29kZS4KVGhlIFtmaXBzT2JqXSB0eXBlIHByb3ZpZGVzIHRoYXQgY2FsY3VsYXRpb24uCgojIERlYnVnZ2luZwoKSXQgaXMgb2YgY291cnNlIGltcG9zc2libGUgdG8gZGVidWcgYSBtaXNtYXRjaGVkIGhhc2ggZGlyZWN0bHk6CnR3byByYW5kb20gMzItYnl0ZSBzdHJpbmdzIGRpZmZlci4gRm9yIGRlYnVnZ2luZywgdGhlIGxpbmtlciBmbGFnCi1maXBzbyBjYW4gYmUgc2V0IHRvIHRoZSBuYW1lIG9mIGEgZmlsZSAoc3VjaCBhcyAvdG1wL2ZpcHMubykKd2hlcmUgdGhlIGxpbmtlciB3aWxsIHdyaXRlIHRoZSDigJxGSVBTIG9iamVjdOKAnSB0aGF0IGlzIGJlaW5nIGhhc2hlZC4KClRoZXJlIGlzIGFsc28gY29tbWVudGVkLW91dCBjb2RlIGluIGNyeXB0by9pbnRlcm5hbC9maXBzMTQwL2NoZWNrIHRoYXQKd2lsbCB3cml0ZSAvdG1wL2ZpcHNjaGVjay5vIGR1cmluZyB0aGUgcnVuLXRpbWUgdmVyaWZpY2F0aW9uLgoKV2hlbiB0aGUgaGFzaGVzIGRpZmZlciwgdGhlIGZpcnN0IHN0ZXAgaXMgdG8gdW5jb21tZW50IHRoZQovdG1wL2ZpcHNjaGVjay5vLXdyaXRpbmcgY29kZSBhbmQgdGhlbiByZWJ1aWxkIHdpdGgKLWxkZmxhZ3M9LWZpcHNvPS90bXAvZmlwcy5vLiBUaGVuIHdoZW4gdGhlIGhhc2ggY2hlY2sgZmFpbHMsCmNvbXBhcmUgL3RtcC9maXBzLm8gYW5kIC90bXAvZmlwc2NoZWNrLm8gdG8gZmluZCB0aGUgZGlmZmVyZW5jZXMuCiovCgpwYWNrYWdlIGxkCgppbXBvcnQgKAoJImJ1ZmlvIgoJImJ5dGVzIgoJImNtZC9pbnRlcm5hbC9vYmoiCgkiY21kL2ludGVybmFsL29iamFiaSIKCSJjbWQvbGluay9pbnRlcm5hbC9sb2FkZXIiCgkiY21kL2xpbmsvaW50ZXJuYWwvc3ltIgoJImNyeXB0by9obWFjIgoJImNyeXB0by9zaGEyNTYiCgkiZGVidWcvZWxmIgoJImRlYnVnL21hY2hvIgoJImRlYnVnL3BlIgoJImVuY29kaW5nL2JpbmFyeSIKCSJmbXQiCgkiaGFzaCIKCSJpbyIKCSJvcyIKKQoKY29uc3QgZW5hYmxlRklQUyA9IHRydWUKCi8vIGZpcHNTeW1zIGFyZSB0aGUgc3BlY2lhbCBGSVBTIHNlY3Rpb24gYnJhY2tldGluZyBzeW1ib2xzLgp2YXIgZmlwc1N5bXMgPSBbXXN0cnVjdCB7CgluYW1lIHN0cmluZwoJa2luZCBzeW0uU3ltS2luZAoJc3ltICBsb2FkZXIuU3ltCglzZWcgICpzeW0uU2VnbWVudAp9ewoJe25hbWU6ICJnbzp0ZXh0Zmlwc3N0YXJ0Iiwga2luZDogc3ltLlNURVhURklQU1NUQVJULCBzZWc6ICZTZWd0ZXh0fSwKCXtuYW1lOiAiZ286dGV4dGZpcHNlbmQiLCBraW5kOiBzeW0uU1RFWFRGSVBTRU5EfSwKCXtuYW1lOiAiZ286cm9kYXRhZmlwc3NuZywgd3JpdGUgYm9vbCkgewoJLy8gcGFyc2Ugc3JjIChjbWQvY29tcGlsZS9pbnRlcm5hbC90eXBlczIpCglzcmNGaWxlbmFtZSA6PSBmaWxlcGF0aC5Gcm9tU2xhc2gocnVudGltZS5HT1JPT1QoKSArIHNyY0RpciArIGZpbGVuYW1lKQoJZmlsZSwgZXJyIDo9IHBhcnNlci5QYXJzZUZpbGUoZnNldCwgc3JjRmlsZW5hbWUsIG5pbCwgcGFyc2VyLlBhcnNlQ29tbWVudHMpCglpZiBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsKGVycikKCX0KCgkvLyBmaXggcGFja2FnZSBuYW1lCglmaWxlLk5hbWUuTmFtZSA9IHN0cmluZ3MuUmVwbGFjZUFsbChmaWxlLk5hbWUuTmFtZSwgInR5cGVzMiIsICJ0eXBlcyIpCgoJLy8gcmV3cml0ZSBBU1QgYXMgbmVlZGVkCglpZiBhY3Rpb24gOj0gZmlsZW1hcFtmaWxlbmFtZV07IGFjdGlvbiAhPSBuaWwgewoJCWFjdGlvbihmaWxlKQoJfQoKCS8vIGZvcm1hdCBBU1QKCXZhciBidWYgYnl0ZXMuQnVmZmVyCglyZWwsIF8gOj0gZmlsZXBhdGguUmVsKGRzdERpciwgc3JjRGlyKQoJZm10LkZwcmludGYoJmJ1ZiwgIi8vIENvZGUgZ2VuZXJhdGVkIGJ5IFwiZ28gdGVzdCAtcnVuPUdlbmVyYXRlIC13cml0ZT1hbGxcIjsgRE8gTk9UIEVESVQuXG4iKQoJZm10LkZwcmludGYoJmJ1ZiwgIi8vIFNvdXJjZTogJXMvJXNcblxuIiwgZmlsZXBhdGguVG9TbGFzaChyZWwpLCBmaWxlbmFtZSkKCWlmIGVyciA6PSBmb3JtYXQuTm9kZSgmYnVmLCBmc2V0LCBmaWxlKTsgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9CglnZW5lcmF0ZWRDb250ZW50IDo9IGJ1Zi5CeXRlcygpCgoJLy8gcmVhZCBkc3QgKGdvL3R5cGVzKQoJZHN0RmlsZW5hbWUgOj0gZmlsZXBhdGguRnJvbVNsYXNoKHJ1bnRpbWUuR09ST09UKCkgKyBkc3REaXIgKyBmaWxlbmFtZSkKCW9uRGlza0NvbnRlbnQsIGVyciA6PSBvcy5SZWFkRmlsZShkc3RGaWxlbmFtZSkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWxmKCJyZWFkaW5nICVxOiAldiIsIGZpbGVuYW1lLCBlcnIpCgl9CgoJLy8gY29tcGFyZSBvbi1kaXNrIGRzdCB3aXRoIGJ1ZmZlciBnZW5lcmF0ZWQgZnJvbSBzcmMuCglpZiBkIDo9IGRpZmYuRGlmZihmaWxlbmFtZSsiIChvbiBkaXNrIGluICIrZHN0RGlyKyIpIiwgb25EaXNrQ29udGVudCwgZmlsZW5hbWUrIiAoZ2VuZXJhdGVkIGZyb20gIitzcmNEaXIrIikiLCBnZW5lcmF0ZWRDb250ZW50KTsgZCAhPSBuaWwgewoJCWlmIHdyaXRlIHsKCQkJdC5Mb2dmKCJhcHBseWluZyBjaGFuZ2U6XG4lcyIsIGQpCgkJCWlmIGVyciA6PSBvcy5Xcml0ZUZpbGUoZHN0RmlsZW5hbWUsIGdlbmVyYXRlZENvbnRlbnQsIDBvNjQ0KTsgZXJyICE9IG5pbCB7CgkJCQl0LkZhdGFsZigid3JpdGluZyAlcTogJXYiLCBmaWxlbmFtZSwgZXJyKQoJCQl9CgkJfSBlbHNlIHsKCQkJdC5FcnJvcmYoImZpbGUgb24gZGlzayBpbiAlcyBpcyBzdGFsZTpcbiVzIiwgZHN0RGlyLCBkKQoJCX0KCX0KfQoKdHlwZSBhY3Rpb24gZnVuYyhpbiAqYXN0LkZpbGUpCgp2YXIgZmlsZW1hcCA9IG1hcFtzdHJpbmddYWN0aW9uewoJImFsaWFzLmdvIjogZml4VG9rZW5Qb3MsCgkiYXNzaWdubWVudHMuZ28iOiBmdW5jKGYgKmFzdC5GaWxlKSB7CgkJcmVuYW1lSW1wb3J0UGF0aChmLCBgImNtZC9jb21waWxlL2ludGVybmFsL3N5bnRheCItPiJnby9hc3QiYCkKCQlyZW5hbWVTZWxlY3RvckV4cHJzKGYsICJzeW50YXguTmFtZS0+YXN0LklkZW50IiwgImlkZW50LlZhbHVlLT5pZGVudC5OYW1lIiwgImFzdC5Qb3MtPnRva2VuLlBvcyIpIC8vIG11c3QgaGFwcGVuIGJlZm9yZSByZW5hbWluZyBpZGVudGlmaWVycwoJCXJlbmFtZUlkZW50cyhmLCAic3ludGF4LT5hc3QiLCAicG9zZXItPnBvc2l0aW9uZXIiLCAibm9wb3MtPm5vcG9zbiIpCgl9LAoJImFycmF5LmdvIjogICAgICAgICAgbmlsLAoJImFwaV9wcmVkaWNhdGVzLmdvIjogbmlsLAoJImJhc2ljLmdvIjogICAgICAgICAgbmlsLAoJImJ1aWx0aW5zLmdvIm8gOj0gdHMuTmFub3NlY29uZCgpICE9IDAKCQlpZiAhaXNNdGltZSB8fCAhZml0c09jdGFsIHx8IG5lZWRzTmFubyB7CgkJCXByZWZlclBBWCA9IHRydWUgLy8gVVNUQVIgbWF5IHRydW5jYXRlIHN1Yi1zZWNvbmQgbWVhc3VyZW1lbnRzCgkJCWlmIHBheEtleSA9PSBwYXhOb25lIHsKCQkJCXdoeU5vUEFYID0gZm10LlNwcmludGYoIlBBWCBjYW5ub3QgZW5jb2RlICVzPSV2IiwgbmFtZSwgdHMpCgkJCQlmb3JtYXQubXVzdE5vdEJlKEZvcm1hdFBBWCkKCQkJfSBlbHNlIHsKCQkJCXBheEhkcnNbcGF4S2V5XSA9IGZvcm1hdFBBWFRpbWUodHMpCgkJCX0KCQl9CgkJaWYgdiwgb2sgOj0gaC5QQVhSZWNvcmRzW3BheEtleV07IG9rICYmIHYgPT0gZm9ybWF0UEFYVGltZSh0cykgewoJCQlwYXhIZHJzW3BheEtleV0gPSB2CgkJfQoJfQoKCS8vIENoZWNrIGJhc2ljIGZpZWxkcy4KCXZhciBibGsgYmxvY2sKCXY3IDo9IGJsay50b1Y3KCkKCXVzdGFyIDo9IGJsay50b1VTVEFSKCkKCWdudSA6PSBibGsudG9HTlUoKQoJdmVyaWZ5U3RyaW5nKGguTmFtZSwgbGVuKHY3Lm5hbWUoKSksICJOYW1lIiwgcGF4UGF0aCkKCXZlcmlmeVN0cmluZyhoLkxpbmtuYW1lLCBsZW4odjcubGlua05hbWUoKSksICJMaW5rbmFtZSIsIHBheExpbmtwYXRoKQoJdmVyaWZ5U3RyaW5nKGguVW5hbWUsIGxlbih1c3Rhci51c2VyTmFtZSgpKSwgIlVuYW1lIiwgcGF4VW5hbWUpCgl2ZXJpZnlTdHJpbmcoaC5HbmFtZSwgbGVuKHVzdGFyLmdyb3VwTmFtZSgpKSwgIkduYW1lIiwgcGF4R25hbWUpCgl2ZXJpZnlOdW1lcmljKGguTW9kZSwgbGVuKHY3Lm1vZGUoKSksICJNb2RlIiwgcGF4Tm9uZSkKCXZlcmlmeU51bWVyaWMoaW50NjQoaC5VaWQpLCBsZW4odjcudWlkKCkpLCAiVWlkIiwgcGF4VWlkKQoJdmVyaWZ5TnVtZXJpYyhpbnQ2NChoLkdpZCksIGxlbih2Ny5naWQoKSksICJHaWQiLCBwYXhHaWQpCgl2ZXJpZnlOdW1lcmljKGguU2l6ZSwgbGVuKHY3LnNpemUoKSksICJTaXplIiwgcGF4U2l6ZSkKCXZlcmlmeU51bWVyaWMoaC5EZXZtYWpvciwgbGVuKHVzdGFyLmRldk1ham9yKCkpLCAiRGV2bWFqb3IiLCBwYXhOb25lKQoJdmVyaWZ5TnVtZXJpYyhoLkRldm1pbm9yLCBsZW4odXN0YXIuZGV2TWlub3IoKSksICJEZXZtaW5vciIsIHBheE5vbmUpCgl2ZXJpZnlUaW1lKGguTW9kVGltZSwgbGVuKHY3Lm1vZFRpbWUoKSksICJNb2RUaW1lIiwgcGF4TXRpbWUpCgl2ZXJpZnlUaW1lKGguQWNjZXNzVGltZSwgbGVuKGdudS5hY2Nlc3NUaW1lKCkpLCAiQWNjZXNzVGltZSIsIHBheEF0aW1lKQoJdmVyaWZ5VGltZShoLkNoYW5nZVRpbWUsIGxlbihnbnUuY2hhbmdlVGltZSgpKSwgIkNoYW5nZVRpbWUiLCBwYXhDdGltZSkKCgkvLyBDaGVjayBmb3IgaGVhZGVyLW9ubHkgdHlwZXMuCgl2YXIgd2h5T25seVBBWCwgd2h5T25seUdOVSBzdHJpbmcKCXN3aXRjaCBoLlR5cGVmbGFnIHsKCWNhc2UgVHlwZVJlZywgVHlwZUNoYXIsIFR5cGVCbG9jaywgVHlwZUZpZm8sIFR5cGVHTlVTcGFyc2U6CgkJLy8gRXhjbHVkZSBUeXBlTGluayBhbmQgVHlwZVN5bWxpbmssIHNpbmNlIHRoZXkgbWF5IHJlZmVyZW5jZSBkaXJlY3Rvcmllcy4KCQlpZiBzdHJpbmdzLkhhc1N1ZmZpeChoLk5hbWUsICIvIikgewoJCQlyZXR1cm4gRm9ybWF0VW5rbm93biwgbmlsLCBoZWFkZXJFcnJvcnsiZmlsZW5hbWUgbWF5IG5vdCBoYXZlIHRyYWlsaW5nIHNsYXNoIn0KCQl9CgljYXNlIFR5cGVYSGVhZGVyLCBUeXBlR05VTG9uZ05hbWUsIFR5cGVHTlVMb25nTGluazoKCQlyZXR1cm4gRm9ybWF0VW5rbm93biwgbmlsLCBoZWFkZXJFcnJvcnsiY2Fubm90IG1hbnVhbGx5IGVuY29kZSBUeXBlWEhlYWRlciwgVHlwZUdOVUxvbmdOYW1lLCBvciBUeXBlR05VTG9uZ0xpbmsgaGVhZGVycyJ9CgljYXNlIFR5cGVYR2xvYmFsSGVhZGVyOgoJCWgyIDo9IEhlYWRlcntOYW1lOiBoLk5hbWUsIFR5cGVmbGFnOiBoLlR5cGVmbGFnLCBYYXR0cnM6IGhyZCB0aGF0IHRoZSBpbnB1dCBpcyBkZWFkIG5vdyBhbmQgbXVzdCBub3QgYmUgcmVmZXJlbmNlZC4KCQkJb3ZlcndyaXR0ZW5bby5hcmdzW3Jtd11dID0gdHJ1ZQoJCX0gZWxzZSBpZiBvLm9wID09ICJkZXJlZiIgewoJCQljYW5vbltvXSA9IGNhbm9uW28uYXJnc1swXV0KCQl9IGVsc2UgewoJCQljYW5vbltvXSA9IG8KCQl9Cgl9CgoJLy8gQ29tcHV0ZSBsaXZlIHJhbmdlcyBvZiBlYWNoIGNhbm9uaWNhbCBvcC4KCS8vCgkvLyBGaXJzdCwgZmluZCB0aGUgbGFzdCB1c2Ugb2YgZWFjaCBvcC4KCWxhc3RVc2VzIDo9IG1ha2UobWFwWypvcF0qb3ApIC8vIENhbm9uaWNhbCBjcmVhdGlvbiBvcCAtPiBsYXN0IHVzZSBvcAoJZm9yIF8sIG9wIDo9IHJhbmdlIGZuLm9wcyB7CgkJZm9yIF8sIGFyZyA6PSByYW5nZSBvcC5hcmdzIHsKCQkJbGFzdFVzZXNbY2Fub25bYXJnXV0gPSBvcAoJCX0KCX0KCS8vIEludmVydCB0aGUgbGFzdCB1c2VzIG1hcCB0byBnZXQgYSBtYXAgZnJvbSBvcCB0byB0aGUgKGNhbm9uaWNhbCkgdmFsdWVzCgkvLyB0aGF0IGRpZSBhdCB0aGF0IG9wLgoJbGFzdFVzZU1hcCA6PSBtYWtlKG1hcFsqb3BdW10qb3ApIC8vIG9wIG9mIGxhc3QgdXNlIC0+IChjYW5vbmljYWwpIGNyZWF0aW9uIG9wcwoJZm9yIGRlZiwgbGFzdFVzZSA6PSByYW5nZSBsYXN0VXNlcyB7CgkJbGFzdFVzZU1hcFtsYXN0VXNlXSA9IGFwcGVuZChsYXN0VXNlTWFwW2xhc3RVc2VdLCBkZWYpCgl9CgoJLy8gUHJlcGFyZSBmb3IgYXNzaWdubWVudHMKCXJlZ1VzZWQgOj0gbWFrZShbXXJlZ1NldCwgbGVuKGZuLm9wcykpIC8vIEluLXVzZSByZWdpc3RlcnMgYXQgZWFjaCBvcAoJZm9yIGkgOj0gcmFuZ2UgcmVnVXNlZCB7CgkJLy8gWDE1L1kxNS9aMTUgaXMgcmVzZXJ2ZWQgYnkgdGhlIEdvIEFCSQoJCXJlZ1VzZWRbaV0uaW5Vc2VbcmVnQ2xhc3NaXSB8PSAxIDw8IDE1CgkJLy8gSzAgaXMgY29udGV4dHVhbCAoaWYgdXNlZCBhcyBhbiBvcG1hc2ssIGl0IG1lYW5zIG5vIG1hc2spLiBUb28KCQkvLyBjb21wbGljYXRlZCwgc28ganVzdCBpZ25vcmUgaXQuCgkJcmVnVXNlZFtpXS5pblVzZVtyZWdDbGFzc0tdIHw9IDEgPDwgMAoJfQoJbG9jcyA6PSBtYWtlKG1hcFsqb3BdbG9jKQoJYXNzaWduIDo9IGZ1bmMobyAqb3AsIGwgbG9jKSB7CgkJaWYgaGF2ZSwgb2sgOj0gbG9jc1tvXTsgb2sgewoJCQlmYXRhbGYoIm9wICUrdiBhbHJlYWR5IGFzc2lnbmVkIGxvY2F0aW9uICV2IChuZXcgJXYpIiwgbywgaGF2ZSwgbCkKCQkJcmV0dXJuCgkJfQoJCWlmIG8gPT0gY2Fub25bb10gewoJCQkvLyBNYXJrIHRoaXMgbG9jYXRpb24gdXNlZCBvdmVyIG8ncyBsaXZlIHJhbmdlCgkJCWZvciBpIDo9IG9wSW5kZXhlc1tvXTsgaSA8IG9wSW5kZXhlc1tsYXN0VXNlc1tvXV07IGkrKyB7CgkJCQlyZWdVc2VkW2ldLnVzZWQoZm4ub3BzW2ldLCBsKQoJCQl9CgkJfQoJCWxvY3Nbb10gPSBsCgl9CgoJLy8gQXNzaWduIGZpeGVkIGxvY2F0aW9ucwoJaWQgOj0gMAoJZm9yIF8sIG8gOj0gcmFuZ2UgZm4ub3BzIHsKCQlzd2l0Y2ggby5vcCB7CgkJY2FzZSAiYXJnIjoKCQkJaWYgdHJhY2VSZWdBbGxvYyB7CgkJCQlsb2cuUHJpbnRmKCJmaXhlZCBvcCAlK3YiLCBvKQoJCQl9CgkJCWFzc2lnbihvLCBvLmMuKGxvY1JlZykpCgkJY2FzZSAiY29uc3QiOgoJCQlpZiB0cmFjZVJlZ0FsbG9jIHsKCQkJCWxvZy5QcmludGYoImZpeGVkIG9wICUrdiIsIG8pCgkJCX0KCQkJbmFtZSA6PSBvLm5hbWUKCQkJaWYgbmFtZSA9PSAiIiB7CgkJCQluYW1lID0gZm10LlNwcmludGYoIiVzXyVkPD4iLCBuYW1lQmFzZSwgaWQpCgkJCQlpZCsrCgkJCX0gZWxzZSBpZiBuYW1lWzBdID09ICcqJyB7CgkJCQluYW1lID0gbmFtZUJhc2UgKyBuYW1lWzE6XQoJCQl9CgkJCWFzc2lnbihvLCBsb2NNZW17bG9jUmVne2NsczogcmVnQ2xhc3NGaXhlZCwgcmVnOiByZWdTQn0sIDAsIG5hbWV9KQoJCWNhc2UgInJldHVybiI6CgkJbGVzCgl9CglpZiB0eXAuS2luZCgpID09IHR5cGVzLlRTVFJJTkcgewoJCXJldHVybiBlbWJlZFN0cmluZwoJfQoJaWYgdHlwLklzU2xpY2UoKSAmJiB0eXAuRWxlbSgpLktpbmQoKSA9PSB0eXBlcy5UVUlOVDggewoJCXJldHVybiBlbWJlZEJ5dGVzCgl9CglyZXR1cm4gZW1iZWRVbmtub3duCn0KCmZ1bmMgZW1iZWRGaWxlTmFtZVNwbGl0KG5hbWUgc3RyaW5nKSAoZGlyLCBlbGVtIHN0cmluZywgaXNEaXIgYm9vbCkgewoJbmFtZSwgaXNEaXIgPSBzdHJpbmdzLkN1dFN1ZmZpeChuYW1lLCAiLyIpCglpIDo9IHN0cmluZ3MuTGFzdEluZGV4Qnl0ZShuYW1lLCAnLycpCglpZiBpIDwgMCB7CgkJcmV0dXJuICIuIiwgbmFtZSwgaXNEaXIKCX0KCXJldHVybiBuYW1lWzppXSwgbmFtZVtpKzE6XSwgaXNEaXIKfQoKLy8gZW1iZWRGaWxlTGVzcyBpbXBsZW1lbnRzIHRoZSBzb3J0IG9yZGVyIGZvciBhIGxpc3Qgb2YgZW1iZWRkZWQgZmlsZXMuCi8vIFNlZSB0aGUgY29tbWVudCBpbnNpZGUgLi4vLi4vLi4vLi4vZW1iZWQvZW1iZWQuZ28ncyBGaWxlcyBzdHJ1Y3QgZm9yIHJhdGlvbmFsZS4KZnVuYyBlbWJlZEZpbGVMZXNzKHgsIHkgc3RyaW5nKSBib29sIHsKCXhkaXIsIHhlbGVtLCBfIDo9IGVtYmVkRmlsZU5hbWVTcGxpdCh4KQoJeWRpciwgeWVsZW0sIF8gOj0gZW1iZWRGaWxlTmFtZVNwbGl0KHkpCglyZXR1cm4geGRpciA8IHlkaXIgfHwgeGRpciA9PSB5ZGlyICYmIHhlbGVtIDwgeWVsZW0KfQoKLy8gV3JpdGVFbWJlZCBlbWl0cyB0aGUgaW5pdCBkYXRhIGZvciBhIC8vZ286ZW1iZWQgdmFyaWFibGUsCi8vIHdoaWNoIGlzIGVpdGhlciBhIHN0cmluZywgYSBbXWJ5dGUsIG9yIGFuIGVtYmVkLkZTLgpmdW5jIFdyaXRlRW1iZWQodiAqaXIuTmFtZSkgewoJLy8gVE9ETyhtZGVtcHNreSk6IFVzZXIgZXJyb3JzIHNob3VsZCBiZSByZXBvcnRlZCBieSB0aGUgZnJvbnRlbmQuCgoJY29tbWVudFBvcyA6PSAoKnYuRW1iZWQpWzBdLlBvcwoJaWYgYmFzZS5GbGFnLkNmZy5FbWJlZC5QYXR0ZXJucyA9PSBuaWwgewoJCWJhc2UuRXJyb3JmQXQoY29tbWVudFBvcywgMCwgImludmFsaWQgZ286ZW1iZWQ6IGJ1aWxkIHN5c3RlbSBkaWQgbm90IHN1cHBseSBlbWJlZCBjb25maWd1cmF0aW9uIikKCQlyZXR1cm4KCX0KCWtpbmQgOj0gZW1iZWRLaW5kKHYuVHlwZSgpKQoJaWYga2luZCA9PSBlbWJlZFVua25vd24gewoJCWJhc2UuRXJyb3JmQXQodi5Qb3MoKSwgMCwgImdvOmVtYmVkIGNhbm5vdCBhcHBseSB0byB2YXIgb2YgdHlwZSAldiIsIHYuVHlwZSgpKQoJCXJldHVybgoJfQoKCWZpbGVzIDo9IGVtYmVkRmlsZUxpc3Qodiwga2luZCkKCWlmIGJhc2UuRXJyb3JzKCkgPiAwIHsKCQlyZXR1cm4KCX0KCXN3aXRjaCBraW5kIHsKCWNhc2UgZW1iZWRTdHJpbmcsIGVtYmVkQnl0ZXM6CgkJZmlsZSA6PSBmaWxlc1swXQoJCWZzeW0sIHNpemUsIGVyciA6PSBmaWxlU3RyaW5nU3ltKHYuUG9zKCksIGJhc2UuRmxhZy5DZmcuRW1iZWQuRmlsZXNbZmlsZV0sIGtpbmQgPT0gZW1iZWRTdHJpbmcsIG5pbCkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJYmFzZS5FcnJvcmZBdCh2LlBvcygpLCAwLCAiZW1iZWQgJXM6ICV2IiwgZmlsZSwgZXJyKQoJCX0KCQlzeW0gOj0gdi5MaW5rc3ltKCkKCQlvZmYgOj0gMAoJCW9mZiA9IG9iancuU3ltUHRyKHN5bSwgb2ZmLCBmc3ltLCAwKSAgICAgICAvLyBkYXRhIHN0cmluZwoJCW9mZiA9IG9iancuVWludHB0cihzeW0sIG9mZiwgdWludDY0KHNpemUpKSAvLyBsZW4KCQlpZiBraW5kID09IGVtYmVkQnl0ZXMgewoJCQlvYmp3LlVpbnRwdHIoc3ltLCBvZmYsIHVpbnQ2NChzaXplKSkgLy8gY2FwIGZvciBzbGljZQoJCX0KCgljYXNlIGVtYmVkRmlsZXM6CgkJc2xpY2VkYXRhIDo9IHYuU3ltKCkuUGtnLkxvb2t1cCh2LlN5bSgpLk5hbWUgKyBgLmZpbGVzYCkuTGlua3N5bSgpCgkJb2ZmIDo9IDAKCQkvLyBbXWZpbGVzIHBvaW50ZWQgYXQgYnkgRmlsZXMKCQlvZmlkZGxlCgkJeyJhYmNkZWZhYmNkZWYiLCAiZiIsIGxlbigiYWJjZGVmYWJjZGUiKX0sIC8vIGxhc3QgYnl0ZQoJCXsiemFiY2RlZmFiY2RlZiIsICJ6IiwgMH0sICAgICAgICAgICAgICAgICAvLyBmaXJzdCBieXRlCgkJeyJh4pi6YuKYu2PimLlkIiwgImIiLCBsZW4oImHimLoiKX0sICAgICAgICAgICAgICAgLy8gbm9uLWFzY2lpCgl9Cglmb3IgXywgdGVzdCA6PSByYW5nZSB0ZXN0Q2FzZXMgewoJCWFjdHVhbCA6PSBMYXN0SW5kZXhCeXRlKHRlc3QucywgdGVzdC5zZXBbMF0pCgkJaWYgYWN0dWFsICE9IHRlc3Qub3V0IHsKCQkJdC5FcnJvcmYoIkxhc3RJbmRleEJ5dGUoJXEsJWMpID0gJXY7IHdhbnQgJXYiLCB0ZXN0LnMsIHRlc3Quc2VwWzBdLCBhY3R1YWwsIHRlc3Qub3V0KQoJCX0KCX0KfQoKZnVuYyBzaW1wbGVJbmRleChzLCBzZXAgc3RyaW5nKSBpbnQgewoJbiA6PSBsZW4oc2VwKQoJZm9yIGkgOj0gbjsgaSA8PSBsZW4ocyk7IGkrKyB7CgkJaWYgc1tpLW46aV0gPT0gc2VwIHsKCQkJcmV0dXJuIGkgLSBuCgkJfQoJfQoJcmV0dXJuIC0xCn0KCmZ1bmMgVGVzdEluZGV4UmFuZG9tKHQgKnRlc3RpbmcuVCkgewoJY29uc3QgY2hhcnMgPSAiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5IgoJZm9yIHRpbWVzIDo9IDA7IHRpbWVzIDwgMTA7IHRpbWVzKysgewoJCWZvciBzdHJMZW4gOj0gNSArIHJhbmQuSW50big1KTsgc3RyTGVuIDwgMTQwOyBzdHJMZW4gKz0gMTAgeyAvLyBBcmJpdHJhcnkKCQkJczEgOj0gbWFrZShbXWJ5dGUsIHN0ckxlbikKCQkJZm9yIGkgOj0gcmFuZ2UgczEgewoJCQkJczFbaV0gPSBjaGFyc1tyYW5kLkludG4obGVuKGNoYXJzKSldCgkJCX0KCQkJcyA6PSBzdHJpbmcoczEpCgkJCWZvciBpIDo9IDA7IGkgPCA1MDsgaSsrIHsKCQkJCWJlZ2luIDo9IHJhbmQuSW50bihsZW4ocykgKyAxKQoJCQkJZW5kIDo9IGJlZ2luICsgcmFuZC5JbnRuKGxlbihzKSsxLWJlZ2luKQoJCQkJc2VwIDo9IHNbYmVnaW46ZW5kXQoJCQkJaWYgaSU0ID09IDAgewoJCQkJCXBvcyA6PSByYW5kLkludG4obGVuKHNlcCkgKyAxKQoJCQkJCXNlcCA9IHNlcFs6cG9zXSArICJBIiArIHNlcFtwb3M6XQoJCQkJfQoJCQkJd2FudCA6PSBzaW1wbGVJbmRleChzLCBzZXApCgkJCQlyZXMgOj0gSW5kZXgocywgc2VwKQoJCQkJaWYgcmVzICE9IHdhbnQgewoJCQkJCXQuRXJyb3JmKCJJbmRleCglcywlcykgPSAlZDsgd2FudCAlZCIsIHMsIHNlcCwgcmVzLCB3YW50KQoJCQkJfQoJCQl9CgkJfQoJfQp9CgpmdW5jIFRlc3RJbmRleFJ1bmUodCAqdGVzdGluZy5UKSB7Cgl0ZXN0cyA6PSBbXXN0cnVjdCB7CgkJaW4gICBzdHJpbmcKCQlydW5lIHJ1bmUKCQl3YW50IGludAoJfXsKCQl7IiIsICdhJywgLTF9LAoJCXsiIiwgJ+KYuicsIC0xfSwKCQl7ImZvbyIsICfimLknLCAtMX0sCgkJeyJmb28iLCAnbycsIDF9LAoJCXsiZm9v4pi6YmFyIiwgJ+KYuicsIDN9LAoJCXsiZm9v4pi64pi74pi5YmFyIiwgJ+KYuScsIDl9LAoJCXsiYSBBIHgiLCAnQScsIDJ9LAoJCXsic29tZV90ZXh0PXNvbWVfdmFsdWUiLCAnPScsIDl9LAoJCXsi4pi6YSIsICdhJywgM30sCgkJeyJh4pi74pi6YiIsICfimLonLCA0fSwKCgkJLy8gUnVuZUVycm9yIHNob3VsZCBtYXRjaCBhbnkgaW52YWxpZCBVVEYtOCBieXRlIHNlcXVlbmNlLgoJCXsi77+9IiwgJ++/vScsIDB9LAoJCXsiXHhmZiIsICfvv70nLCAwfSwKCQl7IuKYu3jvv70iLCAn77+9JywgbGVuKCLimLt4Iil9LAoJCXsi4pi7eFx4ZTJceDk4IiwgJ++/vScsIGxlbigi4pi7eCIpfSwKCQl7IuKYu3hceGUyXHg5OO+/vSIsICfvv70nLCBsZW4oIuKYu3giKX0sCgkJeyLimLt4XHhlMlx4OTh4IiwgJ++/vScsIGxlbigi4pi7eCIpfSwKCgkJLy8gSW52YWxpZCBydW5lIHZhbHVlcyBzaG91bGQgbmV2ZXIgbWF0Y2guCgkJeyJh4pi6YuKYu2PimLlkXHhlMlx4OTjvv71ceGZm77+9XHhlZFx4YTBceDgwIiwgLTEsIC0xfWVhZHkgYXJlKS4KZnVuYyBjYW5vbmljYWxpemVSZXBsYWNlUGF0aChsb2FkZXJzdGF0ZSAqU3RhdGUsIHIgbW9kdWxlLlZlcnNpb24sIG1vZFJvb3Qgc3RyaW5nKSBtb2R1bGUuVmVyc2lvbiB7CglpZiBmaWxlcGF0aC5Jc0FicyhyLlBhdGgpIHx8IHIuVmVyc2lvbiAhPSAiIiB8fCBtb2RSb290ID09ICIiIHsKCQlyZXR1cm4gcgoJfQoJd29ya0ZpbGVQYXRoIDo9IFdvcmtGaWxlUGF0aChsb2FkZXJzdGF0ZSkKCWlmIHdvcmtGaWxlUGF0aCA9PSAiIiB7CgkJcmV0dXJuIHIKCX0KCWFicyA6PSBmaWxlcGF0aC5Kb2luKG1vZFJvb3QsIHIuUGF0aCkKCWlmIHJlbCwgZXJyIDo9IGZpbGVwYXRoLlJlbChmaWxlcGF0aC5EaXIod29ya0ZpbGVQYXRoKSwgYWJzKTsgZXJyID09IG5pbCB7CgkJcmV0dXJuIG1vZHVsZS5WZXJzaW9ue1BhdGg6IFRvRGlyZWN0b3J5UGF0aChyZWwpLCBWZXJzaW9uOiByLlZlcnNpb259Cgl9CgkvLyBXZSBjb3VsZG4ndCBtYWtlIHRoZSB2ZXJzaW9uJ3MgcGF0aCByZWxhdGl2ZSB0byB0aGUgd29ya3NwYWNlJ3MgcGF0aCwKCS8vIHNvIGp1c3QgcmV0dXJuIHRoZSBhYnNvbHV0ZSBwYXRoLiBJdCdzIHRoZSBiZXN0IHdlIGNhbiBkby4KCXJldHVybiBtb2R1bGUuVmVyc2lvbntQYXRoOiBUb0RpcmVjdG9yeVBhdGgoYWJzKSwgVmVyc2lvbjogci5WZXJzaW9ufQp9CgovLyByZXNvbHZlUmVwbGFjZW1lbnQgcmV0dXJucyB0aGUgbW9kdWxlIGFjdHVhbGx5IHVzZWQgdG8gbG9hZCB0aGUgc291cmNlIGNvZGUKLy8gZm9yIG06IGVpdGhlciBtIGl0c2VsZiwgb3IgdGhlIHJlcGxhY2VtZW50IGZvciBtIChpZmYgbSBpcyByZXBsYWNlZCkuCi8vIEl0IGFsc28gcmV0dXJucyB0aGUgbW9kcm9vdCBvZiB0aGUgbW9kdWxlIHByb3ZpZGluZyB0aGUgcmVwbGFjZW1lbnQgaWYKLy8gb25lIHdhcyBmb3VuZC4KZnVuYyByZXNvbHZlUmVwbGFjZW1lbnQobG9hZGVyc3RhdGUgKlN0YXRlLCBtIG1vZHVsZS5WZXJzaW9uKSBtb2R1bGUuVmVyc2lvbiB7CglpZiByIDo9IFJlcGxhY2VtZW50KGxvYWRlcnN0YXRlLCBtKTsgci5QYXRoICE9ICIiIHsKCQlyZXR1cm4gcgoJfQoJcmV0dXJuIG0KfQoKZnVuYyB0b1JlcGxhY2VNYXAocmVwbGFjZW1lbnRzIFtdKm1vZGZpbGUuUmVwbGFjZSkgbWFwW21vZHVsZS5WZXJzaW9uXW1vZHVsZS5WZXJzaW9uIHsKCXJlcGxhY2VNYXAgOj0gbWFrZShtYXBbbW9kdWxlLlZlcnNpb25dbW9kdWxlLlZlcnNpb24sIGxlbihyZXBsYWNlbWVudHMpKQoJZm9yIF8sIHIgOj0gcmFuZ2UgcmVwbGFjZW1lbnRzIHsKCQlpZiBwcmV2LCBkdXAgOj0gcmVwbGFjZU1hcFtyLk9sZF07IGR1cCAmJiBwcmV2ICE9IHIuTmV3IHsKCQkJYmFzZS5GYXRhbGYoImdvOiBjb25mbGljdGluZyByZXBsYWNlbWVudHMgZm9yICV2OlxuXHQldlxuXHQldiIsIHIuT2xkLCBwcmV2LCByLk5ldykKCQl9CgkJcmVwbGFjZU1hcFtyLk9sZF0gPSByLk5ldwoJfQoJcmV0dXJuIHJlcGxhY2VNYXAKfQoKLy8gaW5kZXhNb2RGaWxlIHJlYnVpbGRzIHRoZSBpbmRleCBvZiBtb2RGaWxlLgovLyBJZiBtb2RGaWxlIGhhcyBiZWVuIGNoYW5nZWQgc2luY2UgaXQgd2FzIGZpcnN0IHJlYWQsCi8vIG1vZEZpbGUuQ2xlYW51cCBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgaW5kZXhNb2RGaWxlLgpmdW5jIGluZGV4TW9kRmlsZShkYXRhIFtdYnl0ZSwgbW9kRmlsZSAqbW9kZmlsZS5GaWxlLCBtb2QgbW9kdWxlLlZlcnNpb24sIG5lZWRzRml4IGJvb2wpICptb2RGaWxlSW5kZXggewoJaSA6PSBuZXcobW9kRmlsZUluZGV4KQoJaS5kYXRhID0gZGF0YQoJaS5kYXRhTmVlZHNGaXggPSBuZWVkc0ZpeAoKCWkubW9kdWxlID0gbW9kdWxlLlZlcnNpb257fQoJaWYgbW9kRmlsZS5Nb2R1bGUgIT0gbmlsIHsKCQlpLm1vZHVsZSA9IG1vZEZpbGUuTW9kdWxlLk1vZAoJfQoKCWkuZ29WZXJzaW9uID0gIiIKCWlmIG1vZEZpbGUuR28gPT0gbmlsIHsKCQlyYXdHb1ZlcnNpb24uU3RvcmUobW9kLCAiIikgdGhhbgoJCQkvLyBNQVhfUEFUSCAoMjYwIGNoYXJhY3RlcnMpIGJlY2F1c2UgdGhhdCBtYXkgaW50ZXJmZXJlIHdpdGggbmF2aWdhdGlvbgoJCQkvLyBpbiBzb21lIFdpbmRvd3MgcHJvZ3JhbXMuIEhvd2V2ZXIsIGNtZC9nbyBzaG91bGQgYmUgYWJsZSB0byBoYW5kbGUKCQkJLy8gbG9uZyBwYXRocyBqdXN0IGZpbmUsIGFuZCB3ZSBleHBlY3QgcGVvcGxlIHRvIHVzZSAnZ28gY2xlYW4nIHRvCgkJCS8vIG1hbmlwdWxhdGUgdGhlIG1vZHVsZSBjYWNoZSwgc28gaXQgc2hvdWxkIGJlIGhhcm1sZXNzIHRvIHNldCBoZXJlLAoJCQkvLyBhbmQgaW4gc29tZSBjYXNlcyBtYXkgYmUgbmVjZXNzYXJ5IGluIG9yZGVyIHRvIGRvd25sb2FkIG1vZHVsZXMgd2l0aAoJCQkvLyBsb25nIGJyYW5jaCBuYW1lcy4KCQkJLy8KCQkJLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9naXQtZm9yLXdpbmRvd3MvZ2l0L3dpa2kvR2l0LWNhbm5vdC1jcmVhdGUtYS1maWxlLW9yLWRpcmVjdG9yeS13aXRoLWEtbG9uZy1wYXRoLgoJCQlpZiBfLCBlcnIgOj0gci5ydW5HaXQoY3R4LCAiZ2l0IiwgImNvbmZpZyIsICJjb3JlLmxvbmdwYXRocyIsICJ0cnVlIik7IGVyciAhPSBuaWwgewoJCQkJb3MuUmVtb3ZlQWxsKHIuZGlyKQoJCQkJcmV0dXJuIG5pbCwgZXJyCgkJCX0KCQl9Cgl9CglyLnNoYTI1Nkhhc2hlcyA9IHIuY2hlY2tDb25maWdTSEEyNTYoY3R4KQoJci5yZW1vdGVVUkwgPSByLnJlbW90ZQoJci5yZW1vdGUgPSAib3JpZ2luIgoJcmV0dXJuIHIsIG5pbAp9Cgp0eXBlIGdpdFJlcG8gc3RydWN0IHsKCWN0eCBjb250ZXh0LkNvbnRleHQKCglyZW1vdGUsIHJlbW90ZVVSTCBzdHJpbmcKCWxvY2FsICAgICAgICAgICAgIGJvb2wgLy8gbG9jYWwgb25seSBsb29rdXBzOyBubyByZW1vdGUgZmV0Y2hlcwoJZGlyICAgICAgICAgICAgICAgc3RyaW5nCgoJLy8gUmVwbyB1c2VzIHRoZSBTSEEyNTYgZm9yIGhhc2hlcywgc28gZXhwZWN0IHRoZSBoYXNoZXMgdG8gYmUgMjU2LzQgPT0gNjQtYnl0ZXMgaW4gaGV4LgoJc2hhMjU2SGFzaGVzIGJvb2wKCgltdSBsb2NrZWRmaWxlLk11dGV4IC8vIHByb3RlY3RzIGZldGNoTGV2ZWwgYW5kIGdpdCByZXBvIHN0YXRlCgoJZmV0Y2hMZXZlbCBpbnQKCglzdGF0Q2FjaGUgcGFyLkVyckNhY2hlW3N0cmluZywgKlJldkluZm9dCgoJcmVmc09uY2Ugc3luYy5PbmNlCgkvLyByZWZzIG1hcHMgYnJhbmNoIGFuZCB0YWcgcmVmcyAoZS5nLiwgIkhFQUQiLCAicmVmcy9oZWFkcy9tYXN0ZXIiKQoJLy8gdG8gY29tbWl0cyAoZS5nLiwgIjM3ZmZkMmU3OThhZmRlODI5YTM0ZTg5NTViNzE2YWI3MzBiMmE2ZDYiKQoJcmVmcyAgICBtYXBbc3RyaW5nXXN0cmluZwoJcmVmc0VyciBlcnJvcgoKCWxvY2FsVGFnc09uY2Ugc3luYy5PbmNlCglsb2NhbFRhZ3MgICAgIHN5bmMuTWFwIC8vIG1hcFtzdHJpbmddYm9vbAp9Cgpjb25zdCAoCgkvLyBIb3cgbXVjaCBoYXZlIHdlIGZldGNoZWQgaW50byB0aGUgZ2l0IHJlcG8gKGluIHRoaXMgcHJvY2Vzcyk/CglmZXRjaE5vbmUgPSBpb3RhIC8vIG5vdGhpbmcgeWV0CglmZXRjaFNvbWUgICAgICAgIC8vIHNoYWxsb3cgZmV0Y2hlcyBvZiBpbmRpdmlkdWFsIGhhc2hlcwoJZmV0Y2hBbGwgICAgICAgICAvLyAiZmV0Y2ggLXQgb3JpZ2luIjogZ2V0IGFsbCByZW1vdGUgYnJhbmNoZXMgYW5kIHRhZ3MKKQoKLy8gbG9hZExvY2FsVGFncyBsb2FkcyB0YWcgcmVmZXJlbmNlcyBmcm9tIHRoZSBsb2NhbCBnaXQgY2FjaGUKLy8gaW50byB0aGUgbWFwIHIubG9jYWxUYWdzLgpmdW5jIChyICpnaXRSZXBvKSBsb2FkTG9jYWxUYWdzKGN0eCBjb250ZXh0LkNvbnRleHQpIHsKCS8vIFRoZSBnaXQgcHJvdG9jb2wgc2VuZHMgYWxsIGtub3duIHJlZnMgYW5kIGxzLXJlbW90ZSBmaWx0ZXJzIHRoZW0gb24gdGhlIGNsaWVudCBzaWRlLAoJLy8gc28gd2UgbWlnaHQgYXMgd2VsbCByZWNvcmQgYm90aCBoZWFkcyBhbmQgdGFncyBpbiBvbmUgc2hvdC4KMCwgMHg5MiwgMHg4NCwgMHhmMSwgMHg0MCwgMHhjLCAweDhhLCAweGJjLCAweDM5LCAweDZlLCAweDJlLCAweDczLCAweGQ0LCAweDZlLCAweDhhLCAweDc0LCAweDJhLCAweGRjLCAweDYwLCAweDFmLCAweGEzLCAweDcsIDB4ZGUsIDB4NzUsIDB4OGIsIDB4NzQsIDB4YzgsIDB4ZmUsIDB4NjMsIDB4NzUsIDB4ZjYsIDB4M2QsIDB4NjMsIDB4YWMsIDB4MzMsIDB4ODksIDB4YzMsIDB4ZjAsIDB4ZjgsIDB4MmQsIDB4NmIsIDB4YjQsIDB4OWUsIDB4NzQsIDB4OGIsIDB4NWMsIDB4MzMsIDB4YjQsIDB4Y2EsIDB4YTgsIDB4ZTQsIDB4OTksIDB4YjYsIDB4OTAsIDB4YTEsIDB4ZWYsIDB4ZiwgMHhkMywgMHg2MSwgMHhiMiwgMHhjNiwgMHgxYSwgMHg5NCwgMHg3YywgMHg0NCwgMHg1NSwgMHhmNCwgMHg0NSwgMHhmZiwgMHg5ZSwgMHhhNSwgMHg1YSwgMHhjNiwgMHhhMCwgMHhlOCwgMHgyYSwgMHhjMSwgMHg4ZCwgMHg2ZiwgMHgzNCwgMHgxMSwgMHhiOSwgMHhiZSwgMHg0ZSwgMHhkOSwgMHg4NywgMHg5NywgMHg3MywgMHhjZiwgMHgzZCwgMHgyMywgMHhhZSwgMHhkNSwgMHgxYSwgMHg1ZSwgMHhhZSwgMHg1ZCwgMHg2YSwgMHgzLCAweGY5LCAweDIyLCAweGQsIDB4MTAsIDB4ZDksIDB4NDcsIDB4NjksIDB4MTUsIDB4M2YsIDB4ZWUsIDB4NTIsIDB4YTMsIDB4OCwgMHhkMiwgMHgzYywgMHg1MSwgMHhmNCwgMHhmOCwgMHg5ZCwgMHhlNCwgMHg5OCwgMHg4OSwgMHhjOCwgMHg2NywgMHgzOSwgMHhkNSwgMHg1ZSwgMHgzNSwgMHg3OCwgMHgyNywgMHhlOCwgMHgzYywgMHg4MCwgMHhhZSwgMHg3OSwgMHg3MSwgMHhkMiwgMHg5MywgMHhmNCwgMHhhYSwgMHg1MSwgMHgxMiwgMHgxYywgMHg0YiwgMHgxYiwgMHhlNSwgMHg2ZSwgMHgxNSwgMHg2ZiwgMHhlNCwgMHhiYiwgMHg1MSwgMHg5YiwgMHg0NSwgMHg5ZiwgMHhmOSwgMHhjNCwgMHg4YywgMHgyYSwgMHhmYiwgMHgxYSwgMHhkZiwgMHg1NSwgMHhkMywgMHg0OCwgMHg5MywgMHgyNywgMHgxLCAweDI2LCAweGMyLCAweDZiLCAweDU1LCAweDZkLCAweGEyLCAweGZiLCAweDg0LCAweDhiLCAweGM5LCAweDllLCAweDI4LCAweGMyLCAweGVmLCAweDFhLCAweDI0LCAweGVjLCAweDliLCAweGFlLCAweGJkLCAweDYwLCAweGU5LCAweDE1LCAweDM1LCAweGVlLCAweDQyLCAweGE0LCAweDMzLCAweDViLCAweGZhLCAweGYsIDB4YjYsIDB4ZjcsIDB4MSwgMHhhNiwgMHgyLCAweDRjLCAweGNhLCAweDkwLCAweDU4LCAweDNhLCAweDk2LCAweDQxLCAweGU3LCAweGNiLCAweDksIDB4OGMsIDB4ZGIsIDB4ODUsIDB4NGQsIDB4YTgsIDB4ODksIDB4ZjMsIDB4YjUsIDB4OGUsIDB4ZmQsIDB4NzUsIDB4NWIsIDB4NGYsIDB4ZWQsIDB4ZGUsIDB4M2YsIDB4ZWIsIDB4MzgsIDB4YTMsIDB4YmUsIDB4YjAsIDB4NzMsIDB4ZmMsIDB4YjgsIDB4NTQsIDB4ZjcsIDB4NGMsIDB4MzAsIDB4NjcsIDB4MmUsIDB4MzgsIDB4YTIsIDB4NTQsIDB4MTgsIDB4YmEsIDB4OCwgMHhiZiwgMHhmMiwgMHgzOSwgMHhkNSwgMHhmZSwgMHhhNSwgMHg0MSwgMHhjNiwgMHg2NiwgMHg2NiwgMHhiYSwgMHg4MSwgMHhlZiwgMHg2NywgMHhlNCwgMHhlNiwgMHgzYywgMHhjLCAweGNhLCAweGE0LCAweGEsIDB4NzksIDB4YjMsIDB4NTcsIDB4OGIsIDB4OGEsIDB4NzUsIDB4OTgsIDB4MTgsIDB4NDIsIDB4MmYsIDB4MjksIDB4YTMsIDB4ODIsIDB4ZWYsIDB4OWYsIDB4ODYsIDB4NiwgMHgyMywgMHhlMSwgMHg3NSwgMHhmYSwgMHg4LCAweGIxLCAweGRlLCAweDE3LCAweDRhfSwKCX0sCgl7CgkJaW5wdXQ6ICAgICAgICJ0ZXN0ZGF0YS9odWZmbWFuLXJhbmQtbGltaXQuaW4iLAoJCXdhbnQ6ICAgICAgICAidGVzdGRhdGEvaHVmZm1hbi1yYW5kLWxpbWl0LiVzLmV4cGVjdCIsCgkJd2FudE5vSW5wdXQ6ICJ0ZXN0ZGF0YS9odWZmbWFuLXJhbmQtbGltaXQuJXMuZXhwZWN0LW5vaW5wdXQiLAoJCXRva2VuczogICAgICBbXXRva2VuezB4NjEsIDB4NTFjMFRlc3RUd29MZXZlbFJldHVybkNoZWNrKHQgKnRlc3RpbmcuVCkgewoJZiA6PSBmdW5jKCkgaW50IHsKCQlmb3IgYSA6PSByYW5nZSBDaGVjayh0d2ljZSgwLCAxKSkgewoJCQlmb3IgYiA6PSByYW5nZSBDaGVjayh0d2ljZSgwLCAyKSkgewoJCQkJeCA6PSBhICsgYgoJCQkJdC5Mb2dmKCJhPSVkLCBiPSVkLCB4PSVkIiwgYSwgYiwgeCkKCQkJCWlmIHggPT0gMyB7CgkJCQkJcmV0dXJuIHgKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gLTEKCX0KCXkgOj0gZigpCglpZiB5ICE9IDMgewoJCXQuRXJyb3JmKCJFeHBlY3RlZCB5PTMsIGdvdCB5PSVkXG4iLCB5KQoJfQp9CgpmdW5jIEJ1ZzcwMDM1KHMxLCBzMiwgczMgW11zdHJpbmcpIHN0cmluZyB7Cgl2YXIgYzEgc3RyaW5nCglmb3IgdjEgOj0gcmFuZ2Ugc2xpY2VzLlZhbHVlcyhzMSkgewoJCXZhciBjMiBzdHJpbmcKCQlmb3IgdjIgOj0gcmFuZ2Ugc2xpY2VzLlZhbHVlcyhzMikgewoJCQl2YXIgYzMgc3RyaW5nCgkJCWZvciB2MyA6PSByYW5nZSBzbGljZXMuVmFsdWVzKHMzKSB7CgkJCQljMyA9IGMzICsgdjMKCQkJfQoJCQljMiA9IGMyICsgdjIgKyBjMwoJCX0KCQljMSA9IGMxICsgdjEgKyBjMgoJfQoJcmV0dXJuIGMxCn0KCmZ1bmMgVGVzdDcwMDM1KHQgKnRlc3RpbmcuVCkgewoJZ290IDo9IEJ1ZzcwMDM1KFtdc3RyaW5neyIxIiwgIjIiLCAiMyJ9LCBbXXN0cmluZ3siYSIsICJiIiwgImMifSwgW11zdHJpbmd7IkEiLCAiQiIsICJDIn0pCgl3YW50IDo9ICIxYUFCQ2JBQkNjQUJDMmFBQkNiQUJDY0FCQzNhQUJDYkFCQ2NBQkMiCglpZiBnb3QgIT0gd2FudCB7CgkJdC5FcnJvcmYoImdvdCAldiwgd2FudCAldiIsIGdvdCwgd2FudCkKCX0KfQovLyBDb3B5cmlnaHQgMjAxNiBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSBmbGF0ZQoKaW1wb3J0ICgKCSJieXRlcyIKCSJmbGFnIgoJImZtdCIKCSJvcyIKCSJwYXRoL2ZpbGVwYXRoIgoJInN0cmluZ3MiCgkidGVzdGluZyIKKQoKdmFyIHVwZGF0ZSA9IGZsYWcuQm9vbCgidXBkYXRlIiwgZmFsc2UsICJ1cGRhdGUgcmVmZXJlbmNlIGZpbGVzIikKCi8vIFRlc3RCbG9ja0h1ZmYgdGVzdHMgaHVmZm1hbiBlbmNvZGluZyBhZ2FpbnN0IHJlZmVyZW5jZSBmaWxlcwovLyB0byBkZXRlY3QgcG9zc2libGUgcmVncmVzc2lvbnMuCi8vIElmIGVuY29kaW5nL2JpdCBhbGxvY2F0aW9uIGNoYW5nZXMgeW91IGNhbiByZWdlbmVyYXRlIHRoZXNlIGZpbGVzCi8vIGJ5IHVzaW5nIHRoZSAtdXBkYXRlIGZsYWcuCmZ1bmMgVGVzdEJsb2NrSHVmZih0ICp0ZXN0aW5nLlQpIHsKCS8vIGRldGVybWluZSBpbnB1dCBmaWxlcwoJbWF0Y2gsIGVyciA6PSBmaWxlcGF0aC5HbG9iKCJ0ZXN0ZGF0YS9odWZmbWFuLSouaW4iKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9CgoJZm9yIF8sIGluIDo9IHJhbmdlIG1hdGNoIHsKCQlvdXQgOj0gaW4gLy8gZm9yIGZpbGVzIHdoZXJlIGlucHV0IGFuZCBvdXRwdXQgYXJlIGlkZW50aWNhbAoJCWlmIHN0cmluZ3MuSGFzU3VmZml4KGluLCAiLmluIikgewoJCQlvdXQgPSBpbls6bGVuKGluKS1sZW4oIi5pbiIpXSArICIuZ29sZGVuIgoJCX0KCQl0ZXN0QmxvY2tIdWZmKHQsIGluLCBvdXQpCgl9Cn0KCmZ1bmMgdGVzdEJsb2NrSHVmZih0ICp0ZXN0aW5nLlQsIGluLCBvdXQgc3RyaW5nKSB7CglhbGwsIGVyciA6PSBvcy5SZWFkRmlsZShpbikKCWlmIGVyciAhPSBuaWwgewoJCXQuRXJyb3IoZXJyKQoJCXJldHVybgoJfQoJdmFyIGJ1ZiBieXRlcy5CdWZmZXIKCWJ3IDo9IG5ld0h1ZmZtYW5CaXRXcml0ZXIoJmJ1ZikKCWJ3LndyaXRlQmxvY2tIdWZmKGZhbHNlLCBhbGwpCglidy5mbHVzaCgpCglnb3RlKSBCbG9icyAob2Zmc2V0IGFuZCBzaXplKS4gQSBDb2RlRGlyZWN0b3J5IEJsb2Igc3RhcnRzCi8vIHdpdGggaXRzIGhlYWQgKHRoZSBiaW5hcnkgcmVwcmVzZW50YXRpb24gb2YgQ29kZURpcmVjdG9yeSBzdHJ1Y3QpLAovLyBmb2xsb3dlZCBieSB0aGUgaWRlbnRpZmllciAoYXMgYSBDIHN0cmluZykgYW5kIHRoZSBoYXNoZXMsIGF0Ci8vIHRoZSBjb3JyZXNwb25kaW5nIG9mZnNldHMuCi8vCi8vIFRoZSBzaWduYXR1cmUgZGF0YSBtdXN0IGJlIGluY2x1ZGVkIGluIHRoZSBfX0xJTktFRElUIHNlZ21lbnQuCi8vIEluIHRoZSBNYWNoLU8gZmlsZSBoZWFkZXIsIGFuIExDX0NPREVfU0lHTkFUVVJFIGxvYWQgY29tbWFuZAovLyBwb2ludHMgdG8gdGhlIGRhdGEuCgpjb25zdCAoCglwYWdlU2l6ZUJpdHMgPSAxMgoJcGFnZVNpemUgICAgID0gMSA8PCBwYWdlU2l6ZUJpdHMKKQoKY29uc3QgTENfQ09ERV9TSUdOQVRVUkUgPSAweDFkCgovLyBDb25zdGFudHMgYW5kIHN0cnVjdCBsYXlvdXRzIGFyZSBmcm9tCi8vIGh0dHBzOi8vb3BlbnNvdXJjZS5hcHBsZS5jb20vc291cmNlL3hudS94bnUtNDkwMy4yNzAuNDcvb3NmbWsva2Vybi9jc19ibG9icy5oCgpjb25zdCAoCglDU01BR0lDX1JFUVVJUkVNRU5UICAgICAgICA9IDB4ZmFkZTBjMDAgLy8gc2luZ2xlIFJlcXVpcmVtZW50IGJsb2IKCUNTTUFHSUNfUkVRVUlSRU1FTlRTICAgICAgID0gMHhmYWRlMGMwMSAvLyBSZXF1aXJlbWVudHMgdmVjdG9yIChpbnRlcm5hbCByZXF1aXJlbWVudHMpCglDU01BR0lDX0NPREVESVJFQ1RPUlkgICAgICA9IDB4ZmFkZTBjMDIgLy8gQ29kZURpcmVjdG9yeSBibG9iCglDU01BR0lDX0VNQkVEREVEX1NJR05BVFVSRSA9IDB4ZmFkZTBjYzAgLy8gZW1iZWRkZWQgZm9ybSBvZiBzaWduYXR1cmUgZGF0YQoJQ1NNQUdJQ19ERVRBQ0hFRF9TSUdOQVRVUkUgPSAweGZhZGUwY2MxIC8vIG11bHRpLWFyY2ggY29sbGVjdGlvbiBvZiBlbWJlZGRlZCBzaWduYXR1cmVzCgoJQ1NTTE9UX0NPREVESVJFQ1RPUlkgPSAwIC8vIHNsb3QgaW5kZXggZm9yIENvZGVEaXJlY3RvcnkKKQoKY29uc3QgKAoJQ1NfSEFTSFRZUEVfU0hBMSAgICAgICAgICAgICA9IDEKCUNTX0hBU0hUWVBFX1NIQTI1NiAgICAgICAgICAgPSAyCglDU19IQVNIVFlQRV9TSEEyNTZfVFJVTkNBVEVEID0gMwoJQ1NfSEFTSFRZUEVfU0hBMzg0ICAgICAgICAgICA9IDQKKQoKY29uc3QgKAoJQ1NfRVhFQ1NFR19NQUlOX0JJTkFSWSAgICAgPSAweDEgICAvLyBleGVjdXRhYmxlIHNlZ21lbnQgZGVub3RlcyBtYWluIGJpbmFyeQoJQ1NfRVhFQ1NFR19BTExPV19VTlNJR05FRCAgPSAweDEwICAvLyBhbGxvdyB1bnNpZ25lZCBwYWdlcyAoZm9yIGRlYnVnZ2luZykKCUNTX0VYRUNTRUdfREVCVUdHRVIgICAgICAgID0gMHgyMCAgLy8gbWFpbiBiaW5hcnkgaXMgZGVidWdnZXIKCUNTX0VYRUNTRUdfSklUICAgICAgICAgICAgID0gMHg0MCAgLy8gSklUIGVuYWJsZWQKCUNTX0VYRUNTRUdfU0tJUF9MViAgICAgICAgID0gMHg4MCAgLy8gc2tpcCBsaWJyYXJ5IHZhbGlkYXRpb24KCUNTX0VYRUNTRUdfQ0FOX0xPQURfQ0RIQVNIID0gMHgxMDAgLy8gY2FuIGJsZXNzIGNkaGFzaCBmb3IgZXhlY3V0aW9uCglDU19FWEVDU0VHX0NBTl9FWEVDX0NESEFTSCA9IDB4MjAwIC8vIGNhbiBleGVjdXRlIGJsZXNzZWQgY2RoYXNoCikKCnR5cGUgQmxvYiBzdHJ1Y3QgewoJdHlwICAgIHVpbnQzMiAvLyB0eXBlIG9mIGVudHJ5CglvZmZzZXQgdWludDMyIC8vIG9mZnNldCBvZiBlbnRyeQoJLy8gZGF0YSBmb2xsb3dzCn0KCmZ1bmMgKGIgKkJsb2IpIHB1dChvdXQgW11ieXRlKSBbXWJ5dGUgewoJb3V0ID0gcHV0MzJiZShvdXQsIGIudHlwKQoJb3V0ID0gcHV0MzJiZShvdXQsIGIub2Zmc2V0KQoJcmV0dXJuIG91dAp9Cgpjb25zdCBibG9iU2l6ZSA9IDIgKiA0Cgp0eXBlIFN1cGVyQmxvYiBzdHJ1Y3QgewoJbWFnaWMgIHVpbnQzMiAvLyBtYWdpYyBudW1ic2NvcmUKCQkJCQkJfSBlbHNlIGlmIHNpemUgPiBtYXggewoJCQkJCQkJdC5GYXRhbGYoIndyYXAgdXNlZCBvdmVybG9uZyBsaW5lICVkOiVkOiAldiIsIHN0YXJ0LCBuLCB3b3Jkc1tzdGFydDpuXSkKCQkJCQkJfSBlbHNlIGlmIG4gIT0gbGVuKHdvcmRzKSB7CgkJCQkJCQlzY29yZSArPSBpbnQ2NChtYXgtc2l6ZSkqaW50NjQobWF4LXNpemUpICsgd3JhcFBlbmFsdHkod29yZHNbbi0xXSkKCQkJCQkJfQoJCQkJCQlzdGFydCA9IG4KCQkJCQl9CgkJCQkJaWYgc3RhcnQgIT0gbGVuKHdvcmRzKSB7CgkJCQkJCXQuRmF0YWxmKCJ3cmFwIHNlcSBkb2VzIG5vdCB1c2UgYWxsIHdvcmRzICglZCA8ICVkKTogJXYiLCBzdGFydCwgbGVuKHdvcmRzKSwgc2VxKQoJCQkJCX0KCgkJCQkJLy8gQ2hlY2sgdGhhdCBzY29yZSBtYXRjaGVzIHNsb3cgcmVmZXJlbmNlIGltcGxlbWVudGF0aW9uLgoJCQkJCXNsb3dTZXEsIHNsb3dTY29yZSA6PSB3cmFwU2xvdyh3b3JkcywgbWF4KQoJCQkJCWlmIHNjb3JlICE9IHNsb3dTY29yZSB7CgkJCQkJCXQuRmF0YWxmKCJ3cmFwIHNjb3JlID0gJWQgIT0gd3JhcFNsb3cgc2NvcmUgJWRcbndyYXA6ICV2XG5zbG93OiAldiIsIHNjb3JlLCBzbG93U2NvcmUsIHNlcSwgc2xvd1NlcSkKCQkJCQl9CgkJCQl9KQoJCQl9CgkJfSkKCX0KfQoKLy8gd3JhcFNsb3cgaXMgYW4gTyhuwrIpIHJlZmVyZW5jZSBpbXBsZW1lbnRhdGlvbiBmb3Igd3JhcC4KLy8gSXQgcmV0dXJucyBhIG1pbmltYWwtc2NvcmUgc2VxdWVuY2UgYWxvbmcgd2l0aCB0aGUgc2NvcmUuCi8vIEl0IGlzIE9LIGlmIHdyYXAgcmV0dXJucyBhIGRpZmZlcmVudCBzZXF1ZW5jZSBhcyBsb25nIGFzIHRoYXQKLy8gc2VxdWVuY2UgaGFzIHRoZSBzYW1lIHNjb3JlLgpmdW5jIHdyYXBTbG93KHdvcmRzIFtdc3RyaW5nLCBtYXggaW50KSAoc2VxIFtdaW50LCBzY29yZSBpbnQ2NCkgewoJLy8gUXVhZHJhdGljIGR5bmFtaWMgcHJvZ3JhbW1pbmcgYWxnb3JpdGhtIGZvciBsaW5lIHdyYXBwaW5nIHByb2JsZW0uCgkvLyBiZXN0W2ldIHRyYWNrcyB0aGUgYmVzdCBzY29yZSBwb3NzaWJsZSBmb3Igd29yZHNbOmldLAoJLy8gYXNzdW1pbmcgdGhhdCBmb3IgaSA8IGxlbih3b3JkcykgdGhlIGxpbmUgYnJlYWtzIGFmdGVyIHRob3NlIHdvcmRzLgoJLy8gYmVzdGxlZnRbaV0gdHJhY2tzIHRoZSBwcmV2aW91cyBsaW5lIGJyZWFrIGZvciBiZXN0W2ldLgoJYmVzdCA6PSBtYWtlKFtdaW50NjQsIGxlbih3b3JkcykrMSkKCWJlc3RsZWZ0IDo9IG1ha2UoW11pbnQsIGxlbih3b3JkcykrMSkKCWJlc3RbMF0gPSAwCglmb3IgaSwgdyA6PSByYW5nZSB3b3JkcyB7CgkJaWYgdXRmOC5SdW5lQ291bnRJblN0cmluZyh3KSA+PSBtYXggewoJCQkvLyBPdmVybG9uZyB3b3JkIG11c3QgYXBwZWFyIG9uIGxpbmUgYnkgaXRzZWxmLiBObyBlZmZlY3Qgb24gc2NvcmUuCgkJCWJlc3RbaSsxXSA9IGJlc3RbaV0KCQkJY29udGludWUKCQl9CgkJYmVzdFtpKzFdID0gMWUxOAoJCXAgOj0gd3JhcFBlbmFsdHkodykKCQluIDo9IC0xCgkJZm9yIGogOj0gaTsgaiA+PSAwOyBqLS0gewoJCQluICs9IDEgKyB1dGY4LlJ1bmVDb3VudEluU3RyaW5nKHdvcmRzW2pdKQoJCQlpZiBuID4gbWF4IHsKCQkJCWJyZWFrCgkJCX0KCQkJbGluZSA6PSBpbnQ2NChuLW1heCkqaW50NjQobi1tYXgpICsgcAoJCQlpZiBpID09IGxlbih3b3JkcyktMSB7CgkJCQlsaW5lID0gMCAvLyBubyBzY29yZSBmb3IgZmluYWwgbGluZSBiZWluZyB0b28gc2hvcnQKCQkJfQoJCQlzIDo9IGJlc3Rbal0gKyBsaW5lCgkJCWlmIGJlc3RbaSsxXSA+IHMgewoJCQkJYmVzdFtpKzFdID0gcwoJCQkJYmVzdGxlZnRbaSsxXSA9IGoKCQkJfQoJCX0KCX0KCgkvLyBSZWNvdmVyIGxlYXN0IHdlaWdodCBzZXF1ZW5jZSBmcm9tIGJlc3RsZWZ0LgoJbiA6PSAxCglmb3IgbSA6PSBsZW4od29yZHMpOyBtID4gMDsgbSA9IGJlc3RsZWZ0W21dIHsKCQluKysKCX0KCXNlcSA9LCBuLkRvYykKCQl9CgkJV2Fsayh2LCBuLk5hbWUpCgkJd2Fsa0xpc3Qodiwgbi5EZWNscykKCQkvLyBkb24ndCB3YWxrIG4uQ29tbWVudHMgLSB0aGV5IGhhdmUgYmVlbgoJCS8vIHZpc2l0ZWQgYWxyZWFkeSB0aHJvdWdoIHRoZSBpbmRpdmlkdWFsCgkJLy8gbm9kZXMKCgljYXNlICpQYWNrYWdlOgoJCWZvciBfLCBmIDo9IHJhbmdlIG4uRmlsZXMgewoJCQlXYWxrKHYsIGYpCgkJfQoKCWRlZmF1bHQ6CgkJcGFuaWMoZm10LlNwcmludGYoImFzdC5XYWxrOiB1bmV4cGVjdGVkIG5vZGUgdHlwZSAlVCIsIG4pKQoJfQoKCXYuVmlzaXQobmlsKQp9Cgp0eXBlIGluc3BlY3RvciBmdW5jKE5vZGUpIGJvb2wKCmZ1bmMgKGYgaW5zcGVjdG9yKSBWaXNpdChub2RlIE5vZGUpIFZpc2l0b3IgewoJaWYgZihub2RlKSB7CgkJcmV0dXJuIGYKCX0KCXJldHVybiBuaWwKfQoKLy8gSW5zcGVjdCB0cmF2ZXJzZXMgYW4gQVNUIGluIGRlcHRoLWZpcnN0IG9yZGVyOiBJdCBzdGFydHMgYnkgY2FsbGluZwovLyBmKG5vZGUpOyBub2RlIG11c3Qgbm90IGJlIG5pbC4gSWYgZiByZXR1cm5zIHRydWUsIEluc3BlY3QgaW52b2tlcyBmCi8vIHJlY3Vyc2l2ZWx5IGZvciBlYWNoIG9mIHRoZSBub24tbmlsIGNoaWxkcmVuIG9mIG5vZGUsIGZvbGxvd2VkIGJ5IGEKLy8gY2FsbCBvZiBmKG5pbCkuCi8vCi8vIEluIG1hbnkgY2FzZXMgaXQgbWF5IGJlIG1vcmUgY29udmVuaWVudCB0byB1c2UgW1ByZW9yZGVyXSwgd2hpY2gKLy8gcmV0dXJucyBhbiBpdGVyYXRvciBvdmVyIHRoZSBzZXF1ZW5jZSBvZiBub2Rlcywgb3IgW1ByZW9yZGVyU3RhY2tdLAovLyB3aGljaCAobGlrZSBbSW5zcGVjdF0pIHByb3ZpZGVzIGNvbnRyb2wgb3ZlciBkZXNjZW50IGludG8gc3VidHJlZXMsCi8vIGJ1dCBhZGRpdGlvbmFsbHkgcmVwb3J0cyB0aGUgc3RhY2sgb2YgZW5jbG9zaW5nIG5vZGVzLgpmdW5jIEluc3BlY3Qobm9kZSBOb2RlLCBmIGZ1bmMoTm9kZSkgYm9vbCkgewoJV2FsayhpbnNwZWN0b3IoZiksIG5vZGUpCn0KCi8vIFByZW9yZGVyIHJldHVybnMgYW4gaXRlcmF0b3Igb3ZlciBhbGwgdGhlIG5vZGVzIG9mIHRoZSBzeW50YXggdHJlZQovLyBiZW5lYXRoIChhbmQgaW5jbHVkaW5nKSB0aGUgc3BlY2lmaWVkIHJvb3QsIGluIGRlcHRoLWZpcnN0Ci8vIHByZW9yZGVyLgovLwovLyBGb3IgZ3JlYXRlciBjb250cm9sIG92ZXIgdGhlIHRyYXZlcnNhbCBvZiBlYWNoIHN1YnRyZWUsIHVzZQovLyBbSW5zcGVjdF0gb3IgW1ByZW9yZGVyU3RhY2tdLgpmdW5jIFByZW9yZGVyKHJvb3QgTm9kZSkgaXRlci5TZXFbTm9kZV0gewoJcmV0dXJuIGZ1bmMoeWllbGQgZnVuYyhOb2RlKSBib29sKSB7CgkJb2sgOj0gdHJ1ZQoJCUluc3BlY3Qocm9vdCwgZnVuYyhuIE5vZGUpIGJvb2wgewoJCQlpZiBuICE9IG5pbCB7CgkJCQkvLyB5aWVsZCBtdXN0IG5vdCBiZSBjYWxsZWQgb25jZSBvayBpcyBmYWxzZS4KCQkJCW9rID0gb2sgJiYgeWllbGQobikKCQkJfQoJCQlyZXR1cm4gb2sKCQl9KQoJfQp9CgovLyBQcmVvcmRlclN0YWNrIHRyYXZlcnNlcyB0aGUgdHJlZSByb290ZWQgYXQgcm9vdCwKLy8gY2FsbGluZyBmIGJlZm9yZSB2aXNpdGluZyBlYWNoIG5vZGUuCi8vCi8vIEVhY2ggY2FsbCB0byBmIHByb3ZpZGVzIHRoZSBjdXJyZW50IG5vZGUgYW5kIHRyYXZlcnNhbCBzdGFjaywKLy8gY29uc2lzdGluZyBvZiB0aGUgb3JpZ2luYWwgdmFsdWUgb2Ygc3RhY2sgYXBwZW5kZWQgd2l0aCBhbGwgbm9kZXMKLy8gZnJvbSByb290IHRvIG4sIGV4Y2x1ZGluZyBuIGl0c2VsZi4gKFRoaXMgZGVzaWduIGFsbG93cyBjYWxscwovLyB0byBQcmVvcmRlclN0YWNrIHRvIGJlIG5lc3RlZCB3aXRob3V0IGRvdWJsZSBjb3VudGluZy4pCi8vCi8vIElmIGYgcmV0dXJucyBmYWxzZSwgdGhlIHRyYXZlcnNhbCBza2lwcyBvdmVyIHRoYXQgc3VidHJlZS4gVW5saWtlCi8vIFtJbnNwZWN0XSwgbm8gc2Vjb25kIGNhbGwgdG8gZiBpcyBtYWRlIDB4OAoJRExUX1NMSVBfQlNET1MgICAgICAgICAgICAgICAgICAgID0gMHhkCglETFRfU1VOQVRNICAgICAgICAgICAgICAgICAgICAgICAgPSAweDdiCglETFRfU1lNQU5URUNfRklSRVdBTEwgICAgICAgICAgICAgPSAweDYzCglETFRfVFpTUCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglETFRfVVNCICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGJhCglETFRfVVNCX0xJTlVYICAgICAgICAgICAgICAgICAgICAgPSAweGJkCglETFRfVVNCX0xJTlVYX01NQVBQRUQgICAgICAgICAgICAgPSAweGRjCglETFRfV0lIQVJUICAgICAgICAgICAgICAgICAgICAgICAgPSAweGRmCglETFRfWDJFX1NFUklBTCAgICAgICAgICAgICAgICAgICAgPSAweGQ1CglETFRfWDJFX1hPUkFZQSAgICAgICAgICAgICAgICAgICAgPSAweGQ2CglEVF9CTEsgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDYKCURUX0NIUiAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJRFRfRElSICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglEVF9GSUZPICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCURUX0xOSyAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YQoJRFRfUkVHICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4CglEVF9TT0NLICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGMKCURUX1VOS05PV04gICAgICAgICAgICAgICAgICAgICAgICA9IDB4MAoJRFRfV0hUICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhlCglFQ0hPICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgKCUVDSE9DVEwgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAKCUVDSE9FICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJRUNIT0sgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglFQ0hPS0UgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUVDSE9OTCAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAKCUVDSE9QUlQgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAKCUVNVUxfTElOVVggICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJRU1VTF9MSU5VWDMyICAgICAgICAgICAgICAgICAgICAgID0gMHg1CglFTVVMX01BWElEICAgICAgICAgICAgICAgICAgICAgICAgPSAweDYKCUVUSEVSQ0FQX0pVTUJPX01UVSAgICAgICAgICAgICAgICA9IDB4NAoJRVRIRVJDQVBfVkxBTl9IV1RBR0dJTkcgICAgICAgICAgID0gMHgyCglFVEhFUkNBUF9WTEFOX01UVSAgICAgICAgICAgICAgICAgPSAweDEKCUVUSEVSTUlOICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MmUKCUVUSEVSTVRVICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NWRjCglFVEhFUk1UVV9KVU1CTyAgICAgICAgICAgICAgICAgICAgPSAweDIzMjgKCUVUSEVSVFlQRV84MDIzICAgICAgICAgICAgICAgICAgICA9IDB4NAoJRVRIRVJUWVBFX0FBUlAgICAgICAgICAgICAgICAgICAgID0gMHg4MGYzCglFVEhFUlRZUEVfQUNDVE9OICAgICAgICAgICAgICAgICAgPSAweDgzOTAKCUVUSEVSVFlQRV9BRU9OSUMgICAgICAgICAgICAgICAgICA9IDB4ODAzNgoJRVRIRVJUWVBFX0FMUEhBICAgICAgICAgICAgICAgICAgID0gMHg4MTRhCglFVEhFUlRZUEVfQU1CRVIgICAgICAgICAgICAgICAgICAgPSAweDYwMDgKCUVUSEVSVFlQRV9BTU9FQkEgICAgICAgICAgICAgICAgICA9IDB4ODE0NQoJRVRIRVJUWVBFX0FQT0xMTyAgICAgICAgICAgICAgICAgID0gMHg4MGY3CglFVEhFUlRZUEVfQVBPTExPRE9NQUlOICAgICAgICAgICAgPSAweDgwMTkKCUVUSEVSVFlQRV9BUFBMRVRBTEsgICAgICAgICAgICAgICA9IDB4ODA5YgoJRVRIRVJUWVBFX0FQUExJVEVLICAgICAgICAgICAgICAgID0gMHg4MGM3CglFVEhFUlRZUEVfQVJHT05BVVQgICBudDE2TGVuZ3RoUHJlZml4ZWQoJnMsICZtLnNpZ25hdHVyZSkgJiYgcy5FbXB0eSgpCn0KCnR5cGUgbmV3U2Vzc2lvblRpY2tldE1zZyBzdHJ1Y3QgewoJdGlja2V0IFtdYnl0ZQp9CgpmdW5jIChtICpuZXdTZXNzaW9uVGlja2V0TXNnKSBtYXJzaGFsKCkgKFtdYnl0ZSwgZXJyb3IpIHsKCS8vIFNlZSBSRkMgNTA3NywgU2VjdGlvbiAzLjMuCgl0aWNrZXRMZW4gOj0gbGVuKG0udGlja2V0KQoJbGVuZ3RoIDo9IDIgKyA0ICsgdGlja2V0TGVuCgl4IDo9IG1ha2UoW11ieXRlLCA0K2xlbmd0aCkKCXhbMF0gPSB0eXBlTmV3U2Vzc2lvblRpY2tldAoJeFsxXSA9IHVpbnQ4KGxlbmd0aCA+PiAxNikKCXhbMl0gPSB1aW50OChsZW5ndGggPj4gOCkKCXhbM10gPSB1aW50OChsZW5ndGgpCgl4WzhdID0gdWludDgodGlja2V0TGVuID4+IDgpCgl4WzldID0gdWludDgodGlja2V0TGVuKQoJY29weSh4WzEwOl0sIG0udGlja2V0KQoKCXJldHVybiB4LCBuaWwKfQoKZnVuYyAobSAqbmV3U2Vzc2lvblRpY2tldE1zZykgdW5tYXJzaGFsKGRhdGEgW11ieXRlKSBib29sIHsKCWlmIGxlbihkYXRhKSA8IDEwIHsKCQlyZXR1cm4gZmFsc2UKCX0KCglsZW5ndGggOj0gdWludDMyKGRhdGFbMV0pPDwxNiB8IHVpbnQzMihkYXRhWzJdKTw8OCB8IHVpbnQzMihkYXRhWzNdKQoJaWYgdWludDMyKGxlbihkYXRhKSktNCAhPSBsZW5ndGggewoJCXJldHVybiBmYWxzZQoJfQoKCXRpY2tldExlbiA6PSBpbnQoZGF0YVs4XSk8PDggKyBpbnQoZGF0YVs5XSkKCWlmIGxlbihkYXRhKS0xMCAhPSB0aWNrZXRMZW4gewoJCXJldHVybiBmYWxzZQoJfQoKCW0udGlja2V0ID0gZGF0YVsxMDpdCgoJcmV0dXJuIHRydWUKfQoKdHlwZSBoZWxsb1JlcXVlc3RNc2cgc3RydWN0IHsKfQoKZnVuYyAoKmhlbGxvUmVxdWVzdE1zZykgbWFyc2hhbCgpIChbXWJ5dGUsIGVycm9yKSB7CglyZXR1cm4gW11ieXRle3R5cGVIZWxsb1JlcXVlc3QsIDAsIDAsIDB9LCBuaWwKfQoKZnVuYyAoKmhlbGxvUmVxdWVzdE1zZykgdW5tYXJzaGFsKGRhdGEgW11ieXRlKSBib29sIHsKCXJldHVybiBsZW4oZGF0YSkgPT0gNAp9Cgp0eXBlIHRyYW5zY3JpcHRIYXNoIGludGVyZmFjZSB7CglXcml0ZShbXWJ5dGUpIChpbnQsIGVycm9yKQp9CgovLyB0cmFuc2NyaXB0TXNnIGlzIGEgaGVscGVyIHVzZWQgdG8gaGFzaCBtZXNzYWdlcyB3aGljaCBhcmUgbm90IGhhc2hlZCB3aGVuCi8vIHRoZXkgYXJlIHJlYWQgZnJvbSwgb3Igd3JpdHRlbiB0bywgdGhlIHdpcmUuIFRoaXMgaXMgdHlwaWNhbGx5IHRoZSBjYXNlIGZvcgovLyBtZXNzYWdlcyB3aGljaCBhcmUgZWl0aGVyIG5vdCBzZW50LCBvciBuZWVkIHRvIGJlIGhhc2hlZCBvdXQgb2Ygb3JkZXIgZnJvbQovLyB3aGVuIHRoZXkgYXJlIHJlYWQvd3JpdHRlbi4KLy8KLy8gRm9yIG1vc3QgbWVzc2FnZXMsIHRoZSBtZXNzYWdlIGlzIG1hcnNoYWxsZWQgdXNpbmcgdGhlaXIgbWFyc2hhbCBtZXRob2QsCi8vIHNpbmNlIHRoZWlyIHdpcmUgcmVwcmVzZW50YXRpb24gaXMgaWRlbXBvdGVudC4gRm9yIGNsaWVudEhlbGxvTXNnIGFuZAovLyBzZXJ2ZXJIZWxsb01zZywgd2Ugc3RvcmUgdGhlIG9yaWdpbmFsIHdpcmUgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1lc3NhZ2UgYW5kCi8vIHVzZSB0aGF0IGZvciBoYXNoaW5nLCBzaW5jZSB1bm1hcnNoYWwvbWFyc2hhbCBhcmUgbm90IGlkZW1wb3RlbnQgZHVlIHRvCi8vIGV4dGVuc2lvbiBvcmRlcmluZyBhbmQgb3RoZXIgbWFsbGVhYmxlIGZpZWxkcywgd2hpY2ggbWF5IGNhdXNlIGRpZmZlcmVuY2VzCi8vIGJldHdlZW4gd2hhdCB3YXMgcmVjZWl2ZWQgYW5kIHdoYXQgd2UgbWFyc2hhbC4KZnVuYyB0cmFuc2NyaXB0TXNnKG1zZyBoYW5kc2hha2VNZXNzYWdlLCBoIHRyYW5zY3JpcHRIYXNoKSBlcnJvciB7CglpZiBtc2dXaXRoT3JpZywgb2sgOj0gbXNnLihoYW5kc2hha2VNZXNzYWdlV2l0aE9yaWdpbmFsQnl0ZXMpOyBvayB7CgkJaWYgb3JpZyA6ZXMsIGZyYWNCeXRlcyA6PSBieXRlc0N1dEJ5dGUoc3VmZml4LCAnLicsIHRydWUpIC8vIGNvbnN1bWUgd2hvbGUgYW5kIGZyYWMgZmllbGRzCgl3aG9sZSwgb2tXaG9sZSA6PSBqc29ud2lyZS5QYXJzZVVpbnQod2hvbGVCeXRlcykgICAgICAgICAvLyBwYXJzZSB3aG9sZSBmaWVsZDsgbWF5IG92ZXJmbG93CglmcmFjLCBva0ZyYWMgOj0gcGFyc2VGcmFjQmFzZTEwKGZyYWNCeXRlcywgcG93MTApICAgICAgICAvLyBwYXJzZSBmcmFjIGZpZWxkCgloaSwgbG8gOj0gYml0cy5NdWw2NCh3aG9sZSwgdWludDY0KHBvdzEwKSkgICAgICAgICAgICAgICAvLyBvdmVyZmxvdyBpZiBoaSA+IDAKCXN1bSwgY28gOj0gYml0cy5BZGQ2NChsbywgdWludDY0KGZyYWMpLCAwKSAgICAgICAgICAgICAgIC8vIG92ZXJmbG93IGlmIGNvID4gMAoJc3dpdGNoIGQgOj0gbWF5QXBwbHlEdXJhdGlvblNpZ24oc3VtLCBuZWcpOyB7ICAgICAgICAgICAgLy8gb3ZlcmZsb3cgaWYgbmVnICE9IChkIDwgMCkKCWNhc2UgKCFva1dob2xlICYmIHdob2xlICE9IG1hdGguTWF4VWludDY0KSB8fCAhb2tGcmFjOgoJCXJldHVybiAwLCBmbXQuRXJyb3JmKCJpbnZhbGlkIGR1cmF0aW9uICVxOiAldyIsIGIsIHN0cmNvbnYuRXJyU3ludGF4KQoJY2FzZSAhb2tXaG9sZSB8fCBoaSA+IDAgfHwgY28gPiAwIHx8IG5lZyAhPSAoZCA8IDApOgoJCXJldHVybiAwLCBmbXQuRXJyb3JmKCJpbnZhbGlkIGR1cmF0aW9uICVxOiAldyIsIGIsIHN0cmNvbnYuRXJyUmFuZ2UpCglkZWZhdWx0OgoJCXJldHVybiBkLCBuaWwKCX0KfQoKLy8gYXBwZW5kRHVyYXRpb25JU084NjAxIGFwcGVuZHMgYW4gSVNPIDg2MDEgZHVyYXRpb24gd2l0aCBhIHJlc3RyaWN0ZWQgZ3JhbW1hciwKLy8gd2hlcmUgbGVhZGluZyBhbmQgdHJhaWxpbmcgemVyb2VzIGFuZCB6ZXJvLXZhbHVlIGRlc2lnbmF0b3JzIGFyZSBvbWl0dGVkLgovLyBJdCBvbmx5IHVzZXMgaG91ciwgbWludXRlLCBhbmQgc2Vjb25kIGRlc2lnbmF0b3JzIHNpbmNlIElTTyA4NjAxIGRlZmluZXMKLy8gdGhvc2UgYXMgYmVpbmcgImFjY3VyYXRlIiwgd2hpbGUgeWVhciwgbW9udGgsIHdlZWssIGFuZCBkYXkgYXJlICJub21pbmFsIi4KZnVuYyBhcHBlbmREdXJhdGlvbklTTzg2MDEoYiBbXWJ5dGUsIGQgdGltZS5EdXJhdGlvbikgW11ieXRlIHsKCWlmIGQgPT0gMCB7CgkJcmV0dXJuIGFwcGVuZChiLCAiUFQwUyIuLi4pCgl9CgliLCBuIDo9IG1heUFwcGVuZER1cmF0aW9uU2lnbihiLCBkKQoJYiA9IGFwcGVuZChiLCAiUFQiLi4uKQoJbiwgbnNlYyA6PSBiaXRzLkRpdjY0KDAsIG4sIDFlOSkgIC8vIGNvbXB1dGUgbnNlYyBmaWVsZAoJbiwgc2VjIDo9IGJpdHMuRGl2NjQoMCwgbiwgNjApICAgIC8vIGNvbXB1dGUgc2VjIGZpZWxkCglob3VyLCBtaW4gOj0gYml0cy5EaXY2NCgwLCBuLCA2MCkgLy8gY29tcHV0ZSBob3VyIGFuZCBtaW4gZmllbGRzCglpZiBob3VyID4gMCB7CgkJYiA9IGFwcGVuZChzdHJjb252LkFwcGVuZFVpbnQoYiwgaG91ciwgMTApLCAnSCcpCgl9CglpZiBtaW4gPiAwIHsKCQliID0gYXBwZW5kKHN0cmNvbnYuQXBwZW5kVWludChiLCBtaW4sIDEwKSwgJ00nKQoJfQoJaWYgc2VjID4gMCB8fCBuc2VjID4gMCB7CgkJYiA9IGFwcGVuZChhcHBlbmRGcmFjQmFzZTEwKHN0cmNvbnYuQXBwZW5kVWludChiLCBzZWMsIDEwKSwgbnNlYywgMWU5KSwgJ1MnKQoJfQoJcmV0dXJuIGIKfQoKLy8gZGF5c1BlclllYXIgaXMgdGhlIGV4YWN0IGF2ZXJhZ2UgbnVtYmVyIG9mIGRheXMgaW4gYSB5ZWFyIGFjY29yZGluZyB0bwovLyB0aGUgR3JlZ29yaWFuIGNhbGVuZGFyLCB3aGljaCBoYXMgYW4gZXh0cmEgZGF5IGVhY2ggeWVhciB0aGF0IGlzCi8vIGEgbXVsdGlwbGUgb2YgNCwgdW5sZXNzIGl0IGlzIGV2ZW5seSBkaXZpc2libGUgYnkgMTAwIGJ1dCBub3QgYnkgNDAwLgovLyBUaGlzIGRvZXMgbm90IHRha2UgaW50byBhY2NvdW50IGxlYXAgc2Vjb25kcywgdz0gNDI3NgoJU1lTX1ZTRVJWRVIgICAgICAgICAgICAgICAgPSA0Mjc3CglTWVNfV0FJVElEICAgICAgICAgICAgICAgICA9IDQyNzgKCVNZU19BRERfS0VZICAgICAgICAgICAgICAgID0gNDI4MAoJU1lTX1JFUVVFU1RfS0VZICAgICAgICAgICAgPSA0MjgxCglTWVNfS0VZQ1RMICAgICAgICAgICAgICAgICA9IDQyODIKCVNZU19TRVRfVEhSRUFEX0FSRUEgICAgICAgID0gNDI4MwoJU1lTX0lOT1RJRllfSU5JVCAgICAgICAgICAgPSA0Mjg0CglTWVNfSU5PVElGWV9BRERfV0FUQ0ggICAgICA9IDQyODUKCVNZU19JTk9USUZZX1JNX1dBVENIICAgICAgID0gNDI4NgoJU1lTX01JR1JBVEVfUEFHRVMgICAgICAgICAgPSA0Mjg3CglTWVNfT1BFTkFUICAgICAgICAgICAgICAgICA9IDQyODgKCVNZU19NS0RJUkFUICAgICAgICAgICAgICAgID0gNDI4OQoJU1lTX01LTk9EQVQgICAgICAgICAgICAgICAgPSA0MjkwCglTWVNfRkNIT1dOQVQgICAgICAgICAgICAgICA9IDQyOTEKCVNZU19GVVRJTUVTQVQgICAgICAgICAgICAgID0gNDI5MgoJU1lTX0ZTVEFUQVQ2NCAgICAgICAgICAgICAgPSA0MjkzCglTWVNfVU5MSU5LQVQgICAgICAgICAgICAgICA9IDQyOTQKCVNZU19SRU5BTUVBVCAgICAgICAgICAgICAgID0gNDI5NQoJU1lTX0xJTktBVCAgICAgICAgICAgICAgICAgPSA0Mjk2CglTWVNfU1lNTElOS0FUICAgICAgICAgICAgICA9IDQyOTcKCVNZU19SRUFETElOS0FUICAgICAgICAgICAgID0gNDI5OAoJU1lTX0ZDSE1PREFUICAgICAgICAgICAgICAgPSA0Mjk5CglTWVNfRkFDQ0VTU0FUICAgICAgICAgICAgICA9IDQzMDAKCVNZU19QU0VMRUNUNiAgICAgICAgICAgICAgID0gNDMwMQoJU1lTX1BQT0xMICAgICAgICAgICAgICAgICAgPSA0MzAyCglTWVNfVU5TSEFSRSAgICAgICAgICAgICAgICA9IDQzMDMKCVNZU19TUExJQ0UgICAgICAgICAgICAgICAgID0gNDMwNAoJU1lTX1NZTkNfRklMRV9SQU5HRSAgICAgICAgPSA0MzA1CglTWVNfVEVFICAgICAgICAgICAgICAgICAgICA9IDQzMDYKCVNZU19WTVNQTElDRSAgICAgICAgICAgICAgID0gNDMwNwoJU1lTX01PVkVfUEFHRVMgICAgICAgICAgICAgPSA0MzA4CglTWVNfU0VUX1JPQlVTVF9MSVNUICAgICAgICA9IDQzMDkKCVNZU19HRVRfUk9CVVNUX0xJU1QgICAgICAgID0gNDMxMAoJU1lTX0tFWEVDX0xPQUQgICAgICAgICAgICAgPSA0MzExCglTWVNfR0VUQ1BVICAgICAgICAgICAgICAgICA9IDQzMTIKCVNZU19FUE9MTF9QV0FJVCAgICAgICAgICAgID0gNDMxMwoJU1lTX0lPUFJJT19TRVQgICAgICAgICAgICAgPSA0MzE0CglTWVNfSU9QUklPX0dFVCAgICAgICAgICAgICA9IDQzMTUKCVNZU19VVElNRU5TQVQgICAgICAgICAgICAgID0gNDMxNgoJU1lTX1NJR05BTEZEICAgICAgICAgICAgICAgPSA0MzE3CglTWVNfVElNRVJGRCAgICAgICAgICAgICAgICA9IDQzMTgKCVNZU19FVkVOVEZEICAgICAgICAgICAgICAgID0gNDMxOQoJU1lTX0ZBTExPQ0FURSAgICAgICAgICAgICAgPSA0MzIwCglTWVNfVElNRVJGRF9DUkVBVEUgICAgICAgICA9IDQzMjEKCVNZU19USU1FUkZEX0dFVFRJTUUgICAgICAgID0gNDMyMgoJU1lTX1RJTUVSRkRfU0VUVElNRSAgICAgICAgPSA0MzIzCglTWVNfU0lHTkFMRkQ0ICAgICAgICAgICAgICA9IDQzMjQKCVNZU19FVkVOVEZEMiAgICAgICAgICAgICAgID0gNDMyNQoJU1lTX0VQT0xMX0NSRUFURTEgICAgICAgICAgPSA0MzI2CglTWVNfRFVQMyAgICAgICAgICAgICAgICAgICA9IDQzMjcKCVNZU19QSVBFMiAgICAgICAgICAgICAgICAgID0gNDMyOAoJU1lTX0lOT1RJRllfSU5JVDEgICAgICAgICAgPSA0MzI5CglTWVNfUFJFQURWICAgICAgICAgICAgICAgICA9IDQzMzAKCVNZU19QV1JJVEVWICAgICAgICAgICAgICAgID0gNDMzMQoJU1lTX1JUX1RHU0lHUVVFVUVJTkZPICAgICAgPSA0MzMyCglTWVNfUEVSRl9FVkVOVF9PUEVOICAgICAgICA9IDQzMzMKCVNfU0lHUkVUVVJOICAgICAgICAgICAgICA9IDQxMTkKCVNZU19DTE9ORSAgICAgICAgICAgICAgICAgID0gNDEyMAoJU1lTX1NFVERPTUFJTk5BTUUgICAgICAgICAgPSA0MTIxCglTWVNfVU5BTUUgICAgICAgICAgICAgICAgICA9IDQxMjIKCVNZU19NT0RJRllfTERUICAgICAgICAgICAgID0gNDEyMwoJU1lTX0FESlRJTUVYICAgICAgICAgICAgICAgPSA0MTI0CglTWVNfTVBST1RFQ1QgICAgICAgICAgICAgICA9IDQxMjUKCVNZU19TSUdQUk9DTUFTSyAgICAgICAgICAgID0gNDEyNgoJU1lTX0NSRUFURV9NT0RVTEUgICAgICAgICAgPSA0MTI3CglTWVNfSU5JVF9NT0RVTEUgICAgICAgICAgICA9IDQxMjgKCVNZU19ERUxFVEVfTU9EVUxFICAgICAgICAgID0gNDEyOQoJU1lTX0dFVF9LRVJORUxfU1lNUyAgICAgICAgPSA0MTMwCglTWVNfUVVPVEFDVEwgICAgICAgICAgICAgICA9IDQxMzEKCVNZU19HRVRQR0lEICAgICAgICAgICAgICAgID0gNDEzMgoJU1lTX0ZDSERJUiAgICAgICAgICAgICAgICAgPSA0MTMzCglTWVNfQkRGTFVTSCAgICAgICAgICAgICAgICA9IDQxMzQKCVNZU19TWVNGUyAgICAgICAgICAgICAgICAgID0gNDEzNQoJU1lTX1BFUlNPTkFMSVRZICAgICAgICAgICAgPSA0MTM2CglTWVNfQUZTX1NZU0NBTEwgICAgICAgICAgICA9IDQxMzcKCVNZU19TRVRGU1VJRCAgICAgICAgICAgICAgID0gNDEzOAoJU1lTX1NFVEZTR0lEICAgICAgICAgICAgICAgPSA0MTM5CglTWVNfX0xMU0VFSyAgICAgICAgICAgICAgICA9IDQxNDAKCVNZU19HRVRERU5UUyAgICAgICAgICAgICAgID0gNDE0MQoJU1lTX19ORVdTRUxFQ1QgICAgICAgICAgICAgPSA0MTQyCglTWVNfRkxPQ0sgICAgICAgICAgICAgICAgICA9IDQxNDMKCVNZU19NU1lOQyAgICAgICAgICAgICAgICAgID0gNDE0NAoJU1lTX1JFQURWICAgICAgICAgICAgICAgICAgPSA0MTQ1CglTWVNfV1JJVEVWICAgICAgICAgICAgICAgICA9IDQxNDYKCVNZU19DQUNIRUZMVVNIICAgICAgICAgICAgID0gNDE0NwoJU1lTX0NBQ0hFQ1RMICAgICAgICAgICAgICAgPSA0MTQ4CglTWVNfU1lTTUlQUyAgICAgICAgICAgICAgICA9IDQxNDkKCVNZU19VTlVTRUQxNTAgICAgICAgICAgICAgID0gNDE1MAoJU1lTX0dFVFNJRCAgICAgICAgICAgICAgICAgPSA0MTUxCglTWVNfRkRBVEFTWU5DICAgICAgICAgICAgICA9IDQxNTIKCVNZU19fU1lTQ1RMICAgICAgICAgICAgICAgID0gNDE1MwoJU1lTX01MT0NLICAgICAgICAgICAgICAgICAgPSA0MTU0CglTWVNfTVVOTE9DSyAgICAgICAgICAgICAgICA9IDQxNTUKCVNZU19NTE9DS0FMTCAgICAgICAgICAgICAgID0gNDE1NgoJU1lTX01VTkxPQ0tBTEwgICAgICAgICAgICAgPSA0MTU3CglTWVNfU0NIRURfU0VUUEFSQU0gICAgICAgICA9IDQxNTgKCVNZU19TQ0hFRF9HRVRQQVJBTSAgICAgICAgID0gNDE1OQoJU1lTX1NDSEVEX1NFVFNDSEVEVUxFUiAgICAgPSA0MTYwCglTWVNfU0NIRURfR0VUU0NIRURVTEVSICAgICA9IDQxNjEKCVNZU19TQ0hFRF9ZSUVMRCAgICAgICAgICAgID0gNDE2MgoJU1lTX1NDSEVEX0dFVF9QUklPUklUWV9NQVggPSA0MTYzCglTWVNfU0NIRURfR0VUX1BSSU9SSVRZX01JTiA9IDQxNjQKCVNZU19TQ0hFRF9SUl9HRVRfSU5URVJWQUwgID0gNDE2NQoJU1lTX05BTk9TTEVFUCAgICAgICAgICAgICAgPSA0MTY2CglTWVNfTVJFTUFQICAgICAgICAgICAgICAgICA9IDQxNjcKCVNZU19BQ0NFUFQgICAgICAgICAgICAgICAgID0gNDE2OAoJU1lTX0JJTkQgICAgICAgICAgICAgICAgICAgPSA0MTY5CglTWVNfQ09OTkVDVCAgICAgICAgICAgICAgICA9IDQxNzAKCVNZU19HRVRQRUVSTkFNRSAgICAgICAgICAgID0gNDE3MQoJU1lTX0dFVFNPQ0tOQU1FICAgICAgICAgICAgPSA0MTcyCglTWVNfR0VUU09DS09QVCAgICAgICAgICAgICA9IDQxNzMKCVNZU19MSVNURU4gICAgICAgICAgICAgICAgID0gNDE3NAoJU1lTX1JFQ1YgICAgd2ViLmFyY2hpdmUub3JnL3dlYi8yMDE1MDQyMDA4MDczNi9odHRwOi8vd3d3LmZhc3RjZ2kuY29tL2RydXBhbC9ub2RlLzY/cT1ub2RlLzIyI1M4CnR5cGUgcmVjVHlwZSB1aW50OAoKY29uc3QgKAoJdHlwZUJlZ2luUmVxdWVzdCAgICByZWNUeXBlID0gMQoJdHlwZUFib3J0UmVxdWVzdCAgICByZWNUeXBlID0gMgoJdHlwZUVuZFJlcXVlc3QgICAgICByZWNUeXBlID0gMwoJdHlwZVBhcmFtcyAgICAgICAgICByZWNUeXBlID0gNAoJdHlwZVN0ZGluICAgICAgICAgICByZWNUeXBlID0gNQoJdHlwZVN0ZG91dCAgICAgICAgICByZWNUeXBlID0gNgoJdHlwZVN0ZGVyciAgICAgICAgICByZWNUeXBlID0gNwoJdHlwZURhdGEgICAgICAgICAgICByZWNUeXBlID0gOAoJdHlwZUdldFZhbHVlcyAgICAgICByZWNUeXBlID0gOQoJdHlwZUdldFZhbHVlc1Jlc3VsdCByZWNUeXBlID0gMTAKCXR5cGVVbmtub3duVHlwZSAgICAgcmVjVHlwZSA9IDExCikKCi8vIGtlZXAgdGhlIGNvbm5lY3Rpb24gYmV0d2VlbiB3ZWItc2VydmVyIGFuZCByZXNwb25kZXIgb3BlbiBhZnRlciByZXF1ZXN0CmNvbnN0IGZsYWdLZWVwQ29ubiA9IDEKCmNvbnN0ICgKCW1heFdyaXRlID0gNjU1MzUgLy8gbWF4aW11bSByZWNvcmQgYm9keQoJbWF4UGFkICAgPSAyNTUKKQoKY29uc3QgKAoJcm9sZVJlc3BvbmRlciA9IGlvdGEgKyAxIC8vIG9ubHkgUmVzcG9uZGVycyBhcmUgaW1wbGVtZW50ZWQuCglyb2xlQXV0aG9yaXplcgoJcm9sZUZpbHRlcgopCgpjb25zdCAoCglzdGF0dXNSZXF1ZXN0Q29tcGxldGUgPSBpb3RhCglzdGF0dXNDYW50TXVsdGlwbGV4CglzdGF0dXNPdmVybG9hZGVkCglzdGF0dXNVbmtub3duUm9sZQopCgp0eXBlIGhlYWRlciBzdHJ1Y3QgewoJVmVyc2lvbiAgICAgICB1aW50OAoJVHlwZSAgICAgICAgICByZWNUeXBlCglJZCAgICAgICAgICAgIHVpbnQxNgoJQ29udGVudExlbmd0aCB1aW50MTYKCVBhZGRpbmdMZW5ndGggdWludDgKCVJlc2VydmVkICAgICAgdWludDgKfQoKdHlwZSBiZWdpblJlcXVlc3Qgc3RydWN0IHsKCXJvbGUgICAgIHVpbnQxNgoJZmxhZ3MgICAgdWludDgKCXJlc2VydmVkIFs1XXVpbnQ4Cn0KCmZ1bmMgKGJyICpiZWdpblJlcXVlc3QpIHJlYWQoY29udGVudCBbXWJ5dGUpIGVycm9yIHsKCWlmIGxlbihjb250ZW50KSAhPSA4IHsKCQlyZXR1cm4gZXJyb3JzLk5ldygiZmNnaTogaW52YWxpZCBiZWdpbiByZXF1ZXN0IHJlY29yZCIpCgl9Cglici5yb2xlID0gYmluYXJ5LkJpZ0VuZGlhbi5VaW50MTYoY29udGVudCkKCWJyLmZsYWdzID0gY29udGVudFsyXQoJcmV0dXJuIG5pbAp9CgovLyBmb3IgcGFkZGluZyBzbyB3ZSBkb24ndCBoYXZlIHRvIGFsbG9jYXRlIGFsbCB0aGUgdGltZQovLyBub3Qgc3luY2hyb25pemVkIGJlY2F1c2Ugd2UgZG9uJ3QgY2FyZSB3aGF0IHRoZSBjb250ZW50cyBhcmUKdmFyIHBhZCBbbWF4UGFkXWJ5dGUKCmZ1bmMgKGggKmhlYWRlcikgaW5pdChyZWNUeXBlIHJlY1R5cGUsIHJlcUlkIHVpbnQxNiwgY29udGVudExlbmd0aCBpbnQpIHsKCWguVmVyc2lvbiA9IDEKCWguVHlwZSA9IHJlY1R5cGUKCWguSWQgPSByZXFJZAoJaC5Db250ZW50TGVuZ3RoID0gdWludDE2KGNvbnRlbnRMZW5ndGgpCgloLlBhZGRpbmdMZW5ndGggPSB1aW50OCgtY29udGVudExlbmd0aCAmIDcpCn0KCi8vIGNvbm4gc2VuZHMgcmVjb3JkcyBvdmVyIHJ3Ywp0eXBlIGNvbm4gc3RydWN0IHsKCW11dGV4ICAgIHN5bmMuTXV0ZXgKCXJ3YyAgICAgIGlvLlJlYWRXcml0ZUNsb3NlcgoJY2xvc2VFcnIgZXJyb3IKCWNsb3NlZCAgIGJvb2wKCgkvLyB0byBhdm9pZCBhbGxvY2F0aW9ucwoJYnVmIGJ5dGVzLkJ1ZmZlcgoJaCAgIGhlYWRlcgp9CgpmdW5jIG5ld0Nvbm4ocndjIGlvLlJlYWRXcml0ZUNsb3NlcikgKmNvbm4gewoJcmV0dXJuICZjb25ue3J3YzogcndjfQp9CgovLyBDbG9zZSBjbG9zZXMgdGhlIGNvbm4gaWYgaXQgaXMgbm90IGFscmVhZHkgY2xvc3JucywgYnkgY29weWluZyBpdCBpbnRvIGEgdGVtcCBhbmQgbWFya2luZyB0aGF0IHRlbXAgc3RpbGwKCQkvLyBhbGl2ZSB3aGVuIHdlIHBvcCB0aGUgdGVtcCBzdGFjay4KCQljb252LCBvayA6PSBhcmcuKCppci5Db252RXhwcikKCQlpZiAhb2sgfHwgY29udi5PcCgpICE9IGlyLk9DT05WTk9QIHsKCQkJcmV0dXJuIC8vIG5vdCBhIGNvbnZlcnNpb24KCQl9CgkJaWYgIWNvbnYuWC5UeXBlKCkuSXNVbnNhZmVQdHIoKSB8fCAhY29udi5UeXBlKCkuSXNVaW50cHRyKCkgewoJCQlyZXR1cm4gLy8gbm90IGFuIHVuc2FmZS5Qb2ludGVyLT51aW50cHRyIGNvbnZlcnNpb24KCQl9CgoJCS8vIENyZWF0ZSBhbmQgZGVjbGFyZSBhIG5ldyBwb2ludGVyLXR5cGVkIHRlbXAgdmFyaWFibGUuCgkJLy8KCQkvLyBUT0RPKG1kZW1wc2t5KTogVGhpcyBwb3RlbnRpYWxseSB2aW9sYXRlcyB0aGUgR28gc3BlYydzIG9yZGVyCgkJLy8gb2YgZXZhbHVhdGlvbnMsIGJ5IGV2YWx1YXRpbmcgYXJnLlggYmVmb3JlIGFueSBvdGhlcgoJCS8vIG9wZXJhbmRzLgoJCXRtcCA6PSBlLmNvcHlFeHByKGNvbnYuUG9zKCksIGNvbnYuWCwgY2FsbC5QdHJJbml0KCkpCgkJY29udi5YID0gdG1wCgoJCWsgOj0gZS5tdXRhdG9ySG9sZSgpCgkJaWYgcHJhZ21hJmlyLlVpbnRwdHJFc2NhcGVzICE9IDAgewoJCQlrID0gZS5oZWFwSG9sZSgpLm5vdGUoY29udiwgIi8vZ286dWludHB0cmVzY2FwZXMiKQoJCX0KCQllLmZsb3coaywgZS5vbGRMb2ModG1wKSkKCgkJaWYgcHJhZ21hJmlyLlVpbnRwdHJLZWVwQWxpdmUgIT0gMCB7CgkJCXRtcC5TZXRBZGRydGFrZW4odHJ1ZSkgLy8gZW5zdXJlIFNTQSBrZWVwcyB0aGUgdG1wIHZhcmlhYmxlCgkJCWNhbGwuS2VlcEFsaXZlID0gYXBwZW5kKGNhbGwuS2VlcEFsaXZlLCB0bXApCgkJfQoJfQoKCS8vIEZvciB2YXJpYWRpYyBmdW5jdGlvbnMsIHRoZSBjb21waWxlciBoYXMgYWxyZWFkeSByZXdyaXR0ZW46CgkvLwoJLy8gICAgIGYoYSwgYiwgYykKCS8vCgkvLyB0bzoKCS8vCgkvLyAgICAgZihbXVR7YSwgYiwgY30uLi4pCgkvLwoJLy8gU28gd2UgbmVlZCB0byBsb29rIGludG8gc2xpY2UgZWxlbWVudHMgdG8gaGFuZGxlIHVpbnRwdHIocHRyKQoJLy8gYXJndW1lbnRzIHRvIHZhcmlhZGljIHN5c2NhbGwtbGlrZSBmdW5jdGlvbnMgY29ycmVjdGx5LgoJaWYgYXJnLk9wKCkgPT0gaXIuT1NMSUNFTElUIHsKCQlsaXN0IDo9IGFyZy4oKmlyLkNvbXBMaXRFeHByKS5MaXN0CgkJZm9yIF8sIGVsIDo9IHJhbmdlIGxpc3QgewoJCQlpZiBlbC5PcCgpID09IGlyLk9LRVkgewoJCQkJZWwgPSBlbC4oKmlyLktleUV4cHIpLlZhbHVlCgkJCX0KCQkJdW5zYWZlVWludHB0cihlbCkKCQl9Cgl9IGVsc2UgewoJCXVuc2FmZVVpbnRwdHIoYXJnKQoJfQp9CgovLyBjb3B5RXhwciBjcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHRlbXBvcmFyeSB2YXJpYWJsZSB3aXRoaW4gZm47Ci8vIGFwcGVuZHMgc3RhdGVtZW50cyB0byBpbml0IHRvIGRlY2xhcmUgYW5kIGluaXRpYWxpemUgaXQgdG8gZXhwcjsKLy8gYW5kIGVzY2FwZSBhbmFseXplcyB0aGUgZGF0YSBmbG93LgpmdW5jIChlICplc2NhcGUpIGNvcHlFeHByKHBvcyBzcmMuWFBvcywgZXhwciBpci5Ob2RlLCBpbml0ICppci5Ob2RlcykgKmlyLk5hbWUgewoJaWYgaXIuSGFzVW5pcXVlUG9zKGV4cHIpIHsKCQlwb3MgPSBleHByLlBvcygpCgl9CgoJdG1wIDo9IHR5cGVjaGVjay5UZW1wQXQocG9zLCBlLmN1cmZuLCBleHByLlR5cGUoKSkKCglzdG10cyA6PSBbXWlyLk5vZGV7CgkJaXIuTmV3RGVjbChwb3MsIGlyLk9EQ0wsIHRtcCksCgkJaXIuTmV3QXNzaWduU3RtdChwb3MsIHRtcCwgZXhwciksCgl9Cgl0eXBlY2hlY2suU3RtdHMoc3RtdHMpCglpbml0LkFwcGVuZChzdG10cy4uLikKCgllLm5ld0xvYyh0bXAsIHRydWUpCgllLnN0bXRzKHN0bXRzKQoKCXJldHVybiB0bXAKfQoKLy8gdGFnSG9sZSByZXR1cm5zIGEgaG9sZSB0aW1lLnRocm93CmZ1bmMgcnVudGltZV90aHJvdyhzdHJpbmcpCgovL2dvOmNnb191bnNhZmVfYXJncwpmdW5jIF9jZ29fY21hbGxvYyhwMCB1aW50NjQpIChyMSB1bnNhZmUuUG9pbnRlcikgewoJX2Nnb19ydW50aW1lX2Nnb2NhbGwoX2Nnb1BSRUZJWF9DZnVuY19fQ21hbGxvYywgdWludHB0cih1bnNhZmUuUG9pbnRlcigmcDApKSkKCWlmIHIxID09IG5pbCB7CgkJcnVudGltZV90aHJvdygicnVudGltZTogQyBtYWxsb2MgZmFpbGVkIikKCX0KCXJldHVybgp9CmAKCi8vIGNNYWxsb2NEZWZDIGRlZmluZXMgdGhlIEMgdmVyc2lvbiBvZiBDLm1hbGxvYyBmb3IgdGhlIGdjIGNvbXBpbGVyLgovLyBJdCBpcyBkZWZpbmVkIGhlcmUgYmVjYXVzZSBDLkNTdHJpbmcgYW5kIGZyaWVuZHMgbmVlZCBhIGRlZmluaXRpb24uCi8vIFdlIGRlZmluZSBpdCBieSBoYW5kLCByYXRoZXIgdGhhbiBzaW1wbHkgaW52ZW50aW5nIGEgcmVmZXJlbmNlIHRvCi8vIEMubWFsbG9jLCBiZWNhdXNlIDxzdGRsaWIuaD4gbWF5IG5vdCBoYXZlIGJlZW4gaW5jbHVkZWQuCi8vIFRoaXMgaXMgYXBwcm94aW1hdGVseSB3aGF0IHdyaXRlT3V0cHV0RnVuYyB3b3VsZCBnZW5lcmF0ZSwgYnV0Ci8vIHNraXBzIHRoZSBjZ29fdG9wb2ZzdGFjayBjb2RlICh3aGljaCBpcyBvbmx5IG5lZWRlZCBpZiB0aGUgQyBjb2RlCi8vIGNhbGxzIGJhY2sgaW50byBHbykuIFRoaXMgYWxzbyBhdm9pZHMgcmV0dXJuaW5nIG5pbCBmb3IgYW4KLy8gYWxsb2NhdGlvbiBvZiAwIGJ5dGVzLgpjb25zdCBjTWFsbG9jRGVmQyA9IGAKQ0dPX05PX1NBTklUSVpFX1RIUkVBRAp2b2lkIF9jZ29QUkVGSVhfQ2Z1bmNfX0NtYWxsb2Modm9pZCAqdikgewoJc3RydWN0IHsKCQl1bnNpZ25lZCBsb25nIGxvbmcgcDA7CgkJdm9pZCAqcjE7Cgl9IFBBQ0tFRCAqYSA9IHY7Cgl2b2lkICpyZXQ7CglfY2dvX3RzYW5fYWNxdWlyZSgpOwoJcmV0ID0gbWFsbG9jKGEtPnAwKTsKCWlmIChyZXQgPT0gTlVMTCAmJiBhLT5wMCA9PSAwKSB7CgkJcmV0ID0gbWFsbG9jKDEpOwoJfQoJYS0+cjEgPSByZXQ7CglfY2dvX3RzYW5fcmVsZWFzZSgpOwp9CmAKCmZ1bmMgKHAgKlBhY2thZ2UpIGNQcm9sb2dHY2NnbygpIHN0cmluZyB7CglyIDo9IHN0cmluZ3MuTmV3UmVwbGFjZXIoCgkJIlBSRUZJWCIsIGNQcmVmaXgsCgkJIkdDQ0dPU1lNQk9MUFJFRiIsIHAuZ2NjZ29TeW1ib2xQcmVmaXgoKSwKCQkiX2Nnb0NoZWNrUG9pbnRlciIsIGdjY2dvVG9TeW1ib2woIl9jZ29DaGVja1BvaW50ZXIiKSwKCQkiX2Nnb0NoZWNrUmVzdWx0IiwgZ2NjZ29Ub1N5bWJvbCgiX2Nnb0NoZWNrUmVzdWx0IikpCglyZXR1cm4gci5SZXBsYWNlKGNQcm9sb2dHY2NnbykKfQoKY29uc3QgY1Byb2xvZ0djY2dvID0gYAojbGluZSAxICJjZ28tYy1wcm9sb2ctZ2NjZ28iCiNpbmNsdWRlIDxzdGRpbnQuaD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8c3RyaW5nLmg+Cgp0eXBlZGVmIHVuc2lnbmVkIGNoYXIgYnl0ZTsKdHlwZWRlZiBpbnRwdHJfdCBpbnRnbzsKCnN0cnVjdCBfX2dvX3N0cmluZyB7Cgljb25zdCB1bnNpZ25lZCBjaGFyICpfX2RhdGE7CglpbnRnbyBfX2xlbmd0aDsKfTsKCnR5cGVkZWYgc3RydWN0IF9fZ29fb3Blbl9hcnJheSB7Cgl2b2lkKiBfX3ZhbHVlczsKCWludGdvIF9fY291bnQ7CglpbnRnbyBfX2NhcGFjaXR5Owp9IFNsaWNlOwoKc3RydWN0IF9fZ29fc3RyaW5nIF9fZ29fYnl0ZV9hcnJheV90b19zdHJpbmcoY29uc3Qgdm9pZCogcCwgaW50Z28gbGVuKTsKc3RydWN0IF9fZ29fb3Blbl9hcnJheSBfX2dvX3N0cmluZ190b19ieXRlX2FycmF5IChzdHJ1Y3QgX19nb19zdHJpbmcgc3RyKTsKCmV4dGVybiB2b2lkIHJ1bnRpbWVfdGhyb3coY29uc3QgY2hhciAqKTsKCmNvbnN0IGNoYXIgKl9jZ29QUkVGSVhfQ2Z1bmNfQ1N0cmluZyhzdHJ1Y3QgX19nb19zdHJpbmcgcykgewoJY2hhciAqcCA9IG1hbGxvYyhzLl9fbGVuZ3RoKzEpOwoJaWYocCA9MHgzRkU0NDAxRThCMDA1REZGCgkxLjQ1NDkyMjUwMTM3MjM0NzY4NzM3ZSswMCwgIC8vIDB4M0ZGNzQ3NUNEMTE5QkQ2RgoJOS43NzcxNzUyNzk2MzM3Mjc0NTYwM2UtMDEsICAvLyAweDNGRUY0OTc2NDRFQTg0NTAKCTIuMjg5NjM3MjgwNjQ2OTI0NTEwOTJlLTAxLCAgLy8gMHgzRkNENEVBRUY2MDEwOTI0CgkxLjMzODEwOTE4NTM2Nzg3NjYwMzc3ZS0wMiwgIC8vIDB4M0Y4QjY3OEJCRjJCQUIwOQp9CnZhciBfbGdhbVYgPSBbLi4uXWZsb2F0NjR7CgkxLjAsCgkyLjQ1NTk3NzkzNzEzMDQxMTM0ODIyZSswMCwgLy8gMHg0MDAzQTVEN0MyQkQ2MTlDCgkyLjEyODQ4OTc2Mzc5ODkzMzk1MzYxZSswMCwgLy8gMHg0MDAxMDcyNUE0MkIxOEY1Cgk3LjY5Mjg1MTUwNDU2NjcyNzgzODI1ZS0wMSwgLy8gMHgzRkU4OURGQkU0NTA1MEFGCgkxLjA0MjIyNjQ1NTkzMzY5MTM0MjU0ZS0wMSwgLy8gMHgzRkJBQUU1NUQ2NTM3Qzg4CgkzLjIxNzA5MjQyMjgyNDIzOTExODEwZS0wMywgLy8gMHgzRjZBNUFCQjU3RDBDRjYxCn0KdmFyIF9sZ2FtVyA9IFsuLi5dZmxvYXQ2NHsKCTQuMTg5Mzg1MzMyMDQ2NzI3MjUwNTJlLTAxLCAgLy8gMHgzRkRBQ0ZFMzkwQzk3RDY5Cgk4LjMzMzMzMzMzMzMzMzI5Njc4ODQ5ZS0wMiwgIC8vIDB4M0ZCNTU1NTU1NTU1NTUzQgoJLTIuNzc3Nzc3Nzc3Mjg3NzU1MzY0NzBlLTAzLCAvLyAweEJGNjZDMTZDMTZCMDJFNUMKCTcuOTM2NTA1NTg2NDMwMTk1NTg1MDBlLTA0LCAgLy8gMHgzRjRBMDE5Rjk4Q0YzOEI2CgktNS45NTE4NzU1NzQ1MDMzOTk2MzEzNWUtMDQsIC8vIDB4QkY0MzgwQ0I4QzBGRTc0MQoJOC4zNjMzOTkxODk5NjI4MjEzOTEyNmUtMDQsICAvLyAweDNGNEI2N0JBNENEQUQ1RDEKCS0xLjYzMDkyOTM0MDk2NTc1MjczOTg5ZS0wMywgLy8gMHhCRjVBQjg5RDBCOUU0M0U0Cn0KCi8vIExnYW1tYSByZXR1cm5zIHRoZSBuYXR1cmFsIGxvZ2FyaXRobSBhbmQgc2lnbiAoLTEgb3IgKzEpIG9mIFtHYW1tYV0oeCkuCi8vCi8vIFNwZWNpYWwgY2FzZXMgYXJlOgovLwovLwlMZ2FtbWEoK0luZikgPSArSW5mCi8vCUxnYW1tYSgwKSA9ICtJbmYKLy8JTGdhbW1hKC1pbnRlZ2VyKSA9ICtJbmYKLy8JTGdhbW1hKC1JbmYpID0gLUluZgovLwlMZ2FtbWEoTmFOKSA9IE5hTgpmdW5jIExnYW1tYSh4IGZsb2F0NjQpIChsZ2FtbWEgZmxvYXQ2NCwgc2lnbiBpbnQpIHsKCWNvbnN0ICgKCQlZbWluICA9IDEuNDYxNjMyMTQ0OTY4MzYyMjQ1CgkJVHdvNTIgPSAxIDw8IDUyICAgICAgICAgICAgICAgICAgICAgLy8gMHg0MzMwMDAwMDAwMDAwMDAwIH40LjUwMzZlKzE1CgkJVHdvNTMgPSAxIDw8IDUzICAgICAgICAgICAgICAgICAgICAgLy8gMHg0MzQwMDAwMDAwMDAwMDAwIH45LjAwNzJlKzE1CgkJVHdvNTggPSAxIDw8IDU4ICAgICAgICAgICAgICAgICAgICAgLy8gMHg0MzkwMDAwMDAwMDAwMDAwIH4yLjg4MjNlKzE3CgkJVGlueSAgPSAxLjAgLyAoMSA8PCA3MCkgICAgICAgICAgICAgLy8gMHgzYjkwMDAwMDAwMDAwMDAwIH44LjQ3MDMzZS0yMgoJCVRjICAgID0gMS40NjE2MzIxNDQ5NjgzNjIyNDU3NmUrMDAgIC8vIDB4M0ZGNzYyRDg2MzU2QkUzRgoJCVRmICAgID0gLTEuMjE0ODYyOTA1MzU4NDk2MTE0NjFlLTAxIC8vIDB4QkZCRjE5QjlCQ0MzOEE0MgoJCS8vIFR0ID0gLSh0YWlsIG9mIFRmKQoJCVR0ID0gLTMuNjM4Njc2OTk3MDM5NTA1MzY1NDFlLTE4IC8vIDB4QkM1MEM3Q0FBNDhBOTcxRgoJKQoJLy8gc3BlY2lhbCBjYXNlcwoJc2lnbiA9IDEKCXN3aXRjaCB7CgljYXNlIElzTmFOKHgpOgoJCWxnYW1tYSA9IHgKCQlyZXR1cm4KCWNhc2UgSXNJbmYoeCwgMCk6CgkJbGdhbW1hID0geAoJCXJldHVybgoJY2FzZSB4ID09IDA6CgkJbGdhbW1hID0gSW5mKDEpCgkJcmV0dXJuCgl9CgoJbmVnIDo9IGZhbHNlCglpZiB4IDwgMCB7CgkJeCA9IC14CgkJbmVnID0gdHJ1ZQoJfQoKCWlmIHggPCBUaW55IHsgLy8gaWYgfHh8IDwgMioqLTcwLCByZXR1LkxlbiB7CgkJLy8gcmVtb3ZlIHRoZSBiZWdpbm5pbmcgb2YgcGVvcCB0aGF0IG92ZXJsYXBzIHdpdGggZXhpc3QKCQlkZWx0YSA6PSBleGlzdC5ZICsgZXhpc3QuTGVuIC0gcHJvcC5ZCgkJcHJvcC5MZW4gLT0gZGVsdGEKCQlpZiBwcm9wLkxlbiA8PSAwIHsKCQkJcmV0dXJuIGVtcHR5LCBwcm9wCgkJfQoJCXByb3AuWCArPSBkZWx0YSAvLyBubyB0ZXN0IHJlYWNoZXMgdGhpcyBjb2RlCgkJcHJvcC5ZICs9IGRlbHRhCgl9CglpZiBwcm9wLlgrcHJvcC5MZW4gPD0gZXhpc3QuWCAmJiBwcm9wLlkrcHJvcC5MZW4gPD0gZXhpc3QuWSB7CgkJcmV0dXJuIGxlZnRkb3duLCBwcm9wCgl9CglpZiBleGlzdC5YK2V4aXN0LkxlbiA8PSBwcm9wLlggJiYgZXhpc3QuWStleGlzdC5MZW4gPD0gcHJvcC5ZIHsKCQlyZXR1cm4gcmlnaHR1cCwgcHJvcAoJfQoJLy8gcHJvcCBjYW4ndCBiZSBpbiBhbiBsY3MgdGhhdCBjb250YWlucyBleGlzdAoJcmV0dXJuIGJhZCwgcHJvcAp9CgovLyBtYW5pcHVsYXRpbmcgRGlhZyBhbmQgbGNzCgovLyBwcmVwZW5kIGEgZGlhZ29uYWwgKHgseSktKHgrMSx5KzEpIHNlZ21lbnQgZWl0aGVyIHRvIGFuIGVtcHR5IGxjcwovLyBvciB0byBpdHMgZmlyc3QgRGlhZy4gcHJlcGVuZCBpcyBvbmx5IGNhbGxlZCB0byBleHRlbmQgZGlhZ29uYWxzCi8vIHRoZSBiYWNrd2FyZCBkaXJlY3Rpb24uCmZ1bmMgKGxjcyBsY3MpIHByZXBlbmQoeCwgeSBpbnQpIGxjcyB7CglpZiBsZW4obGNzKSA+IDAgewoJCWQgOj0gJmxjc1swXQoJCWlmIGludChkLlgpID09IHgrMSAmJiBpbnQoZC5ZKSA9PSB5KzEgewoJCQkvLyBleHRlbmQgdGhlIGRpYWdvbmFsIGRvd24gYW5kIHRvIHRoZSBsZWZ0CgkJCWQuWCwgZC5ZID0gaW50KHgpLCBpbnQoeSkKCQkJZC5MZW4rKwoJCQlyZXR1cm4gbGNzCgkJfQoJfQoKCXIgOj0gZGlhZ3tYOiBpbnQoeCksIFk6IGludCh5KSwgTGVuOiAxfQoJbGNzID0gYXBwZW5kKFtdZGlhZ3tyfSwgbGNzLi4uKQoJcmV0dXJuIGxjcwp9CgovLyBhcHBlbmQgYXBwZW5kcyBhIGRpYWdvbmFsLCBvciBleHRlbmRzIHRoZSBleGlzdGluZyBvbmUuCi8vIGJ5IGFkZGluZyB0aGUgZWRnZSAoeCx5KS0oeCsxLnkrMSkuIGFwcGVuZCBpcyBvbmx5IGNhbGxlZAovLyB0byBleHRlbmQgZGlhZ29uYWxzIGluIHRoZSBmb3J3YXJkIGRpcmVjdGlvbi4KZnVuYyAobGNzIGxjcykgYXBwZW5kKHgsIHkgaW50KSBsY3MgewoJaWYgbGVuKGxjcykgPiAwIHsKCQlsYXN0IDo9ICZsY3NbbGVuKGxjcyktMV0KCQkvLyBFeHBhbmQgbGFzdCBlbGVtZW50IGlmIGFkam9pbmluZy4KCQlpZiBsYXN0LlgrbGFzdC5MZW4gPT0geCAmJiBsYXN0LlkrbGFzdC5MZW4gPT0geSB7CgkJCWxhc3QuTGVuKysKCQkJcmV0dXJuIGxjcwoJCX0KCX0KCglyZXR1cm4gYXBwZW5kKGxjcywgZGlhZ3tYOiB4LCBZOiB5LCBMZW46IDF9KQp9CgovLyBlbmZvcmNlIGNvbnN0cmFpbnQgb24gZCwgawpmdW5jIG9rKGQsIGsgaW50KSBib29sIHsKCXJldHVybiBkID49IDAgJiYgLWQgPD0gayAmJiBrIDw9IGQKfQovLyBDb3B5cmlnaHQgMjAyMiBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSBnb2Vycm9yX2ZwCgp0eXBlIFNlcVtUIGFueV0gW11UCgpmdW5jIChyIFNlcVtUXSkgU2l6ZSgpIGludCB7CglyZXR1cm4gbGVuKHIpCn0KCmZ1bmMgKHIgU2VxW1RdKSBBcHBlbmQoaXRlbXMgLi4uVCkgU2VxW1RdIHsKCXRhaWwgOj0gU2VxW1RdKGl0ZW1zKQoJcmV0IDo9IG1ha2UoU2VxW1RdLCByLlNpemUoKSt0YWlsLlNpemUoKSkKCglmb3IgaSA6PSByYW5nZSByIHsKCQlyZXRbaV0gPSByW2ldCgl9CgoJZm9yIGkgOj0gcmFuZ2UgdGFpbCB7CgkJcmV0W2krci5TaXplKCldID0gdGFpbFtpXVQtNDFdCglfID0geFtTREFUQUZJUFMtNDJdCglfID0geFtTREFUQUZJUFNFTkQtNDNdCglfID0geFtTREFUQUVORC00NF0KCV8gPSB4W1NYQ09GRlRPQy00NV0KCV8gPSB4W1NCU1MtNDZdCglfID0geFtTTk9QVFJCU1MtNDddCglfID0geFtTTElCRlVaWkVSXzhCSVRfQ09VTlRFUi00OF0KCV8gPSB4W1NDT1ZFUkFHRV9DT1VOVEVSLTQ5XQoJXyA9IHhbU0NPVkVSQUdFX0FVWFZBUi01MF0KCV8gPSB4W1NUTFNCU1MtNTFdCglfID0geFtTRmlyc3RVbmFsbG9jYXRlZC01Ml0KCV8gPSB4W1NYUkVGLTUzXQoJXyA9IHhbU01BQ0hPU1lNU1RSLTU0XQoJXyA9IHhbU01BQ0hPU1lNVEFCLTU1XQoJXyA9IHhbU01BQ0hPSU5ESVJFQ1RQTFQtNTZdCglfID0geFtTTUFDSE9JTkRJUkVDVEdPVC01N10KCV8gPSB4W1NEWU5JTVBPUlQtNThdCglfID0geFtTSE9TVE9CSi01OV0KCV8gPSB4W1NVTkRFRkVYVC02MF0KCV8gPSB4W1NEV0FSRlNFQ1QtNjFdCglfID0geFtTRFdBUkZDVUlORk8tNjJdCglfID0geFtTRFdBUkZDT05TVC02M10KCV8gPSB4W1NEV0FSRkZDTi02NF0KCV8gPSB4W1NEV0FSRkFCU0ZDTi02NV0KCV8gPSB4W1NEV0FSRlRZUEUtNjZdCglfID0geFtTRFdBUkZWQVItNjddCglfID0geFtTRFdBUkZSQU5HRS02OF0KCV8gPSB4W1NEV0FSRkxPQy02OV0KCV8gPSB4W1NEV0FSRkxJTkVTLTcwXQoJXyA9IHhbU0RXQVJGQUREUi03MV0KCV8gPSB4W1NTRUhVTldJTkRJTkZPLTcyXQoJXyA9IHhbU1NFSFNFQ1QtNzNdCn0KCmNvbnN0IF9TeW1LaW5kX25hbWUgPSAiU3h4eFNURVhUU1RFWFRGSVBTU1RBUlRTVEVYVEZJUFNTVEVYVEZJUFNFTkRTVEVYVEVORFNFTEZSWFNFQ1RTTUFDSE9QTFRTU1RSSU5HU0dPU1RSSU5HU0dDQklUU1NST0RBVEFTUk9EQVRBRklQU1NUQVJUU1JPREFUQUZJUFNTUk9EQVRBRklQU0VORFNST0RBVEFFTkRTUENMTlRBQlNUWVBFTElOS1NFTEZST1NFQ1RTUk9EQVRBUkVMUk9TVFlQRVNHT0ZVTkNTRUxGUkVMUk9TRUNUU01BQ0hPUkVMUk9TRUNUU0lUQUJMSU5LU0ZpcnN0V3JpdGFibGVTQlVJTERJTkZPU0ZJUFNJTkZPU0VMRlNFQ1RTTUFDSE9TV0lORE9XU1NNT0RVTEVEQVRBU0VMRkdPVFNNQUNIT0dPVFNOT1BUUkRBVEFTTk9QVFJEQVRBRklQU1NUQVJUU05PUFRSREFUQUZJUFNTTk9QVFJEQVRBRklQU0VORFNOT1BUUkRBVEFFTkRTSU5JVEFSUlNEQVRBU0RBVEFGSVBTU1RBUlRTREFUQUZJUFNTREFUQUZJUFNFTkRTREFUQUVORFNYQ09GRlRPQ1NCU1NTTk9QVFJCU1NTTElCRlVaWkVSXzhCSVRfQ09VTlRFUlNDT1ZFUkFHRV9DT1VOVEVSU0NPVkVSQUdFX0FVWFZBUlNUTFNCU1NTRmlyc3RVbmFsbG9jYXRlZFNYUkVGU01BQ0hPU1lNU1RSU01BQ0hPU1lNVEFCU01BQ0hPSU5ESVJFQ1RQTFRTTUFDSE9JTkRJUkVDVEdPVFNEWU5JTVBPUlRTSE9TVE9CSlNVTkRFRkVYVFNEV0FSRlNFQ1RTRFdBUkZDVUlORk9TRFdBUkZDT05TVFNEV0FSRkZDTlNEV0FSRkFCU0ZDTlNEV0FSRlRZUEVTRFdBUkZWQVJTRFdBUkZSQU5HRVNEV0FSRkxPQ1NEV0FSRkxJTkVTU0RXQVJGQUREUlNTRUhVTldJTkRJTkZPU1NFSFNFQ1QiCgp2YXIgX1N5bUtpbmRfaW5kZXggPSBbLi4uXXVpbnQxNnswLCA0LCA5LCAyMywgMzIsIDQ0LCA1MiwgNjIsIDcxLCA3OCwgODcsIDk0LCAxMDEsIDExNywgMTI4LCAxNDIsIDE1MiwgMTYwLCAxNjksIDE3OSwgMTkxLCAxOTYsIDIwMywgMjE2LCAyMzEsIDI0MCwgMjU0LCAyNjQsIDI3MywgMjgxLCAyODcsIDI5NSwgMzA2LCAzMTMsIDMyMiwgMzMyLCAzNTEsIDM2NSwgMzgyLCAzOTUsIDQwMywgNDA4LCA0MjIsIDQzMSwgNDQzLCA0NTEsIDQ2MCwgNDY0LCA0NzMsIDQ5NiwgNTEzLCA1MjksIDUzNiwgNTUzLCA1NTgsIDU3MCwgNTgyLCA1OTksIDYxNiwgNjI2LCA2MzQsIDY0MywgNjUzLCA2NjUsIDY3NiwgNjg1LCA2OTcsIDcwNywgNzE2LCA3MjcsIDczNiwgNzQ3LCA3NTcsIDc3MSwgNzc5fQoKZnVuYyAoaSBTeW1LaW5kKSBTdHJuYyBpc3N1ZTY3NjZhKCkgewoJYSwgYSAvKiBFUlJPUiAiYSByZXBlYXRlZCBvbiBsZWZ0IHNpZGUgb2YgOj0iICovIDo9IDEsIDIKCV8gPSBhCglhLCBiLCBiIC8qIEVSUk9SICJiIHJlcGVhdGVkIG9uIGxlZnQgc2lkZSBvZiA6PSIgKi8gOj0gMSwgMiwgMwoJXyA9IGIKCWMsIGMgLyogRVJST1IgImMgcmVwZWF0ZWQgb24gbGVmdCBzaWRlIG9mIDo9IiAqLywgYiA6PSAxLCAyLCAzCglfID0gYwoJYSwgYiA6PSAvKiBFUlJPUiAibm8gbmV3IHZhcmlhYmxlcyIgKi8gMSwgMgp9CgpmdW5jIHNob3J0VmFyRGVjbHMxKCkgewoJY29uc3QgYyA9IDAKCXR5cGUgZCBpbnQKCWEsIGIsIGMgLyogRVJST1IgImNhbm5vdCBhc3NpZ24iICovICwgZCAvKiBFUlJPUiAiY2Fubm90IGFzc2lnbiIgKi8gIDo9IDEsICJ6d2VpIiwgMy4wLCA0Cgl2YXIgXyBpbnQgPSBhIC8vIGEgaXMgb2YgdHlwZSBpbnQKCXZhciBfIHN0cmluZyA9IGIgLy8gYiBpcyBvZiB0eXBlIHN0cmluZwp9CgpmdW5jIGluY2RlY3MoKSB7Cgljb25zdCBjID0gMy4xNAoJYyAvKiBFUlJPUiAiY2Fubm90IGFzc2lnbiIgKi8gKysKCXMgOj0gImZvbyIKCXMgLyogRVJST1IgImludmFsaWQgb3BlcmF0aW9uIiAqLyAtLQoJMy4xNCAvKiBFUlJPUiAiY2Fubm90IGFzc2lnbiIgKi8gKysKCXZhciAoCgkJeCBpbnQKCQl5IGZsb2F0MzIKCQl6IGNvbXBsZXgxMjgKCSkKCXgrKwoJeS0tCgl6KysKfQoKZnVuYyBzZW5kcygpIHsKCXZhciBjaCBjaGFuIGludAoJdmFyIHJjaCA8LWNoYW4gaW50Cgl2YXIgeCBpbnQKCXggPC0gLyogRVJST1IgImNhbm5vdCBzZW5kIiAqLyB4CglyY2ggPC0gLyogRVJST1IgImNhbm5vdCBzZW5kIiAqLyB4CgljaCA8LSAiZm9vIiAvKiBFUlJPUnggYGNhbm5vdCB1c2UgLiogaW4gc2VuZGAgKi8KCWNoIDwtIHgKfQoKZnVuYyBzZWxlY3RzKCkgewoJc2VsZWN0IHt9Cgl2YXIgKAoJCWNoIGNoYW4gaW50CgkJc2MgY2hhbiA8LSBib29sCgkpCglzZWxlY3QgewoJY2FzZSA8LWNoOgoJY2FzZSAoPC1jaCk6CgljYXNlIHQgOj0gPC1jaDoKCQlfID0gdAoJY2FzZSB0IDo9ICg8LWNoKToKCQlfID0gdAoJY2FzZSB0LCBvayA6PSA8LWNoOgoJCV8sIF8gPSB0LCBvawoJY2FzZSB0LCBvayA6PSAoPC1jaCk6CgkJXywgXyA9IHQsIG9rCgljYXNlIDwtc2MgLyogRVJST1IgImNhbm5vdCByZWNlaXZlIGZyb20gc2VuZC1vbmx5IGNoYW5uZWwiICovIDoKCX0KCXNlbGVjdCB7CglkZWZhdWx0OgoJZGVmYXVsdCAvKiBFUlJPUiAibXVsdGlwbGUgZGVmYXVsdHMiICovIDoKCX0KCXNlbGVjdCB7CgljYXNlIGEsIGIgOj0gPC1jaDoKCQlfLCBiID0gYSwgYgoJY2FzZSB4IC8qIEVSUk9SICJzZW5kIG9yIHJlY2VpdmUiICovIDoKCWNhc2UgYSAvKiBFUlJPUiAic2VuZCBvciByZWNlaXZlIiAqLyA6PSBjaDoKCX0KCgkvLyB0ZXN0IGZvciBpc3N1ZSA5NTcwOiBjaDIgaW4gc2Vjb25kIGNhc2UgZmFsc2VseSByZXNvbHZlZCB0bwoJLy8gY2gyIGRlY2xhcmVkIGluIGJvZHkgb2YgZmlyc3QgY2FzZQoJY2gxIDo9IG1ha2UoY2hhbiBpbnQpCgljaDIgOj0gbWFrZShjaGFuIGludCkKCXNlbGVjdCB7CgljYXNlIDwtY2gxOgoJCXZhciBjaDIgLyogRVJST1IgImRlY2xhcmVkIGFuZCBub3QgdXNlZDogY2gyIiAqLyBjaGFuIGJvb2wKCWNhc2UgaSA6PSA8LWNoMjoKCQlwcmludChpICsgMSkKCX0KfQoKZnVuYyBnb3MoKSB7CglnbyAxOyAvKiBFUlJPUiAibXVzdCBiZSBmdW5jdGlvbiBjYWxsIiAqLwoJZ28gaW50IC8qIEVSUk9SICJnbyByZXF1aXJlcyBmdW5jdGlvbiBjYWxsLCBub3QgY29udmVyc2lvbiIgKi8gKDApCglnbyAoIC8qIEVSUk9SICJleHByZXNzaW9uIGluIGdvIG11c3Qgbm90IGJlIHBhcmVudGhlc2l6ZWQiICovIGdvcygpKQoJZ28gZ29zKCkKCXZhciBjIGNoYW4gaW50CglnbyBjbG9zZShjKQoJZ28gbGVuIC8qIEVSUk9SICJnbyBkaXNjYXJkcyByZXN1bHQiICovIChjKQp9CgpmdW5jIGRlZmVycygpMDY5MTYKCVNJT0NTSUZQSFlBRERSICAgICAgICAgICAgICAgICAgICA9IDB4ODA0MDY5NDYKCVNJT0NTSUZQUklPUklUWSAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5OWIKCVNJT0NTSUZSRE9NQUlOICAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5OWYKCVNJT0NTSUZSVExBQkVMICAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5ODIKCVNJT0NTSUZUSU1FU0xPVCAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5ODUKCVNJT0NTSUZYRkxBR1MgICAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5OWQKCVNJT0NTTElGUEhZQUREUiAgICAgICAgICAgICAgICAgICA9IDB4ODIxODY5NGEKCVNJT0NTTElGUEhZUlRBQkxFICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5YTEKCVNJT0NTTElGUEhZVFRMICAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5YTgKCVNJT0NTTE9XQVQgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDczMDIKCVNJT0NTUEdSUCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwNDczMDgKCVNJT0NTU1BQUFBBUkFNUyAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5OTMKCVNJT0NTVkggICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YzAyMDY5ZjUKCVNJT0NTVk5FVElEICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAyMDY5YTYKCVNPQ0tfQ0xPRVhFQyAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwMAoJU09DS19ER1JBTSAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyCglTT0NLX05PTkJMT0NLICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDAKCVNPQ0tfUkFXICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MwoJU09DS19SRE0gICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglTT0NLX1NFUVBBQ0tFVCAgICAgICAgICAgICAgICAgICAgPSAweDUKCVNPQ0tfU1RSRUFNICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJU09MX1NPQ0tFVCAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmZmZmCglTT01BWENPTk4gICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglTT19BQ0NFUFRDT05OICAgICAgICAgICAgICAgICAgICAgPSAweDIKCVNPX0JJTkRBTlkgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAwMAoJU09fQlJPQURDQVNUICAgICAgICAgICAgICAgICAgICAgID0gMHgyMAoJU09fREVCVUcgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglTT19ET05UUk9VVEUgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglTT19FUlJPUiAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMDcKCVNPX0tFRVBBTElWRSAgICAgICAgICAgICAgICAgICAgICA9IDB4OAoJU09fTElOR0VSICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MAoJU09fTkVUUFJPQyAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDIwCglTT19PT0JJTkxJTkUgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMAoJU09fUEVFUkNSRUQgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDIyCglTT19SQ1ZCVUYgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMDIKCVNPX1JDVkxPV0FUICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAwNAoJU09fUkNWVElNRU8gICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDA2CglTT19SRVVTRUFERFIgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCVNPX1JFVVNFUE9SVCAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAwCglTT19SVEFCTEUgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMjEKCVNPX1NOREJVRiAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAwMQoJU09fU05ETE9XQVQgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDAzCglTT19TTkRUSU1FTyAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwMDUKCVNPX1NQTElDRSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAyMwoJU09fVElNRXJmYWNlczsgdXNlZCB0byBzZWUgaWYgd2UgY2FuIGRpZyBpbnNpZGUgb25lLgoJRW1wdHkwIGFueSAvLyBuaWwKCUVtcHR5MSBhbnkKCUVtcHR5MiBhbnkKCUVtcHR5MyBhbnkKCUVtcHR5NCBhbnkKCS8vIE5vbi1lbXB0eSBpbnRlcmZhY2VzLgoJTm9uRW1wdHlJbnRlcmZhY2UgICAgICAgICBJCglOb25FbXB0eUludGVyZmFjZVB0UyAgICAgICpJCglOb25FbXB0eUludGVyZmFjZU5pbCAgICAgIEkKCU5vbkVtcHR5SW50ZXJmYWNlVHlwZWROaWwgSQoJLy8gU3RyaW5nZXIuCglTdHIgZm10LlN0cmluZ2VyCglFcnIgZXJyb3IKCS8vIFBvaW50ZXJzCglQSSAgICAgICAqaW50CglQUyAgICAgICAqc3RyaW5nCglQU0kgICAgICAqW11pbnQKCU5JTCAgICAgICppbnQKCVVQSSAgICAgIHVuc2FmZS5Qb2ludGVyCglFbXB0eVVQSSB1bnNhZmUuUG9pbnRlcgoJLy8gRnVuY3Rpb24gKG5vdCBtZXRob2QpCglCaW5hcnlGdW5jICAgICAgICAgICAgIGZ1bmMoc3RyaW5nLCBzdHJpbmcpIHN0cmluZwoJVmFyaWFkaWNGdW5jICAgICAgICAgICBmdW5jKC4uLnN0cmluZykgc3RyaW5nCglWYXJpYWRpY0Z1bmNJbnQgICAgICAgIGZ1bmMoaW50LCAuLi5zdHJpbmcpIHN0cmluZwoJTmlsT0tGdW5jICAgICAgICAgICAgICBmdW5jKCppbnQpIGJvb2wKCUVyckZ1bmMgICAgICAgICAgICAgICAgZnVuYygpIChzdHJpbmcsIGVycm9yKQoJUGFuaWNGdW5jICAgICAgICAgICAgICBmdW5jKCkgc3RyaW5nCglUb29GZXdSZXR1cm5Db3VudEZ1bmMgIGZ1bmMoKQoJVG9vTWFueVJldHVybkNvdW50RnVuYyBmdW5jKCkgKHN0cmluZywgZXJyb3IsIGludCkKCUludmFsaWRSZXR1cm5UeXBlRnVuYyAgZnVuYygpIChzdHJpbmcsIGJvb2wpCgkvLyBUZW1wbGF0ZSB0byB0ZXN0IGV2YWx1YXRpb24gb2YgdGVtcGxhdGVzLgoJVG1wbCAqVGVtcGxhdGUKCS8vIFVuZXhwb3J0ZWQgZmllbGQ7IGNhbm5vdCBiZSBhY2Nlc3NlZCBieSB0ZW1wbGF0ZS4KCXVuZXhwb3J0ZWQgaW50Cn0KCnR5cGUgUyBbXXN0cmluZwoKZnVuYyAoUykgTWV0aG9kMCgpIHN0cmluZyB7CglyZXR1cm4gIk0wIgp9Cgp0eXBlIFUgc3RydWN0IHsKCVYgc3RyaW5nCn0KCnR5cGUgViBzdHJ1Y3QgewoJaiBpbnQKfQoKZnVuYyAodiAqVikgU3RyaW5nKCkgc3RyaW5nIHsKCWlmIHYgPT0gbmlsIHsKCQlyZXR1cm4gIm5pbFYiCgl9CglyZXR1cm4gZm10LlNwcmludGYoIjwlZD4iLCB2LmopCn0KCnR5cGUgVyBzdHJ1Y3QgewoJayBpbnQKfQoKZnVuYyAodyAqVykgRXJyb3IoKSBzdHJpbmcgewoJaWYgdyA9PSBuaWwgewoJCXJldHVybiAibmlsVyIKCX0KCXJldHVybiBmbXQuU3ByaW50ZigiWyVkXSIsIHcuaykKfQoKdmFyIHNpVmFsID0gSShTeyJhIiwgImIifSkKCnZhciB0VmFsID0gJlR7CglUcnVlOiAgIHRydWUsCglJOiAgICAgIDE3LAoJVTE2OiAgICAxNiwKCVg6ICAgICAgIngiLAoJUzogICAgICAieHl6IiwKCVU6ICAgICAgJlV7InYifSwKCVYwOiAgICAgVns2NjY2fSwKCVYxOiAgICAgJlZ7Nzc3N30sIC8vIGxlYXZlIFYyIGFzIG5pbAoJVzA6ICAgICBXezg4OH0sCglXMTogICAgICZXezk5OX0sIC8vIGxlYXZlIFcyIGFzIG5pbAoJU0k6ICAgICBbXWludHszLCA0LCA1fSwKCVNJQ2FwOiAgbWFrZShbXWludCwgNSwgMTApLAoJQUk6ICAgICBbM11pbnR7MywgNCwgNX0sCglQQUk6ICAgICZbM11pbnR7MywgNCwgNX0sCglTQjogICAgIFtdYm9vbHt0cnVlLCBmYWxzZX0sCglNU0k6ICAgIG1hcFtzdHJpbmddaW50eyJvbmUiOiAxLCAidHdvIjogMiwgInRocmVlIjogM30sCglNU0lvbmU6IG1hcFtzdHJpbmddaW50eyJvbmUiOiAxfSwKCU1YSTogICAgbWFwW2FueV1pbnR7Im9uZSI6IDF9LAoJTUlJOiAgICBtYXBbaW50XWludHsxOiAxfSwKCU1JMzJTOiAgbWFwW2ludDMyXXN0cmluZ3sxOiAib25lIiwgMjogInR3byJ9LAoJTUk2NFM6ICBtYXBbaW50NjRdc3RyaW5nezI6ICJpNjQyIiwgMzogImk2NDMifSwKCU1VSTMyUzo2NDY5MTg5NDUwMjU4NGUtMTEsIC8vIDB4QkRBOTE4QjE0N0U0OTVDQwoJLTcuMDMxMjQ5NDA4NzM1OTkyODAwNzhlLTAyLCAvLyAweEJGQjFGRkZGRTY5QUZCQzYKCS00LjE1OTYxMDY0NDcwNTg3NzgyNDM4ZSswMCwgLy8gMHhDMDEwQTM3MEY5MEM2QkJGCgktNi43Njc0NzY1MjI2NTE2NzI2MTAyMWUrMDEsIC8vIDB4QzA1MEVCMkY1QTdEMTc4MwoJLTMuMzEyMzEyOTk2NDkxNzI5Njc3NDdlKzAyLCAvLyAweEMwNzRCM0IzNjc0MkNDNjMKCS0zLjQ2NDMzMzg4MzY1NjA0OTEyNDUxZSswMiwgLy8gMHhDMDc1QTZFRjI4QTM4QkQ3Cn0KdmFyIHAwUzUgPSBbNV1mbG9hdDY0ewoJNi4wNzUzOTM4MjY5MjMwMDMzNTk3NWUrMDEsIC8vIDB4NDA0RTYwODEwQzk4QzVERQoJMS4wNTEyNTIzMDU5NTcwNDU3OTE3M2UrMDMsIC8vIDB4NDA5MDZEMDI1QzdFMjg2NAoJNS45Nzg5NzA5NDMzMzg1NTc4NDQ5OGUrMDMsIC8vIDB4NDBCNzVBRjg4RkJFMUQ2MAoJOS42MjU0NDUxNDM1Nzc3NDQ2MDIyM2UrMDMsIC8vIDB4NDBDMkNDQjhGQTc2RkEzOAoJMi40MDYwNTgxNTkyMjkzOTEwOTQ0MWUrMDMsIC8vIDB4NDBBMkNDMURDNzBCRTg2NAp9CgovLyBmb3IgeCBpbiBbNC41NDcsMi44NTcxXT0xL1swLjIxOTksMC4zNTAwMV0KdmFyIHAwUjMgPSBbNl1mbG9hdDY0ewoJLTIuNTQ3MDQ2MDE3NzE5NTE5MTU2MjBlLTA5LCAvLyAweEJFMjVFMTAzNkZFMUFBODYKCS03LjAzMTE5NjE2MzgxNDgxNjU0NjU0ZS0wMiwgLy8gMHhCRkIxRkZGNkY3QzBFMjRCCgktMi40MDkwMzIyMTU0OTUyOTYxMTQyM2UrMDAsIC8vIDB4QzAwMzQ1QjJBRUE0ODA3NAoJLTIuMTk2NTk3NzQ3MzQ4ODMwODY0NjdlKzAxLCAvLyAweEMwMzVGNzRBNENCOTRFMTQKCS01LjgwNzkxNzA0NzAxNzM3NTcyMjM2ZSswMSwgLy8gMHhDMDREMEEyMjQyMEExQTQ1CgktMy4xNDQ3OTQ3MDU5NDg4ODUwMzg1NGUrMDEsIC8vIDB4QzAzRjcyQUNBODkyRDgwRgp9CnZhciBwMFMzID0gWzVdZmxvYXQ2NHsKCTMuNTg1NjAzMzgwNTUyMDk3MjYzNDllKzAxLCAvLyAweDQwNDFFRDkyODQwNzdERDMKCTMuNjE1MTM5ODMwNTAzMDM4NjM4MjBlKzAyLCAvLyAweDQwNzY5ODM5NDY0QTdDMEUKCTEuMTkzNjA3ODM3OTIxMTE1MzMzMzBlKzAzLCAvLyAweDQwOTJBNjZFNkQxMDYxRDYKCTEuMTI3OTk2Nzk4NTY5MDc0MTQ0MzJlKzAzLCAvLyAweDQwOTE5RkZDQjhDMzlCN0UKCTEuNzM1ODA5MzA4MTMzMzU3NTQ2OTJlKzAyLCAvLyAweDQwNjVCMjk2RkMzNzkwODEKfQoKLy8gZm9yIHggaW4gWzIuODU3MCwyXT0xL1swLjM0OTksMC41XQp2YXIgcDBSMiA9IFs2XWZsb2F0NjR7CgktOC44NzUzNDMzMzAzMjUyNjQxMTI1NGUtMDgsIC8vIDB4QkU3N0QzMTZFOTI3MDI2RAoJLTcuMDMwMzA5OTU0ODM2MjQ3NDMyNDdlLTAyLCAvLyAweEJGQjFGRjYyNDk1RTFFNDIKCS0xLjQ1MDczODQ2NzgwOTUyOTg2MzU3ZSswMCwgLy8gMHhCRkY3MzYzOThBMjRBODQzCgktNy42MzU2OTYxMzgyMzUyNzc3MDc5MWUrMDAsIC8vIDB4QzAxRThBRjNFREFGQTdGMwoJLTEuMTE5MzE2Njg4NjAzNTY3NDc3ODZlKzAxLCAvLyAweEMwMjY2MkU2QzUyNDYzMDMKCS0zLjIzMzY0NTc5MzUxMzM1MzM1MDMzZSswMCwgLy8gMHhDMDA5REU4MUFGOEZFNzBGCn0KdmFyIHAwUzIgPSBbNV1mbG9hdDY0ewoJMi4yMjIwMjk5NzUzMjA4ODgwODQ0MWUrMDEsIC8vIDB4NDAzNjM4NjU5MDhCNTk1OQoJMS4zNjIwNjc5NDIxODIxNTIwODA0OGUrMDIsIC8vIDB4NDA2MTA2OUUwRUU4ODc4RgoJMi43MDQ3MDI3ODY1ODA4MzQ4Njc4OWUrMDIsIC8vIDB4NDA3MEU3ODY0MkVBMDc5QgoJMS41Mzg3NTM5NDIwODMyMDMyOTg4MWUrMDIsIC8vIDB4NDA2MzNDMDMzQUI2RkFGRgoJMS40NjU3NjE3Njk0ODI1NjE5MzgxMGUrMDEsIC8vIDB4NDAyRDUwQjM0NDM5MTgwOQp9CgpmdW5jIHB6ZXJvKHggZmxvYXQ2NCkgZmxvYXQ2NCB7Cgl2YXIgcCAqWzZdZmxvYXQ2NAoJdmFyIHEgKls1XWZsICAgMyBTcGVjaWFsIGNhc2VzCi8vICAgICAgICAgICAgICBqMChuYW4pPSBuYW4KLy8gICAgICAgICAgICAgIGowKDApID0gMQovLyAgICAgICAgICAgICAgajAoaW5mKSA9IDAKLy8KLy8gTWV0aG9kIC0tIHkwKHgpOgovLyAgICAgIDEuIEZvciB4PDIuCi8vICAgICAgICAgU2luY2UKLy8gICAgICAgICAgICAgIHkwKHgpID0gMi9waSooajAoeCkqKGxuKHgvMikrRXVsZXIpICsgeCoqMi80IC0gLi4uKQovLyAgICAgICAgIHRoZXJlZm9yZSB5MCh4KS0yL3BpKmowKHgpKmxuKHgpIGlzIGFuIGV2ZW4gZnVuY3Rpb24uCi8vICAgICAgICAgV2UgdXNlIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb24gdG8gYXBwcm94aW1hdGUgeTAsCi8vICAgICAgICAgICAgICB5MCh4KSA9IFUoeikvVih6KSArICgyL3BpKSooajAoeCkqbG4oeCkpLCB6PSB4KioyCi8vICAgICAgICAgd2hlcmUKLy8gICAgICAgICAgICAgIFUoeikgPSB1MDAgKyB1MDEqeiArIC4uLiArIHUwNip6Kio2Ci8vICAgICAgICAgICAgICBWKHopID0gMSAgKyB2MDEqeiArIC4uLiArIHYwNCp6Kio0Ci8vICAgICAgICAgd2l0aCBhYnNvbHV0ZSBhcHByb3hpbWF0aW9uIGVycm9yIGJvdW5kZWQgYnkgMioqLTcyLgovLyAgICAgICAgIE5vdGU6IEZvciB0aW55IHgsIFUvViA9IHUwIGFuZCBqMCh4KX4xLCBoZW5jZQovLyAgICAgICAgICAgICAgeTAodGlueSkgPSB1MCArICgyL3BpKSpsbih0aW55KSwgKGNob29zZSB0aW55PDIqKi0yNykKLy8gICAgICAyLiBGb3IgeD49Mi4KLy8gICAgICAgICAgICAgIHkwKHgpID0gc3FydCgyLyhwaSp4KSkqKHAwKHgpKmNvcyh4MCkrcTAoeCkqc2luKHgwKSkKLy8gICAgICAgICB3aGVyZSB4MCA9IHgtcGkvNC4gSXQgaXMgYmV0dGVyIHRvIGNvbXB1dGUgc2luKHgwKSxjb3MoeDApCi8vICAgICAgICAgYnkgdGhlIG1ldGhvZCBtZW50aW9uZWQgYWJvdmUuCi8vICAgICAgMy4gU3BlY2lhbCBjYXNlczogeTAoMCk9LWluZiwgeTAoeDwwKT1OYU4sIHkwKGluZik9MC4KLy8KCi8vIEowIHJldHVybnMgdGhlIG9yZGVyLXplcm8gQmVzc2VsIGZ1bmN0aW9uIG9mIHRoZSBmaXJzdCBraW5kLgovLwovLyBTcGVjaWFsIGNhc2VzIGFyZToKLy8KLy8JSjAowrFJbmYpID0gMAovLwlKMCgwKSA9IDEKLy8JSjAoTmFOKSA9IE5hTgpmdW5jIEowKHggZmxvYXQ2NCkgZmxvYXQ2NCB7Cgljb25zdCAoCgkJSHVnZSAgID0gMWUzMDAKCQlUd29NMjcgPSAxLjAgLyAoMSA8PCAyNykgLy8gMioqLTI3IDB4M2U0MDAwMDAwMDAwMDAwMAoJCVR3b00xMyA9IDEuMCAvICgxIDw8IDEzKSAvLyAyKiotMTMgMHgzZjIwMDAwMDAwMDAwMDAwCgkJVHdvMTI5ID0gMSA8PCAxMjkgICAgICAgIC8vIDIqKjEyOSAweDQ4MDAwMDAwMDAwMDAwMDAKCQkvLyBSMC9TMCBvbiBbMCwgMl0KCQlSMDIgPSAxLjU2MjQ5OTk5OTk5OTk5OTQ3OTU4ZS0wMiAgLy8gMHgzRjhGRkZGRkZGRkZGRkZECgkJUjAzID0gLTEuODk5NzkyOTQyMzg4NTQ3MjE3NTFlLTA0IC8vIDB4QkYyOEU2QTVCNjFBQzZFOQoJCVIwNCA9IDEuODI5NTQwNDk1MzI3MDA2NjU2NzBlLTA2ICAvLyAweDNFQkVCMUQxMEM1MDM5MTkKCQlSMDUgPSAtNC42MTgzMjY4ODUzMjEwMzE4OTE5OWUtMDkgLy8gMHhCRTMzRDVFNzczRDYzRkNFCgkJUzAxID0gMS41NjE5MTAyOTQ2NDg5MDAxMDQ5MmUtMDIgIC8vIDB4M0Y4RkZDRTg4MkM4QzJBNAoJCVMwMiA9IDEuMTY5MjY3ODQ2NjMzMzc0NTAyNjBlLTA0ICAvLyAweDNGMUVBNkQyREQ1N0RCRjQKCQlTMDMgPSA1LjEzNTQ2NTUwMjA3MzE4MTExNDQ2ZS0wNyAgLy8gMHgzRUExM0I1NENFODRENUE5CgkJUzA0ID0gMS4xNjYxNDAwMzMzMzc5MDAwMDIwNWUtMDkgIC8vIDB4M0UxNDA4QkNGNDc0NUQ4RgoJKQoJLy8gc3BlY2lhbCBjYXNlcwoJc3dpdGNoIHsKCWNhc2UgSXNOYU4oeCk6CgkJcmV0dXJuIHgKCWNhc2UgSXNJbmYoeCwgMCk6CgkJcmV0dXJuIDAKCWNhc2UgeCA9PSAwOgoJCXJldHVybiAxCgl9CgoJeCA9IHJpdGUoYXJnc1swXSkKCQkJZGlnZXN0IDo9IG1ha2UoW11ieXRlLCAwLCBoLlNpemUoKSkKCQkJZGlnZXN0ID0gaC5TdW0oZGlnZXN0KQoKCQkJcmV0dXJuIFtdW11ieXRle2RpZ2VzdH0sIG5pbAoJCX0sCgl9Cn0KCi8vIGNtZEhhc2hNY3QgcmV0dXJucyBhIGNvbW1hbmQgaGFuZGxlciBmb3IgdGhlIHNwZWNpZmllZCBoYXNoCi8vIGFsZ29yaXRobSBmb3IgbW9udGUgY2FybG8gdGVzdCAoTUNUKSB0ZXN0IGNhc2VzLgovLwovLyBUaGlzIHNoYXBlIG9mIGNvbW1hbmQgZXhwZWN0cyBhIHNlZWQgYXMgdGhlIHNvbGUgYXJndW1lbnQsCi8vIGFuZCB3cml0ZXMgdGhlIHJlc3VsdGluZyBkaWdlc3QgYXMgYSByZXNwb25zZS4gSXQgaW1wbGVtZW50cwovLyB0aGUgInN0YW5kYXJkIiBmbGF2b3VyIG9mIHRoZSBNQ1QsIG5vdCB0aGUgImFsdGVybmF0aXZlIi4KLy8KLy8gVGhpcyBhbGdvcml0aG0gd2FzIHBvcnRlZCBmcm9tIGBIYXNoTUNUYCBpbiBCU1NMJ3MgYG1vZHVsZXdyYXBwZXIuY2NgCi8vIE5vdGUgdGhhdCBpdCBkaWZmZXJzIHNsaWdodGx5IGZyb20gdGhlIHVwc3RyZWFtIE5JU1QgTUNUWzBdIGFsZ29yaXRobQovLyBpbiB0aGF0IGl0IGRvZXMgbm90IHBlcmZvcm0gdGhlIG91dGVyIDEwMCBpdGVyYXRpb25zIGl0c2VsZi4gU2VlCi8vIGZvb3Rub3RlICMxIGluIHRoZSBBQ1ZQLm1kIGRvY3NbMV0sIHRoZSBhY3ZwdG9vbCBoYW5kbGVzIHRoaXMuCi8vCi8vIFswXTogaHR0cHM6Ly9wYWdlcy5uaXN0Lmdvdi9BQ1ZQL2RyYWZ0LWNlbGktYWN2cC1zaGEuaHRtbCNzZWN0aW9uLTYuMgovLyBbMV06IGh0dHBzOi8vYm9yaW5nc3NsLmdvb2dsZXNvdXJjZS5jb20vYm9yaW5nc3NsLysvcmVmcy9oZWFkcy9tYXN0ZXIvdXRpbC9maXBzdG9vbHMvYWN2cC9BQ1ZQLm1kI3Rlc3Rpbmctb3RoZXItZmlwcy1tb2R1bGVzCmZ1bmMgY21kSGFzaE1jdChoIGhhc2guSGFzaCkgY29tbWFuZCB7CglyZXR1cm4gY29tbWFuZHsKCQlyZXF1aXJlZEFyZ3M6IDEsIC8vIFNlZWQgbWVzc2FnZS4KCQloYW5kbGVyOiBmdW5jKGFyZ3MgW11bXWJ5dGUpIChbXVtdYnl0ZSwgZXJyb3IpIHsKCQkJaFNpemUgOj0gaC5TaXplKCkKCQkJc2VlZCA6PSBhcmdzWzBdCgoJCQlpZiBzZWVkTGVuIDo9IGxlbihzZWVkKTsgc2VlZExlbiAhPSBoU2l6ZSB7CgkJCQlyZXR1cm4gbmlsLCBmbXQuRXJyb3JmKCJpbnZhbGlkIHNlZWQgc2l6ZTogZXhwZWN0ZWQgJWQgZ290ICVkIiwgaFNpemUsIHNlZWRMZW4pCgkJCX0KCgkJCWRpZ2VzdCA6PSBtYWtlKFtdYnl0ZSwgMCwgaFNpemUpCgkJCWJ1ZiA6PSBtYWtlKFtdYnl0ZSwgMCwgMypoU2l6ZSkKCQkJYnVmID0gYXBwZW5kKGJ1Ziwgc2VlZC4uLikKCQkJYnVmID0gYXBwZW5kKGJ1Ziwgc2VlZC4uLikKCQkJYnVmID0gYXBwZW5kKGJ1Ziwgc2VlZC4uLikKCgkJCWZvciBpIDo9IDA7IGkgPCAxMDAwOyBpKysgewoJCQkJaC5SZXNldCgpCgkJCQloLldyaXRlKGJ1ZikKCQkJCWRpZ2VzdCA9IGguU3VtKGRpZ2VzdFs6MF0pCgoJCQkJY29weShidWYsIGJ1ZltoU2l6ZTpdKQoJCQkJY29weShidWZbMipoU2l6ZTpdLCBkaWdlc3QpCgkJCX0KCgkJCXJldHVybiBbXVtdYnl0ZXtidWZbaFNpemUqMjpdfSwgbmlsCgkJfSwKCX0KfQoKLy8gY21kRW50cm9weUhhc2hFbnRyb3B5U2hhMzg0QWZ0IHJldHVybnMgYSBjb21tYW5kIGhhbmRsZXIgdGhhdCB0ZXN0cyB0aGUKLy8gZW50cm9weSBwYWNrYWdlJ3MgU0hBMi0zODQgZGlnZXN0IGZvciBBRlQgaW5wdXRzLgpmdW5jIGNtZEVudHJvcHlIYXNoRW50cm9weVNoYTM4NEFmdCgpIGNvbW1hbmQgewoJcmV0dXJuIGNvbW1hbmR7CgkJcmVxdWlyZWRBcmdzOiAxLCAvLyBNZXNzYWdlIHRvIGhhc2guCgkJaGFuZGxlcjogZnVuYyhhcmdzIFtdW11ieXRlKSAoW11bXWJ5dGUsIGVycm9yKSB7CgkJCWRpZ2VzdCA6PSBlbnRyb3B5LlRlc3RpbmdPbmx5U0hBMzg0KGFyZ3NbMF0pCgkJCXJldHVybiBbXVtdYnl0ZXtkaWdlc3RbOl19LCA9IDB4MzIKCUI1NzYwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZTEwMAoJQjYwMCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyNTgKCUI3MjAwICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MWMyMAoJQjc1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0YgoJQjc2ODAwICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMmMwMAoJQjk2MDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyNTgwCglCSU9DRkxVU0ggICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMDA0MjY4CglCSU9DR0JMRU4gICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0MjY2CglCSU9DR0RJUkZJTFQgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0MjdjCglCSU9DR0RMVCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0MjZhCglCSU9DR0RMVExJU1QgICAgICAgICAgICAgICAgICAgICAgPSAweGMwMTA0MjdiCglCSU9DR0VUSUYgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMjA0MjZiCglCSU9DR0ZJTERST1AgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0Mjc4CglCSU9DR0hEUkNNUExUICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0Mjc0CglCSU9DR1JTSUcgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0MjczCglCSU9DR1JUSU1FT1VUICAgICAgICAgICAgICAgICAgICAgPSAweDQwMTA0MjZlCglCSU9DR1NUQVRTICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDg0MjZmCglCSU9DSU1NRURJQVRFICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0MjcwCglCSU9DTE9DSyAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMDA0Mjc2CglCSU9DUFJPTUlTQyAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMDA0MjY5CglCSU9DU0JMRU4gICAgICAgICAgICAgICAgICAgICAgICAgPSAweGMwMDQ0MjY2CglCSU9DU0RJUkZJTFQgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0MjdkCglCSU9DU0RMVCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0MjdhCglCSU9DU0VURiAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMTA0MjY3CglCSU9DU0VUSUYgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMjA0MjZjCglCSU9DU0VUV0YgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMTA0Mjc3CglCSU9DU0ZJTERST1AgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0Mjc5CglCSU9DU0hEUkNNUExUICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0Mjc1CglCSU9DU1JTSUcgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ0MjcyCglCSU9DU1JUSU1FT1VUICAgICAgICAgICAgICAgICAgICAgPSAweDgwMTA0MjZkCglCSU9DVkVSU0lPTiAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ0MjcxCglCUEZfQSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglCUEZfQUJTICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwCglCUEZfQUREICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDAKCUJQRl9BTElHTk1FTlQgICAgICAgICAgICAgICAgICAgICA9IDB4NAoJQlBGX0FMVSAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglCUEZfQU5EICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDUwCglCUEZfQiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEwCglCUEZfRElSRUNUSU9OX0lOICAgICAgICAgICAgICAgICAgPSAweDEKCUJQRl9ESVJFQ1RJT05fT1VUICAgICAgICAgICAgICAgICA9IDB4MgoJQlBGX0RJViAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzMAoJQlBGX0ZJTERST1BfQ0FQVFVSRSAgICAgICAgICAgICAgID0gMHgxCglCUEZfRklMRFJPUF9EUk9QICBhbiBlbWJlZGRlZCBmaWVsZC4KCURXX0FUX2dvX2VtYmVkZGVkX2ZpZWxkID0gMHgyOTAzCglEV19BVF9nb19ydW50aW1lX3R5cGUgICA9IDB4MjkwNAoKCURXX0FUX2dvX3BhY2thZ2VfbmFtZSAgID0gMHgyOTA1IC8vIEF0dHJpYnV0ZSBmb3IgRFdfVEFHX2NvbXBpbGVfdW5pdAoJRFdfQVRfZ29fZGljdF9pbmRleCAgICAgPSAweDI5MDYgLy8gQXR0cmlidXRlIGZvciBEV19UQUdfdHlwZWRlZl90eXBlLCBpbmRleCBvZiB0aGUgZGljdGlvbmFyeSBlbnRyeSBkZXNjcmliaW5nIHRoZSByZWFsIHR5cGUgb2YgdGhpcyB0eXBlIHNoYXBlCglEV19BVF9nb19jbG9zdXJlX29mZnNldCA9IDB4MjkwNyAvLyBBdHRyaWJ1dGUgZm9yIERXX1RBR192YXJpYWJsZSwgb2Zmc2V0IGluIHRoZSBjbG9zdXJlIHN0cnVjdCB3aGVyZSB0aGlzIGNhcHR1cmVkIHZhcmlhYmxlIHJlc2lkZXMKCglEV19BVF9pbnRlcm5hbF9sb2NhdGlvbiA9IDI1MyAvLyBwYXJhbXMgYW5kIGxvY2Fsczsgbm90IGVtaXR0ZWQKKQoKLy8gSW5kZXggaW50byB0aGUgYWJicmV2cyB0YWJsZSBiZWxvdy4KY29uc3QgKAoJRFdfQUJSVl9OVUxMID0gaW90YQoJRFdfQUJSVl9DT01QVU5JVAoJRFdfQUJSVl9DT01QVU5JVF9URVhUTEVTUwoJRFdfQUJSVl9GVU5DVElPTgoJRFdfQUJSVl9XUkFQUEVSCglEV19BQlJWX0ZVTkNUSU9OX0FCU1RSQUNUCglEV19BQlJWX0ZVTkNUSU9OX0NPTkNSRVRFCglEV19BQlJWX1dSQVBQRVJfQ09OQ1JFVEUKCURXX0FCUlZfSU5MSU5FRF9TVUJST1VUSU5FCglEV19BQlJWX0lOTElORURfU1VCUk9VVElORV9SQU5HRVMKCURXX0FCUlZfVkFSSUFCTEUKCURXX0FCUlZfSU5UX0NPTlNUQU5UCglEV19BQlJWX0xFWElDQUxfQkxPQ0tfUkFOR0VTCglEV19BQlJWX0xFWElDQUxfQkxPQ0tfU0lNUExFCglEV19BQlJWX1NUUlVDVEZJRUxECglEV19BQlJWX0ZVTkNUWVBFUEFSQU0KCURXX0FCUlZfRlVOQ1RZUEVPVVRQQVJBTQoJRFdfQUJSVl9ET1RET1RET1QKCURXX0FCUlZfQVJSQVlSQU5HRQoJRFdfQUJSVl9OVUxMVFlQRQoJRFdfQUJSVl9CQVNFVFlQRQoJRFdfQUJSVl9BUlJBWVRZUEUKCURXX0FCUlZfQ0hBTlRZUEUKCURXX0FCUlZfRlVOQ1RZUEUKCURXX0FCUlZfSUZBQ0VUWVBFCglEV19BQlJWX01BUFRZUEUKCURXX0FCUlZfUFRSVFlQRQoJRFdfQUJSVl9CQVJFX1BUUlRZUEUgLy8gb25seSBmb3Igdm9pZCosIG5vIERXX0FUX3R5cGUgYXR0ciB0byBwbGVhc2UgZ2RiIDYuCglEV19BQlJWX1NMSUNFVFlQRQoJRFdfQUJSVl9TVFJJTkdUWVBFCglEV19BQlJWX1NUUlVDVFRZUEUKCURXX0FCUlZfVFlQRURFQ0wKCURXX0FCUlZfRElDVF9JTkRFWAoJRFdfQUJSVl9QVVRWQVJfU1RBUlQKKQoKdHlwZSBkd0FiYnJldiBzdHJ1Y3QgewoJdGFnICAgICAgdWludDgKCWNoaWxkcmVuIHVpbnQ4CglhdHRyICAgICBbXWR3QXR0ckZvcm0KfQoKdmFyIGFiYnJldnNGaW5hbGl6ZWQgYm9vbAoKLy8gZXhwYW5kUHNldWRvRm9ybSB0YWtlcyBhbiBpbnB1dCBEV19GT1JNX3h4eCB2YWx1ZSBhbmQgdHJhbnNsYXRlcyBpdAovLyBpbnRvIGEgdmVyc2lvbi0gYW5kIHBsYXRmb3JtLWFwcHJvcHJpYXRlIGNvbmNyZXRlIGZvcm0uIEV4aXN0aW5nCi8vIGNvbmNyZXRlL3JlYWwgRFdfRk9STSB2YWx1ZXMgYXJlIGxlZnQgdW50b3VjaGVkLiBGb3IgdGhlIG1vbWVudCB0aGUKLy8gb25seSBwbGF0Zm9ybS1zcGVjaWZpYyBwc2V1ZG8tZm9ybSBpcyBEV19GT1JNX3VkYXRhX3BzZXVkbywgd2hpY2gKLy8gZ2V0cyBleHBhbmRlZCB0byBEV19GT1JNX2RhdGE0IG9uIERhcndpbiBhbmQgRFdfRk9STV91ZGF0YQovLyBldmVyeXdoZXJlIGVsc2UuIFNlZSBpc3N1ZSAjMzE0NTkgZm9yIG1vcmUgY29udGV4dC4gVGhlbiB3ZSBoYXZlIGEKLy8gcGFpciBvZiBwc2V1ZG8tZm9ybXMgZm9yIGxvIGFuZCBoaSBQQyBhdHRyaWJ1dGVzLCB3aGljaCBhcmUKLy8gZXhwYW5kZWQgZGlmZmVyZW50bHkgZGVwZXN0YXRlX2xlbiB1aW50MzIKCW1jX3NwYXJlMiAgICAgICAgWzRddWludDMyCn0KCnR5cGUgdWNvbnRleHQgc3RydWN0IHsKCXVjX3NpZ21hc2sgIHNpZ3NldAoJdWNfbWNvbnRleHQgbWNvbnRleHQKCXVjX2xpbmsgICAgICp1Y29udGV4dAoJdWNfc3RhY2sgICAgc3RhY2t0Cgl1Y19mbGFncyAgICBpbnQzMgoJX19zcGFyZV9fICAgWzRdaW50MzIKCXBhZF9jZ29fMCAgIFsxMl1ieXRlCn0KCnR5cGUgdGltZXNwZWMgc3RydWN0IHsKCXR2X3NlYyAgaW50MzIKCXR2X25zZWMgaW50MzIKfQoKLy9nbzpub3NwbGl0CmZ1bmMgKHRzICp0aW1lc3BlYykgc2V0TnNlYyhucyBpbnQ2NCkgewoJdHMudHZfc2VjID0gaW50MzIobnMgLyAxZTkpCgl0cy50dl9uc2VjID0gaW50MzIobnMgJSAxZTkpCn0KCnR5cGUgdGltZXZhbCBzdHJ1Y3QgewoJdHZfc2VjICBpbnQzMgoJdHZfdXNlYyBpbnQzMgp9CgpmdW5jICh0diAqdGltZXZhbCkgc2V0X3VzZWMoeCBpbnQzMikgewoJdHYudHZfdXNlYyA9IHgKfQoKdHlwZSBpdGltZXJ2YWwgc3RydWN0IHsKCWl0X2ludGVydmFsIHRpbWV2YWwKCWl0X3ZhbHVlICAgIHRpbWV2YWwKfQoKdHlwZSB1bXR4X3RpbWUgc3RydWN0IHsKCV90aW1lb3V0IHRpbWVzcGVjCglfZmxhZ3MgICB1aW50MzIKCV9jbG9ja2lkIHVpbnQzMgp9Cgp0eXBlIGtldmVudHQgc3RydWN0IHsKCWlkZW50ICB1aW50MzIKCWZpbHRlciBpbnQxNgoJZmxhZ3MgIHVpbnQxNgoJZmZsYWdzIHVpbnQzMgoJZGF0YSAgIGludDY0Cgl1ZGF0YSAgKmJ5dGUKCWV4dCAgICBbNF11aW50NjQKfQoKdHlwZSBiaW50aW1lIHN0cnVjdCB7CglzZWMgIGludDMyCglmcmFjIHVpbnQ2NAp9Cgp0eXBlIHZkc29UaW1laGFuZHMgc3RydWN0IHsKCWFsZ28gICAgICAgICB1aW50MzIKCWdlbiAgICAgICAgICB1aW50MzIKCXNjYWxlICAgICAgICB1aW50NjQKCW9mZnNldF9jb3VudCB1aW50MzIKCWNvdW50ZXJfbWFzayB1aW50MzIKCW9mZnNldCAgICAgICBiaW50aW1lCglib290dGltZSAgICAgYmludGltZQoJeDg2X3NoaWZ0ICAgIHVpbnQzMgoJeDg2X2hwZXRfaWR4IHVpbnQzMgoJcmVzICAgICAgICAgIFs2XXVpbnQzMgp9Cgp0eXBlIHZkc29UaW1la2VlcCBzdHJ1Y3QgewoJdmVyICAgICB1aW50MzIKCWVuYWJsZWQgdWludDMyCgljdXJyZW50IHVpbnQzMgp9Cgpjb25zdCAoCglfVkRTT19US19WRVJfQ1VSUiA9IDB4MQoKCXZkc29UaW1laGFuZHNTaXplID0gMHg1MAoJdmRzb1RpbWVrZWVwU2l6ZSAgPSAweGMKKQovLyBDb3B5cmlnaHQgMjAxMSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSBjc3YKCmltcG9ydCAoCgkiYnl0ZXMiCgkiZXJyb3JzIgoJInN0cmluZ3MiCgkidGVzdGluZyIKKQoKdmFyIHdyaXRlVGVzdHMgPSBbXXN0cnVjdCB7CglJbnB1dCAgIFtdW11zdHJpbmcKCU91dHB1dCAgc3RyaW5nCglFcnJvciAgIGVycm9yCglVc2VDUkxGIGJvb2wKCUNvbW1hICAgcnVuZQp9ewoJe0lucHV0OiBbXVtdc3RyaW5ne3siYWJjIn19LCBPdXRwdXQ6ICJhYmNcbiJ9LAoJe0lucHV0OiBbXVtdc3RyaW5ne3siYWJjIn19LCBPdXRwdXQ6ICJhYmNcclxuIiwgVXNlQ1JMRjogdHJ1ZX0sCgl7SW5wdXQ6IFtdW11zdHJpbmd7e2AiYWJjImB9fSwgT3V0cHV0OiBgIiIiYWJjIiIiYCArICJcbiJ9LAoJe0lucHV0OiBbXVtdc3RyaW5ne3tgYSJiYH19LCBPdXRwdXQ6IGAiYSIiYiJgICsgIlxuIn0sCgl7SW5wdXQ6IFtdW11zdHJpbmd7e2AiYSJiImB9fSwgT3V0cHV0OiBgIiIiYSIiYiIiImAgKyAiXG4ifSwKCXtJbnB1dDogW11bXXN0cmluZ3t7IiBhYmMifX0sIE91dHB1dDogYCIgYWJjImAgKyAiXG4ifSwKCXtJbnB1dDogW11bXXN0cmluZ3t7ImFiYyxkZWYifX0sIG5hbC9zdHIiCgkiY21kL2ludGVybmFsL3F1b3RlZCIKCSJjcnlwdG8vc2hhMSIKKQoKLy8gVGVzdHMgY2FuIG92ZXJyaWRlIHRoaXMgYnkgc2V0dGluZyAkVEVTVEdPX1RPT0xDSEFJTl9WRVJTSU9OLgp2YXIgVG9vbGNoYWluVmVyc2lvbiA9IHJ1bnRpbWUuVmVyc2lvbigpCgovLyBUaGUgR28gdG9vbGNoYWluLgoKdHlwZSBnY1Rvb2xjaGFpbiBzdHJ1Y3R7fQoKZnVuYyAoZ2NUb29sY2hhaW4pIGNvbXBpbGVyKCkgc3RyaW5nIHsKCXJldHVybiBiYXNlLlRvb2woImNvbXBpbGUiKQp9CgpmdW5jIChnY1Rvb2xjaGFpbikgbGlua2VyKCkgc3RyaW5nIHsKCXJldHVybiBiYXNlLlRvb2woImxpbmsiKQp9CgpmdW5jIHBrZ1BhdGgoYSAqQWN0aW9uKSBzdHJpbmcgewoJcCA6PSBhLlBhY2thZ2UKCXBwYXRoIDo9IHAuSW1wb3J0UGF0aAoJaWYgY2ZnLkJ1aWxkQnVpbGRtb2RlID09ICJwbHVnaW4iIHsKCQlwcGF0aCA9IHBsdWdpblBhdGgoYSkKCX0gZWxzZSBpZiBwLk5hbWUgPT0gIm1haW4iICYmICFwLkludGVybmFsLkZvcmNlTGlicmFyeSB7CgkJcHBhdGggPSAibWFpbiIKCX0KCXJldHVybiBwcGF0aAp9CgpmdW5jIChnY1Rvb2xjaGFpbikgZ2MoYiAqQnVpbGRlciwgYSAqQWN0aW9uLCBhcmNoaXZlIHN0cmluZywgaW1wb3J0Y2ZnLCBlbWJlZGNmZyBbXWJ5dGUsIHN5bWFiaXMgc3RyaW5nLCBhc21oZHIgYm9vbCwgcGdvUHJvZmlsZSBzdHJpbmcsIGdvZmlsZXMgW11zdHJpbmcpIChvZmlsZSBzdHJpbmcsIG91dHB1dCBbXWJ5dGUsIGVyciBlcnJvcikgewoJcCA6PSBhLlBhY2thZ2UKCXNoIDo9IGIuU2hlbGwoYSkKCW9iamRpciA6PSBhLk9iamRpcgoJaWYgYXJjaGl2ZSAhPSAiIiB7CgkJb2ZpbGUgPSBhcmNoaXZlCgl9IGVsc2UgewoJCW91dCA6PSAiX2dvXy5vIgoJCW9maWxlID0gb2JqZGlyICsgb3V0Cgl9CgoJcGtncGF0aCA6PSBwa2dQYXRoKGEpCglkZWZhdWx0R2NGbGFncyA6PSBbXXN0cmluZ3siLXAiLCBwa2dwYXRofQoJdmVycyA6PSBnb3Zlci5Mb2NhbCgpCglpZiBwLk1vZHVsZSAhPSBuaWwgewoJCXYgOj0gcC5Nb2R1bGUuR29WZXJzaW9uCgkJaWYgdiA9PSAiIiB7CgkJCXYgPSBnb3Zlci5EZWZhdWx0R29Nb2RWZXJzaW9uCgkJfQoJCS8vIFRPRE8oc2FtdGhhbmF3YWxsYSk6IEludmVzdGlnYXRlIHdoZW4gYWxsb3dlZFZlcnNpb24gaXMgbm90IHRydWUuCgkJaWYgYWxsb3dlZFZlcnNpb24odikgewoJCQl2ZXJzID0gdgoJCX0KCX0KCWRlZmF1bHRHY0ZsYWdzID0gYXBwZW5kKGRlZmF1bHRHY0ZsYWdzLCAiLWxhbmc9Z28iK2dvdmVyLkxhbmcodmVycykpCglpZiBwLlN0YW5kYXJkIHsKCQlkZWZhdWx0R2NGbGFncyA9IGFwcGVuZChkZWZhdWx0R2NGbGFncywgIi1zdGQiKQoJfQoKCS8vIElmIHdlJ3JlIGdpdmluZyB0aGUgY29tcGlsZXIgdGhlIGVudGlyZSBwYWNrYWdlIChubyBDIGV0YyBmaWxlcyksIHRlbGwgaXQgdGhhdCwKCS8vIHNvIHRoYXQgaXQgY2FuIGdpdmUgZ29vZCBlcnJvciBtZXNzYWdlcyBhYm91dCBmb3J3YXJkIGRlY2xhcmF0aW9ucy4KCS8vIEV4Y2VwdGlvbnM6IGEgZmV3IHN0YW5kYXJkIHBhY2thZ2VzIGhhdmUgZm9yd2FyZCBkZWNsYXJhdGlvbnMgZm9yCgkvLyBwaWVjZXMgc3VwcGxpZWQgYmVoaW5kLXRoZS1zY2VuZXMgYnkgcGFja2FnZSBydW50aW1lLgoJZXh0RmlsZXMgOj0gbGVuKHAuQ2dvRmlsZXMpICsgbGVuKHAuQ0ZpbGVzKSArIGxlbihwLkNYWEZpbGVzKSArIGxlbihwLk1GaWxlcykgKyBsZW4ocC5GRmlsZXMpICsgbGVuKHAuU0ZpbGVzKSArIGxlbihwLlN5c29GaWxlcykgKyBsZW4ocC5Td2lnRmlsZXMpICsgbGVuKHAuU3dpZ0NYWEZpbGVzKQoJaWYgcC5TdGFuZGFyZCB7CgkJc3dpdGNoIHAuSW1wb3J0UGF0aCB7CgkJY2FzZSAiYnl0ZXMiLCAiaW50ZXJuYWwvcG9sbCIsICJuZXQiLCAib3MiOgoJCQlmYWxsdGhyb3VnaAoJCWNhc2UgInJ1bnRpbWUvbWV0cmljcyIsICJydW50aW1lL3Bwcm9mIiwgInJlLkV2ZW50U3RhdGVUcmFuc2l0aW9uOgoJCQlzd2l0Y2ggZXYuU3RhdGVUcmFuc2l0aW9uKCkuUmVzb3VyY2UuS2luZCB7CgkJCWNhc2UgdHJhY2UuUmVzb3VyY2VQcm9jOgoJCQkJZy5Qcm9jVHJhbnNpdGlvbihjdHgsIGV2KQoJCQljYXNlIHRyYWNlLlJlc291cmNlR29yb3V0aW5lOgoJCQkJZy5Hb3JvdXRpbmVUcmFuc2l0aW9uKGN0eCwgZXYpCgkJCX0KCQljYXNlIHRyYWNlLkV2ZW50TG9nOgoJCQlnLkxvZyhjdHgsIGV2KQoJCX0KCX0KCWZvciBpLCB0YXNrIDo9IHJhbmdlIG9wdHMudGFza3MgewoJCWVtaXRUYXNrKGN0eCwgdGFzaywgaSkKCQlpZiBvcHRzLm1vZGUmdHJhY2V2aWV3ZXIuTW9kZUdvcm91dGluZU9yaWVudGVkICE9IDAgewoJCQlmb3IgXywgcmVnaW9uIDo9IHJhbmdlIHRhc2suUmVnaW9ucyB7CgkJCQllbWl0UmVnaW9uKGN0eCwgcmVnaW9uKQoJCQl9CgkJfQoJfQoJZy5GaW5pc2goY3R4KQp9CgovLyBlbWl0VGFzayBlbWl0cyBpbmZvcm1hdGlvbiBhYm91dCBhIHRhc2sgaW50byB0aGUgdHJhY2Ugdmlld2VyJ3MgZXZlbnQgc3RyZWFtLgovLwovLyBzb3J0SW5kZXggc2V0cyB0aGUgb3JkZXIgaW4gd2hpY2ggdGhpcyB0YXNrIHdpbGwgYXBwZWFyIHJlbGF0ZWQgdG8gb3RoZXIgdGFza3MsCi8vIGxvd2VzdCBmaXJzdC4KZnVuYyBlbWl0VGFzayhjdHggKnRyYWNlQ29udGV4dCwgdGFzayAqdHJhY2UuVXNlclRhc2tTdW1tYXJ5LCBzb3J0SW5kZXggaW50KSB7CgkvLyBDb2xsZWN0IGluZm9ybWF0aW9uIGFib3V0IHRoZSB0YXNrLgoJdmFyIHN0YXJ0U3RhY2ssIGVuZFN0YWNrIHRyYWNlLlN0YWNrCgl2YXIgc3RhcnRHLCBlbmRHIHRyYWNlLkdvSUQKCXN0YXJ0VGltZSwgZW5kVGltZSA6PSBjdHguc3RhcnRUaW1lLCBjdHguZW5kVGltZQoJaWYgdGFzay5TdGFydCAhPSBuaWwgewoJCXN0YXJ0U3RhY2sgPSB0YXNrLlN0YXJ0LlN0YWNrKCkKCQlzdGFydEcgPSB0YXNrLlN0YXJ0Lkdvcm91dGluZSgpCgkJc3RhcnRUaW1lID0gdGFzay5TdGFydC5UaW1lKCkKCX0KCWlmIHRhc2suRW5kICE9IG5pbCB7CgkJZW5kU3RhY2sgPSB0YXNrLkVuZC5TdGFjaygpCgkJZW5kRyA9IHRhc2suRW5kLkdvcm91dGluZSgpCgkJZW5kVGltZSA9IHRhc2suRW5kLlRpbWUoKQoJfQoJYXJnIDo9IHN0cnVjdCB7CgkJSUQgICAgIHVpbnQ2NCBganNvbjoiaWQiYAoJCVN0YXJ0RyB1aW50NjQgYGpzb246InN0YXJ0X2csb21pdGVtcHR5ImAKCQlFbmRHICAgdWludDY0IGBqc29uOiJlbmRfZyxvbWl0ZW1wdHkiYAoJfXsKCQlJRDogICAgIHVpbnQ2NCh0YXNrLklEKSwKCQlTdGFydEc6IHVpbnQ2NChzdGFydEcpLAoJCUVuZEc6ICAgdWludDY0KGVuZEcpLAoJfQoKCS8vIEVtaXQgdGhlIHRhc2sgc2xpY2UgYW5kIG5vdGlmeSB0aGUgZW1pdHRlciBvZiB0aGUgdGFzay4KCWN0eC5UYXNrKHVpbnQ2NCh0YXNrLklEKSwgZm10LlNwcmludGYoIlQlZCAlcyIsIHRhc2suSUQsIHRhc2suTmFtZSksIHNvcnRJbmRleCkKCWN0eC5UYXNrU2xpY2UodHJhY2V2aWV3ZXIuU2xpY2VFdmVudHsKCQlOYW1lOiAgICAgdGFzay5OYW1lLAoJCVRzOiAgICAgICBjdHguZWxhcHNlZChzdGFydFRpbWUpLAoJCUR1cjogICAgICBlbmRUaW1lLlN1YihzdGFydFRpbWUpLAoJCVJlc291cmNlOiB1aW50NjQodGFzay5JRCksCgkJU3RhY2s6ICAgIGN0eC5TdGFjayh2aWV3ZXJGcmFtZXMoc3RhcnRTdGFjaykpLAoJCUVuZFN0YWNrOiBjdHguU3RhY2sodmlld2VyRnJhbWVzKGVuZFN0YWNrKSksCgkJQXJnOiAgICAgIGFyZywKCX0pCgkvLyBFbWl0IGFuIGFycm93IGZyb20gdGhlIHBhcmVudCB0byB0aGUgY2hpbGQuCglpZiB0YXNrLlBhcmVudCAhPSBuaWwgJiYgdGFzay5TdGFydCAhPSBuaWwgJiYgdGFzay5TdGFydC5LaW5kKCkgPT0gdHJhY2UuRXZlbnRUYXNrQmVnaW4gewoJCWN0eC5UYXNrQXJyb3codHJhY2V2aWV3ZXIuQXJyb3dFdmVudHsKCQkJTmFtZTogICAgICAgICAibmV3VGFzayIsCgkJdDE2CglUYWJsZWlkICB1aW50MTYKCVByaW9yaXR5IHVpbnQ4CglNcGxzICAgICB1aW50OAoJQWRkcnMgICAgaW50MzIKCUZsYWdzICAgIGludDMyCglGbWFzayAgICBpbnQzMgoJUGlkICAgICAgaW50MzIKCVNlcSAgICAgIGludDMyCglFcnJubyAgICBpbnQzMgoJSW5pdHMgICAgdWludDMyCglSbXggICAgICBSdE1ldHJpY3MKfQoKdHlwZSBSdE1ldHJpY3Mgc3RydWN0IHsKCVBrc2VudCAgIHVpbnQ2NAoJRXhwaXJlICAgaW50NjQKCUxvY2tzICAgIHVpbnQzMgoJTXR1ICAgICAgdWludDMyCglSZWZjbnQgICB1aW50MzIKCUhvcGNvdW50IHVpbnQzMgoJUmVjdnBpcGUgdWludDMyCglTZW5kcGlwZSB1aW50MzIKCVNzdGhyZXNoIHVpbnQzMgoJUnR0ICAgICAgdWludDMyCglSdHR2YXIgICB1aW50MzIKCVBhZCAgICAgIHVpbnQzMgp9Cgpjb25zdCAoCglTaXplb2ZCcGZWZXJzaW9uID0gMHg0CglTaXplb2ZCcGZTdGF0ICAgID0gMHg4CglTaXplb2ZCcGZQcm9ncmFtID0gMHg4CglTaXplb2ZCcGZJbnNuICAgID0gMHg4CglTaXplb2ZCcGZIZHIgICAgID0gMHgxOAopCgp0eXBlIEJwZlZlcnNpb24gc3RydWN0IHsKCU1ham9yIHVpbnQxNgoJTWlub3IgdWludDE2Cn0KCnR5cGUgQnBmU3RhdCBzdHJ1Y3QgewoJUmVjdiB1aW50MzIKCURyb3AgdWludDMyCn0KCnR5cGUgQnBmUHJvZ3JhbSBzdHJ1Y3QgewoJTGVuICAgdWludDMyCglJbnNucyAqQnBmSW5zbgp9Cgp0eXBlIEJwZkluc24gc3RydWN0IHsKCUNvZGUgdWludDE2CglKdCAgIHVpbnQ4CglKZiAgIHVpbnQ4CglLICAgIHVpbnQzMgp9Cgp0eXBlIEJwZkhkciBzdHJ1Y3QgewoJVHN0YW1wICBCcGZUaW1ldmFsCglDYXBsZW4gIHVpbnQzMgoJRGF0YWxlbiB1aW50MzIKCUhkcmxlbiAgdWludDE2CglJZmlkeCAgIHVpbnQxNgoJRmxvd2lkICB1aW50MTYKCUZsYWdzICAgdWludDgKCURyb3BzICAgdWludDgKfQoKdHlwZSBCcGZUaW1ldmFsIHN0cnVjdCB7CglTZWMgIHVpbnQzMgoJVXNlYyB1aW50MzIKfQoKdHlwZSBUZXJtaW9zIHN0cnVjdCB7CglJZmxhZyAgdWludDMyCglPZmxhZyAgdWludDMyCglDZmxhZyAgdWludDMyCglMZmxhZyAgdWludDMyCglDYyAgICAgWzIwXXVpbnQ4CglJc3BlZWQgaW50MzIKCU9zcGVlZCBpbnQzMgp9Cgp0eXBlIFdpbnNpemUgc3RydWN0IHsKCVJvdyAgICB1aW50MTYKCUNvbCAgICB1aW50MTYKCVhwaXhlbCB1aW50MTYKCVlwaXhlbCB1aW50MTYKfQoKY29uc3QgKAoJQVRfRkRDV0QgICAgICAgICAgICA9IC0weDY0CglBVF9FQUNDRVNTICAgICAgICAgID0gMHgxCglBVF9TWU1MSU5LX05PRk9MTE9XID0gMHgyCglBVF9TWU1MSU5LX0ZPTExPVyAgID0gMHg0CglBVF9SRU1PVkVESVIgICAgICAgID0gMHg4CikKCnR5cGUgUG9sbEZkIHN0cnVjdCB7CglGZCAgICAgIGludDMyCglFdmVudHMgIGludDE2CglSZXZlbnRzIGludDE2Cn0KCmNvbnN0ICgKCVBPTExFUlIgICAgPSAweDgKCVBPTExIVVAgICAgPSAweDEwCglQT0xMSU4gICAgID0gMHgxCglQT0xMTlZBTCAgID0gMHgyMAoJUE9MTE9VVCAgICA9IDB4NAoJUE9MTFBSSSAgICA9IDB4MgoJUE9MTFJEQkFORCA9IDB4ODAKCVBPTExSRE5PUk0gPSAweDQwCglQT0xMV1JCQU5EID0gMHgxMDAKCVBPTExXUk5PUk0gPSAweDQKKQoKdHlwZSBTaWdzZXRfdCB1aW50MzIKCnR5cGUgVXRzbmFtZSBzdHJ1Y3QgewoJU3lzbmFtZSAgWzI1Nl1ieXRlCglOb2RlbmFtZSBbMjU2XWJ5dGUKCVJlbGVhc2UgIFsyNTZdYnl0ZQoJVmVyc2lvbiAgWzI1Nl1ieXRlCglNYWNoaW5lICBbMjU2XWJ5dGUKfQoKY29uc3QgU2l6ZW9mVXZtZXhwID0gMHgxNTgKCnR5cGUgVXZtZXhwIHN0cnVjdCB7CglQYWdlc2l6ZSAgICAgICAgICAgaW50MzIKCVBhZ2VtYXNrICAgICAgICAgICBpbnQzMgoJUGFnZXNoaWZ0ICAgICAgICAgIGludDMyCglOcGFnZXMgICAgICAgICAgICAgaW50MzIKCUZyZWUgICAgICAgICAgICAgICBpbnQzMgoJQWN0aXZlICAgIGFzZSBmb3IgU1VCRiwgU1VCRkM6IG5vdCByZXZlcnNlZAoJY2FzZSBBREQsIEFEREMsIEFEREUsIEFERENDLCBBRERDQ0M6CgkJcmV0dXJuIHRydWUKCWNhc2UgTVVMTFcsIE1VTExXQ0MsIE1VTEhXLCBNVUxIV0NDLCBNVUxMRCwgTVVMTERDQywgTVVMSEQsIE1VTEhEQ0MsIE1VTExXTywgTVVMTFdPQ0MsIE1VTEhXVSwgTVVMSFdVQ0MsIE1VTExETywgTVVMTERPQ0M6CgkJcmV0dXJuIHRydWUKCWNhc2UgRElWRCwgRElWRENDLCBESVZEVSwgRElWRFVDQywgRElWREUsIERJVkRFQ0MsIERJVkRFVSwgRElWREVVQ0MsIERJVkRPLCBESVZET0NDLCBESVZEVU8sIERJVkRVT0NDOgoJCXJldHVybiB0cnVlCgljYXNlIE1PRFVELCBNT0RTRCwgTU9EVVcsIE1PRFNXOgoJCXJldHVybiB0cnVlCgljYXNlIEZBREQsIEZBRERTLCBGU1VCLCBGU1VCUywgRk1VTCwgRk1VTFMsIEZESVYsIEZESVZTLCBGTUFERCwgRk1BRERTLCBGTVNVQiwgRk1TVUJTLCBGTk1BREQsIEZOTUFERFMsIEZOTVNVQiwgRk5NU1VCUywgRk1VTFNDQzoKCQlyZXR1cm4gdHJ1ZQoJY2FzZSBGQUREQ0MsIEZBRERTQ0MsIEZTVUJDQywgRk1VTENDLCBGRElWQ0MsIEZESVZTQ0M6CgkJcmV0dXJuIHRydWUKCWNhc2UgT1IsIE9SQ0MsIE9SQywgT1JDQ0MsIEFORCwgQU5EQ0MsIEFOREMsIEFORENDQywgWE9SLCBYT1JDQywgTkFORCwgTkFORENDLCBFUVYsIEVRVkNDLCBOT1IsIE5PUkNDOgoJCXJldHVybiB0cnVlCgljYXNlIFNMVywgU0xXQ0MsIFNMRCwgU0xEQ0MsIFNSVywgU1JBVywgU1JXQ0MsIFNSQVdDQywgU1JELCBTUkRDQywgU1JBRCwgU1JBRENDOgoJCXJldHVybiB0cnVlCgl9CglyZXR1cm4gZmFsc2UKfQoKLy8gcmV2Q29uZE1hcCBtYXBzIGEgY29uZGl0aW9uYWwgcmVnaXN0ZXIgYml0IHRvIGl0cyBpbnZlcnNlLCBpZiBwb3NzaWJsZS4KdmFyIHJldkNvbmRNYXAgPSBtYXBbc3RyaW5nXXN0cmluZ3sKCSJMVCI6ICJHRSIsICJHVCI6ICJMRSIsICJFUSI6ICJORSIsCn0KCi8vIExvb2t1cCB0YWJsZSB0byBtYXAgQklbMDoxXSBhbmQgQk9bM10gdG8gYW4gZXh0ZW5kZWQgbW5lbW9uaWMgZm9yIENSIG9wcy4KLy8gQml0cyAwLTEgbWFwIHRvIGEgYml0IHdpdGggYSBDUiBmaWVsZCwgYW5kIGJpdCAyIHNlbGVjdHMgdGhlIGludmVydGVkICgwKQovLyBvciByZWd1bGFyICgxKSBleHRlbmRlZCBtbmVtb25pYy4KdmFyIGNvbmROYW1lID0gW11zdHJpbmd7CgkiR0UiLAoJIkxFIiwKCSJORSIsCgkiTlNPIiwKCSJMVCIsCgkiR1QiLAoJIkVRIiwKCSJTTyIsCn0KCi8vIHBsYW45T3BNYXAgbWFwcyBhbiBPcCB0byBpdHMgUGxhbiA5IG1uZW1vbmljcywgaWYgZGlmZmVyZW50IHRoYW4gaXRzIEdOVSBtbmVtb25pY3MuCnZhciBwbGFuOU9wTWFwID0gbWFwW09wXXN0cmluZ3sKCUxXQVJYOiAgICAgIkxXQVIiLAoJTERBUlg6ICAgICAiTERBUiIsCglMSEFSWDogICAgICJMSEFSIiwKCUxCQVJYOiAgICAgIkxCQVIiLAoJTFdBWDogICAgICAiTU9WVyIsCglMSEFYOiAgICAgICJNT1ZIIiwKCUxXQVVYOiAgICAgIk1PVldVIiwKCUxIQVU6ICAgICAgIk1PVkhVIiwKCUxIQVVYOiAgICAgIk1PVkhVIiwKCUxEWDogICAgICAgIk1PVkQiLAoJTERVWDogICAgICAiTU9WRFUiLAoJTFdaWDogICAgICAiTU9WV1oiLAoJTFdaVVg6ICAgICAiTU9WV1pVIiwKCUxIWlg6ICAgICAgIk1PVkhaIiwKCUxIWlVYOiAgICAgIk1PVkhaVSIsCglMQlpYOiAgICAgICJNT1ZCWiIsCglMQlpVWDogICAgICJNT1ZCWlUiLAoJTERCUlg6ICAgICAiTU9WREJSIiwKCUxXQlJYOiAgICAgIk1PVldCUiIsCglMSEJSWDogICAgICJNT1ZIQlIiLAoJTUNSRjogICAgICAiTU9WRkwiLAoJWE9SSTogICAgICAiWE9SIiwKCU9SSTogICAgICAgIk9SIiwKCUFORElDQzogICAgIkFORENDIiwKCUFOREM6ICAgICAgIkFORE4iLAoJQU5EQ0NDOiAgICAiQU5ETkNDIiwKCUFEREVPOiAgICAgIkFEREVWIiwKCUFEREVPQ0M6ICAgIkFEREVWQ0MiLApsZExpc3QpIEVuZCgpIHRva2VuLlBvcyB7CglpZiBmLkNsb3NpbmcuSXNWYWxpZCgpIHsKCQlyZXR1cm4gZi5DbG9zaW5nICsgMQoJfQoJLy8gdGhlIGxpc3Qgc2hvdWxkIG5vdCBiZSBlbXB0eSBpbiB0aGlzIGNhc2U7CgkvLyBiZSBjb25zZXJ2YXRpdmUgYW5kIGd1YXJkIGFnYWluc3QgYmFkIEFTVHMKCWlmIG4gOj0gbGVuKGYuTGlzdCk7IG4gPiAwIHsKCQlyZXR1cm4gZi5MaXN0W24tMV0uRW5kKCkKCX0KCXJldHVybiB0b2tlbi5Ob1Bvcwp9CgovLyBOdW1GaWVsZHMgcmV0dXJucyB0aGUgbnVtYmVyIG9mIHBhcmFtZXRlcnMgb3Igc3RydWN0IGZpZWxkcyByZXByZXNlbnRlZCBieSBhIFtGaWVsZExpc3RdLgpmdW5jIChmICpGaWVsZExpc3QpIE51bUZpZWxkcygpIGludCB7CgluIDo9IDAKCWlmIGYgIT0gbmlsIHsKCQlmb3IgXywgZyA6PSByYW5nZSBmLkxpc3QgewoJCQltIDo9IGxlbihnLk5hbWVzKQoJCQlpZiBtID09IDAgewoJCQkJbSA9IDEKCQkJfQoJCQluICs9IG0KCQl9Cgl9CglyZXR1cm4gbgp9CgovLyBBbiBleHByZXNzaW9uIGlzIHJlcHJlc2VudGVkIGJ5IGEgdHJlZSBjb25zaXN0aW5nIG9mIG9uZQovLyBvciBtb3JlIG9mIHRoZSBmb2xsb3dpbmcgY29uY3JldGUgZXhwcmVzc2lvbiBub2Rlcy4KdHlwZSAoCgkvLyBBIEJhZEV4cHIgbm9kZSBpcyBhIHBsYWNlaG9sZGVyIGZvciBhbiBleHByZXNzaW9uIGNvbnRhaW5pbmcKCS8vIHN5bnRheCBlcnJvcnMgZm9yIHdoaWNoIGEgY29ycmVjdCBleHByZXNzaW9uIG5vZGUgY2Fubm90IGJlCgkvLyBjcmVhdGVkLgoJLy8KCUJhZEV4cHIgc3RydWN0IHsKCQlGcm9tLCBUbyB0b2tlbi5Qb3MgLy8gcG9zaXRpb24gcmFuZ2Ugb2YgYmFkIGV4cHJlc3Npb24KCX0KCgkvLyBBbiBJZGVudCBub2RlIHJlcHJlc2VudHMgYW4gaWRlbnRpZmllci4KCUlkZW50IHN0cnVjdCB7CgkJTmFtZVBvcyB0b2tlbi5Qb3MgLy8gaWRlbnRpZmllciBwb3NpdGlvbgoJCU5hbWUgICAgc3RyaW5nICAgIC8vIGlkZW50aWZpZXIgbmFtZQoJCU9iaiAgICAgKk9iamVjdCAgIC8vIGRlbm90ZWQgb2JqZWN0LCBvciBuaWwuIERlcHJlY2F0ZWQ6IHNlZSBPYmplY3QuCgl9CgoJLy8gQW4gRWxsaXBzaXMgbm9kZSBzdGFuZHMgZm9yIHRoZSAiLi4uIiB0eXBlIGluIGEKCS8vIHBhcmFtZXRlciBsaXN0IG9yIHRoZSAiLi4uIiBsZW5ndGggaW4gYW4gYXJyYXkgdHlwZS4KCS8vCglFbGxpcHNpcyBzdHJ1Y3QgewoJCUVsbGlwc2lzIHRva2VuLlBvcyAvLyBwb3NpdGlvbiBvZiAiLi4uIgoJCUVsdCAgICAgIEV4cHIgICAgICAvLyBlbGxpcHNpcyBlbGVtZW50IHR5cGUgKHBhcmFtZXRlciBsaXN0cyBvbmx5KTsgb3IgbmlsCgl9CgoJLy8gQSBCYXNpY0xpdCBub2RlIHJlcHJlc2VudHMgYSBsaXRlcmFsIG9mIGJhc2ljIHR5cGUuCgkvLwoJLy8gTm90ZSB0aGF0IGZvciB0aGUgQ0hBUiBhbmQgU1RSSU5HIGtpbmRzLCB0aGUgbGl0ZXJhbCBpcyBzdG9yZWQKCS8vIHdpdGggaXRzIHF1b3Rlcy4gRm9yIGV4YW1wbGUsIGZvciBhIGRvdWJsZS1xdW90ZWQgU1RSSU5HLCB0aGUKCS8vIGZpcnN0IGFuZCB0aGUgbGFzdCBydW5lIGluIHRoZSBWYWx1ZSBmaWVsZCB3aWxsIGJlICIuIFRoZQoJLy8gW3N0cmNvbnYuVW5xdW90ZV0gYW5kIFtzdHJjb252LlVucXVvdGVDaGFyXSBmdW5jdGlvbnMgY2FuIGJlCgkvLyB1c2VkIHRvIHVucXVvdGUgU1RSSU5HIGFuZCBDSEFSIHZhbHVlcywgcmVzcGVjdGl2ZWx5LgoJLy8KCS8vIEZvciByYXcgc3RyaW5nIGxpdGVyYWxzIChLaW5kID09IHRva2VuLlNUUklORyAmJiBWYWx1ZVswXSA9PSAnYCcpLAoJLy8gdGhlIFZhbHVlIGZpZWxkIGNvbnRhaW5zIHRoZSBzdHJpbmcgdGV4dCB3aXRob3V0IGNhcnJpYWdlIHJldHVybnMgKFxyKSB0aGF0CgkvLyBtYXkgaGF2ZSBiZWVuIHByZXNlbnQgaW4gdGhlIHNvdXJjZS4KCUJhc2ljTGl0IHN0cnVjdCB7CgkJVmFsdWVQb3MgdG9rZW4uUG9zICAgLy8gbGl0ZXJhbCBwb3NpaGUgc2VsZWN0b3IgaXMgemVybywgd2hlbiBpdCBzaG91bGQgYmUKCS8vIHRoZSBwb2ludCBhdCBpbmZpbml0eSAoYmVjYXVzZSBpbmZpbml0eSBjYW4ndCBiZSByZXByZXNlbnRlZCBpbiBhZmZpbmUKCS8vIGNvb3JkaW5hdGVzKS4gSGVyZSB3ZSBjb25kaXRpb25hbGx5IHNldCBwIHRvIHRoZSBpbmZpbml0eSBpZiBzZWwgaXMgemVyby4KCS8vIEluIHRoZSBsb29wLCB0aGF0J3MgaGFuZGxlZCBieSBBZGRBZmZpbmUuCglzZWxJc1plcm8gOj0gY29uc3RhbnR0aW1lLkJ5dGVFcShzZWwsIDApCglwLlNlbGVjdChOZXdQMjU2UG9pbnQoKSwgdC5Qcm9qZWN0aXZlKCksIHNlbElzWmVybykKCglmb3IgaW5kZXggPj0gNSB7CgkJaW5kZXggLT0gNgoKCQlpZiBpbmRleCA+PSAwIHsKCQkJc2VsLCBzaWduID0gYm9vdGhXNihzLlJzaChpbmRleCkgJiAwYjExMTExMTEpCgkJfSBlbHNlIHsKCQkJLy8gQm9vdGggZW5jb2RpbmcgY29uc2lkZXJzIGEgdmlydHVhbCB6ZXJvIGJpdCBhdCBpbmRleCAtMSwKCQkJLy8gc28gd2Ugc2hpZnQgbGVmdCB0aGUgbGVhc3Qgc2lnbmlmaWNhbnQgbGltYi4KCQkJd3ZhbHVlIDo9IChzWzBdIDw8IDEpICYgMGIxMTExMTExCgkJCXNlbCwgc2lnbiA9IGJvb3RoVzYod3ZhbHVlKQoJCX0KCgkJdGFibGUgOj0gJnAyNTZHZW5lcmF0b3JUYWJsZXNbKGluZGV4KzEpLzZdCgkJdGFibGUuU2VsZWN0KHQsIHNlbCkKCQl0Lk5lZ2F0ZShzaWduKQoJCXNlbElzWmVybyA6PSBjb25zdGFudHRpbWUuQnl0ZUVxKHNlbCwgMCkKCQlwLkFkZEFmZmluZShwLCB0LCBzZWxJc1plcm8pCgl9CgoJcmV0dXJuIHAsIG5pbAp9CgovLyBOZWdhdGUgc2V0cyBwIHRvIC1wLCBpZiBjb25kID09IDEsIGFuZCB0byBwIGlmIGNvbmQgPT0gMC4KZnVuYyAocCAqcDI1NkFmZmluZVBvaW50KSBOZWdhdGUoY29uZCBpbnQpICpwMjU2QWZmaW5lUG9pbnQgewoJbmVnWSA6PSBuZXcoZmlhdC5QMjU2RWxlbWVudCkKCW5lZ1kuU3ViKG5lZ1ksICZwLnkpCglwLnkuU2VsZWN0KG5lZ1ksICZwLnksIGNvbmQpCglyZXR1cm4gcAp9CgovLyBwMjU2U3FydCBzZXRzIGUgdG8gYSBzcXVhcmUgcm9vdCBvZiB4LiBJZiB4IGlzIG5vdCBhIHNxdWFyZSwgcDI1NlNxcnQgcmV0dXJucwovLyBmYWxzZSBhbmQgZSBpcyB1bmNoYW5nZWQuIGUgYW5kIHggY2FuIG92ZXJsYXAuCmZ1bmMgcDI1NlNxcnQoZSwgeCAqZmlhdC5QMjU2RWxlbWVudCkgKGlzU3F1YXJlIGJvb2wpIHsKCXQwLCB0MSA6PSBuZXcoZmlhdC5QMjU2RWxlbWVudCksIG5ldyhmaWF0LlAyNTZFbGVtZW50KQoKCS8vIFNpbmNlIHAgPSAzIG1vZCA0LCBleHBvbmVudGlhdGlvbiBieSAocCArIDEpIC8gNCB5aWVsZHMgYSBzcXVhcmUgcm9vdCBjYW5kaWRhdGUuCgkvLwoJLy8gVGhlIHNlcXVlbmNlIG9mIDcgbXVsdGlwbGljYXRpb25zIGFuZCAyNTMgc3F1YXJpbmdzIGlzIGRlcml2ZWQgZnJvbSB0aGUKCS8vIGZvbGxvd2luZyBhZGRpdGlvbiBjaGFpbiBnZW5lcmF0ZWQgd2l0aCBnaXRodWIuY29tL21tY2xvdWdobGluL2FkZGNoYWluIHYwLjQuMC4KCS8vCgkvLwlfMTAgICAgICAgPSAyKjEKCS8vCV8xMSAgICAgICA9IDEgKyBfMTAKCS8vCV8xMTAwICAgICA9IF8xMSA8PCAyCgkvLwlfMTExMSAgICAgPSBfMTEgKyBfMTEwMAoJLy8JXzExMTEwMDAwID0gXzExMTEgPDwgNAoJLy8JXzExMTExMTExID0gXzExMTEgKyBfMTExMTAwMDAKCS8vCXgxNiAgICAgICA9IF8xMTExMTExMSA8PCA4ICsgXzExMTExMTExCgkvLwl4MzIgICAgICAgPSB4MTYgPDwgMTYgKyB4MTYKCS8vCXJldHVybiAgICAgICgoeDMyIDw8IDMyICsgMSkgPDwgOTYgKyAxKSA8PCA5NAoJLy8KCXAyNTZTcXVhcmUodDAsIHgsIDEpCgl0MC5NdWwoeCwgdDApCglwMjU2U3F1YXJlKHQxLCB0MCwgMikKCXQwLk11bCh0MCwgdDEpCglwMjU2U3F1YXJlKHQxLCB0MCwgNCkKCXQwLk11bCh0MCwgdDEpCglwMjU2U3F1YXJlKHQxLCB0MCwgOCkKCXQwQUFBQUFBQk1BMEdDU3FHU0liM0RRRUIKQ3dVQUE0SUJBUUJuZk80bFlSWFI5QWRNaWRwZ2RJVHFNRUtKaWs4TXZDa3BRK0VLUUxxM0NJR1hQdDVsa0hMcwp5c2JGOWYzVnhpb0tOWXprYWtKR1ZHeXU1MWhxeWhHcUdRNE03SXBPQlFrbVkyNElFeFdQVkVrMndrSVYrSFRVCitvUVZaT0lySEYrczlJSUZPSWgzU0lQSXNYTnZ4N3JVYzVzZ0Y0UCtlQW5BY3YzbzF6TDdZakdKWjhlMjdBaTIKdUY4aUcvcG8vMFZkOTNPU0I4VGovTnZnOTlTU3VjeTduQllUcmVTZGhValpXUkkwVzFvWUpYNDkvZmhXbGpSOQo4K2YyR3FVZkxjN2lDamNWM3d4bGZCcUVLQ2RwalhzaXF0c2IxS3JBeDdBRU9qN1hmRGpKanlDTDRic2hMcDl4ClBiVitrQkZDTjE1MWlXWXRmemhLRXBsclpGWU5YbFgyCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS1gKQoKLy8gbG9jYWxob3N0S2V5IGlzIHRoZSBwcml2YXRlIGtleSBmb3IgbG9jYWxob3N0Q2VydC4KdmFyIGxvY2FsaG9zdEtleSA9IFtdYnl0ZSh0ZXN0aW5nS2V5KGAKLS0tLS1CRUdJTiBSU0EgVEVTVElORyBLRVktLS0tLQpNSUlFdmdJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLZ3dnZ1NrQWdFQUFvSUJBUURic0VmazFiSzdvendaCmxjUU04ckJVaWtDNGd3bm53MEoxUFVsR0RHdTFZODRkS3R1bGJkV2p5cmg4OEQ0ZlNkdG14RmJYRTdmaFlVSlQKQm1FSFNVazlPTEhoL1RyK25TQzNTZkgwSS85eTZsOWo5dlZWWWhZSkMwN1oxbVpaS1ZiK2dtYmJCN0xFYXZHTQpOYUZIanZSSkF3QlgyVE1EYlhKY2VaOWpVL2lpaElMa1picmJHNDBybjFtY3RZVm1jUjNZcU96SS95bkxqZTk3CkZFdnh0c2c5OU9Vanp6WHlGTXFmQWwwSjNHYzZ0enZBRVIzTitvdktudWRzbk1CNVkrSW5RSEhtUGVpekc0bUYKeWVCWWVzWE53WDZjbUkzMGM4S0ZpQWxLSGNzeGpKc3VvQlozYlN3dnZGZEsyaG51Q08wNUhFZ0N6QVFLVWxZNgpRMkYweEpibEFnTUJBQUVDZ2dFQUN6WklPUXJhQkI4TTNHNXJFdEVaQkR1SkdaR2dnZ3BTWERyc1FDMjJtb3VWCk02SmlFdU9UNVhmZGFnejEwckY1aDlscDZEQ3FzQTgvYkE3VmlXSnBZVDFCUU53a2RHV3ZDNE96M0VheERSdWUKa2pMQ3F5Q21LTUNCdmZibUF0TnNDL0c2VDUvcE5RS1RRTmxrMllyWGQxbDJuVVVweUJsQUhxMmJYNTJqd1NHRApiRnk1aHl6U3J6amVMcExVTlo1NlcvdVhDdlAwbDZQQUV2WFJuL0tHODlYTFpDdE1CdlZETUNmakllNzdRMVU5Ci9YeklybmI2N1J6UXdpRGVsdlgrYmlNa0JyamVZdy9HdmRvOWhOQ09mYk9aK1NwbmZET0xFZkFoYS9YUG1yMysKNUVlRjRlbWVFaENPRHZmZTd3eS80aDFnSEVHMk40MzVTNjFEY1YzZ1FRS0JnUUQ5MkVKaWR3cmlQR0RUVVNNOApuSnJQUTV4d1BNS3o1aFdwZkkwenhJWVp5cUEzN2VSQzVROVdEM3JEYnJFWmlMQ0luRmgrQ2k4OTlpTHpFcEZaCmRGUUFVaVJhbSt6RnBEQ1FjR0hyL3V5dFJvVEgvbnhoMk1yWVBxOGNBNVpHVTZvTUgrWWw0VHlucUptMktON2UKMG9jRTA3UWp5Sy85bkl2RXRkaWJFaUZFd1FLQmdRRGRqY2dvcUhhTTQ5WUo0eXhHcGp1UmRjNWEzaXVLelpVNgpCT040R0txWVE5dS9vOC9OUGFPU1Ezdktod3pUamlFb09aSW1uK2VYMWNSUDBac2ttUStMeXpzZFZBSE1EeWR6CjlJMjNkYkl5d3RDWEdoS09KUnd0OU8rKzhhdGFXSXhpMWZyamo2QmNJK1R6R2w4TE0ybFlJZlVIelZ6ZnN3d0UKMUVLOGlreG5KUUtCZ0JxUEt2cjBhNTRhSlNOWEJQSE5qT0VNdU95Qlh2bkZwQlNVcEkxN0RYRGJZNElXa09CeQo2UFRmTDhBTTc5aTFGWXRsbUZpdnBodThpaEdXcXNDS1RGT3dSSDk2ZXY1KzNGbndlRDVoOE05OFpsNHFnVWNYCmtMbXBiVmJvQlN3Y2l0a3o2VGVqWmw1QVpMekxiKzR1WnRRWmRtcWNEOVhnTUR1SHJ6OGlXWHJCQW9HQkFNSk8KWjM0cENSZlZkZEZrR0YrNXlNSnc1RkxUU0xMS1RKYisxSlJ1WmFkMjFCSUYwK2kzcDI1T214SHJVWGQwem1XZAo0Q3paenQ1ZUQzYkZhT0EzRU9oVWkvclR3Mk80NHF3U2pmdVpVSGl1WFF3NFJJKy93akFZQWUrZnVkMVpqWDNkCkZ0VmNhc2UgYXJjaHNpbWQuTEhITDoKCQl6IDo9IHguRXhwb3J0VGVzdENvbmNhdFNlbGVjdGVkQ29uc3RhbnRHcm91cGVkKGFyY2hzaW1kLkV4cG9ydFRlc3RDc2NJbW00KGEsIGQsIGIsIGMpLCB5KQoJCXJldHVybiB6LkV4cG9ydFRlc3RDb25jYXRTZWxlY3RlZENvbnN0YW50R3JvdXBlZCgwYjAxXzExXzEwXzAwIC8qID1hcmNoc2ltZC5FeHBvcnRUZXN0Q3NjSW1tNCgwLCAyLCAzLCAxKSAqLywgeikKCX0KCXBhbmljKCJtaXNzaW5nIGNhc2UsIHN3aXRjaCBzaG91bGQgYmUgZXhoYXVzdGl2ZSIpCn0KLy8gQ29weXJpZ2h0IDIwMTggVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCnBhY2thZ2UgbWFpbgoKaW1wb3J0ICJzdHJpbmdzIgoKdmFyIHJlZ05hbWVzV2FzbSA9IFtdc3RyaW5newoJIlIwIiwKCSJSMSIsCgkiUjIiLAoJIlIzIiwKCSJSNCIsCgkiUjUiLAoJIlI2IiwKCSJSNyIsCgkiUjgiLAoJIlI5IiwKCSJSMTAiLAoJIlIxMSIsCgkiUjEyIiwKCSJSMTMiLAoJIlIxNCIsCgkiUjE1IiwKCgkiRjAiLAoJIkYxIiwKCSJGMiIsCgkiRjMiLAoJIkY0IiwKCSJGNSIsCgkiRjYiLAoJIkY3IiwKCSJGOCIsCgkiRjkiLAoJIkYxMCIsCgkiRjExIiwKCSJGMTIiLAoJIkYxMyIsCgkiRjE0IiwKCSJGMTUiLAoKCSJGMTYiLAoJIkYxNyIsCgkiRjE4IiwKCSJGMTkiLAoJIkYyMCIsCgkiRjIxIiwKCSJGMjIiLAoJIkYyMyIsCgkiRjI0IiwKCSJGMjUiLAoJIkYyNiIsCgkiRjI3IiwKCSJGMjgiLAoJIkYyOSIsCgkiRjMwIiwKCSJGMzEiLAoKCSJTUCIsCgkiZyIsCgoJLy8gcHNldWRvLXJlZ2lzdGVycwoJIlNCIiwKfQoKZnVuYyBpbml0KCkgewoJLy8gTWFrZSBtYXAgZnJvbSByZWcgbmFtZXMgdG8gcmVnIGludGVnZXJzLgoJaWYgbGVuKHJlZ05hbWVzV2FzbSkgPiA2NCB7CgkJcGFuaWMoInRvbyBtYW55IHJlZ2lzdGVycyIpCgl9CgludW0gOj0gbWFwW3N0cmluZ11pbnR7fQoJZm9yIGksIG5hbWUgOj0gcmFuZ2UgcmVnTmFtZXNXYXNtIHsKCQludW1bbmFtZV0gPSBpCgl9CglidWlsZFJlZyA6PSBmdW5jKHMgc3RyaW5nKSByZWdNYXNrIHsKCQltIDo9IHJlZ01hc2soMCkKCQlmb3IgXywgciA6PSByYW5nZSBzdHJpbmdzLlNwbGl0KHMsICIgIikgewoJCQlpZiBuLCBvayA6PSBudW1bcl07IG9rIHsKCQkJCW0gfD0gcmVnTWFzaygxKSA8PCB1aW50KG4pCgkJCQljb250aW51ZQoJCQl9CgkJCXBhbmljKCJyZWdpc3RlciAiICsgciArICIgbm90IGZvdW5kIikKCQl9CgkJcmV0dXJuIG0KCX0KCgl2YXIgKAoJCWdwICAgICA9IGJ1aWxkUmVnKCJSMCBSMSBSMiBSMyBSNCBSNSBSNiBSNyBSOCBSOSBSMTAgUjExIFIxMiBSMTMgUjE0IFIxNSIpCgkJZnAzMiAgID0gYnVpbGRSZWcoIkYwIEYxIEYyIEYzIEY0IEY1IEY2IEY3IEY4IEY5IEYxMCBGMTEgRjEyIEYxMyBGMTQgRjE1IikKCQlmcDY0ICAgPSBidWlsZFJlZygiRjE2IEYxNyBGMTggRjE5IEYyMCBGMjEgRjIyIEYyMyBGMjQgRjI1IEYyNiBGMjcgRjI4IEYyOSBGMzAgRjMxIikKCQlncHNwICAgPSBncCB8IGJ1aWxkUmVnKCJTUCIpCgkJZ3BzcHNiID0gZ3BzcCB8IGJ1aWxkUmVnKCJTQiIpCgkJLy8gVGhlICJyZWdpc3RlcnMiLCB3aGljaCBhcmUgYWN0dWFsbHkgbG9jYWwgdmFyaWFibGVzLCBjYW4gZ2V0IGNsb2JiZXJlZAoJCS8vIGlmIHdlJ3JlIHN3aXRjaGluZyBnb3JvdXRpbmVzLCBiZWNhdXNlIGl0IHVud2luZHMgdGhlIFdlYkFzc2VtYmx5IHN0YWNrLgoJCWNhbGxlclNhdmUgPSBncCB8IGZwMzIgfCBmcDY0IHwgYnVpbGRSZWcoImciKQoJKQoKCS8vIENvbW1vbiByZWdJbmZvCgl2YXIgKAoJCWdwMDEgICAgICA9IHJlZ0luZm97aW5wdXRzOiBuaWwsIG91dHB1dHM6IFtdcmVnTWFza3tncH19CgkJZ3AxMSAgIEZGRkZGREYzCgktMS42MjcxNzUzNDU0NDU4OTk4Nzg4OGUrMDEsIC8vIDB4QzAzMDQ1OTFBMjY3NzlGNwoJLTcuNTk2MDE3MjI1MTM5NTAxMDc4OTZlKzAyLCAvLyAweEMwODdCQ0QwNTNFNEI1NzYKCS0xLjE4NDk4MDY2NzAyNDI5NTg3MTY3ZSswNCwgLy8gMHhDMEM3MjRFNzQwRjg3NDE1CgktNC44NDM4NTEyNDI4NTc1MDM1MzAxMGUrMDQsIC8vIDB4QzBFN0E2RDA2NUQwOUM2QQp9CnZhciBxMVM4ID0gWzZdZmxvYXQ2NHsKCTEuNjEzOTUzNjk3MDA3MjI5MDk1NTZlKzAyLCAgLy8gMHg0MDY0MkNBNkRFNUJDREU1Cgk3LjgyNTM4NTk5OTIzMzQ4NDY1MzgxZSswMywgIC8vIDB4NDBCRTkxNjJEMEQ4ODQxOQoJMS4zMzg3NTMzNjI4NzI0OTU3ODE2M2UrMDUsICAvLyAweDQxMDA1NzlBQjBCNzVFOTgKCTcuMTk2NTc3MjM2ODMyNDA5Mzk4NjNlKzA1LCAgLy8gMHg0MTI1RjY1MzcyODY5QzE5Cgk2LjY2NjAxMjMyNjE3Nzc2Mzc1MjY0ZSswNSwgIC8vIDB4NDEyNDU3RDI3NzE5QUQ1QwoJLTIuOTQ0OTAyNjQzMDM4MzQ2NDMyMTVlKzA1LCAvLyAweEMxMTFGOTY5MEVBNUFBMTgKfQoKLy8gZm9yIHggaW4gWzgsNC41NDU0XSA9IDEvWzAuMTI1LDAuMjIwMDFdCnZhciBxMVI1ID0gWzZdZmxvYXQ2NHsKCS0yLjA4OTc5OTMxMTQxNzY0MTA0Mjk3ZS0xMSwgLy8gMHhCREI2RkE0MzFBQTFBMDk4CgktMS4wMjUzOTA1MDI0MTM3NTQyNjIzMWUtMDEsIC8vIDB4QkZCQTNGRkZDQjU5N0ZFRgoJLTguMDU2NDQ4MjgxMjM5MzYwMjk4NDBlKzAwLCAvLyAweEMwMjAxQ0U2Q0EwM0FENEIKCS0xLjgzNjY5NjA3NDc0ODg4MzgwMjM5ZSswMiwgLy8gMHhDMDY2RjU2RDZDQTdCOUIwCgktMS4zNzMxOTM3NjA2NTUwODE2MzI2NWUrMDMsIC8vIDB4QzA5NTc0QzY2OTMxNzM0RgoJLTIuNjEyNDQ0NDA0NTMyMTU2NTY4MTdlKzAzLCAvLyAweEMwQTQ2OEUzODhGREE3OUQKfQp2YXIgcTFTNSA9IFs2XWZsb2F0NjR7Cgk4LjEyNzY1NTAxMzg0MzM1Nzc3ODU3ZSswMSwgIC8vIDB4NDA1NDUxQjJGRjVBMTFCMgoJMS45OTE3OTg3MzQ2MDQ4NTk2NDY0MmUrMDMsICAvLyAweDQwOUYxRjMxRTc3QkY4MzkKCTEuNzQ2ODQ4NTE5MjQ5MDg5MDc2NzdlKzA0LCAgLy8gMHg0MEQxMEYxRjBENjRDRTI5Cgk0Ljk4NTE0MjcwOTEwMzUyMjc5MzE2ZSswNCwgIC8vIDB4NDBFODU3NkRBQUJBRDE5NwoJMi43OTQ4MDc1MTYzODkxODExODI2MGUrMDQsICAvLyAweDQwREI0QjA0Q0Y3QzM2NEIKCS00LjcxOTE4MzU0Nzk1MTI4NDcwODY5ZSswMywgLy8gMHhDMEIyNkYyRUZDRkZBMDA0Cn0KCi8vIGZvciB4IGluIFs0LjU0NTQsMi44NTcxXSA9IDEvWzAuMjE5OSwwLjM1MDAxXSA/Pz8KdmFyIHExUjMgPSBbNl1mbG9hdDY0ewoJLTUuMDc4MzEyMjY0NjE3NjY1NjEzNjllLTA5LCAvLyAweEJFMzVDRkE5RDM4RkM4NEYKCS0xLjAyNTM3ODI5ODIwODM3MDg5NzQ1ZS0wMSwgLy8gMHhCRkJBM0ZFQjUxQUVFRDU0CgktNC42MTAxMTU4MTEzOTQ3MzQwMzExM2UrMDAsIC8vIDB4QzAxMjcwQzIzMzAyRDlGRgoJLTUuNzg0NzIyMTY1NjI3ODM2NDMyMTJlKzAxLCAvLyAweEMwNENFQzcxQzI1RDE2REEKCS0yLjI4MjQ0NTQwNzM3NjMxNjk1MDM4ZSswMiwgLy8gMHhDMDZDODdEMzQ3MThENTVGCgktMi4xOTIxMDEyODQ3ODkwOTMyNTYyMmUrMDIsIC8vIDB4QzA2QjY2Qjk1RjVDMUJGNgp9CnZhciBxMVMzID0gWzZdZmxvYXQ2NHsKCTQuNzY2NTE1NTAzMjM3Mjk1MDkyNzNlKzAxLCAgLy8gMHg0MDQ3RDUyM0NDRDM2N0U0Cgk2LjczODY1MTEyNjc2Njk5NzA5NDgyZSswMiwgIC8vIDB4NDA4NTBFRUJDMDMxRUUzRQoJMy4zODAxNTI4NjY3OTUyNjM0MzUwNWUrMDMsICAvLyAweDQwQUE2ODRFNDQ4RTdDOUEKCTUuNTQ3NzI5MDk3MjA3MjI3ODIzNjdlKzAzLCAgLy8gMHg0MEI1QUJCQUE2MUQ1NEE2CgkxLjkwMzExOTE5MzM4ODEwNzk4NzYzZSswMywgIC8vIDB4NDA5REJDN0EwREQ0REY0QgoJLTEuMzUyMDExOTE0NDQzMDczNDBlICUldyIsIG5hbWUpCgkJCQlyZXR1cm4KCQkJfQoJCX0KCX0KCS8vIERvdGRvdGRvdCBpcyBoYXJkLgoJaWYgY2FsbC5FbGxpcHNpcy5Jc1ZhbGlkKCkgJiYgbWF4QXJnSW5kZXggPj0gbGVuKGNhbGwuQXJncyktMiB7CgkJcmV0dXJuCgl9CgkvLyBJZiBhbnkgZm9ybWF0cyBhcmUgaW5kZXhlZCwgZXh0cmEgYXJndW1lbnRzIGFyZSBpZ25vcmVkLgoJaWYgYW55SW5kZXggewoJCXJldHVybgoJfQoJLy8gVGhlcmUgc2hvdWxkIGJlIG5vIGxlZnRvdmVyIGFyZ3VtZW50cy4KCWlmIG1heEFyZ0luZGV4KzEgPCBsZW4oY2FsbC5BcmdzKSB7CgkJZXhwZWN0IDo9IG1heEFyZ0luZGV4ICsgMSAtIGZpcnN0QXJnCgkJbnVtQXJncyA6PSBsZW4oY2FsbC5BcmdzKSAtIGZpcnN0QXJnCgkJcGFzcy5SZXBvcnRSYW5nZWYoY2FsbCwgIiVzIGNhbGwgbmVlZHMgJXYgYnV0IGhhcyAldiIsIG5hbWUsIGNvdW50KGV4cGVjdCwgImFyZyIpLCBjb3VudChudW1BcmdzLCAiYXJnIikpCgl9Cn0KCi8vIG9wUmFuZ2UgcmV0dXJucyB0aGUgc291cmNlIHJhbmdlIGZvciB0aGUgc3BlY2lmaWVkIHByaW50ZiBvcGVyYXRpb24sCi8vIHN1Y2ggYXMgdGhlIHBvc2l0aW9uIG9mIHRoZSAldiBzdWJzdHJpbmcgb2YgIi4uLiV2Li4uIi4KZnVuYyBvcFJhbmdlKGZvcm1hdEFyZyBhc3QuRXhwciwgb3AgKmZtdHN0ci5PcGVyYXRpb24pIGFuYWx5c2lzLlJhbmdlIHsKCWlmIGxpdCwgb2sgOj0gZm9ybWF0QXJnLigqYXN0LkJhc2ljTGl0KTsgb2sgewoJCXJuZywgZXJyIDo9IGFzdHV0aWwuUmFuZ2VJblN0cmluZ0xpdGVyYWwobGl0LCBvcC5SYW5nZS5TdGFydCwgb3AuUmFuZ2UuRW5kKQoJCWlmIGVyciA9PSBuaWwgewoJCQlyZXR1cm4gcm5nIC8vIHBvc2l0aW9uIG9mICIldiIKCQl9Cgl9CglyZXR1cm4gZm9ybWF0QXJnIC8vIGVudGlyZSBmb3JtYXQgc3RyaW5nCn0KCi8vIHByaW50ZkFyZ1R5cGUgZW5jb2RlcyB0aGUgdHlwZXMgb2YgZXhwcmVzc2lvbnMgYSBwcmludGYgdmVyYiBhY2NlcHRzLiBJdCBpcyBhIGJpdG1hc2suCnR5cGUgcHJpbnRmQXJnVHlwZSBpbnQKCmNvbnN0ICgKCWFyZ0Jvb2wgcHJpbnRmQXJnVHlwZSA9IDEgPDwgaW90YQoJYXJnQnl0ZQoJYXJnSW50CglhcmdSdW5lCglhcmdTdHJpbmcKCWFyZ0Zsb2F0CglhcmdDb21wbGV4CglhcmdQb2ludGVyCglhcmdFcnJvcgoJYW55VHlwZSBwcmludGZBcmdUeXBlID0gXjAKKQoKdHlwZSBwcmludFZlcmIgc3RydWN0IHsKCXZlcmIgIHJ1bmUgICAvLyBVc2VyIG1heSBwcm92aWRlIHZlcmIgdGhyb3VnaCBGb3JtYXR0ZXI7IGNvdWxkIGJlIGEgcnVuZS4KCWZsYWdzIHN0cmluZyAvLyBrbm93biBmbGFncyBhcmUgYWxsIEFTQ0lJCgl0eXAgICBwcmludGZBcmdUeXBlCn0KCi8vIENvbW1vbiBmbGFnIHNldHMgZm9yIHByaW50ZiB2ZXJicy4KY29uc3QgKAoJbm9GbGFnICAgICAgID0gIiIKCW51bUZsYWcgICAgICA9ICIgLSsuMCIKCXNoYXJwTnVtRmxhZyA9ICIgLSsuMCMiCglhbGxGbGFncyAgICAgPSAiIC0rLjAjIgopCgovLyBwcmludFZlcmJzIGlkZW50aWZpZXMgd2hpY2ggZmxhZ3MgYXJlIGtub3duIHRvIHByaW50ZiBmb3IgZWFjaCB2ZXJiLgp2YXIgcHJpbnRWZXJicyA9IFtdcHJpbnRWZXJiewoJLy8gJy0nIGlzIGEgd2lkdGggbW9kaWZpZXIsIGFsd2F5cyB2YWxpZC4KCS8vICcuJyBpcyBhIHByZWNpc2lvbiBmb3IgZmxvYXQsIG1heCB3aWR0aCBmb3Igc3RyaW5ncy4KCS8vICcrJyBpcyByZXF1aXJlZCBzaWduIGZvciBudW1iZXJzLCBHbyBmb3JtYXQgZm9yICV2LgoJLy8gJyMnIGlzIGFsdGVybmF0ZSBmb3JtYXQgZm9yIHNldmVyYWwgdmVyYnMuCgkvLyAnICcgaXMgc3BhY2VyIGZvciBudW1iZXJzCgl7JyUnLCBub0ZsYWcsIDB9LAoJeydiJywgc2hhcnBOdW1GbGFnLCBhcmdJbnQgfCBhcmdGbG9hdCB8IGFyZ0NvbXBsZXggfCBhcmdQb2ludGVyfSwKCXsnYycsICItIiwgYXJnUnVuZSB8IGFyZ0ludH0sCgl7J2QnLCBudW1GbGVuKHR0LnByb2dzKQoJCWZuID0gbGVuKGYuUHJvZ3MpCgkJaWYgdG4gIT0gZm4gewoJCQl0LkVycm9yZigib3BlbiAlczogbGVuKFByb2dzKSA9ICVkLCB3YW50ICVkIiwgdHQuZmlsZSwgZm4sIHRuKQoJCX0KCQl0bCA6PSB0dC5uZWVkZWQKCQlmbCwgZXJyIDo9IGYuSW1wb3J0ZWRMaWJyYXJpZXMoKQoJCWlmIGVyciAhPSBuaWwgewoJCQl0LkVycm9yKGVycikKCQl9CgkJaWYgIXJlZmxlY3QuRGVlcEVxdWFsKHRsLCBmbCkgewoJCQl0LkVycm9yZigib3BlbiAlczogRFRfTkVFREVEID0gJXYsIHdhbnQgJXYiLCB0dC5maWxlLCB0bCwgZmwpCgkJfQoJCXN5bWJvbHMsIGVyciA6PSBmLlN5bWJvbHMoKQoJCWlmIHR0LnN5bWJvbHMgPT0gbmlsIHsKCQkJaWYgIWVycm9ycy5JcyhlcnIsIEVyck5vU3ltYm9scykgewoJCQkJdC5FcnJvcmYoIm9wZW4gJXM6IFN5bWJvbHMoKSBleHBlY3RlZCBFcnJOb1N5bWJvbHMsIGhhdmUgbmlsIiwgdHQuZmlsZSkKCQkJfQoJCQlpZiBzeW1ib2xzICE9IG5pbCB7CgkJCQl0LkVycm9yZigib3BlbiAlczogU3ltYm9scygpIGV4cGVjdGVkIG5vIHN5bWJvbHMsIGhhdmUgJXYiLCB0dC5maWxlLCBzeW1ib2xzKQoJCQl9CgkJfSBlbHNlIHsKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQl0LkVycm9yZigib3BlbiAlczogU3ltYm9scygpIHVuZXhwZWN0ZWQgZXJyb3IgJXYiLCB0dC5maWxlLCBlcnIpCgkJCX0KCQkJaWYgIXNsaWNlcy5FcXVhbChzeW1ib2xzLCB0dC5zeW1ib2xzKSB7CgkJCQl0LkVycm9yZigib3BlbiAlczogU3ltYm9scygpID0gJXYsIHdhbnQgJXYiLCB0dC5maWxlLCBzeW1ib2xzLCB0dC5zeW1ib2xzKQoJCQl9CgkJfQoJfQp9CgovLyBlbGYuTmV3RmlsZSByZXF1aXJlcyBpby5SZWFkZXJBdCwgd2hpY2ggY29tcHJlc3MvZ3ppcCBjYW5ub3QKLy8gcHJvdmlkZS4gRGVjb21wcmVzcyB0aGUgZmlsZSB0byBhIGJ5dGVzLlJlYWRlci4KZnVuYyBkZWNvbXByZXNzKGd6IHN0cmluZykgKGlvLlJlYWRlckF0LCBlcnJvcikgewoJaW4sIGVyciA6PSBvcy5PcGVuKGd6KQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CglkZWZlciBpbi5DbG9zZSgpCglyLCBlcnIgOj0gZ3ppcC5OZXdSZWFkZXIoaW4pCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCXZhciBvdXQgYnl0ZXMuQnVmZmVyCglfLCBlcnIgPSBpby5Db3B5KCZvdXQsIHIpCglyZXR1cm4gYnl0ZXMuTmV3UmVhZGVyKG91dC5CeXRlcygpKSwgZXJyCn0KCnR5cGUgcmVsb2NhdGlvblRlc3RFbnRyeSBzdHJ1Y3QgewoJZW50cnlOdW1iZXIgaW50CgllbnRyeSAgICAgICAqZHdhcmYuRW50cnkKCXBjUmFuZ2VzICAgIFtdWzJddWludDY0Cn0KCnR5cGUgcmVsb2NhdGlvblRlc3Qgc3RydWN0IHsKCWZpbGUgICAgc3RyaW5nCgllbnRyaWVzIFtdcmVsb2NhdGlvblRlc3RFbnRyeQp9Cgp2YXIgcmVsb2NhdGlvblRlc3RzID0gW11yZWxvY2F0aW9uVGVzdHsKCXsKCQkidGVzdGRhdGEvZ28tcmVsb2NhdGlvbi10ZXN0LWdjYzQ0MS14ODYtNjQub2JqIiwKCQlbXXJlbG9jYXRpb25UZXN0RW50cnl7CgkJCXsKCQkJCWVudHJ5OiAmZHdhcmYuRW50cnl7CgkJCQkJT2Zmc2V0OiAgIDB4YiwKCQkJCQlUYWc6ICAgICAgZHdhcmYuVGFnQ29tcGlsZVVuaXQsCgkJCQkJQ2hpbGRyZW46IHRydWUsCgkJCQkJRmllbGQ6IFtdZHdhcmYuRmllbGR7CgkJCQkJCXtBdHRyOiBkd2FyZi5BdHRyUHJvZHVjZXIsIFZhbDogIkdOVSBDIDQuNC4xIiwgQ2xhc3M6IGR3YXJmLkNsYXNzU3RyaW5nfSwKCQkJCQkJe0F0dHI6IGR3YXJmLkF0dHJMYW5ndWFnZSwgVmFsOiBpbnQ2NCgxKSwgQ2xhc3M6IGR3YXJmLkNsYXNzQ29uc3RhbnR9LAoJCQkJCQl7QXR0cjogZHdhcmYuQXR0ck5hbWUsIFZhbDogImdvLXJlbG9jYXRpb24tdGVzdC5jIiwgQ2xhc3M6IGR3YXJmLkNsYXNzU3RyaW5nfSwKCQkJCQkJe0F0dHI6IGR3YXJmLkF0dHJDb21wRGlyLCBWYWw6ICIvdG1wIiBzCgl9CgliIDo9IG1ha2UoW11ieXRlLCAwLCBuZXdMZW4pCgl2YXIgcG9zIGludAoJZm9yIGkgOj0gMDsgaSA8IGxlbihzKTsgaSsrIHsKCQlpZiBzW2ldID49IHV0ZjguUnVuZVNlbGYgewoJCQlpZiBwb3MgPCBpIHsKCQkJCWIgPSBhcHBlbmQoYiwgc1twb3M6aV0uLi4pCgkJCX0KCQkJYiA9IGFwcGVuZChiLCAnJScpCgkJCWIgPSBzdHJjb252LkFwcGVuZEludChiLCBpbnQ2NChzW2ldKSwgMTYpCgkJCXBvcyA9IGkgKyAxCgkJfQoJfQoJaWYgcG9zIDwgbGVuKHMpIHsKCQliID0gYXBwZW5kKGIsIHNbcG9zOl0uLi4pCgl9CglyZXR1cm4gc3RyaW5nKGIpCn0KCi8vIE5vQm9keSBpcyBhbiBbaW8uUmVhZENsb3Nlcl0gd2l0aCBubyBieXRlcy4gUmVhZCBhbHdheXMgcmV0dXJucyBFT0YKLy8gYW5kIENsb3NlIGFsd2F5cyByZXR1cm5zIG5pbC4gSXQgY2FuIGJlIHVzZWQgaW4gYW4gb3V0Z29pbmcgY2xpZW50Ci8vIHJlcXVlc3QgdG8gZXhwbGljaXRseSBzaWduYWwgdGhhdCBhIHJlcXVlc3QgaGFzIHplcm8gYnl0ZXMuCi8vIEFuIGFsdGVybmF0aXZlLCBob3dldmVyLCBpcyB0byBzaW1wbHkgc2V0IFtSZXF1ZXN0LkJvZHldIHRvIG5pbC4KdmFyIE5vQm9keSA9IG5vQm9keXt9Cgp0eXBlIG5vQm9keSBzdHJ1Y3R7fQoKZnVuYyAobm9Cb2R5KSBSZWFkKFtdYnl0ZSkgKGludCwgZXJyb3IpICAgICAgICAgeyByZXR1cm4gMCwgaW8uRU9GIH0KZnVuYyAobm9Cb2R5KSBDbG9zZSgpIGVycm9yICAgICAgICAgICAgICAgICAgICAgeyByZXR1cm4gbmlsIH0KZnVuYyAobm9Cb2R5KSBXcml0ZVRvKGlvLldyaXRlcikgKGludDY0LCBlcnJvcikgeyByZXR1cm4gMCwgbmlsIH0KCnZhciAoCgkvLyB2ZXJpZnkgdGhhdCBhbiBpby5Db3B5IGZyb20gTm9Cb2R5IHdvbid0IHJlcXVpcmUgYSBidWZmZXI6CglfIGlvLldyaXRlclRvICAgPSBOb0JvZHkKCV8gaW8uUmVhZENsb3NlciA9IE5vQm9keQopCgovLyBQdXNoT3B0aW9ucyBkZXNjcmliZXMgb3B0aW9ucyBmb3IgW1B1c2hlci5QdXNoXS4KdHlwZSBQdXNoT3B0aW9ucyBzdHJ1Y3QgewoJLy8gTWV0aG9kIHNwZWNpZmllcyB0aGUgSFRUUCBtZXRob2QgZm9yIHRoZSBwcm9taXNlZCByZXF1ZXN0LgoJLy8gSWYgc2V0LCBpdCBtdXN0IGJlICJHRVQiIG9yICJIRUFEIi4gRW1wdHkgbWVhbnMgIkdFVCIuCglNZXRob2Qgc3RyaW5nCgoJLy8gSGVhZGVyIHNwZWNpZmllcyBhZGRpdGlvbmFsIHByb21pc2VkIHJlcXVlc3QgaGVhZGVycy4gVGhpcyBjYW5ub3QKCS8vIGluY2x1ZGUgSFRUUC8yIHBzZXVkbyBoZWFkZXIgZmllbGRzIGxpa2UgIjpwYXRoIiBhbmQgIjpzY2hlbWUiLAoJLy8gd2hpY2ggd2lsbCBiZSBhZGRlZCBhdXRvbWF0aWNhbGx5LgoJSGVhZGVyIEhlYWRlcgp9CgovLyBQdXNoZXIgaXMgdGhlIGludGVyZmFjZSBpbXBsZW1lbnRlZCBieSBSZXNwb25zZVdyaXRlcnMgdGhhdCBzdXBwb3J0Ci8vIEhUVFAvMiBzZXJ2ZXIgcHVzaC4gRm9yIG1vcmUgYmFja2dyb3VuZCwgc2VlCi8vIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM3NTQwI3NlY3Rpb24tOC4yLgp0eXBlIFB1c2hlciBpbnRlcmZhY2UgewoJLy8gUHVzaCBpbml0aWF0ZXMgYW4gSFRUUC8yIHNlcnZlciBwdXNoLiBUaGlzIGNvbnN0cnVjdHMgYSBzeW50aGV0aWMKCS8vIHJlcXVlc3QgdXNpbmcgdGhlIGdpdmVuIHRhcmdldCBhbmQgb3B0aW9ucywgc2VyaWFsaXplcyB0aGF0IHJlcXVlc3QKCS8vIGludG8gYSBQVVNIX1BST01JU0UgZnJhbWUsIHRoZW4gZGlzcGF0Y2hlcyB0aGF0IHJlcXVlc3QgdXNpbmcgdGhlCgkvLyBzZXJ2ZXIncyByZXF1ZXN0IGhhbmRsZXIuIElmIG9wdHMgaXMgbmlsLCBkZWZhdWx0IG9wdGlvbnMgYXJlIHVzZWQuCgkvLwoJLy8gVGhlIHRhcmdldCBtdXN0IGVpdGhlciBiZSBhbiBhYnNvbHV0ZSBwYXRoIChsaWtlICIvcGF0aCIpIG9yIGFuIGFic29sdXRlCgkvLyBVUkwgdGhhdCBjb250YWlucyBhIHZhbGlkIGhvc3QgYW5lcy4KCXJlZ2V4cCAhPCBnby90eXBlczsKCglnby9kb2MvY29tbWVudCwgZ28vcGFyc2VyLCBpbnRlcm5hbC9sYXp5cmVnZXhwLCB0ZXh0L3RlbXBsYXRlCgk8IGdvL2RvYzsKCglnby9idWlsZC9jb25zdHJhaW50LCBnby9kb2MsIGdvL3BhcnNlciwgaW50ZXJuYWwvYnVpbGRjZmcsIGludGVybmFsL2dvcm9vdCwgaW50ZXJuYWwvZ292ZXJzaW9uLCBpbnRlcm5hbC9wbGF0Zm9ybSwgaW50ZXJuYWwvc3lzbGlzdAoJPCBnby9idWlsZDsKCgkjIGRhdGFiYXNlcwoJRk1UCgk8IGRhdGFiYXNlL3NxbC9pbnRlcm5hbAoJPCBkYXRhYmFzZS9zcWwvZHJpdmVyOwoKCWRhdGFiYXNlL3NxbC9kcml2ZXIsIG1hdGgvcmFuZC92MiA8IGRhdGFiYXNlL3NxbDsKCgkjIGltYWdlcwoJRk1ULCBjb21wcmVzcy9sencsIGNvbXByZXNzL3psaWIKCTwgaW1hZ2UvY29sb3IKCTwgaW1hZ2UsIGltYWdlL2NvbG9yL3BhbGV0dGUKCTwgaW1hZ2UvaW50ZXJuYWwvaW1hZ2V1dGlsCgk8IGltYWdlL2RyYXcKCTwgaW1hZ2UvZ2lmLCBpbWFnZS9qcGVnLCBpbWFnZS9wbmc7CgoJIyBjZ28sIGRlbGF5ZWQgYXMgbG9uZyBhcyBwb3NzaWJsZS4KCSMgSWYgeW91IGFkZCBhIGRlcGVuZGVuY3kgb24gQ0dPLCB5b3UgbXVzdCBhZGQgdGhlIHBhY2thZ2UKCSMgdG8gY2dvUGFja2FnZXMgaW4gY21kL2Rpc3QvdGVzdC5nbyBhcyB3ZWxsLgoJUlVOVElNRQoJPCBDCgk8IHJ1bnRpbWUvY2dvCgk8IENHTwoJPCBydW50aW1lL21zYW4sIHJ1bnRpbWUvYXNhbjsKCgkjIHJ1bnRpbWUvcmFjZQoJTk9ORSA8IHJ1bnRpbWUvcmFjZS9pbnRlcm5hbC9hbWQ2NHYxOwoJTk9ORSA8IHJ1bnRpbWUvcmFjZS9pbnRlcm5hbC9hbWQ2NHYzOwoJQ0dPLCBydW50aW1lL3JhY2UvaW50ZXJuYWwvYW1kNjR2MSwgcnVudGltZS9yYWNlL2ludGVybmFsL2FtZDY0djMgPCBydW50aW1lL3JhY2U7CgoJIyBCdWxrIG9mIHRoZSBzdGFuZGFyZCBsaWJyYXJ5IG11c3Qgbm90IHVzZSBjZ28uCgkjIFRoZSBwcm9oaWJpdGlvbiBzdG9wcyBhdCBuZXQgYW5kIG9zL3VzZXIuCglDICE8IGZtdCwgZ28vdHlwZXMsIENSWVBUTy1NQVRILCBsb2cvc2xvZzsKCglDR08sIE9TCgk8IHBsdWdpbjsKCglDR08sIEZNVAoJPCBvcy91c2VyCgk8IGFyY2hpdmUvdGFyOwoKCXN5bmMKCTwgaW50ZXJuYWwvc2luZ2xlZmxpZ2h0OwoKCW9zCgk8IGdvbGFuZy5vcmcveC9uZXQvZG5zL2Ruc21lc3NhZ2UsCgkgIGdvbGFuZy5vcmcveC9uZXQvbGlmOwoKCW9zLCBuZXQvbmV0aXAKCTwgaW50ZXJuYWwvcm91dGVic2Q7CgoJIyBuZXQgaXMgdW5hdm9pZGFibGUgd2hlbiBkb2luZyBhbnkgbmV0d29ya2luZywKCSMgc28gbGFyZ2UgZGVwZW5kZW5jaWVzIG11c3QgYmUga2VwdCBvdXQuCgkjIFRoaXMgaXMgYSBsb25nLWxvb2tpbmcgbGlzdCBidXQgbW9zdCBvZiB0aGVzZQoJIyBhcmUgc21hbGwgd2l0aCBmZXcgZGVwZW5kZW5jaWVzLgoJQ0dPLAoJZ29sYW5nLm9yZy94L25ldC9kbnMvZG5zbWVzc2FnZSwKCWdvbGFuZy5vcmcveC9uZXQvbGlmLAoJaW50ZXJuYWwvZ29kZWJ1ZywKCWludGVybmFsL25ldHRyYWNlLAoJaW50ZXJuYWwvcG9sbCwKCWludGVybmFsL3JvdXRlYnNkLAoJaW50ZXJuYWwvc2luZ2xlZmxpZ2h0LAoJbmV0L25ldGlwLAoJb3MsCglzb3J0Cgk8IG5ldDsKCglmbXQsIHVuaWNvZGUgITwgbmV0OwoJbWF0aC9yYW5kICE8IG5ldDsgIyBuZXQgdXNlcyBydW50aW1lIGluc3RlYWQKCgkjIE5FVCBpcyBuZXQgcGx1cyBuZXQtaGVscGVyIHBhY2thZ2VzLgoJRk1ULCBuZXQKCTwgbmV0L3RleHRwcm90bzsKCgltaW1lLCBuZXQvdGV4dHByb3RvLCBuZXQvdXJsCgk8IE5FVDsKCgkjIGxvZ2dpbmcgLSBtb3N0IHBhY2thZ2VzIHNob3VsZCBub3QgaW1wb3J0OyBodHRwIGFuZCB1cCBpcyBhbGxvd2VkCglGTVQsIGxvZy9pbnRlcm5hbAoJPCBsb2c7CgoJbG9nLCBsb2cvc2xvZyAhPCBjcnlwdG8vdGxzLCBkYXRhYmFzZS9zcWwsIGdvL2ltcG9ydGVyLCB0ZXNJbnQ2NCgpKQoJc2hvdygiVWludDMyIiwgci5VaW50MzIoKSwgci5VaW50MzIoKSwgci5VaW50MzIoKSkKCgkvLyBJbnROLCBJbnQzMk4sIGFuZCBJbnQ2NE4gbGltaXQgdGhlaXIgb3V0cHV0IHRvIGJlIDwgbi4KCS8vIFRoZXkgZG8gc28gbW9yZSBjYXJlZnVsbHkgdGhhbiB1c2luZyByLkludCgpJW4uCglzaG93KCJJbnROKDEwKSIsIHIuSW50TigxMCksIHIuSW50TigxMCksIHIuSW50TigxMCkpCglzaG93KCJJbnQzMk4oMTApIiwgci5JbnQzMk4oMTApLCByLkludDMyTigxMCksIHIuSW50MzJOKDEwKSkKCXNob3coIkludDY0TigxMCkiLCByLkludDY0TigxMCksIHIuSW50NjROKDEwKSwgci5JbnQ2NE4oMTApKQoKCS8vIFBlcm0gZ2VuZXJhdGVzIGEgcmFuZG9tIHBlcm11dGF0aW9uIG9mIHRoZSBudW1iZXJzIFswLCBuKS4KCXNob3coIlBlcm0iLCByLlBlcm0oNSksIHIuUGVybSg1KSwgci5QZXJtKDUpKQoJLy8gT3V0cHV0OgoJLy8gRmxvYXQzMiAgICAgMC45NTk1NTY5NCAgICAgICAgICAwLjgwNzY3MzMgICAgICAgICAgICAwLjgxMzU2ODQKCS8vIEZsb2F0NjQgICAgIDAuNDI5NzkyNzQzNjAzNzI5OSAgMC43OTc4MDIzNDkzODg2MTMgICAgMC4zODgzNjY0ODU1NDEwMDU2CgkvLyBFeHBGbG9hdDY0ICAwLjQzNDYzNDEwNTQ1NTQxMTA0IDAuNTUxMzYzMjA0NjUwNDU5MyAgIDAuNzQyNjQwNDYxNzM3NDQ4MQoJLy8gTm9ybUZsb2F0NjQgLTAuOTMwMzMxODExMTY3NjYzNSAtMC4wNDc1MDc4OTQxOTg1Mjg1MiAwLjIyMjQ4MzAxMTA3NTgyNzM1CgkvLyBJbnQzMiAgICAgICAyMDIwNzc3Nzg3ICAgICAgICAgIDI2MDgwODUyMyAgICAgICAgICAgIDg1MTEyNjUwOQoJLy8gSW50NjQgICAgICAgNTIzMTA1NzkyMDg5MzUyMzMyMyA0MjU3ODcyNTg4NDg5NTAwOTAzICAxNTgzOTcxNzU3MDIzNTExMzgKCS8vIFVpbnQzMiAgICAgIDMxNDQ3ODM0MyAgICAgICAgICAgMTQxODc1ODcyOCAgICAgICAgICAgMjA4OTU1MzQ1CgkvLyBJbnROKDEwKSAgICA2ICAgICAgICAgICAgICAgICAgIDIgICAgICAgICAgICAgICAgICAgIDAKCS8vIEludDMyTigxMCkgIDMgICAgICAgICAgICAgICAgICAgNyAgICAgICAgICAgICAgICAgICAgNwoJLy8gSW50NjROKDEwKSAgOCAgICAgICAgICAgICAgICAgICA5ICAgICAgICAgICAgICAgICAgICA0CgkvLyBQZXJtICAgICAgICBbMCAzIDEgNCAyXSAgICAgICAgIFs0IDEgMiAwIDNdICAgICAgICAgIFs0IDMgMiAwIDFdCn0KCmZ1bmMgRXhhbXBsZVBlcm0oKSB7Cglmb3IgXywgdmFsdWUgOj0gcmFuZ2UgcmFuZC5QZXJtKDMpIHsKCQlmbXQuUHJpbnRsbih2YWx1ZSkKCX0KCgkvLyBVbm9yZGVyZWQgb3V0cHV0OiAxCgkvLyAyCgkvLyAwCn0KCmZ1bmMgRXhhbXBsZU4oKSB7CgkvLyBQcmludCBhbiBpbnQ2NCBpbiB0aGUgaGFsZi1vcGVuIGludGVydmFsIFswLCAxMDApLgoJZm10LlByaW50bG4ocmFuZC5OKGludDY0KDEwMCkpKQoKCS8vIFNsZWVwIGZvciBhIHJhbmRvbSBkdXJhdGlvbiBiZXR3ZWVuIDAgYW5kIDEwMCBtaWxsaXNlY29uZHMuCgl0aW1lLlNsZWVwKHJhbmQuTigxMDAgKiB0aW1lLk1pbGxpc2Vjb25kKSkKfQoKZnVuYyBFeGFtcGxlU2h1ZmZsZSgpIHsKCXdvcmRzIDo9IHN0cmluZ3MuRmllbGRzKCJpbmsgcnVucyBmcm9tIHRoZSBjb3JuZXJzIG9mIG15IG1vdXRoIikKCXJhbmQuU2h1ZmZsZShsZW4od29yZHMpLCBmdW5jKGksIGogaW50KSB7CgkJd29yZHNbaV0sIHdvcmRzW2pdID0gd29yZHNbal0sIHdvcmRzW2ldCgl9KQoJZm10LlByaW50bG4od29yZHMpCn0KCmZ1bmMgRXhhbXBsZVNodWZmbGVfc2xpY2VzSW5Vbmlzb24oKSB7CgludW1iZXJzIDo9IFtdYnl0ZSgiMTIzNDUiKQoJbGV0dGVycyA6PSBbXWJ5dGUoIkFCQ0RFIikKCS8vIFNodWZmbGUgbnVtYmVycywgc3dhcHBpbmcgY29ycmVzcG9uZGluZyBlbnRyaWVzIGluIGxldHRlcnMgYXQgdGhlIHNhbWUgdGltZS4KCXJhbmQuU2h1ZmZsZShsZW4obnVtYWlucyBBUElzIGFuZCBoZWxwZXJzIGZvciB3cml0aW5nIG91dCBhIG1ldGEtZGF0YQovLyBmaWxlIChjb21wb3NlZCBvZiBhIGZpbGUgaGVhZGVyLCBvZmZzZXRzL2xlbmd0aHMsIGFuZCB0aGVuIGEgc2VyaWVzIG9mCi8vIG1ldGEtZGF0YSBibG9icyBlbWl0dGVkIGJ5IHRoZSBjb21waWxlciwgb25lIHBlciBHbyBwYWNrYWdlKS4KCnR5cGUgQ292ZXJhZ2VNZXRhRmlsZVdyaXRlciBzdHJ1Y3QgewoJc3RhYiAgIHN0cmluZ3RhYi5Xcml0ZXIKCW1mbmFtZSBzdHJpbmcKCXcgICAgICAqYnVmaW8uV3JpdGVyCgl0bXAgICAgW11ieXRlCglkZWJ1ZyAgYm9vbAp9CgpmdW5jIE5ld0NvdmVyYWdlTWV0YUZpbGVXcml0ZXIobWZuYW1lIHN0cmluZywgdyBpby5Xcml0ZXIpICpDb3ZlcmFnZU1ldGFGaWxlV3JpdGVyIHsKCXIgOj0gJkNvdmVyYWdlTWV0YUZpbGVXcml0ZXJ7CgkJbWZuYW1lOiBtZm5hbWUsCgkJdzogICAgICBidWZpby5OZXdXcml0ZXIodyksCgkJdG1wOiAgICBtYWtlKFtdYnl0ZSwgNjQpLAoJfQoJci5zdGFiLkluaXRXcml0ZXIoKQoJci5zdGFiLkxvb2t1cCgiIikKCXJldHVybiByCn0KCmZ1bmMgKG0gKkNvdmVyYWdlTWV0YUZpbGVXcml0ZXIpIFdyaXRlKGZpbmFsSGFzaCBbMTZdYnl0ZSwgYmxvYnMgW11bXWJ5dGUsIG1vZGUgY292ZXJhZ2UuQ291bnRlck1vZGUsIGdyYW51bGFyaXR5IGNvdmVyYWdlLkNvdW50ZXJHcmFudWxhcml0eSkgZXJyb3IgewoJbWhzeiA6PSB1aW50NjQodW5zYWZlLlNpemVvZihjb3ZlcmFnZS5NZXRhRmlsZUhlYWRlcnt9KSkKCXN0U2l6ZSA6PSBtLnN0YWIuU2l6ZSgpCglzdE9mZnNldCA6PSBtaHN6ICsgdWludDY0KDE2KmxlbihibG9icykpCglwcmVhbWJsZUxlbmd0aCA6PSBzdE9mZnNldCArIHVpbnQ2NChzdFNpemUpCgoJaWYgbS5kZWJ1ZyB7CgkJZm10LkZwcmludGYob3MuU3RkZXJyLCAiPSs9IHNpemVvZihNZXRhRmlsZUhlYWRlcik9JWRcbiIsIG1oc3opCgkJZm10LkZwcmludGYob3MuU3RkZXJyLCAiPSs9IHByZWFtYmxlTGVuZ3RoPSVkIHN0U2l6ZT0lZFxuIiwgcHJlYW1ibGVMZW5ndGgsIHN0U2l6ZSkKCX0KCgkvLyBDb21wdXRlIHRvdGFsIHNpemUKCXRsZW4gOj0gcHJlYW1ibGVMZW5ndGgKCWZvciBpIDo9IDA7IGkgPCBsZW4oYmxvYnMpOyBpKysgewoJCXRsZW4gKz0gdWludDY0KGxlbihibG9ic1tpXSkpCgl9CgoJLy8gRW1pdCBoZWFkZXIKCW1oIDo9IGNvdmVyYWdlLk1ldGFGaWxlSGVhZGVyewoJCU1hZ2ljOiAgICAgICAgY292ZXJhZ2UuQ292TWV0YU1hZ2ljLAoJCVZlcnNpb246ICAgICAgY292ZXJhZ2UuTWV0YUZpbGVWZXJzaW9uLAoJCVRvdGFsTGVuZ3RoOiAgdGxlbiwKCQlFbnRyaWVzOiAgICAgIHVpbnQ2NChsZW4oYmxvYnMpKSwKCQlNZXRhRmlsZUhhc2g6IGZpbmFsSGFzaCwKCQlTdHJUYWJPZmZzZXQ6IHVpbnQzMihzdE9mZnNldCksCgkJU3RyVGFiTGVuZ3RoOiBzdFNpemUsCgkJQ01vZGU6ICAgICAgICBtb2RlLAoJCUNHcmFudWxhcml0eTogZ3JhbnVsYXJpdHksCgl9Cgl2YXIgZXJyIGVycm9yCglpZiBlcnIgPSBiaW5hcnkuV3JpdGUobS53LCBiaW5hcnkuTGl0dGxlRW5kaWFuLCBtaCk7IGVyciAhPSBuaWwgewoJCXJldHVybiBmbXQuRXJyb3JmKCJlcnJvciB3cml0aW5nICVzOiAldiIsIG0ubWZuYW1lLCBlcnIpCgl9CgoJaWYgbS5kZWJ1ZyB7CgkJZm10LkZwcmludGYob3MuU3RkZXJyLCAiPSs9IGxlbihibG9icykgaXMgJWRcbiIsIG1oLkVudHJpZXMpCgl9CgoJLy8gRW1pdCBwYWNrYWdlIG9mZnNldHMgc2VjdGlvbiBmb2xsb3dlZCBieSBwYWNrYWdlIGxlbmd0aHMgc2VjdGlvbi4KCW9mZiA6PSBwcmVhbWJsZUxlbmd0aAoJb2ZmMiA6PSBtaHN6CglidWYgOj0gbWFrZShbXWJ5dGUsIDgpCglmb3IgXywgYmxvYiA6PSByYW5nZSBibG9icyB7CgkJYmluYXJ5LkxpdHRsZUVuZGlhbi5QdXRVaW50NjQoYnVmLCBvZmYpCgkJaWYgXywgZXJyID0gbS53LldyaXRlKGJ1Zik7IGVycCAhPSBWYWx1ZU9mKGMyKS5VbnNhZmVQb2ludGVyKCkgewoJCQl0LkVycm9yZigiIzYgTWFwSW5kZXgoYzEpID0gJSN4IHdhbnQgJXAiLCBwLCBjMikKCQl9Cgl9Cgl7CgkJLy8gY29udmVydCBpZGVudGljYWwgdW5kZXJseWluZyB0eXBlcwoJCXR5cGUgTXlCdWZmZXIgYnl0ZXMuQnVmZmVyCgkJbSA6PSBtYWtlKG1hcFsqTXlCdWZmZXJdKmJ5dGVzLkJ1ZmZlcikKCQltdiA6PSBWYWx1ZU9mKG0pCgkJYjEgOj0gbmV3KE15QnVmZmVyKQoJCWIyIDo9IG5ldyhieXRlcy5CdWZmZXIpCgkJbXYuU2V0TWFwSW5kZXgoVmFsdWVPZihiMSksIFZhbHVlT2YoYjIpKQoJCXgsIG9rIDo9IG1bYjFdCgkJaWYgeCAhPSBiMiB7CgkJCXQuRXJyb3JmKCIjNyBhZnRlciBTZXRNYXBJbmRleChiMSwgYjIpOiAlcCAoIT0gJXApLCAldCAobWFwPSV2KSIsIHgsIGIyLCBvaywgbSkKCQl9CgkJaWYgcCA6PSBtdi5NYXBJbmRleChWYWx1ZU9mKGIxKSkuVW5zYWZlUG9pbnRlcigpOyBwICE9IHVuc2FmZS5Qb2ludGVyKGIyKSB7CgkJCXQuRXJyb3JmKCIjNyBNYXBJbmRleChiMSkgPSAlI3ggd2FudCAlcCIsIHAsIGIyKQoJCX0KCX0KCn0KCmZ1bmMgVGVzdEltcGxpY2l0U2V0Q29udmVyc2lvbih0ICp0ZXN0aW5nLlQpIHsKCS8vIEFzc3VtZSBUZXN0SW1wbGljaXRNYXBDb252ZXJzaW9uIGNvdmVyZWQgdGhlIGJhc2ljcy4KCS8vIEp1c3QgbWFrZSBzdXJlIGNvbnZlcnNpb25zIGFyZSBiZWluZyBhcHBsaWVkIGF0IGFsbC4KCXZhciByIGlvLlJlYWRlcgoJYiA6PSBuZXcoYnl0ZXMuQnVmZmVyKQoJcnYgOj0gVmFsdWVPZigmcikuRWxlbSgpCglydi5TZXQoVmFsdWVPZihiKSkKCWlmIHIgIT0gYiB7CgkJdC5FcnJvcmYoImFmdGVyIFNldDogcj0lVCgldikiLCByLCByKQoJfQp9CgpmdW5jIFRlc3RJbXBsaWNpdFNlbmRDb252ZXJzaW9uKHQgKnRlc3RpbmcuVCkgewoJYyA6PSBtYWtlKGNoYW4gaW8uUmVhZGVyLCAxMCkKCWIgOj0gbmV3KGJ5dGVzLkJ1ZmZlcikKCVZhbHVlT2YoYykuU2VuZChWYWx1ZU9mKGIpKQoJaWYgYmIgOj0gPC1jOyBiYiAhPSBiIHsKCQl0LkVycm9yZigiUmVjZWl2ZWQgJXAgIT0gJXAiLCBiYiwgYikKCX0KfQoKZnVuYyBUZXN0SW1wbGljaXRDYWxsQ29udmVyc2lvbih0ICp0ZXN0aW5nLlQpIHsKCS8vIEFyZ3VtZW50cyBtdXN0IGJlIGFzc2lnbmFibGUgdG8gcGFyYW1ldGVyIHR5cGVzLgoJZnYgOj0gVmFsdWVPZihpby5Xcml0ZVN0cmluZykKCWIgOj0gbmV3KHN0cmluZ3MuQnVpbGRlcikKCWZ2LkNhbGwoW11WYWx1ZXtWYWx1ZU9mKGIpLCBWYWx1ZU9mKCJoZWxsbyB3b3JsZCIpfSkKCWlmIGIuU3RyaW5nKCkgIT0gImhlbGxvIHdvcmxkIiB7CgkJdC5FcnJvcmYoIkFmdGVyIGNhbGw6IHN0cmluZz0lcSB3YW50ICVxIiwgYi5TdHJpbmcoKSwgImhlbGxvIHdvcmxkIikKCX0KfQoKZnVuYyBUZXN0SW1wbGljaXRBcHBlbmRDb252ZXJzaW9uKHQgKnRlc3RpbmcuVCkgewoJLy8gQXJndW1lbnRzIG11c3QgYmUgYXNzaWduYWJsZSB0byB0aGUgc2xpY2UncyBlbGVtZW50IHR5cGUuCglzIDo9IFtdaW8uUmVhZGVye30KCXN2IDo9IFZhbHVlT2YoJnMpLkVsZW0oKQoJYiA6PSBuZXcoYnl0ZXMuQnVmZmVyKQoJc3YuU2V0KEFwcGVuZChzdiwgVmFsdWVPZihiKSkpCglpZiBsZW4ocykgIT0gMSB8fCBzWzBdICE9IGIgewoJCXQuRXJyb3JmKCJhZnRlciBhcHBlbmQ6IHM9JXYgd2FudCBbJXBdIiwgcywgYikKCX0KfQoKdmFyIGltcGxlbWVudHNUZXN0cyA9IFtdc3RydWN0IHsKCXggYW55Cgl0IGFueQoJYiBib29sCn17Cgl7bmV3KCpieXRlcy5CdWZmZXIpLCBuZXcoaW8uUmVhZGVyKSwgdHJ1ZX0sCgl7bmV3KGJ5dGVzLkJ1ZmZlciksIG5ldyhpby5SZWFkZXIpLCBmYWxzZX0sCgl7bmV3KCpieXRlcy5CdWZmZXIpLCBuZXcoaW8uUmVhZGVyQXQpLCBmYWxzZX0sCgl7bmV3KCphc3QuSWRlbnQpLCBuZXcoYXN0LkV4cHIpLCB0cnVlfSwKCXtuZXcoKm5vdEFuRXhwciksIG52KCJHT0FSQ0giLCAiYW1kNjQiKQoKCVBhY2thZ2UoImNyeXB0by9pbnRlcm5hbC9maXBzMTQwL3NoYTUxMiIpCglDb25zdHJhaW50RXhwcigiIXB1cmVnbyIpCglibG9ja0FWWDIoKQoJR2VuZXJhdGUoKQp9CgovLyBWZXJzaW9uIGJlbG93IGlzIGJhc2VkIG9uICJGYXN0IFNIQTUxMiBJbXBsZW1lbnRhdGlvbnMgb24gSW50ZWwKLy8gQXJjaGl0ZWN0dXJlIFByb2Nlc3NvcnMiIFdoaXRlLXBhcGVyCi8vIGh0dHBzOi8vd3d3LmludGVsLmNvbS9jb250ZW50L2RhbS93d3cvcHVibGljL3VzL2VuL2RvY3VtZW50cy93aGl0ZS1wYXBlcnMvZmFzdC1zaGE1MTItaW1wbGVtZW50YXRpb25zLWlhLXByb2Nlc3NvcnMtcGFwZXIucGRmCi8vIEFWWDIgdmVyc2lvbiBieSBJbnRlbCwgc2FtZSBhbGdvcml0aG0gaW4gTGludXgga2VybmVsOgovLyBodHRwczovL2dpdGh1Yi5jb20vdG9ydmFsZHMvbGludXgvYmxvYi9tYXN0ZXIvbGliL2NyeXB0by94ODYvc2hhNTEyLWF2eDItYXNtLlMKCi8vIEphbWVzIEd1aWxmb3JkIDxqYW1lcy5ndWlsZm9yZEBpbnRlbC5jb20+Ci8vIEtpcmsgWWFwIDxraXJrLnMueWFwQGludGVsLmNvbT4KLy8gVGltIENoZW4gPHRpbS5jLmNoZW5AbGludXguaW50ZWwuY29tPgovLyBEYXZpZCBDb3RlIDxkYXZpZC5tLmNvdGVAaW50ZWwuY29tPgovLyBBbGVrc2V5IFNpZG9yb3YgPGFsZWtzZXkuc2lkb3JvdkBpbnRlbC5jb20+CgovLyBMaW5lIDI4OQp2YXIgKAoJWUZFUl9TSVpFIGludCA9ICg0ICogOCkKCVNSTkRfU0laRSAgICAgPSAoMSAqIDgpCglJTlBfU0laRSAgICAgID0gKDEgKiA4KQoKCWZyYW1lX1lGRVIgICA9ICgwKQoJZnJhbWVfU1JORCAgID0gKGZyYW1lX1lGRVIgKyBZRkVSX1NJWkUpCglmcmFtZV9JTlAgICAgPSAoZnJhbWVfU1JORCArIFNSTkRfU0laRSkKCWZyYW1lX0lOUEVORCA9IChmcmFtZV9JTlAgKyBJTlBfU0laRSkKKQoKLy8gTGluZSAyOTgKZnVuYyBhZGRtKHAxIE1lbSwgcDIgR1BQaHlzaWNhbCkgewoJQUREUShwMSwgcDIpCglNT1ZRKHAyLCBwMSkKfQoKLy8gTGluZSAzMDIKZnVuYyBDT1BZX1lNTV9BTkRfQlNXQVAocDEgVmVjUGh5c2ljYWwsIHAyIE1lbSwgcDMgVmVjUGh5c2ljYWwpIHsKCVZNT1ZEUVUocDIsIHAxKQoJVlBTSFVGQihwMywgcDEsIHAxKQp9CgovLyBMaW5lIDMwNgpmdW5jIE1ZX1ZQQUxJR05SKFlEU1QsIFlTUkMxLCBZU1JDMiBWZWNQaHlzaWNhbCwgUlZBTCBpbnQpIHsKCVZQRVJNMkYxMjgoVTgoMHgzKSwgWVNSQzIsIFlTUkMxLCBZRFNUKQoJVlBBTElHTlIoVTgoUlZBTCksIFlTUkMyLCBZRFNULCBZRFNUKQp9CgovLyBMaW5lIDMyNApmdW5jIGJsb2NrQVZYMigpIHsKCUltcGxlbWVudCgiYmxvY2tBVlgyIikKCUF0dHJpYnV0ZXMoTk9TUExJVCkKCUFsbG9jTG9jYWwoNTYpCgoJTG9hZChQYXJhbSgiZGlnIiksIFJTSSkKCUxvYWQoUGFyYW0oInAiKS5CYXNlKCksIFJESSkKCUxvYWQoUGFyYW0oInAiKS5MZW4oKSwgUkRYKQoKCVNIUlEoSW1tKDcpLCBSRFgpCglTSExRKEltbSg3KSwgUkRYKQoKCUpaKExhYmVsUmVmKCJkb25lX2hhc2giKSkKCUFERFEoUkRJLCBSRFgpCglNT1ZRKFJEWCwgTWVte0Jhc2U6IFNQfS5PZmZzZXQoZnJhbWVfSU5QRU5EKSkKCglNT1ZRKE1lbXtCYXNlOiBTSX0uT2Zmc2V0KDAqOCksIFJBWCkKCU1PVlEoTWVte0Jhc2U6IFNJfS5PZmZzZXQoMSo4KSwgUkJYKQoJTU9WUShNZW17QmFzZTogU0l9Lk9mZnNldCgyKjgpLCBSQ1gpCglNT1ZRKE1lbXtCYXNlOiBTSX0uT2Zmc2V0KDMqOCksIFI4KQoJTU9WUShNZW17QmFzZTogU0l9Lk9mZnNldCg0KjgpLCBSRFgpCglNT1ZRKE1lbXtCYXNlOiBTSX0uT2Zmc2V0KDUqOCksIFI5KQoJTU9WUShNZW17QmFzZTogU0l9Lk9mZnNldCg2KjgpLCBSMTApCglNT1ZRKE1lbXtCYXNlOiBTSX0uT2Zmc2V0KDcqOCksIFIxMSkKCglQU0hVRkZMRV9CWVRFX0ZMSVBfTUFTSyA6PSBQU0hVRkZMRV9CWVRFX0ZMSVBfTUFTS19EQVRBKCkKCVZNeDEKCVNfSVhVU1IgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAKCVNfTE9HSU5fU0VUICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJVENJRkxVU0ggICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglUQ0lPRkxVU0ggICAgICAgICAgICAgICAgICAgICAgICAgPSAweDMKCVRDT0ZMVVNIICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJVENQX0NPTkdDVEwgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMAoJVENQX0tFRVBDTlQgICAgICAgICAgICAgICAgICAgICAgID0gMHg2CglUQ1BfS0VFUElETEUgICAgICAgICAgICAgICAgICAgICAgPSAweDMKCVRDUF9LRUVQSU5JVCAgICAgICAgICAgICAgICAgICAgICA9IDB4NwoJVENQX0tFRVBJTlRWTCAgICAgICAgICAgICAgICAgICAgID0gMHg1CglUQ1BfTUFYQlVSU1QgICAgICAgICAgICAgICAgICAgICAgPSAweDQKCVRDUF9NQVhTRUcgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJVENQX01BWFdJTiAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmZmZmCglUQ1BfTUFYX1dJTlNISUZUICAgICAgICAgICAgICAgICAgPSAweGUKCVRDUF9NRDVTSUcgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAKCVRDUF9NSU5NU1MgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZDgKCVRDUF9NU1MgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MjE4CglUQ1BfTk9ERUxBWSAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCVRDU0FGTFVTSCAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJVElPQ0NCUksgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQ3YQoJVElPQ0NEVFIgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQ3OAoJVElPQ0NPTlMgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ2MgoJVElPQ0RDRFRJTUVTVEFNUCAgICAgICAgICAgICAgICAgID0gMHg0MDBjNzQ1OAoJVElPQ0RSQUlOICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQ1ZQoJVElPQ0VYQ0wgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMDAwNzQwZAoJVElPQ0VYVCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDA0NzQ2MAoJVElPQ0ZMQUdfQ0RUUkNUUyAgICAgICAgICAgICAgICAgID0gMHgxMAoJVElPQ0ZMQUdfQ0xPQ0FMICAgICAgICAgICAgICAgICAgID0gMHgyCglUSU9DRkxBR19DUlRTQ1RTICAgICAgICAgICAgICAgICAgPSAweDQKCVRJT0NGTEFHX01ETUJVRiAgICAgICAgICAgICAgICAgICA9IDB4OAoJVElPQ0ZMQUdfU09GVENBUiAgICAgICAgICAgICAgICAgID0gMHgxCglUSU9DRkxVU0ggICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ3NDEwCglUSU9DR0VUQSAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMmM3NDEzCglUSU9DR0VURCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ3NDFhCglUSU9DR0ZMQUdTICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ3NDVkCglUSU9DR0xJTkVEICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMjA3NDQyCglUSU9DR1BHUlAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ3NDc3CglUSU9DR1FTSVpFICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ3NDgxCglUSU9DR1JBTlRQVCAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwMDA3NDQ3CglUSU9DR1NJRCAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDQ3NDYzCglUSU9DR1NJWkUgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDg3NDY4CglUSU9DR1dJTlNaICAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMDg3NDY4CglUSU9DTUJJQyAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ3NDZiCglUSU9DTUJJUyAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMDQ3NDZjCglUSU9DTUdFVCAgIFRoZSBnZW5lcmFsIGZvcm0gb2YgYSB0ZXN0IGlucHV0IGxpbmUgaXM6CgkJLy8JLy8gY29tbWVudAoJCS8vCUlOU1QgYXJncyBbLy8gcHJpbnRlZCBmb3JtXSBbLy8gaGV4IGVuY29kaW5nXQoJCXBhcnRzIDo9IHN0cmluZ3MuU3BsaXQobGluZSwgIi8vIikKCQlwcmludGVkIDo9IHN0cmluZ3MuVHJpbVNwYWNlKHBhcnRzWzBdKQoJCWlmIHByaW50ZWQgPT0gIiIgfHwgc3RyaW5ncy5IYXNTdWZmaXgocHJpbnRlZCwgIjoiKSB7IC8vIGVtcHR5IG9yIGxhYmVsCgkJCWNvbnRpbnVlCgkJfQoJCXNlcSsrCgoJCXZhciBoZXhlcyBzdHJpbmcKCQlzd2l0Y2ggbGVuKHBhcnRzKSB7CgkJZGVmYXVsdDoKCQkJdC5FcnJvcmYoIiVzOiVkOiB1bmFibGUgdG8gdW5kZXJzdGFuZCBjb21tZW50czogJXMiLCBpbnB1dCwgbGluZW5vLCBsaW5lKQoJCWNhc2UgMToKCQkJLy8gbm8gY29tbWVudAoJCWNhc2UgMjoKCQkJLy8gbWlnaHQgYmUgcHJpbnRlZCBmb3JtIG9yIGhleAoJCQlub3RlIDo9IHN0cmluZ3MuVHJpbVNwYWNlKHBhcnRzWzFdKQoJCQlpZiBpc0hleGVzKG5vdGUpIHsKCQkJCWhleGVzID0gbm90ZQoJCQl9IGVsc2UgewoJCQkJcHJpbnRlZCA9IG5vdGUKCQkJfQoJCWNhc2UgMzoKCQkJLy8gcHJpbnRlZCBmb3JtLCB0aGVuIGhleAoJCQlwcmludGVkID0gc3RyaW5ncy5UcmltU3BhY2UocGFydHNbMV0pCgkJCWhleGVzID0gc3RyaW5ncy5UcmltU3BhY2UocGFydHNbMl0pCgkJCWlmICFpc0hleGVzKGhleGVzKSB7CgkJCQl0LkVycm9yZigiJXM6JWQ6IG1hbGZvcm1lZCBoZXggaW5zdHJ1Y3Rpb24gZW5jb2Rpbmc6ICVzIiwgaW5wdXQsIGxpbmVubywgbGluZSkKCQkJfQoJCX0KCgkJaWYgaGV4ZXMgIT0gIiIgewoJCQloZXhCeUxpbmVbZm10LlNwcmludGYoIiVzOiVkIiwgaW5wdXQsIGxpbmVubyldID0gaGV4ZXMKCQl9CgoJCS8vIENhbm9uaWNhbGl6ZSBzcGFjaW5nIGluIHByaW50ZWQgZm9ybS4KCQkvLyBGaXJzdCBmaWVsZCBpcyBvcGNvZGUsIHRoZW4gdGFiLCB0aGVuIGFyZ3VtZW50cyBzZXBhcmF0ZWQgYnkgc3BhY2VzLgoJCS8vIENhbm9uaWNhbGl6ZSBzcGFjZXMgYWZ0ZXIgY29tbWFzIGZpcnN0LgoJCS8vIENvbW1hIHRvIHNlcGFyYXRlIGFyZ3VtZW50IGdldHMgYSBzcGFjZTsgY29tbWEgd2l0aGluIGRvZXMgbm90LgoJCXZhciBidWYgW11ieXRlCgkJbmVzdCA6PSAwCgkJZm9yIGkgOj0gMDsgaSA8IGxlbihwcmludGVkKTsgaSsrIHsKCQkJYyA6PSBwcmludGVkW2ldCgkJCXN3aXRjaCBjIHsKCQkJY2FzZSAneycsICdbJzoKCQkJCW5lc3QrKwoJCQljYXNlICd9JywgJ10nOgoJCQkJbmVzdC0tCgkJCWNhc2UgJywnOgoJCQkJYnVmID0gYXBwZW5kKGJ1ZiwgJywnKQoJCQkJaWYgbmVzdCA9PSAwIHsKCQkJCQlidWYgPSBhcHBlbmQoYnVmLCAnICcpCgkJCQl9CgkJCQlmb3IgaSsxIDwgbGVuKHByaW50ZWQpICYmIChwcmludGVkW2krMV0gPT0gJyAnIHx8IHByaW50ZWRbaSsxXSA9PSAnXHQnKSB7CgkJCQkJaSsrCgkJCQl9CgkJCQljb250aW51ZQoJCQl9CgkJCWJ1ZiA9IGFwcGVuZChidWYsIGMpCgkJfQoKCQlmIDo9IHN0cmluZ3MuRmllbGRzKHN0cmluZyhidWYpKQoKCQkvLyBUdXJuIHJlbGF0aXZlIChQQykgaW50byBhYnNvbHV0ZSAoUEMpIGF1dG9tYXRpY2FsbHksCgkJLy8gc28gdGhhdCBtb3N0IGJyYW5jaCBpbnN0cnVjdGlvbnMgZG9uJ3QgbmVlZCBjb21tZW50cwoJCS8vIGdpdmluZyB0aGUgYWJzb2x1dGUgZm9ybS4KCQlpZiBsZW4oZikgPiAwICYmIHN0cmluZ3MuQ29udGFpbnMocHJpbnRlZCwgIihQQykiKSB7CgkJCWluZGV4IDo9IGxlbihmKSAtIDEKCQkJc3VmIDo9ICIoUEMpIgoJCQlmb3IgIXN0cmluZ3MuSGFzU3VmZml4KGZbaW5kZXhdLCBzdWYpIHsKCQkJCWluZGV4LS0KCQkJCXN1ZiA9ICIoUEMpLCIKCQkJfQoJCQlzdHIgOj0gZltpbmRleF0KCQkJbiwgZXJyIDo9IHN0cmNvbnYuQXRvaShzdHJbOmxlbihzdHIpLWxlbihzdWYpXSkKCQkwLAoJIkZsb2F0NjQiOiAwLAoJImJhciI6ICIiLAoJImJhcjIiOiAiIiwKICAgICAgICAiSW50U3RyIjogIjAiLAoJIlVpbnRwdHJTdHIiOiAiMCIsCgkiUEJvb2wiOiB0cnVlLAoJIlBJbnQiOiAyLAoJIlBJbnQ4IjogMywKCSJQSW50MTYiOiA0LAoJIlBJbnQzMiI6IDUsCgkiUEludDY0IjogNiwKCSJQVWludCI6IDcsCgkiUFVpbnQ4IjogOCwKCSJQVWludDE2IjogOSwKCSJQVWludDMyIjogMTAsCgkiUFVpbnQ2NCI6IDExLAoJIlBVaW50cHRyIjogMTIsCgkiUEZsb2F0MzIiOiAxNC4xLAoJIlBGbG9hdDY0IjogMTUuMSwKCSJTdHJpbmciOiAiIiwKCSJQU3RyaW5nIjogIjE2IiwKCSJNYXAiOiBudWxsLAoJIk1hcFAiOiBudWxsLAoJIlBNYXAiOiB7CgkJIjE3IjogewoJCQkiVGFnIjogInRhZzE3IgoJCX0sCgkJIjE4IjogewoJCQkiVGFnIjogInRhZzE4IgoJCX0KCX0sCgkiUE1hcFAiOiB7CgkJIjE5IjogewoJCQkiVGFnIjogInRhZzE5IgoJCX0sCgkJIjIwIjogbnVsbAoJfSwKCSJFbXB0eU1hcCI6IG51bGwsCgkiTmlsTWFwIjogbnVsbCwKCSJTbGljZSI6IG51bGwsCgkiU2xpY2VQIjogbnVsbCwKCSJQU2xpY2UiOiBbCgkJewoJCQkiVGFnIjogInRhZzIwIgoJCX0sCgkJewoJCQkiVGFnIjogInRhZzIxIgoJCX0KCV0sCgkiUFNsaWNlUCI6IFsKCQl7CgkJCSJUYWciOiAidGFnMjIiCgkJfSwKCQludWxsLAoJCXsKCQkJIlRhZyI6ICJ0YWcyMyIKCQl9CgldLAoJIkVtcHR5U2xpY2UiOiBudWxsLAoJIk5pbFNsaWNlIjogbnVsbCwKCSJTdHJpbmdTbGljZSI6IG51bGwsCgkiQnl0ZVNsaWNlIjogbnVsbCwKCSJTbWFsbCI6IHsKCQkiVGFnIjogIiIKCX0sCgkiUFNtYWxsIjogbnVsbCwKCSJQUFNtYWxsIjogewoJCSJUYWciOiAidGFnMzEiCgl9LAoJIkludGVyZmFjZSI6IG51bGwsCgkiUEludGVyZmFjZSI6IDUuMgp9YAoKdmFyIHBhbGxWYWx1ZUNvbXBhY3QgPSBzdHJpcFdoaXRlc3BhY2UocGFsbFZhbHVlSW5kZW50KQoKZnVuYyBUZXN0UmVmVW5tYXJzaGFsKHQgKnRlc3RpbmcuVCkgewoJdHlwZSBTIHN0cnVjdCB7CgkJLy8gUmVmIGlzIGRlZmluZWQgaW4gZW5jb2RlX3Rlc3QuZ28uCgkJUjAgUmVmCgkJUjEgKlJlZgoJCVIyIFJlZlRleHQKCQlSMyAqUmVmVGV4dAoJfQoJd2FudCA6PSBTewoJCVIwOiAxMiwKCQlSMTogbmV3KFJlZiksCgkJUjI6IDEzLAoJCVIzOiBuZXcoUmVmVGV4dCksCgl9Cgkqd2FudC5SMSA9IDEyCgkqd2FudC5SMyA9IDEzCgoJdmFyIGdvdCBTCglpZiBlcnIgOj0gVW5tYXJzaGFsKFtdYnl0ZShgeyJSMCI6InJlZiIsIlIxIjoicmVmIiwiUjIiOiJyZWYiLCJSMyI6InJlZiJ9YCksICZnb3QpOyBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsZigiVW5tYXJzaGFsIGVycm9yOiAldiIsIGVycikKCX0KCWlmICFyZWZsZWN0LkRlZXBFcXVhbChnb3QsIHdhbnQpIHsKCQl0LkVycm9yZigiVW5tYXJzaGE6XG5cdGdvdDogICUrdlxuXHR3YW50OiAlK3YiLCBnb3QsIHdhbnQpCgl9Cn0KCi8vIFRlc3QgdGhhdCB0aGUgZW1wdHkgc3RyaW5nIGRvZXNuJ3QgcGFuaWMgZGVjb2Rpbmcgd2hlbiAsc3RyaW5nIGlzIHNwZWNpZmllZAovLyBJc3N1ZSAzNDUwCmZ1bmMgVGVzdEVtcHR5U3RyaW5nKHQgKnRlc3RpbmcuVCkgewoJdHlwZSBUMiBzdHJ1Y3QgewoJCU51bWJlcjEgaW50IGBqc29uOiIsc3RyaW5nImAKCQlOdW1iZXIyIGludCBganNvbjoiLHN0cmluZyJgCgl9CglkYXRhIDo9IGB7Ik51bWJlcjEiOiIxIiwgIk51bWJlcjIiOiIifWAKCWRlYyA6PSBOZXdEZWNvZGVyKHN0cmluZ3MuTmV3UmVhZGVyKGRhdGEpKQoJdmFyIGdvdCBUMgoJc3dpdGNoIGVyciA6PSBkZWMuRGVjb2RlKCZnb3QpOyB7CgljYXNlIGVyciA9PSBuaWw6CgkJdC5GYXRhbGYoIkRlY29kZSBlcnJvcjogZ290IG5pbCwgd2FudCBub24tbmlsIikKCWNhc2UgZ290Lk51bWJlcjEgIT0gMToKCQl0LkZhdGFsZigiRGVjb2RlOiBnb3QuTnVtYmVyMSA9ICVkLCB3YW50IDEiLCBnb3QuZyBvZiBzdGF0ZW1lbnRzLgoKcGFja2FnZSB0eXBlcwoKaW1wb3J0ICgKCSJnby9hc3QiCgkiZ28vY29uc3RhbnQiCgkiZ28vdG9rZW4iCgkuICJpbnRlcm5hbC90eXBlcy9lcnJvcnMiCgkic2xpY2VzIgopCgovLyBkZWNsIG1heSBiZSBuaWwKZnVuYyAoY2hlY2sgKkNoZWNrZXIpIGZ1bmNCb2R5KGRlY2wgKmRlY2xJbmZvLCBuYW1lIHN0cmluZywgc2lnICpTaWduYXR1cmUsIGJvZHkgKmFzdC5CbG9ja1N0bXQsIGlvdGEgY29uc3RhbnQuVmFsdWUpIHsKCWlmIGNoZWNrLmNvbmYuSWdub3JlRnVuY0JvZGllcyB7CgkJcGFuaWMoImZ1bmN0aW9uIGJvZHkgbm90IGlnbm9yZWQiKQoJfQoKCWlmIGNoZWNrLmNvbmYuX1RyYWNlIHsKCQljaGVjay50cmFjZShib2R5LlBvcygpLCAiLS0gJXM6ICVzIiwgbmFtZSwgc2lnKQoJfQoKCS8vIHNhdmUvcmVzdG9yZSBjdXJyZW50IGVudmlyb25tZW50IGFuZCBzZXQgdXAgZnVuY3Rpb24gZW52aXJvbm1lbnQKCS8vIChhbmQgdXNlIDAgaW5kZW50YXRpb24gYXQgZnVuY3Rpb24gc3RhcnQpCglkZWZlciBmdW5jKGVudiBlbnZpcm9ubWVudCwgaW5kZW50IGludCkgewoJCWNoZWNrLmVudmlyb25tZW50ID0gZW52CgkJY2hlY2suaW5kZW50ID0gaW5kZW50Cgl9KGNoZWNrLmVudmlyb25tZW50LCBjaGVjay5pbmRlbnQpCgljaGVjay5lbnZpcm9ubWVudCA9IGVudmlyb25tZW50ewoJCWRlY2w6ICAgIGRlY2wsCgkJc2NvcGU6ICAgc2lnLnNjb3BlLAoJCXZlcnNpb246IGNoZWNrLnZlcnNpb24sIC8vIFRPRE8oYWRvbm92YW4pOiB3b3VsZCBkZWNsLnZlcnNpb24gKGlmIGRlY2wgIT0gbmlsKSBiZSBiZXR0ZXI/CgkJaW90YTogICAgaW90YSwKCQlzaWc6ICAgICBzaWcsCgl9CgljaGVjay5pbmRlbnQgPSAwCgoJY2hlY2suc3RtdExpc3QoMCwgYm9keS5MaXN0KQoKCWlmIGNoZWNrLmhhc0xhYmVsIHsKCQljaGVjay5sYWJlbHMoYm9keSkKCX0KCglpZiBzaWcucmVzdWx0cy5MZW4oKSA+IDAgJiYgIWNoZWNrLmlzVGVybWluYXRpbmcoYm9keSwgIiIpIHsKCQljaGVjay5lcnJvcihhdFBvcyhib2R5LlJicmFjZSksIE1pc3NpbmdSZXR1cm4sICJtaXNzaW5nIHJldHVybiIpCgl9CgoJLy8gc3BlYzogIkltcGxlbWVudGF0aW9uIHJlc3RyaWN0aW9uOiBBIGNvbXBpbGVyIG1heSBtYWtlIGl0IGlsbGVnYWwgdG8KCS8vIGRlY2xhcmUgYSB2YXJpYWJsZSBpbnNpZGUgYSBmdW5jdGlvbiBib2R5IGlmIHRoZSB2YXJpYWJsZSBpcyBuZXZlciB1c2VkLiIKCWNoZWNrLnVzYWdlKHNpZy5zY29wZSkKfQoKZnVuYyAoY2hlY2sgKkNoZWNrZXIpIHVzYWdlKHNjb3BlICpTY29wZSkgewoJbmVlZFVzZSA6PSBmdW5jKGtpbmQgVmFyS2luZCkgYm9vbCB7CgkJcmV0dXJuICEoa2luZCA9PSBSZWN2VmFyIHx8IGtpbmQgPT0gUGFyYW1WYXIgfHwga2luZCA9PSBSZXN1bHRWYXIpCgl9Cgl2YXIgdW51c2VkIFtdKlZhcgoJZm9yIG5hbWUsIGVsZW0gOj0gcmFuZ2Ugc2NvcGUuZWxlbXMgewoJCWVsZW0gPSByZXNvbHZlKG5hbWUsIGVsZW0pCgkJaWYgdiwgXyA6PSBlbGVtLigqVmFyKTsgdiAhPSBuaWwgJiYgbmVlZFVzZSh2LmtpbmQpICYmICFjaGVjay51c2VkVmFyc1t2XSB7CgkJCXVudXNlZCA9IGFwcGVuZCh1bnVzZWQsIHYpCgkJfQoJfQoJc2xpY2VzLlNvcnRGdW5jKHVudXNlZCwgZnVuYyhhLCBiICpWYXIpIGludCB7CgkJcmV0dXJuIGNtcFBvcyhhLnBvcywgYi5wb3MpCgl9KQoJZm9yIF8sIHYgOj0gcmFuZ2UgdW51c2VkIHsKCQljaGVjay5zb2Z0RXJyb3JmKHYsIFVudXNlZFZhciwgImRlY2xhcmVkIGFuZCBub3QgdXNlZDogJXMiLCB2Lm5hbWUpCgl9CgoJZm9yIF8sIHNjb3BlIDo9IHJhbmdlIHNjb3BlLmNoaWxkcmVuIHsKCQkvLyBEb24ndCBnbyBpbnNpZGUgZnVuY3Rpb24gbGl0ZXJhbCBzY29wZXMgYSBzZWNvbmQgdGltZTsKCQkvLyB0aGV5IGFyZSBoYW5kbGVkIGV4cGxpY2l0bHkgYnkgZnVuY0JvZHkuCgkJaWYgIXNjb3BlLmlzRnVuYyB7ClgpCgkJdmFyIGxocyBbXWFzdC5FeHByCgkJaWYgbi5LZXkgIT0gbmlsIHsKCQkJbGhzID0gYXBwZW5kKGxocywgbi5LZXkpCgkJfQoJCWlmIG4uVmFsdWUgIT0gbmlsIHsKCQkJbGhzID0gYXBwZW5kKGxocywgbi5WYWx1ZSkKCQl9CgkJaWYgbGVuKGxocykgPiAwIHsKCQkJaWYgbi5Ub2sgPT0gdG9rZW4uREVGSU5FIHsKCQkJCS8vIE5vdGU6IHdlIGNhbid0IGV4YWN0bHkgbWF0Y2ggdGhlIGJlaGF2aW9yIG9mIG9iamVjdCByZXNvbHV0aW9uCgkJCQkvLyBkdXJpbmcgdGhlIHBhcnNpbmcgcGFzcyBoZXJlLCBhcyBpdCB1c2VzIHRoZSBwb3NpdGlvbiBvZiB0aGUgUkFOR0UKCQkJCS8vIHRva2VuIGZvciB0aGUgUkhTIE9wUG9zLiBUaGF0IGluZm9ybWF0aW9uIGlzIG5vdCBjb250YWluZWQgd2l0aGluCgkJCQkvLyB0aGUgQVNULgoJCQkJYXMgOj0gJmFzdC5Bc3NpZ25TdG10ewoJCQkJCUxoczogICAgbGhzLAoJCQkJCVRvazogICAgdG9rZW4uREVGSU5FLAoJCQkJCVRva1Bvczogbi5Ub2tQb3MsCgkJCQkJUmhzOiAgICBbXWFzdC5FeHByeyZhc3QuVW5hcnlFeHBye09wOiB0b2tlbi5SQU5HRSwgWDogbi5YfX0sCgkJCQl9CgkJCQkvLyBUT0RPKHJGaW5kbGV5KTogdGhpcyB3YWxrTEhTIHJlcHJvZHVjZWQgdGhlIHBhcnNlciByZXNvbHV0aW9uLCBidXQKCQkJCS8vIGlzIGl0IG5lY2Vzc2FyeT8gQnkgY29tcGFyaXNvbiwgZm9yIGEgbm9ybWFsIEFzc2lnblN0bXQgd2UgZG9uJ3QKCQkJCS8vIHdhbGsgdGhlIExIUyBpbiBjYXNlIHRoZXJlIGlzIGFuIGludmFsaWQgaWRlbnRpZmllciBsaXN0LgoJCQkJci53YWxrTEhTKGxocykKCQkJCXIuc2hvcnRWYXJEZWNsKGFzKQoJCQl9IGVsc2UgewoJCQkJci53YWxrRXhwcnMobGhzKQoJCQl9CgkJfQoJCWFzdC5XYWxrKHIsIG4uQm9keSkKCgkvLyBEZWNsYXJhdGlvbnMKCWNhc2UgKmFzdC5HZW5EZWNsOgoJCXN3aXRjaCBuLlRvayB7CgkJY2FzZSB0b2tlbi5DT05TVCwgdG9rZW4uVkFSOgoJCQlmb3IgaSwgc3BlYyA6PSByYW5nZSBuLlNwZWNzIHsKCQkJCXNwZWMgOj0gc3BlYy4oKmFzdC5WYWx1ZVNwZWMpCgkJCQlraW5kIDo9IGFzdC5Db24KCQkJCWlmIG4uVG9rID09IHRva2VuLlZBUiB7CgkJCQkJa2luZCA9IGFzdC5WYXIKCQkJCX0KCQkJCXIud2Fsa0V4cHJzKHNwZWMuVmFsdWVzKQoJCQkJaWYgc3BlYy5UeXBlICE9IG5pbCB7CgkJCQkJYXN0LldhbGsociwgc3BlYy5UeXBlKQoJCQkJfQoJCQkJci5kZWNsYXJlKHNwZWMsIGksIHIudG9wU2NvcGUsIGtpbmQsIHNwZWMuTmFtZXMuLi4pCgkJCX0KCQljYXNlIHRva2VuLlRZUEU6CgkJCWZvciBfLCBzcGVjIDo9IHJhbmdlIG4uU3BlY3MgewoJCQkJc3BlYyA6PSBzcGVjLigqYXN0LlR5cGVTcGVjKQoJCQkJLy8gR28gc3BlYzogVGhlIHNjb3BlIG9mIGEgdHlwZSBpZGVudGlmaWVyIGRlY2xhcmVkIGluc2lkZSBhIGZ1bmN0aW9uIGJlZ2lucwoJCQkJLy8gYXQgdGhlIGlkZW50aWZpZXIgaW4gdGhlIFR5cGVTcGVjIGFuZCBlbmRzIGF0IHRoZSBlbmQgb2YgdGhlIGlubmVybW9zdAoJCQkJLy8gY29udGFpbmluZyBibG9jay4KCQkJCXIuZGVjbGFyZShzcGVjLCBuaWwsIHIudG9wU2NvcGUsIGFzdC5UeXAsIHNwZWMuTmFtZSkKCQkJCWlmIHNwZWMuVHlwZVBhcmFtcyAhPSBuaWwgewoJCQkJCXIub3BlblNjb3BlKHNwZWMuUG9zKCkpCgkJCQkJZGVmZXIgci5jbG9zZVNjb3BlKCkKCQkJCQlyLndhbGtUUGFyYW1zKHNwZWMuVHlwZVBhcmFtcykKCQkJCX0KCQkJCWFzdC5XYWxrKHIsIHNwZWMuVHlwZSkKCQkJfQoJCX0KCgljYXNlICphc3QuRnVuY0RlY2w6CgkJLy8gT3BlbiB0aGUgZnVuY3Rpb24gc2NvcGUuCgkJci5vcGVuU2NvcGUobi5Qb3MoKSkKCQlkZWZlciByLmNsb3NlU2NvcGUoKQoKCQlyLndhbGtSZWN2KG4uUmVjdikKCgkJLy8gVHlwZSBwYXJhbWV0ZXJzIGFyZSB3YWxrZWQgbm9ybWFsbHk6IHRoZXkgY2FuIHJlZmVyZW5jZSBlYWNoIG90aGVyLCBhbmRzc2VkIGZvcm0uCgljYXNlIGxlbihiKSA9PSBwMjU2Q29tcHJlc3NlZExlbmd0aCAmJiAoYlswXSA9PSAyIHx8IGJbMF0gPT0gMyk6CgkJdmFyIHIgUDI1NlBvaW50CgkJcDI1NkJpZ1RvTGl0dGxlKCZyLngsICgqWzMyXWJ5dGUpKGJbMTozM10pKQoJCWlmIHAyNTZMZXNzVGhhblAoJnIueCkgPT0gMCB7CgkJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImludmFsaWQgUDI1NiBlbGVtZW50IGVuY29kaW5nIikKCQl9CgkJcDI1Nk11bCgmci54LCAmci54LCAmcnIpCgoJCS8vIHnCsiA9IHjCsyAtIDN4ICsgYgoJCXAyNTZQb2x5bm9taWFsKCZyLnksICZyLngpCgkJaWYgIXAyNTZTcXJ0KCZyLnksICZyLnkpIHsKCQkJcmV0dXJuIG5pbCwgZXJyb3JzLk5ldygiaW52YWxpZCBQMjU2IGNvbXByZXNzZWQgcG9pbnQgZW5jb2RpbmciKQoJCX0KCgkJLy8gU2VsZWN0IHRoZSBwb3NpdGl2ZSBvciBuZWdhdGl2ZSByb290LCBhcyBpbmRpY2F0ZWQgYnkgdGhlIGxlYXN0CgkJLy8gc2lnbmlmaWNhbnQgYml0LCBiYXNlZCBvbiB0aGUgZW5jb2RpbmcgdHlwZSBieXRlLgoJCXl5IDo9IG5ldyhwMjU2RWxlbWVudCkKCQlwMjU2RnJvbU1vbnQoeXksICZyLnkpCgkJY29uZCA6PSBpbnQoeXlbMF0mMSkgXiBpbnQoYlswXSYxKQoJCXAyNTZOZWdDb25kKCZyLnksIGNvbmQpCgoJCXIueiA9IHAyNTZPbmUKCQlyZXR1cm4gcC5TZXQoJnIpLCBuaWwKCglkZWZhdWx0OgoJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImludmFsaWQgUDI1NiBwb2ludCBlbmNvZGluZyIpCgl9Cn0KCi8vIHAyNTZQb2x5bm9taWFsIHNldHMgeTIgdG8geMKzIC0gM3ggKyBiLCBhbmQgcmV0dXJucyB5Mi4KZnVuYyBwMjU2UG9seW5vbWlhbCh5MiwgeCAqcDI1NkVsZW1lbnQpICpwMjU2RWxlbWVudCB7Cgl4MyA6PSBuZXcocDI1NkVsZW1lbnQpCglwMjU2U3FyKHgzLCB4LCAxKQoJcDI1Nk11bCh4MywgeDMsIHgpCgoJdGhyZWVYIDo9IG5ldyhwMjU2RWxlbWVudCkKCXAyNTZBZGQodGhyZWVYLCB4LCB4KQoJcDI1NkFkZCh0aHJlZVgsIHRocmVlWCwgeCkKCXAyNTZOZWdDb25kKHRocmVlWCwgMSkKCglwMjU2QiA6PSAmcDI1NkVsZW1lbnR7MHhkODljZGY2MjI5YzRiZGRmLCAweGFjZjAwNWNkNzg4NDMwOTAsCgkJMHhlNWEyMjBhYmY3MjEyZWQ2LCAweGRjMzAwNjFkMDQ4NzQ4MzR9CgoJcDI1NkFkZCh4MywgeDMsIHRocmVlWCkKCXAyNTZBZGQoeDMsIHgzLCBwMjU2QikKCgkqeTIgPSAqeDMKCXJldHVybiB5Mgp9CgpmdW5jIHAyNTZDaGVja09uQ3VydmUoeCwgeSAqcDI1NkVsZW1lbnQpIGVycm9yIHsKCS8vIHnCsiA9IHjCsyAtIDN4ICsgYgoJcmhzIDo9IHAyNTZQb2x5bm9taWFsKG5ldyhwMjU2RWxlbWVudCksIHgpCglsaHMgOj0gbmV3KHAyNTZFbGVtZW50KQoJcDI1NlNxcihsaHMsIHksIDEpCglpZiBwMjU2RXF1YWwobGhzLCByaHMpICE9IDEgewoJCXJldHVybiBlcnJvcnMuTmV3KCJQMjU2IHBvaW50IG5vdCBvbiBjdXJ2ZSIpCgl9CglyZXR1cm4gbmlsCn0KCi8vIHAyNTZMZXNzVGhhblAgcmV0dXJucyAxIGlmIHggPCBwLCBhbmQgMCBvdGhlcndpc2UuIE5vdGUgdGhhdCBhIHAyNTZFbGVtZW50IGlzCi8vIG5vdCBhbGxvd2VkIHRvIGJlIGVxdWFsIHRvIG9yIGdyZWF0ZXIgdGhhbiBwLCBzbyBpZiB0aGlzIGZ1bmN0aW9uIHJldHVybnMgMAovLyB0aGVuIHggaXMgaW52YWxpZC4KZnVuYyBwMjU2TGVzc1RoYW5QKHggKnAyNTZFbGVtZW50KSBpbnQgewoJdmFyIGIgdWludDY0CglfLCBiID0gYml0cy5TdWI2NCh4WzBdLCBwMjU2UFswXSwgYikKCV8sIGIgPSBiaXRzLlN1YjY0KHhbMV0sIHAyNTZQWzFdLCBiKQoJXywgYiA9IGJpdHMuU3ViNjQoeFsyXSwgcDI1NlBbMl0sIGIpCglfLCBiID0gYml0cy5TdWI2NCh4WzNdLCBwMjU2UFszXSwgYikKCXJldHVybiBpbnQoYikKfQoKZnVuYyBwMjU2QmlnVG9MaXR0bGUobCAqcDI1NkVsZW1lbnQsIGIgKlszMl1ieXRlKSB7CglieXRlc1RvTGltYnMoKCpbNF11ZSBidWcKaXMgbm90IGluIG15IGNvZGUuICBJIHRoaW5rIHRoYXQgdGhlIHNlcnZlciBleHBlY3RzIHRvIGJlCmFibGUgdG8gZ3JhYiB0aGUgZmVlZCBhbmQgc2VlIHRoZSBmZWVkJmFtcDsjMzk7cyBhY3R1YWwgVVJMIGluCnRoZSBsaW5rIHJlbD0mYW1wO3F1b3Q7c2VsZiZhbXA7cXVvdDssIGJ1dCB0aGUgZGVmYXVsdCB2YWx1ZSBmb3IgdGhhdCBkcm9wcwp0aGUgOnBvcnQgZnJvbSB0aGUgVVJMLCBhbmQgSSBjYW5ub3QgZm9yIHRoZSBsaWZlIG9mIG1lCmZpZ3VyZSBvdXQgaG93IHRvIGdldCB0aGUgQXRvbSBnZW5lcmF0b3IgZGVlcCBpbnNpZGUKZGphbmdvIG5vdCB0byBkbyB0aGF0LCBvciBldmVuIHdoZXJlIGl0IGlzIGRvaW5nIHRoYXQsCm9yIGV2ZW4gd2hhdCBjb2RlIGlzIHJ1bm5pbmcgdG8gZ2VuZXJhdGUgdGhlIEF0b20gZmVlZC4KKEkgdGhvdWdodCBJIGtuZXcgYnV0IEkgYWRkZWQgc29tZSBhc3NlcnQgRmFsc2Ugc3RhdGVtZW50cwphbmQgaXQga2VwdCBydW5uaW5nISkKCklnbm9yaW5nIHRoYXQgcGFydGljdWxhciBwcm9ibGVtLCBJIHdvdWxkIGFwcHJlY2lhdGUKZmVlZGJhY2sgb24gdGhlIHJpZ2h0IHdheSB0byBnZXQgdGhlIHR3byB2YWx1ZXMgYXQKdGhlIHRvcCBvZiBmZWVkcy5weSBtYXJrZWQgTk9URShyc2MpLgoKCjwvc3VtbWFyeT48L2VudHJ5PjxlbnRyeT48dGl0bGU+cmlldHZlbGQ6IGNvcnJlY3QgdGFiIGhhbmRsaW5nCjwvdGl0bGU+PGxpbmsgaHJlZj0iaHR0cDovL2NvZGVyZXZpZXcuYXBwc3BvdC5jb20vMTI0MTA2IiByZWw9ImFsdGVybmF0ZSI+PC9saW5rPjx1cGRhdGVkPjIwMDktMTAtMDNUMjM6MDI6MTcrMDA6MDA8L3VwZGF0ZWQ+PGF1dGhvcj48bmFtZT5lbWFpbC1hZGRyZXNzLXJlbW92ZWQ8L25hbWU+PC9hdXRob3I+PGlkPnVybjptZDU6MGEyYTRmMTliYjgxNTEwMWYwYmEyOTA0YWVkN2MzNWE8L2lkPjxzdW1tYXJ5IHR5cGU9Imh0bWwiPgogIFRoaXMgZml4ZXMgdGhlIGJ1Z2d5IHRhYiByZW5kZXJpbmcgdGhhdCBjYW4gYmUgc2VlbiBhdApodHRwOi8vY29kZXJldmlldy5hcHBzcG90LmNvbS8xMTYwNzUvZGlmZi8xLzIKClRoZSBmdW5kYW1lbnRhbCBwcm9ibGVtIHdhcyB0aGF0IHRoZSB0YWIgY29kZSB3YXMKbm90IGJlaW5nIHRvbGQgd2hhdCBjb2x1bW4gdGhlIHRleHQgYmVnYW4gaW4sIHNvIGl0CmRpZG4mYW1wOyMzOTt0IGtub3cgd2hlcmUgdG8gcHV0IHRoZSB0YWIgc3RvcHMuICBBbm90aGVyIHByb2JsZW0Kd2FzIHRoYXQgc29tZSBvZiB0aGUgY29kZSBhc3N1bWVkIHRoYXQgc3RyaW5nIGJ5dGUKb2Zmc2V0cyB3ZXJlIHRoZSBzYW1lIGFzIGNvbHVtbiBvZmZzZXRzLCB3aGljaCBpcyBvbmx5CnRydWUgaWYgdGhlcmUgYXJlIG5vIHRhYnMuCgpJbiB0aGUgcHJvY2VzcyBvZiBmaXhpbmcgdGhpcywgSSBjbGVhbmVkIHVwIHRoZSBhcmd1bWVudHMKdG8gRm9sZCBhbmQgRXhwYW5kVGFicyBhbmQgcmVuYW1lZCB0aGVtIEJyZWFrIGFuZApfRXhwYW5kVGFicyBzbyB0aGF0IEkgY291bGQgYmUgc3VyZSB0aGF0IEkgZm91bmQgYWxsIHRoZQpjYWxsIHNpdGVzLiAgSSBhbHNvIHdhbnRlZCB0byB2ZXJpZnkgdGhhdCBFeHBhbmRUYWJzIHdhcwpub3QgYmVpbmcgdXNlZCBmcm9tIG91dHNpZGUgaW50cmFfcmVnaW9uX2RpZmYucHkuCgoKPC9zdW1tYXJ5PjwvZW50cnk+PC9mZWVkPiAJICAgYAoKdHlwZSBGZWVkIHN0cnVjdCB7CglYTUxOYW1lIE5hbWUgICAgICBgeG1sOiJodHRwOi8vd3d3LnczLm9yZy8yMDA1L0F0b20gZmVlZCJgCglUaXRsZSAgIHN0cmluZyAgICBgeG1sOiJ0aXRsZSJgCglJRCAgICAgIHN0cmluZyAgICBgeG1sOiJpZCJgCglMaW5rICAgIFtdTGluayAgICBgeG1sOiJsaW5rImAKCVVwZGF0ZWQgdGltZS5UaW1lIGB4bWw6InVwZGF0ZWQsYXR0ciJgCglBdXRob3IgIFBlcnNvbiAgICBgeG1sOiJhdXRob3IiYAoJRW50cnkgICBbXUVudHJ5ICAgYHhtbDoiZW50cnkiYAp9Cgp0eXBlIEVudHJ5IHN0cm50OChvdGhlcikpCgkJb3V0LldyaXRlMTYodWludDE2KHNobmR4KSkKCQlzeW1TaXplICs9IEVMRjMyU1lNU0laRQoJfQp9CgpmdW5jIHB1dGVsZnN5bShjdHh0ICpMaW5rLCB4IGxvYWRlci5TeW0sIHR5cCBlbGYuU3ltVHlwZSwgY3VyYmluZCBlbGYuU3ltQmluZCkgewoJbGRyIDo9IGN0eHQubG9hZGVyCglhZGRyIDo9IGxkci5TeW1WYWx1ZSh4KQoJc2l6ZSA6PSBsZHIuU3ltU2l6ZSh4KQoKCXhvIDo9IHgKCWlmIGxkci5PdXRlclN5bSh4KSAhPSAwIHsKCQl4byA9IGxkci5PdXRlclN5bSh4KQoJfQoJeG90IDo9IGxkci5TeW1UeXBlKHhvKQoJeG9zZWN0IDo9IGxkci5TeW1TZWN0KHhvKQoKCXZhciBlbGZzaG51bSBlbGYuU2VjdGlvbkluZGV4CglpZiB4b3QgPT0gc3ltLlNEWU5JTVBPUlQgfHwgeG90ID09IHN5bS5TSE9TVE9CSiB8fCB4b3QgPT0gc3ltLlNVTkRFRkVYVCB7CgkJZWxmc2hudW0gPSBlbGYuU0hOX1VOREVGCgkJc2l6ZSA9IDAKCX0gZWxzZSB7CgkJaWYgeG9zZWN0ID09IG5pbCB7CgkJCWxkci5FcnJvcmYoeCwgIm1pc3Npbmcgc2VjdGlvbiBpbiBwdXRlbGZzeW0iKQoJCQlyZXR1cm4KCQl9CgkJaWYgeG9zZWN0LkVsZnNlY3QgPT0gbmlsIHsKCQkJbGRyLkVycm9yZih4LCAibWlzc2luZyBFTEYgc2VjdGlvbiBpbiBwdXRlbGZzeW0iKQoJCQlyZXR1cm4KCQl9CgkJZWxmc2hudW0gPSBlbGZTaGRyU2hudW0oeG9zZWN0LkVsZnNlY3QuKCpFbGZTaGRyKSkKCX0KCglzbmFtZSA6PSBsZHIuU3ltRXh0bmFtZSh4KQoJc25hbWUgPSBtYW5nbGVBQklOYW1lKGN0eHQsIGxkciwgeCwgc25hbWUpCgoJLy8gT25lIHBhc3MgZm9yIGVhY2ggYmluZGluZzogZWxmLlNUQl9MT0NBTCwgZWxmLlNUQl9HTE9CQUwsCgkvLyBtYXliZSBvbmUgZGF5IGVsZi5TVEJfV0VBSy4KCWJpbmQgOj0gZWxmLlNUQl9HTE9CQUwKCWlmIGxkci5Jc0ZpbGVMb2NhbCh4KSAmJiAhaXNTdGF0aWNUbXAoc25hbWUpIHx8IGxkci5BdHRyVmlzaWJpbGl0eUhpZGRlbih4KSB8fCBsZHIuQXR0ckxvY2FsKHgpIHsKCQkvLyBTdGF0aWMgdG1wIGlzIHBhY2thZ2UgbG9jYWwsIGJ1dCBhIHBhY2thZ2UgY2FuIGJlIHNoYXJlZCBhbW9uZyBtdWx0aXBsZSBEU09zLgoJCS8vIFRoZXkgbmVlZCB0byBoYXZlIGEgc2luZ2xlIHZpZXcgb2YgdGhlIHN0YXRpYyB0bXAgdGhhdCBhcmUgd3JpdGFibGUuCgkJYmluZCA9IGVsZi5TVEJfTE9DQUwKCX0KCgkvLyBJbiBleHRlcm5hbCBsaW5raW5nIG1vZGUsIHdlIGhhdmUgdG8gaW52b2tlIGdjYyB3aXRoIC1yZHluYW1pYwoJLy8gdG8gZ2V0IHRoZSBleHBvcnRlZCBzeW1ib2xzIHB1dCBpbnRvIHRoZSBkeW5hbWljIHN5bWJvbCB0YWJsZS4KCS8vIFRvIGF2b2lkIGZpbGxpbmcgdGhlIGR5bmFtaWMgdGFibGUgd2l0aCBsb3RzIG9mIHVubmVjZXNzYXJ5IHN5bWJvbHMsCgkvLyBtYXJrIGFsbCBHbyBzeW1ib2xzIGxvY2FsIChub3QgZ2xvYmFsKSBpbiB0aGUgZmluYWwgZXhlY3V0YWJsZS4KCS8vIEJ1dCB3aGVuIHdlJ3JlIGR5bmFtaWNhbGx5IGxpbmtpbmcsIHdlIG5lZWQgYWxsIHRob3NlIGdsb2JhbCBzeW1ib2xzLgoJaWYgIWN0eHQuRHlubGlua2luZ0dvKCkgJiYgY3R4dC5Jc0V4dGVybmFsKCkgJiYgIWxkci5BdHRyQ2dvRXhwb3J0U3RhdGljKHgpICYmIGVsZnNobnVtICE9IGVsZi5TSE5fVU5ERUYgewoJCWJpbmQgPSBlbGYuU1RCX0xPQ0FMCgl9CgoJaWYgY3R4dC5MaW5rTW9kZSA9PSBMaW5rRXh0ZXJuYWwgJiYgZWxmc2hudW0gIT0gZWxmLlNITl9VTkRFRiB7CgkJYWRkciAtPSBpbnQ2NCh4b3NlY3QuVmFkZHIpCgl9CglvdGhlciA6PSBpbnQoZWxmLlNUVl9ERUZBVUxUKQoJaWYgbGRyLkF0dHJWaXNpYmlsaXR5SGlkZGVuKHgpIHsKCQkvLyBUT0RPKG13aHVkc29uKTogV2Ugb25seSBzZXQgQXR0clZpc2liaWxpdHlIaWRkZW4gaW4gbGRlbGYsIGkuZS4gd2hlbgoJCS8vIGludGVybmFsbHkgbGlua2luZy4gQnV0IFNUVl9ISURERU4gdmlzaWIsICJhIn0sCgl7YCfimLknYCwgIuKYuSJ9LAoJe2AnXGEnYCwgIlxhIn0sCgl7YCdceDEwJ2AsICJceDEwIn0sCgl7YCdcMzc3J2AsICJcMzc3In0sCgl7YCdcdTEyMzQnYCwgIlx1MTIzNCJ9LAoJe2AnXFUwMDAxMDExMSdgLCAiXFUwMDAxMDExMSJ9LAoJe2AnXHQnYCwgIlx0In0sCgl7YCcgJ2AsICIgIn0sCgl7YCdcJydgLCAiJyJ9LAoJe2AnIidgLCAiXCIifSwKCgl7ImBgIiwgYGB9LAoJeyJgYWAiLCBgYWB9LAoJeyJgYWJjYCIsIGBhYmNgfSwKCXsiYOKYumAiLCBg4pi6YH0sCgl7ImBoZWxsbyB3b3JsZGAiLCBgaGVsbG8gd29ybGRgfSwKCXsiYFxceEZGYCIsIGBceEZGYH0sCgl7ImBcXDM3N2AiLCBgXDM3N2B9LAoJeyJgXFxgIiwgYFxgfSwKCXsiYFxuYCIsICJcbiJ9LAoJeyJgCWAiLCBgCWB9LAoJeyJgIGAiLCBgIGB9LAoJeyJgYVxyYmAiLCAiYWIifSwKfQoKdmFyIG1pc3F1b3RlZCA9IFtdc3RyaW5newoJYGAsCglgImAsCglgImFgLAoJYCInYCwKCWBiImAsCglgIlwiYCwKCWAiXDkiYCwKCWAiXDE5ImAsCglgIlwxMjkiYCwKCWAnXCdgLAoJYCdcOSdgLAoJYCdcMTknYCwKCWAnXDEyOSdgLAoJYCdhYidgLAoJYCJceDEhImAsCglgIlxVMTIzNDU2NzgiYCwKCWAiXHoiYCwKCSJgIiwKCSJgeHh4IiwKCSJgYHhcciIsCgkiYFwiIiwKCWAiXCciYCwKCWAnXCInYCwKCSJcIlxuXCIiLAoJIlwiXFxuXG5cIiIsCgkiJ1xuJyIsCglgIlx1ZGVhZCJgLAoJYCJcdWQ4M2RcdWRlNGYiYCwKfQoKZnVuYyBUZXN0VW5xdW90ZSh0ICp0ZXN0aW5nLlQpIHsKCWZvciBfLCB0dCA6PSByYW5nZSB1bnF1b3RldGVzdHMgewoJCXRlc3RVbnF1b3RlKHQsIHR0LmluLCB0dC5vdXQsIG5pbCkKCX0KCWZvciBfLCB0dCA6PSByYW5nZSBxdW90ZXRlc3RzIHsKCQl0ZXN0VW5xdW90ZSh0LCB0dC5vdXQsIHR0LmluLCBuaWwpCgl9Cglmb3IgXywgcyA6PSByYW5nZSBtaXNxdW90ZWQgewoJCXRlc3RVbnF1b3RlKHQsIHMsICIiLCBFcnJTeW50YXgpCgl9Cn0KCi8vIElzc3VlIDIzNjg1OiBpbnZhbGlkIFVURi04IHNob3VsZCBub3QgZ28gdGhyb3VnaCB0aGUgZmFzdCBwYXRoLgpmdW5jIFRlc3RVbnF1b3RlSW52YWxpZFVURjgodCAqdGVzdGluZy5UKSB7Cgl0ZXN0cyA6PSBbXXN0cnVjdCB7CgkJaW4gc3RyaW5nCgoJCS8vIG9uZSBvZjoKCQl3YW50ICAgIHN0cmluZwoJCXdhbnRFcnIgZXJyb3IKCX17CgkJe2luOiBgImZvbyJgLCB3YW50OiAiZm9vIn0sCgkJe2luOiBgImZvb2AsIHdhbnRFcnI6IEVyclN5bnRheH0sCgkJe2luOiBgImAgKyAiXHhjMCIgKyBgImAsIHdhbnQ6ICJceGVmXHhiZlx4YmQifSwKCQl7aW46IGAiYWAgKyAiXHhjMCIgKyBgImAsIHdhbnQ6ICJhXHhlZlx4YmZceGJkIn0sCgkJe2luOiBgIlx0YCArICJceGMwIiArIGAiYCwgd2FudDogIlx0XHhlZlx4YmZceGJkIn0sCgl9Cglmb3IgXywgdHQgOj0gcmFuZ2UgdGVzdHMgewoJCXRlc3RVbnF1b3RlKHQsIHR0LmluLCB0dC53YW50LCB0dC53YW50RXJyKQoJfQp9CgpmdW5jIHRlc3RVbnF1b3RlKHQgKnRlc3RpbmcuVCwgaW4sIHdhbnQgc3RyaW5nLCB3YW50RXJyIGVycm9yKSB7CgkvLyBUZXN0IFVucXVvdGUuCglnb3QsIGdvdEVyciA6PSBVbnF1b3RlKGluKQoJaWYgZ290ICE9IHdhbnQgfHwgZ290RXJyICE9IHdhbnRFcnIgewoJCXQuRXJyb3JmKCJVbnF1b3RlKCVxKSA9ICglcSwgJXYpLCB3YW50ICglcSwgJXYpIiwgaW4sIGdvdCwgZ290RXJyLCB3YW50LCB3YW50RXJyKQoJfQoKCS8vIFRlc3QgUXVvdGVkUHJlZml4LgoJLy8gQWRkaW5nIGFuIGFyYml0cmFyeSBzdWZmaXggc2hvdWxkIG5vdCBjaGFuZ2UgdGhlIHJlc3VsdCBvZiBRdW90ZWRQcmVmaXgKCS8vIGFzc3VtZSB0aGF0IHRoZSBzdWZmaXggZG9lc24ndCBhY2NpZGVudGFsbHkgdGVybWluYXRlIGEgdHJ1bmNhdGVkIGlucHV0LgoJaWYgZ290RXJyID09IG5pbCB7CgkJd2FudCA9IGluCgl9CglzdWZmaXggOj0gIlxuXHJcXFwiYCciIC8vIHNwZWUgPGEgaHJlZj1cIi9oZWxwXCI+L2hlbHA8L2E+LlxuXG4iKQoKCWZtdC5GcHJpbnRmKHcsICI8Yj5jYWNoZTwvYj5cbiIpCgoJdHcgOj0gdGFid3JpdGVyLk5ld1dyaXRlcih3LCAxLCA4LCAxLCAnXHQnLCAwKQoJZXJyIDo9IGZpbGVwYXRoLldhbGtEaXIocy5zY3JpcHREaXIsIGZ1bmMocGF0aCBzdHJpbmcsIGQgZnMuRGlyRW50cnksIGVyciBlcnJvcikgZXJyb3IgewoJCWlmIGVyciAhPSBuaWwgewoJCQlyZXR1cm4gZXJyCgkJfQoJCWlmIGZpbGVwYXRoLkV4dChwYXRoKSAhPSAiLnR4dCIgewoJCQlyZXR1cm4gbmlsCgkJfQoKCQlyZWwsIGVyciA6PSBmaWxlcGF0aC5SZWwocy5zY3JpcHREaXIsIHBhdGgpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXJldHVybiBlcnIKCQl9CgkJaGFzaFRpbWUgOj0gIihub3QgbG9hZGVkKSIKCQlzdGF0dXMgOj0gIiIKCQlpZiByaSwgb2sgOj0gcy5zY3JpcHRDYWNoZS5Mb2FkKHJlbCk7IG9rIHsKCQkJciA6PSByaS4oKnNjcmlwdFJlc3VsdCkKCQkJci5tdS5STG9jaygpCgkJCWRlZmVyIHIubXUuUlVubG9jaygpCgoJCQlpZiAhci5oYXNoVGltZS5Jc1plcm8oKSB7CgkJCQloYXNoVGltZSA9IHIuaGFzaFRpbWUuRm9ybWF0KHRpbWUuUkZDMzMzOSkKCQkJfQoJCQlpZiByLmVyciA9PSBuaWwgewoJCQkJc3RhdHVzID0gIm9rIgoJCQl9IGVsc2UgewoJCQkJc3RhdHVzID0gci5lcnIuRXJyb3IoKQoJCQl9CgkJfQoJCWZtdC5GcHJpbnRmKHR3LCAiJXNcdCVzXHQlc1xuIiwgcmVsLCBoYXNoVGltZSwgc3RhdHVzKQoJCXJldHVybiBuaWwKCX0pCgl0dy5GbHVzaCgpCgoJaWYgZXJyICE9IG5pbCB7CgkJZm10LkZwcmludGxuKHcsIGVycikKCX0KfQoKLy8gaGVscCBzZXJ2ZXMgYSBwbGFpbi10ZXh0IHN1bW1hcnkgb2YgdGhlIHNlcnZlcidzIHN1cHBvcnRlZCBzY3JpcHQgbGFuZ3VhZ2UuCmZ1bmMgKHMgKlNlcnZlcikgaGVscCh3IGh0dHAuUmVzcG9uc2VXcml0ZXIsIHJlcSAqaHR0cC5SZXF1ZXN0KSB7CglzdCwgZXJyIDo9IHMubmV3U3RhdGUocmVxLkNvbnRleHQoKSwgcy53b3JrRGlyKQoJaWYgZXJyICE9IG5pbCB7CgkJaHR0cC5FcnJvcih3LCBlcnIuRXJyb3IoKSwgaHR0cC5TdGF0dXNJbnRlcm5hbFNlcnZlckVycm9yKQoJCXJldHVybgoJfQoKCXNjcmlwdExvZyA6PSBuZXcoc3RyaW5ncy5CdWlsZGVyKQoJZXJyID0gcy5lbmdpbmUuRXhlY3V0ZShzdCwgImhlbHAiLCBidWZpby5OZXdSZWFkZXIoc3RyaW5ncy5OZXdSZWFkZXIoImhlbHAiKSksIHNjcmlwdExvZykKCWlmIGVyciAhPSBuaWwgewoJCWh0dHAuRXJyb3IodywgZXJyLkVycm9yKCksIGh0dHAuU3RhdHVzSW50ZXJuYWxTZXJ2ZXJFcnJvcikKCQlyZXR1cm4KCX0KCgl3LkhlYWRlcigpLlNldCgiQ29udGVudC1UeXBlIiwgInRleHQvcGxhaW47IGNoYXJzZXQ9VVRGLTgiKQoJaW8uV3JpdGVTdHJpbmcodywgc2NyaXB0TG9nLlN0cmluZygpKQp9Ci8vIENvcHlyaWdodCAyMDIyIFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIGNvbXBhcmlzb25zCgp0eXBlICgKCUIgaW50IC8vIGJhc2ljIHR5cGUgcmVwcmVzZW50YXRpdmUKCUEgWzEwXWZ1bmMoKQoJTCBbXWJ5dGUKCVMgc3RydWN0eyBmIFtdYnl0ZSB9CglQICpTCglGIGZ1bmMoKQoJSSBpbnRlcmZhY2V7fQoJTSBtYXBbc3RyaW5nXWludAoJQyBjaGFuIGludAopCgp2YXIgKAoJYiBCCglhIEEKCWwgTAoJcyBTCglwIFAKCWYgRgoJaSBJCgltIE0KCWMgQwopCgpmdW5jIF8oKSB7CglfID0gbmlsID09IG5pbCAvLyBFUlJPUiAib3BlcmF0b3IgPT0gbm90IGRlZmluZWQgb24gdW50eXBlZCBuaWwiCglfID0gYiA9PSBiCglfID0gYSAvKiBFUlJPUiAiQSBjYW5ub3QgYmUgY29tcGFyZWQiICovID09IC5jb20vdXNuaXN0Z292L0FDVlAtU2VydmVyL2Jsb2IvZmI0NGRjZS9nZW4tdmFsL2pzb24tZmlsZXMvY3RyRFJCRy0xLjAvcHJvbXB0Lmpzb24jTDQ0NDctTDQ0ODIKCgllbnRyb3B5SW5wdXQgOj0gZGVjb2RlSGV4KHQsICI5RkNCQjRDQ0MwMTM1QzQ4NEJERUQwNjFEQTlGRDcwNzQ4NjgyRkU4NDE2NkI5N0ZGNTNGOUFBMTkwOUIyRTk1RDNENTI5QzBGNDUzQjNBQzU3NUQxMkFBNDQxQ0M1Q0QiKQoJcGVyc29TdHJpbmcgOj0gZGVjb2RlSGV4KHQsICIyQzlGRUQwQjM5NTU2Q0RCRTY5OUVCQ0EyQTBFQzdFRUNCMjg3RTg3NDQ0NzUwNTBDNTcyRkE4QUU5RUQwQTRBN0Q2RjFDQUJGMUM0Mjc4NTMyRkIyMEFGN0Q2NEJEMzIiKQoJcmVzZWVkRW50cm9weSA6PSBkZWNvZGVIZXgodCwgIjkxM0MwREExOUIwMTBFRERENTVBN0E0RjNGNzEzRUVGNUIxNTM0RDM0MzYwQTdFQzM3NkFFNzFBNkIzNDAwNDNDQzc3MjZGNzYyQ0I4NTM0NTNGMzk5QjNBNjQ1MDYyQSIpCglyZXNlZWRBZGRpdGlvbmFsIDo9IGRlY29kZUhleCh0LCAiMkQ5RDRFQzE0MUEyMkU2Q0QyRjZFRTRGNjcxOUNGNkJERjk1Q0ZFNTBCOEQ1RUE2Qzg3RDM4QjRCODcyNzA2RkZGODBCMDM4MEJCOTBFOUM0MkQxMUQ2NTI2RTU2QzI5IikKCWFkZGl0aW9uYWwxIDo9IGRlY29kZUhleCh0LCAiQTY0MkYwNkQzMjc4MjhGM0U4NDU2NEEzRTM3RDYwQzE1NzA3M0I5NTg2NENBMDc5ODFCMDE4OTY2OEEwRDk3OENENURDNjhGMDY4MDFDRUZGMERDODM5QTMxMkIwMjhFIikKCWFkZGl0aW9uYWwyIDo9IGRlY29kZUhleCh0LCAiOURCMTRCQUJGQTkxMDdDODhCQTkyMDczQzBCNEE2NUU4OTE0N0VBMDZENzRCODk0MTQyOTc5NDgyRjQ1MjkxNUIzNUI1NjM2RjlCOEE5NTE3NTk3MzVBREU3QzhENUQxIikKCXJldHVybmVkQml0cyA6PSBkZWNvZGVIZXgodCwgIkYxMEM2NDU2ODNGRjAxMzEyNTQwNTJFRDRDNjk4MTIyQjQ2QjU2MzY1NEMyOUQ3MjhBQzE5MUNBNEFBRUZFNjQ5RUVGRTRDNkZDMzNCMjVCQjczOTI5NERENUNGNTc4MDk5Rjg1NkM5OEQ5ODAwMENCRjk3MUYxRTZFQTkwMDgyMkZGOEMxMTAxMThGNjUyMDQ3MTc0NEQzRjhBM0Y1QzdENTY4NDk0MjQwRTU3RjU0ODhBRjlDOUY5RjRFNzMyMkY1NkNDRDg0M0MwREJGQ0U5MTcwQzAyRTIwNTM4OTQyMDUyN0YyM0VEQjMzNjlEOUZDQzVFMzQ5MDFCNUJBNEVCNzFCOTczRkM3OTgyRkZFMDg5OUZGN0ZFNTNFRTBDNEY1MUEzRUY5M0VGOUM2RDREMjc5REQ3NTM2Rjg3NzZCRTk0QUFBMDVFODlFRjZFNkFFRTg4MzJCNEI0MkZGQ0E1RkI5MUVDMDI3M0Y5RUY5NDU4NjU1MTI4ODlCMEM1RUUxNDFEMUIzOERGODI3RDJBNjk0ODM1NTYxNjI4QzZGOUIwOTNBMDFBODM1RjA3QURCQjlFMDNGRUJGOTMzODlFOEYzQjg2RTFFMEFCRjFGOTk1OEZBMjg2QUQ5OTUyODlDMkY2MDZEMUE5MDQzQTE2NkMxQUZFOEQwMDc2OUM3MTI2NTA4MTlDOTA2OEE0QkQyMjcxN0M5ODMzODM5NUE3QkE2RTk1QjUxNzhCRkJGNEVGQjBGMDVBOTE3MTNCQThCRjIxMjdBNkJBMUVERkE2RDFDQUIwNUMwM0VFMEQyQUZFMURBNEVCOEYyQzU3OUVDODcyRkY0QjYwMjAyN0VGNEJEQ0YyRjRCMDE0MjNGOEU2MDBBMTNEN0NBQ0I2QUI4MzI2M0JBNThGOTA3Njk0QUY2MTRBNjcyNEZEMEU0QzYyN0EwRDkxRERDNjcxNkM2OTdGQUNFNkY0ODA4QTRGMzdCNzMxREU0RTBDRDQ3NjZDRUFEQUFBRjQ3OTkyNTA1Mjk5QzcyQUMxQTZFOUE4MzM1QjhEN0U1MDFCMzg0MTE4OEQwREE0REU1MjY3Njc0NDQ0REMyQjBDRjlGMDEwNzU2RkE4NjVBMjVDQTNGMUIyNEMzNEU4NDVCMjI1OTkyNkI2QTg2N0E3Njg0REU2OEE2MTM3QzRGQjBGNDdBMkU1NEFFOUU2NDU1QkVCQTBCMEE5NjI5NjQ0RkU5RTM3OEVFOTUzODY0NDNCQTk3NzEyNEZGRDExOTJFOUY0NjA2ODRDN0IwOUZBOTlGNUY5M0YwNEY1NkZENzk1NUUwNDIxODc4ODdDRTY5NkYxOTM0MDE3RTQ1OEIxNkI1QzkiKQoKCS8vIFdlIGRvbid0IHN1cHBvcnQgcGVyc29uYWxpemFvKDB4MjYpCglFTk9UU1VQICAgICAgICAgPSBFcnJubygweDViKQoJRU5PVFRZICAgICAgICAgID0gRXJybm8oMHgxOSkKCUVOWElPICAgICAgICAgICA9IEVycm5vKDB4NikKCUVPUE5PVFNVUFAgICAgICA9IEVycm5vKDB4MmQpCglFT1ZFUkZMT1cgICAgICAgPSBFcnJubygweDU3KQoJRU9XTkVSREVBRCAgICAgID0gRXJybm8oMHg1ZSkKCUVQRVJNICAgICAgICAgICA9IEVycm5vKDB4MSkKCUVQRk5PU1VQUE9SVCAgICA9IEVycm5vKDB4MmUpCglFUElQRSAgICAgICAgICAgPSBFcnJubygweDIwKQoJRVBST0NMSU0gICAgICAgID0gRXJybm8oMHg0MykKCUVQUk9DVU5BVkFJTCAgICA9IEVycm5vKDB4NGMpCglFUFJPR01JU01BVENIICAgPSBFcnJubygweDRiKQoJRVBST0dVTkFWQUlMICAgID0gRXJybm8oMHg0YSkKCUVQUk9UTyAgICAgICAgICA9IEVycm5vKDB4NWYpCglFUFJPVE9OT1NVUFBPUlQgPSBFcnJubygweDJiKQoJRVBST1RPVFlQRSAgICAgID0gRXJybm8oMHgyOSkKCUVSQU5HRSAgICAgICAgICA9IEVycm5vKDB4MjIpCglFUkVNT1RFICAgICAgICAgPSBFcnJubygweDQ3KQoJRVJPRlMgICAgICAgICAgID0gRXJybm8oMHgxZSkKCUVSUENNSVNNQVRDSCAgICA9IEVycm5vKDB4NDkpCglFU0hVVERPV04gICAgICAgPSBFcnJubygweDNhKQoJRVNPQ0tUTk9TVVBQT1JUID0gRXJybm8oMHgyYykKCUVTUElQRSAgICAgICAgICA9IEVycm5vKDB4MWQpCglFU1JDSCAgICAgICAgICAgPSBFcnJubygweDMpCglFU1RBTEUgICAgICAgICAgPSBFcnJubygweDQ2KQoJRVRJTUVET1VUICAgICAgID0gRXJybm8oMHgzYykKCUVUT09NQU5ZUkVGUyAgICA9IEVycm5vKDB4M2IpCglFVFhUQlNZICAgICAgICAgPSBFcnJubygweDFhKQoJRVVTRVJTICAgICAgICAgID0gRXJybm8oMHg0NCkKCUVXT1VMREJMT0NLICAgICA9IEVycm5vKDB4MjMpCglFWERFViAgICAgICAgICAgPSBFcnJubygweDEyKQopCgovLyBTaWduYWxzCmNvbnN0ICgKCVNJR0FCUlQgICA9IFNpZ25hbCgweDYpCglTSUdBTFJNICAgPSBTaWduYWwoMHhlKQoJU0lHQlVTICAgID0gU2lnbmFsKDB4YSkKCVNJR0NITEQgICA9IFNpZ25hbCgweDE0KQoJU0lHQ09OVCAgID0gU2lnbmFsKDB4MTMpCglTSUdFTVQgICAgPSBTaWduYWwoMHg3KQoJU0lHRlBFICAgID0gU2lnbmFsKDB4OCkKCVNJR0hVUCAgICA9IFNpZ25hbCgweDEpCglTSUdJTEwgICAgPSBTaWduYWwoMHg0KQoJU0lHSU5GTyAgID0gU2lnbmFsKDB4MWQpCglTSUdJTlQgICAgPSBTaWduYWwoMHgyKQoJU0lHSU8gICAgID0gU2lnbmFsKDB4MTcpCglTSUdJT1QgICAgPSBTaWduYWwoMHg2KQoJU0lHS0lMTCAgID0gU2lnbmFsKDB4OSkKCVNJR1BJUEUgICA9IFNpZ25hbCgweGQpCglTSUdQUk9GICAgPSBTaWduYWwoMHgxYikKCVNJR1FVSVQgICA9IFNpZ25hbCgweDMpCglTSUdTRUdWICAgPSBTaWduYWwoMHhiKQoJU0lHU1RPUCAgID0gU2lnbmFsKDB4MTEpCglTSUdTWVMgICAgPSBTaWduYWwoMHhjKQoJU0lHVEVSTSAgID0gU2lnbmFsKDB4ZikKCVNJR1RIUiAgICA9IFNpZ25hbCgweDIwKQoJU0lHVFJBUCAgID0gU2lnbmFsKDB4NSkKCVNJR1RTVFAgICA9IFNpZ25hbCgweDEyKQoJU0lHVFRJTiAgID0gU2lnbmFsKDB4MTUpCglTSUdUVE9VICAgPSBTaWduYWwoMHgxNikKCVNJR1VSRyAgICA9IFNpZ25hbCgweDEwKQoJU0lHVVNSMSAgID0gU2lnbmFsKDB4MWUpCglTSUdVU1IyICAgPSBTaWduYWwoMHgxZikKCVNJR1ZUQUxSTSA9IFNpZ25hbCgweDFhKQoJU0lHV0lOQ0ggID0gU2lnbmFsKDB4MWMpCglTSUdYQ1BVICAgPSBTaWduYWwoMHgxOCkKCVNJR1hGU1ogICA9IFNpZ25hbCgweDE5KQopCgovLyBFcnJvciB0YWJsZQp2YXIgZXJyb3JzID0gWy4uLl1zdHJpbmd7CgkxOiAgIm9wZXJhdGlvbiBub3QgcGVybWl0dGVkIiwKCTI6ICAibm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeSIsCgkzOiAgIm5vIHN1Y2ggcHJvY2VzcyIsCgk0bWUgYSBtZW1vcnkgYWRkcmVzcyAoY2hvc2VuCgkvLyBieSB0aGUgcHJvZ3JhbSBsaW5rZXIpIHRoYXQgdGhlIGR5bmFtaWMgbGlua2VyIHdpbGwgZmlsbCB3aXRoIHRoZQoJLy8gb2Zmc2V0IGZyb20gdGhlIHRocmVhZCBsb2NhbCBiYXNlLgoJQ19UTFNfSUUKCglDX1RFWFRTSVpFCgoJQ19HT0sKCglDX05DTEFTUyAvKiBtdXN0IGJlIHRoZSBsYXN0ICovCikKCmNvbnN0ICgKCUFBTkQgPSBvYmouQUJhc2VBUk0gKyBvYmouQV9BUkNIU1BFQ0lGSUMgKyBpb3RhCglBRU9SCglBU1VCCglBUlNCCglBQURECglBQURDCglBU0JDCglBUlNDCglBVFNUCglBVEVRCglBQ01QCglBQ01OCglBT1JSCglBQklDCgoJQU1WTgoKCS8qCgkgKiBEbyBub3QgcmVvcmRlciBvciBmcmFnbWVudCB0aGUgY29uZGl0aW9uYWwgYnJhbmNoCgkgKiBvcGNvZGVzLCBvciB0aGUgcHJlZGljYXRpb24gY29kZSB3aWxsIGJyZWFrCgkgKi8KCUFCRVEKCUFCTkUKCUFCQ1MKCUFCSFMKCUFCQ0MKCUFCTE8KCUFCTUkKCUFCUEwKCUFCVlMKCUFCVkMKCUFCSEkKCUFCTFMKCUFCR0UKCUFCTFQKCUFCR1QKCUFCTEUKCglBTU9WV0QKCUFNT1ZXRgoJQU1PVkRXCglBTU9WRlcKCUFNT1ZGRAoJQU1PVkRGCglBTU9WRgoJQU1PVkQKCglBQ01QRgoJQUNNUEQKCUFBRERGCglBQURERAoJQVNVQkYKCUFTVUJECglBTVVMRgoJQU1VTEQKCUFOTVVMRgoJQU5NVUxECglBTVVMQUYKCUFNVUxBRAoJQU5NVUxBRgoJQU5NVUxBRAoJQU1VTFNGCglBTVVMU0QKCUFOTVVMU0YKCUFOTVVMU0QKCUFGTVVMQUYKCUFGTVVMQUQKCUFGTk1VTEFGCglBRk5NVUxBRAoJQUZNVUxTRgoJQUZNVUxTRAoJQUZOTVVMU0YKCUFGTk1VTFNECglBRElWRgoJQURJVkQKCUFTUVJURgoJQVNRUlRECglBQUJTRgoJQUFCU0QKCUFORUdGCglBTkVHRAoKCUFTUkwKCUFTUkEKCUFTTEwKCUFNVUxVCglBRElWVQoJQU1VTAoJQU1NVUwKCUFESVYKCUFNT0QKCUFNT0RVCglBRElWSFcKCUFESVZVSFcKCglBTU9WQgoJQU1PVkJTCglBTU9WQlUKCUFNT1ZICglBTU9WSFMKCUFNT1ZIVQoJQU1PVlcKCUFNT1ZNCglBU1dQQlUKCUFTV1BXCgoJQVJGRQoJQVNXSQoJQU1VTEEKCUFNVUxTCglBTU1VTEEKCUFNTVVMUwoKCUFXT1JECgoJQU1VTEwKCUFNVUxBTAoJQU1VTExVCglBTVVMQUxVCgoJQUJYCglBQlhSRVQKCUFEV09SRAoKCUFMRFJFWAoJQVNUUkVYCglBTERSRVhECglBTERSRVhCCglBU1RSRVhECglBU1RSRVhCCgoJQURNQgoKCUFQTEQKCglBQ0xaCglBUkVWCglBUkVWMTYKCUFSRVZTSAoJQVJCSVQKCglBWFRBQgoJQVhUQUgKCUFYVEFCVQoJQVhUQUhVCgoJQUJGWAoJQUJGWFUKCUFCRkMKCUFCRkkKCglBTVVMV1QKCUFNVUxXQgoJQU1VTEJCCglBTVVMQVdUCglBTVVMQVdCCglBTVVMQUJCCgoJQU1SQyAvLyBNUkMvTUNSCgoJQUxBU1QKCgkvLyBhbGlhc2VzCglBQiAgPSBvYmouQUpNUAoJQUJMID0gb2JqLkFDQUxMCikKCi8qIHNjb25kIGJ5dGUgKi8KY29uc3QgKAoJQ19TQ09ORCA9ICgxIDw8IDQpIC0gMQoJQ19TQklUICA9IDEgPDwgNAoJQ19QQklUICA9IDEgPDwgNQoJQ19XQklUICA9IDEgPDwgNgoJQ19GQklUICA9IDEgPDwgNyAvKiBwc3IgZmxhZ3Mtb25seSAqLwoJQ19VQklUICA9IDEgPDwgNyAvKiB1cCBiaXQsIHVuc2lnbmVkIGJpdCAqLwoKCS8vIFRoZXNlIGNvbnN0YW50cyBhcmUgdGhlIEFSTSBjb25kaXRpb24gY29kZXMgZW5jb2RpbmdzLAoJLy8gWE9SZWQgd2l0aCAxNCBzbyB0aGF0IENfU0NPTkRfTk9ORSBoYXMgdmFsdWUgMCwKCS8vIHNvIHRoYXQgYSB6ZXJvZWQgUHJvZy5zY29uZCBtZWFucyAiYWx3YXlzIGV4ZWN1dGUiLgoJQ19TQ09ORF9YT1IgPSAxNAoKCUNfU0NPTkRfRVEgICA9IDAgXiBDX1NDT05EX1hPUgoJQ19TQ09ORF9ORSAgID0gMSBeIENfU0NPTkRfWE9SCglDX1NDT05EX0hTICAgPSAyIF4gQ19TQ09ORF9YT1IKCUNfU0NPTkRfTE8gICA9IDMgXiBDX1NDT05EX1hPUgoJQ19TQ09ORF9NSSAgID0gNCBeIENfcm5zIGlmIHRoZSB2YWx1ZSB3YXMgbWFya2VkIG9yIG5vdC4KZnVuYyAoYiAqYXRvbWljT2ZmQWRkcikgTG9hZCgpICh1aW50cHRyLCBib29sKSB7Cgl2IDo9IGIuYS5Mb2FkKCkKCXdhc01hcmtlZCA6PSBmYWxzZQoJaWYgdiA8IDAgewoJCXdhc01hcmtlZCA9IHRydWUKCQl2ID0gLXYKCX0KCXJldHVybiB1aW50cHRyKHYpICsgYXJlbmFCYXNlT2Zmc2V0LCB3YXNNYXJrZWQKfQoKLy8gYWRkclJhbmdlcyBpcyBhIGRhdGEgc3RydWN0dXJlIGhvbGRpbmcgYSBjb2xsZWN0aW9uIG9mIHJhbmdlcyBvZgovLyBhZGRyZXNzIHNwYWNlLgovLwovLyBUaGUgcmFuZ2VzIGFyZSBjb2FsZXNjZWQgZWFnZXJseSB0byByZWR1Y2UgdGhlCi8vIG51bWJlciByYW5nZXMgaXQgaG9sZHMuCi8vCi8vIFRoZSBzbGljZSBiYWNraW5nIHN0b3JlIGZvciB0aGlzIGZpZWxkIGlzIHBlcnNpc3RlbnRhbGxvYydkCi8vIGFuZCB0aHVzIHRoZXJlIGlzIG5vIHdheSB0byBmcmVlIGl0LgovLwovLyBhZGRyUmFuZ2VzIGlzIG5vdCB0aHJlYWQtc2FmZS4KdHlwZSBhZGRyUmFuZ2VzIHN0cnVjdCB7CgkvLyByYW5nZXMgaXMgYSBzbGljZSBvZiByYW5nZXMgc29ydGVkIGJ5IGJhc2UuCglyYW5nZXMgW11hZGRyUmFuZ2UKCgkvLyB0b3RhbEJ5dGVzIGlzIHRoZSB0b3RhbCBhbW91bnQgb2YgYWRkcmVzcyBzcGFjZSBpbiBieXRlcyBjb3VudGVkIGJ5CgkvLyB0aGlzIGFkZHJSYW5nZXMuCgl0b3RhbEJ5dGVzIHVpbnRwdHIKCgkvLyBzeXNTdGF0IGlzIHRoZSBzdGF0IHRvIHRyYWNrIGFsbG9jYXRpb25zIGJ5IHRoaXMgdHlwZQoJc3lzU3RhdCAqc3lzTWVtU3RhdAp9CgpmdW5jIChhICphZGRyUmFuZ2VzKSBpbml0KHN5c1N0YXQgKnN5c01lbVN0YXQpIHsKCXJhbmdlcyA6PSAoKm5vdEluSGVhcFNsaWNlKSh1bnNhZmUuUG9pbnRlcigmYS5yYW5nZXMpKQoJcmFuZ2VzLmxlbiA9IDAKCXJhbmdlcy5jYXAgPSAxNgoJcmFuZ2VzLmFycmF5ID0gKCpub3RJbkhlYXApKHBlcnNpc3RlbnRhbGxvYyh1bnNhZmUuU2l6ZW9mKGFkZHJSYW5nZXt9KSp1aW50cHRyKHJhbmdlcy5jYXApLCBnb2FyY2guUHRyU2l6ZSwgc3lzU3RhdCkpCglhLnN5c1N0YXQgPSBzeXNTdGF0CglhLnRvdGFsQnl0ZXMgPSAwCn0KCi8vIGZpbmRTdWNjIHJldHVybnMgdGhlIGZpcnN0IGluZGV4IGluIGEgc3VjaCB0aGF0IGFkZHIgaXMKLy8gbGVzcyB0aGFuIHRoZSBiYXNlIG9mIHRoZSBhZGRyUmFuZ2UgYXQgdGhhdCBpbmRleC4KZnVuYyAoYSAqYWRkclJhbmdlcykgZmluZFN1Y2MoYWRkciB1aW50cHRyKSBpbnQgewoJYmFzZSA6PSBvZmZBZGRye2FkZHJ9CgoJLy8gTmFycm93IGRvd24gdGhlIHNlYXJjaCBzcGFjZSB2aWEgYSBiaW5hcnkgc2VhcmNoCgkvLyBmb3IgbGFyZ2UgYWRkclJhbmdlcyB1bnRpbCB3ZSBoYXZlIGF0IG1vc3QgaXRlck1heAoJLy8gY2FuZGlkYXRlcyBsZWZ0LgoJY29uc3QgaXRlck1heCA9IDgKCWJvdCwgdG9wIDo9IDAsIGxlbihhLnJhbmdlcykKCWZvciB0b3AtYm90ID4gaXRlck1heCB7CgkJaSA6PSBpbnQodWludChib3QrdG9wKSA+PiAxKQoJCWlmIGEucmFuZ2VzW2ldLmNvbnRhaW5zKGJhc2UuYWRkcigpKSB7CgkJCS8vIGEucmFuZ2VzW2ldIGNvbnRhaW5zIGJhc2UsIHNvCgkJCS8vIGl0cyBzdWNjZXNzb3IgaXMgdGhlIG5leHQgaW5kZXguCgkJCXJldHVybiBpICsgMQoJCX0KCQlpZiBiYXNlLmxlc3NUaGFuKGEucmFuZ2VzW2ldLmJhc2UpIHsKCQkJLy8gSW4gdGhpcyBjYXNlIGkgbWlnaHQgYWN0dWFsbHkgYmUKCQkJLy8gdGhlIHN1Y2Nlc3NvciwgYnV0IHdlIGNhbid0IGJlIHN1cmUKCQkJLy8gdW50aWwgd2UgY2hlY2sgdGhlIG9uZXMgYmVmb3JlIGl0LgoJCQl0b3AgPSBpCgkJfSBlbHNlIHsKCQkJLy8gSW4gdGhpcyBjYXNlIHdlIGtub3cgYmFzZSBpcwoJCQkvLyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gYS5yYW5nZXNbaV0ubGltaXQtMSwKCQkJLy8gc28gaSBpcyBkZWZpbml0ZWx5IG5vZmxvdykKCUFCVlMgIC8vIEJyYW5jaCBpZiBmbG9hdCB1bm9yZGVyZWQgKGFsc28gYnJhbmNoIG9uIHN1bW1hcnkgb3ZlcmZsb3cpCglBQkROWiAvLyBEZWNyZW1lbnQgQ1RSLCBhbmQgYnJhbmNoIGlmIENUUiAhPSAwCglBQkRaICAvLyBEZWNyZW1lbnQgQ1RSLCBhbmQgYnJhbmNoIGlmIENUUiA9PSAwCglBQ01QCglBQ01QVQoJQUNNUEVRQgoJQUNOVExaVwoJQUNOVExaV0NDCglBQ1JBTkQKCUFDUkFORE4KCUFDUkVRVgoJQUNSTkFORAoJQUNSTk9SCglBQ1JPUgoJQUNST1JOCglBQ1JYT1IKCUFEQURECglBREFERFEKCUFEQ01QTwoJQURDTVBPUQoJQURDTVBVCglBRENNUFVRCglBRERJVgoJQURESVZRCglBRElWVwoJQURJVldDQwoJQURJVldWQ0MKCUFESVZXVgoJQURJVldVCglBRElWV1VDQwoJQURJVldVVkNDCglBRElWV1VWCglBRE1VTAoJQURNVUxRCglBRFNVQgoJQURTVUJRCglBTU9EVUQKCUFNT0RVVwoJQU1PRFNECglBTU9EU1cKCUFFUVYKCUFFUVZDQwoJQUVYVFNCCglBRVhUU0JDQwoJQUVYVFNICglBRVhUU0hDQwoJQUZBQlMKCUFGQUJTQ0MKCUFGQURECglBRkFERENDCglBRkFERFMKCUFGQUREU0NDCglBRkNNUE8KCUFGQ01QVQoJQUZDVElXCglBRkNUSVdDQwoJQUZDVElXWgoJQUZDVElXWkNDCglBRkRJVgoJQUZESVZDQwoJQUZESVZTCglBRkRJVlNDQwoJQUZNQURECglBRk1BRERDQwoJQUZNQUREUwoJQUZNQUREU0NDCglBRk1PVkQKCUFGTU9WRENDCglBRk1PVkRVCglBRk1PVlMKCUFGTU9WU1UKCUFGTU9WU1gKCUFGTU9WU1oKCUFGTVNVQgoJQUZNU1VCQ0MKCUFGTVNVQlMKCUFGTVNVQlNDQwoJQUZNVUwKCUFGTVVMQ0MKCUFGTVVMUwoJQUZNVUxTQ0MKCUFGTkFCUwoJQUZOQUJTQ0MKCUFGTkVHCglBRk5FR0NDCglBRk5NQURECglBRk5NQUREQ0MKCUFGTk1BRERTCglBRk5NQUREU0NDCglBRk5NU1VCCglBRk5NU1VCQ0MKCUFGTk1TVUJTCglBRk5NU1VCU0NDCglBRlJTUAoJQUZSU1BDQwoJQUZTVUIKCUFGU1VCQ0MKCUFGU1VCUwoJQUZTVUJTQ0MKCUFJU0VMCglBTU9WTVcKCUFMQkFSCglBTEhBUgoJQUxTVwoJQUxXQVIKCUFMV1NZTkMKCUFNT1ZEQlIKCUFNT1ZXQlIKCUFNT1ZCCglBTU9WQlUKCUFNT1ZCWgoJQU1PVkJaVQoJQU1PVkgKCUFNT1ZIQlIKCUFNT1ZIVQoJQU1PVkhaCglBTU9WSFpVCglBTU9WVwoJQU1PVldVCglBTU9WRkwKCUFNT1ZDUkZTCglBTVRGU0IwCglBTVRGU0IwQ0MKCUFNVEZTQjEKCUFNVEZTQjFDQwoJQU1VTEhXCglBTVVMSFdDQwoJQU1VTEhXVQoJQU1VTEhXVUNDCglBTVVMTFcKCUFNVUxMV0NDCglBTVVMTFdWQ0MKCUFNVUxMV1YKCUFOQU5ECglBTkFORENDCglBTkVHCglBTkVHQ0MKCUFORUdWQ0MKCUFORUdWCglBTk9SCglBTk9SQ0MKCUFPUgoJQU9SQ0MKCUFPUk4KCUFPUk5DQwoJQU9SSVMKCUFSRU0KCUFSRU1VCglBUkZJCglBUkxXTUkKCUFSTFdNSUNDCglBUkxXTk0KCUFSTFdOTUNDCglBQ0xSTFNMV0kKCUFTTFcKCUFTTFdDQwoJQVNSVwoJQVNSQVcKCUFTUkFXQ0MKCUFTUldDQwoJQVNUQkNDQwoJQVNUSENDQwoJQVNUU1cKCUFTVFdDQ0MKCUFTVUIKCUFTVUJDQwoJQVNVQlZDQwoJQVNVQkMKCUFTVUJDQ0MKCUFTVUJDVgoJQVNVQkNWQ0MKCUFTVUJNRQoJQVNVQk1FQ0MKCUFTVUJNRVZDQwoJQVNVQk1FVgoJQVNVQlYKCUFTVUJFCglBU1VCRUNDCglBU1VCRVYKCUFTVUJFVkNDCglBU1VCWkUKCUFTVUJaRUNDCglBU1VCWkVWQ0MKCUFTVUJaRVYKCUFTWU5DCglBWE9SCglBWE9SQ0MKCUFYT1JJUwoKCUFEQ0JGCglBRENCSQoJQURDQlNUCglBRENCVAoJQURDQlRTVAoJQURDQloKCUFFSUVJTwoJQUlDQkkKCUFJU1lOQwoJQVBURVNZTkMKCUFUTEJJRQoJQVRMQklFTAoJQVRMQlNZTkMKCUFUVwoKCUFTWVNDQUxMCglBV09SRAoKCUFSRkNJCgoJQUZDUFNHTgoJQUZDUFNHTkNDCgkvKiBvcHRpb25hbCBvbiAzMi1iaXQgKi8KCUFGUkVTCglBRlJFU0NDCglBRlJJTQoJQUZSSU1DQwoJQUZSSVAKCUFGUklQQ0MKCXQoKQoJZHNzLnRlYXJkb3duKCkKCWFmdGVyIDo9IHN3LlNvY2tldHMoKQoJaWYgbGVuKGFmdGVyKSAhPSBsZW4oYmVmb3JlKSB7CgkJdC5FcnJvcmYoImdvdCAlZDsgd2FudCAlZCIsIGxlbihhZnRlciksIGxlbihiZWZvcmUpKQoJfQp9CgovLyBEZWZpbmUgYSBwYWlyIG9mIGJsYWNraG9sZWQgKElQdjQsIElQdjYpIGFkZHJlc3NlcywgZm9yIHdoaWNoIGRpYWxUQ1AgaXMKLy8gZXhwZWN0ZWQgdG8gaGFuZyB1bnRpbCB0aGUgdGltZW91dCBlbGFwc2VzLiBUaGVzZSBhZGRyZXNzZXMgYXJlIHJlc2VydmVkCi8vIGZvciBiZW5jaG1hcmtpbmcgYnkgUkZDIDY4OTAuCmNvbnN0ICgKCXNsb3dEc3Q0ID0gIjE5OC4xOC4wLjI1NCIKCXNsb3dEc3Q2ID0gIjIwMDE6Mjo6MjU0IgopCgovLyBJbiBzb21lIGVudmlyb25tZW50cywgdGhlIHNsb3cgSVBzIG1heSBiZSBleHBsaWNpdGx5IHVucmVhY2hhYmxlLCBhbmQgZmFpbAovLyBtb3JlIHF1aWNrbHkgdGhhbiBleHBlY3RlZC4gVGhpcyB0ZXN0IGhvb2sgcHJldmVudHMgZGlhbFRDUCBmcm9tIHJldHVybmluZwovLyBiZWZvcmUgdGhlIGRlYWRsaW5lLgpmdW5jIHNsb3dEaWFsVENQKGN0eCBjb250ZXh0LkNvbnRleHQsIG5ldHdvcmsgc3RyaW5nLCBsYWRkciwgcmFkZHIgKlRDUEFkZHIpICgqVENQQ29ubiwgZXJyb3IpIHsKCXNkIDo9ICZzeXNEaWFsZXJ7bmV0d29yazogbmV0d29yaywgYWRkcmVzczogcmFkZHIuU3RyaW5nKCl9CgljLCBlcnIgOj0gc2QuZG9EaWFsVENQKGN0eCwgbGFkZHIsIHJhZGRyKQoJaWYgUGFyc2VJUChzbG93RHN0NCkuRXF1YWwocmFkZHIuSVApIHx8IFBhcnNlSVAoc2xvd0RzdDYpLkVxdWFsKHJhZGRyLklQKSB7CgkJLy8gV2FpdCBmb3IgdGhlIGRlYWRsaW5lLCBvciBpbmRlZmluaXRlbHkgaWYgbm9uZSBleGlzdHMuCgkJPC1jdHguRG9uZSgpCgl9CglyZXR1cm4gYywgZXJyCn0KCmZ1bmMgZGlhbENsb3NlZFBvcnQodCAqdGVzdGluZy5UKSAoZGlhbExhdGVuY3kgdGltZS5EdXJhdGlvbikgewoJLy8gT24gbW9zdCBwbGF0Zm9ybXMsIGRpYWxpbmcgYSBjbG9zZWQgcG9ydCBzaG91bGQgYmUgbmVhcmx5IGluc3RhbnRhbmVvdXMg4oCUCgkvLyBsZXNzIHRoYW4gYSBmZXcgaHVuZHJlZCBtaWxsaXNlY29uZHMuIEhvd2V2ZXIsIG9uIHNvbWUgcGxhdGZvcm1zIGl0IG1heSBiZQoJLy8gbXVjaCBzbG93ZXI6IG9uIFdpbmRvd3MgYW5kIE9wZW5CU0QsIGl0IGhhcyBiZWVuIG9ic2VydmVkIHRvIHRha2UgdXAgdG8gYQoJLy8gZmV3IHNlY29uZHMuCgoJbCwgZXJyIDo9IExpc3RlbigidGNwIiwgIjEyNy4wLjAuMTowIikKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWxmKCJkaWFsQ2xvc2VkUG9ydDogTGlzdGVuIGZhaWxlZDogJXYiLCBlcnIpCgl9CglhZGRyIDo9IGwuQWRkcigpLlN0cmluZygpCglsLkNsb3NlKCkKCglzdGFydFRpbWUgOj0gdGltZS5Ob3coKQoJYywgZXJyIDo9IERpYWwoInRjcCIsIGFkZHIpCglpZiBlcnIgPT0gbmlsIHsKCQljLkNsb3NlKCkKCX0KCWVsYXBzZWQgOj0gdGltZS5TaW5jZShzdGFydFRpbWUpCgl0LkxvZ2YoImRpYWxDbG9zZWRQb3J0OiBtZWFzdXJlZCBkZWxheSAldiIsIGVsYXBzZWQpCglyZXR1cm4gZWxhcHNlZAp9CgpmdW5jIFRlc3REaWFsUGFyYWxsZWwodCAqdGVzdGluZy5UKSB7Cgljb25zdCBpbnN0YW50IHRpbWUuRHVyYXRpb24gPSAwCgljb25zdCBmYWxsYmFja0RlbGF5ID0gMjAwICogdGltZS5NaWxsaXNlY29uZAoKCW5Db3BpZXMgOj0gZnVuYyhzIHN0cmluZywgbiBpbnQpIFtdc3RyaW5nIHsKCQlvdXQgOj0gbWFrZShbXXN0cmluZywgbikKCQlmb3IgaSA6PSAwOyBpIDwgbjsgaSsrIHsKCQkJb3V0W2ldID0gcwoJCX0KCQlyZXR1cm4gb3V0Cgl9CgoJdmFyIHRlc3RDYXNlcyA9IFtdc3RydWN0IHsKCQlwcmltYXJpZXMgICAgICAgW11zdHJpbmcKCQlmYWxsYmFja3MgICAgICAgW11zdHJpbmcKCQl0ZWFyZG93bk5ldHdvcmsgc3RyaW5nCgkJZXhwZWtub3duKCZ4KQp9CgpmdW5jIGZvbzExOCh1bmtub3duIGZ1bmMoKmludCkpIHsgLy8gRVJST1IgInVua25vd24gZG9lcyBub3QgZXNjYXBlJCIKCXggOj0gMSAvLyBFUlJPUiAibW92ZWQgdG8gaGVhcDogeCQiCgl1bmtub3duKCZ4KQp9CgpmdW5jIGV4dGVybmFsKCppbnQpCgpmdW5jIGZvbzExOSh4ICppbnQpIHsgLy8gRVJST1IgImxlYWtpbmcgcGFyYW06IHgkIgoJZXh0ZXJuYWwoeCkKfQoKZnVuYyBmb28xMjAoKSB7CgkvLyBmb3JtZXJseSBleHBvbmVudGlhbCB0aW1lIGFuYWx5c2lzCkwxOgpMMjoKTDM6Ckw0OgpMNToKTDY6Ckw3OgpMODoKTDk6CkwxMDoKTDExOgpMMTI6CkwxMzoKTDE0OgpMMTU6CkwxNjoKTDE3OgpMMTg6CkwxOToKTDIwOgpMMjE6CkwyMjoKTDIzOgpMMjQ6CkwyNToKTDI2OgpMMjc6CkwyODoKTDI5OgpMMzA6CkwzMToKTDMyOgpMMzM6CkwzNDoKTDM1OgpMMzY6CkwzNzoKTDM4OgpMMzk6Ckw0MDoKTDQxOgpMNDI6Ckw0MzoKTDQ0OgpMNDU6Ckw0NjoKTDQ3OgpMNDg6Ckw0OToKTDUwOgpMNTE6Ckw1MjoKTDUzOgpMNTQ6Ckw1NToKTDU2OgpMNTc6Ckw1ODoKTDU5OgpMNjA6Ckw2MToKTDYyOgpMNjM6Ckw2NDoKTDY1OgpMNjY6Ckw2NzoKTDY4OgpMNjk6Ckw3MDoKTDcxOgpMNzI6Ckw3MzoKTDc0OgpMNzU6Ckw3NjoKTDc3OgpMNzg6Ckw3OToKTDgwOgpMODE6Ckw4MjoKTDgzOgpMODQ6Ckw4NToKTDg2OgpMODc6Ckw4ODoKTDg5OgpMOTA6Ckw5MToKTDkyOgpMOTM6Ckw5NDoKTDk1OgpMOTY6Ckw5NzoKTDk4OgpMOTk6CkwxMDA6CgkvLyB1c2UgdGhlIGxhYmVscyB0byBzaWxlbmNlIGNvbXBpbGVyIGVycm9ycwoJZ290byBMMQoJZ290byBMMgoJZ290byBMMwoJZ290byBMNAoJZ290byBMNQoJZ290byBMNgoJZ290byBMNwoJZ290byBMOAoJZ290byBMOQoJZ290byBMMTAKCWdvdG8gTDExCglnb3RvIEwxMgoJZ290byBMMTMKCWdvdG8gTDE0Cglnb3RvIEwxNQoJZ290byBMMTYKCWdvdG8gTDE3Cglnb3RvIEwxOAoJZ290byBMMTkKCWdvdG8gTDIwCglnb3RvIEwyMQoJZ290byBMMjIKCWdvdG8gTDIzCglnb3RvIEwyNAoJZ290byBMMjUKCWdvdG8gTDI2Cglnb3RvIEwyNwoJZ290byBMMjgKCWdvdG8gTDI5Cglnb3RvIEwzMAoJZ290byBMMzEKCWdvdG8gTDMyCglnb3RvIEwzMwoJZ290byBMMzQKCWdvdG8gTDM1Cglnb3RvIEwzNgoJZ290byBMMzcKCWdvdG8gTDM4Cglnb3RvIEwzOQoJZ290byBMNDAKCWdvdG8gTDQxCglnb3RvIEw0MgoJZ290byBMNDMKCWdvdG8gTDQ0Cglnb3RvIEw0NQoJZ290byBMNDYKCWdvdG8gTDQ3Cglnb3RvIEw0OAoJZ290byBMNDkKCWdvdG8gTDUwCglnb3RvIEw1MQoJZ290byBMNTIKCWdvdG8gTDUzCglnb3RvIEw1NAoJZ290byBMNTUKCWdvdG8gTDU2Cglnb3RvIEw1NwoJZ290byBMNTgKCWdvdG8gTDU5Cglnb3RvIEw2MAoJZ290byBMNjEKCWdvdG8gTDYyCglnb3RvIEw2MwoJZ290byBMNjQKCWdvdG8gTDY1Cglnb3RvIEw2NgoJZ290byBMNjcKCWdvdG8gTDY4Cglnb3RvIEw2OQoJZ290byBMNzAKCWdvdG8gTDcxCglnb3RvIEw3MgoJZ290byBMNzMKCWdvdG8gTDc0Cglnb3RvIEw3NQoJZ290byBMNzYKCWdvdG8gTDc3Cglnb3RvIEw3OAoJZ290byBMNzkKCWdvdG8gTDgwCglnb3RvIEw4MQoJZ290byBMODIKCWdvdG8gTDgzCglnb3RvIEw4NAoJZ290byBMODUKCWdvdG8gTDg2Cglnb3RvIEw4NwoJZ290byBMODgKCWdvdG8gTDg5Cglnb3RvIEw5MAoJZ290byBMOTEKCWdvdG8gTDkyCglnb3RvIEw5MwoJZ290byBMOTQKCWdvdG8gTDk1Cglnb3RvIEw5NgoJZ290byBMOTcKCWdvdG8gTDk4Cglnb3RvIEw5OQoJZ290byBMMTAwCn0KCmZ1bmMgZm9vMTIxKCkgewoJZm9yIGkgOj0gMDsgaSA8IDEwOyBpKysgewoJCWRlZmVyIG15cHJpbnQobmlsLCBpKSAvLyBFUlJPUiAiLi4uIGFyZ3VtZW50IGRvZXMgbm90IGVzY2FwZSQiICJpIGVzY2FwZXMgdG8gaGVhcCQiCgkJZ28gbXlwcmludChuaWwsIGkpICAgIC8vIEVvbi4KCW4sIHJhdGUgaW50CgoJLy8gZHNieXRlIGNvbnRhaW5zIHRoZSAiZG9tYWluIHNlcGFyYXRpb24iIGJpdHMgYW5kIHRoZSBmaXJzdCBiaXQgb2YKCS8vIHRoZSBwYWRkaW5nLiBTZWN0aW9ucyA2LjEgYW5kIDYuMiBvZiBbMV0gc2VwYXJhdGUgdGhlIG91dHB1dHMgb2YgdGhlCgkvLyBTSEEtMyBhbmQgU0hBS0UgZnVuY3Rpb25zIGJ5IGFwcGVuZGluZyBiaXRzdHJpbmdzIHRvIHRoZSBtZXNzYWdlLgoJLy8gVXNpbmcgYSBsaXR0bGUtZW5kaWFuIGJpdC1vcmRlcmluZyBjb252ZW50aW9uLCB0aGVzZSBhcmUgIjAxIiBmb3IgU0hBLTMKCS8vIGFuZCAiMTExMSIgZm9yIFNIQUtFLCBvciAwMDAwMDAxMGIgYW5kIDAwMDAxMTExYiwgcmVzcGVjdGl2ZWx5LiBUaGVuIHRoZQoJLy8gcGFkZGluZyBydWxlIGZyb20gc2VjdGlvbiA1LjEgaXMgYXBwbGllZCB0byBwYWQgdGhlIG1lc3NhZ2UgdG8gYSBtdWx0aXBsZQoJLy8gb2YgdGhlIHJhdGUsIHdoaWNoIGludm9sdmVzIGFkZGluZyBhICIxIiBiaXQsIHplcm8gb3IgbW9yZSAiMCIgYml0cywgYW5kCgkvLyBhIGZpbmFsICIxIiBiaXQuIFdlIG1lcmdlIHRoZSBmaXJzdCAiMSIgYml0IGZyb20gdGhlIHBhZGRpbmcgaW50byBkc2J5dGUsCgkvLyBnaXZpbmcgMDAwMDAxMTBiICgweDA2KSBhbmQgMDAwMTExMTFiICgweDFmKS4KCS8vIFsxXSBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZHJhZnRzL2ZpcHMtMjAyL2ZpcHNfMjAyX2RyYWZ0LnBkZgoJLy8gICAgICJEcmFmdCBGSVBTIDIwMjogU0hBLTMgU3RhbmRhcmQ6IFBlcm11dGF0aW9uLUJhc2VkIEhhc2ggYW5kCgkvLyAgICAgIEV4dGVuZGFibGUtT3V0cHV0IEZ1bmN0aW9ucyAoTWF5IDIwMTQpIgoJZHNieXRlIGJ5dGUKCglvdXRwdXRMZW4gaW50ICAgICAgICAgICAgIC8vIHRoZSBkZWZhdWx0IG91dHB1dCBzaXplIGluIGJ5dGVzCglzdGF0ZSAgICAgc3BvbmdlRGlyZWN0aW9uIC8vIHdoZXRoZXIgdGhlIHNwb25nZSBpcyBhYnNvcmJpbmcgb3Igc3F1ZWV6aW5nCn0KCi8vIEJsb2NrU2l6ZSByZXR1cm5zIHRoZSByYXRlIG9mIHNwb25nZSB1bmRlcmx5aW5nIHRoaXMgaGFzaCBmdW5jdGlvbi4KZnVuYyAoZCAqRGlnZXN0KSBCbG9ja1NpemUoKSBpbnQgeyByZXR1cm4gZC5yYXRlIH0KCi8vIFNpemUgcmV0dXJucyB0aGUgb3V0cHV0IHNpemUgb2YgdGhlIGhhc2ggZnVuY3Rpb24gaW4gYnl0ZXMuCmZ1bmMgKGQgKkRpZ2VzdCkgU2l6ZSgpIGludCB7IHJldHVybiBkLm91dHB1dExlbiB9CgovLyBSZXNldCByZXNldHMgdGhlIERpZ2VzdCB0byBpdHMgaW5pdGlhbCBzdGF0ZS4KZnVuYyAoZCAqRGlnZXN0KSBSZXNldCgpIHsKCS8vIFplcm8gdGhlIHBlcm11dGF0aW9uJ3Mgc3RhdGUuCgljbGVhcihkLmFbOl0pCglkLnN0YXRlID0gc3BvbmdlQWJzb3JiaW5nCglkLm4gPSAwCn0KCmZ1bmMgKGQgKkRpZ2VzdCkgQ2xvbmUoKSAqRGlnZXN0IHsKCXJldCA6PSAqZAoJcmV0dXJuICZyZXQKfQoKLy8gcGVybXV0ZSBhcHBsaWVzIHRoZSBLZWNjYWtGLTE2MDAgcGVybXV0YXRpb24uCmZ1bmMgKGQgKkRpZ2VzdCkgcGVybXV0ZSgpIHsKCWtlY2Nha0YxNjAwKCZkLmEpCglkLm4gPSAwCn0KCi8vIHBhZEFuZFBlcm11dGUgYXBwZW5kcyB0aGUgZG9tYWluIHNlcGFyYXRpb24gYml0cyBpbiBkc2J5dGUsIGFwcGxpZXMKLy8gdGhlIG11bHRpLWJpdHJhdGUgMTAuLjEgcGFkZGluZyBydWxlLCBhbmQgcGVybXV0ZXMgdGhlIHN0YXRlLgpmdW5jIChkICpEaWdlc3QpIHBhZEFuZFBlcm11dGUoKSB7CgkvLyBQYWQgd2l0aCB0aGlzIGluc3RhbmNlJ3MgZG9tYWluLXNlcGFyYXRvciBiaXRzLiBXZSBrbm93IHRoYXQgdGhlcmUncwoJLy8gYXQgbGVhc3Qgb25lIGJ5dGUgb2Ygc3BhY2UgaW4gdGhlIHNwb25nZSBiZWNhdXNlLCBpZiBpdCB3ZXJlIGZ1bGwsCgkvLyBwZXJtdXRlIHdvdWxkIGhhdmUgYmVlbiBjYWxsZWQgdG8gZW1wdHkgaXQuIGRzYnl0ZSBhbHNvIGNvbiB1c2UgKmJ5dGUgdG8gYXZvaWQgdGlueSBhbGxvY2F0b3IKCQlmIGludAoJfQoJdiA6PSAmVHt9CglydW50aW1lLkFkZENsZWFudXAodiwgZnVuYyhpbnQpIHsKCQl0LkxvZyh2LmYpCgkJdC5FcnJvcigiY2xlYW51cCByYW4gdW5leHBlY3RlZGx5IikKCX0sIDApCn0KCi8vIEJlbmNobWFya0FkZENsZWFudXBBbmRTdG9wIGJlbmNobWFya3MgYWRkaW5nIGFuZCByZW1vdmluZyBhIGNsZWFudXAKLy8gZnJvbSB0aGUgc2FtZSBhbGxvY2F0aW9uLgovLwovLyBBdCBmYWNlIHZhbHVlLCB0aGlzIGJlbmNobWFyayBpcyB1bnJlYWxpc3RpYywgc2luY2Ugbm8gcHJvZ3JhbSB3b3VsZAovLyBkbyB0aGlzIGluIHByYWN0aWNlLiBIb3dldmVyLCBhZGRpbmcgY2xlYW51cHMgdG8gbmV3IGFsbG9jYXRpb25zIGluIGEKLy8gbG9vcCBpcyBhbHNvIHVucmVhbGlzdGljLiBJdCBhZGRzIGFkZGl0aW9uYWwgdW51c2VkIGFsbG9jYXRpb25zLAovLyBleGVyY2lzZXMgdW5jb21tb24gcGVyZm9ybWFuY2UgcGl0ZmFsbHMgaW4gQWRkQ2xlYW51cCAodHJhdmVyc2luZyB0aGUKLy8gc3BlY2lhbHMgbGlzdCwgd2hpY2ggc2hvdWxkIGp1c3QgYmUgaXRzIG93biBiZW5jaG1hcmspLCBhbmQgZXhlY3V0aW5nCi8vIGNsZWFudXBzIGF0IGEgZnJlcXVlbmN5IHRoYXQgaXMgdW5saWtlbHkgdG8gYXBwZWFyIGluIHJlYWwgcHJvZ3JhbXMuCi8vCi8vIFRoaXMgYmVuY2htYXJrIGlzIHN0aWxsIHVzZWZ1bCBob3dldmVyLCBzaW5jZSB3ZSBjYW4gZ2V0IGEgbG93LW5vaXNlCi8vIG1lYXN1cmVtZW50IG9mIHRoZSBjb3N0IG9mIEFkZENsZWFudXAgYW5kIFN0b3AgYWxsIGluIG9uZSB3aXRob3V0IHRoZQovLyBhYm92ZSBwaXRmYWxsczogd2UgY2FuIG1lYXN1cmUgdGhlIHB1cmUgb3ZlcmhlYWQuIFdlIGNhbiB0aGVuIHNlcGFyYXRlCi8vIG91dCB0aGUgY29zdCBvZiBlYWNoIGluIENQVSBwcm9maWxlcyBpZiB3ZSBzbyBjaG9vc2UgKHRoZXkncmUgbm90IHNvCi8vIGluZXhwZW5zaXZlIGFzIHRvIG1ha2UgdGhpcyBpbmZlYXNpYmxlKS4KZnVuYyBCZW5jaG1hcmtBZGRDbGVhbnVwQW5kU3RvcChiICp0ZXN0aW5nLkIpIHsKCWIuUmVwb3J0QWxsb2NzKCkKCgl0eXBlIFQgc3RydWN0IHsKCQl2IGludAoJCXAgdW5zYWZlLlBvaW50ZXIKCX0KCXggOj0gbmV3KFQpCglmb3IgYi5Mb29wKCkgewoJCXJ1bnRpbWUuQWRkQ2xlYW51cCh4LCBmdW5jKGludCkge30sIDE0KS5TdG9wKCkKCX0KfQovLyBDb3B5cmlnaHQgMjAxMiBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy9nbzpidWlsZCAoYW1kNjQgfHwgYXJtNjQgfHwgcHBjNjQgfHwgcHBjNjRsZSkgJiYgIXB1cmVnbwoKcGFja2FnZSBhZXMKCmltcG9ydCAoCgkiY3J5cHRvL2ludGVybmFsL2ZpcHMxNDBkZXBzL2NwdSIKCSJjcnlwdG8vaW50ZXJuYWwvZmlwczE0MGRlcHMvZ29kZWJ1ZyIKCSJjcnlwdG8vaW50ZXJuYWwvaW1wbCIKKQoKLy9nbzpub2VzY2FwZQpmdW5jIGVuY3J5cHRCbG9ja0FzbShuciBpbnQsIHhrICp1aW50MzIsIGRzdCwgc3JjICpieXRlKQoKLy9nbzpub2VzY2FwZQpmdW5jIGRlY3J5cHRCbG9ja0FzbShuciBpbnQsIHhrICp1aW50MzIsIGRzdCwgc3JjICpieXRlKQoKLy9nbzpub2VzY2FwZQpmdW5jIGV4cGFuZEtleUFzbShuciBpbnQsIGtleSAqYnl0ZSwgZW5jICp1aW50MzIsIGRlYyAqdWludDMyKQoKdmFyIHN1cHBvcnRzQUVTID0gY3B1Llg4Nkhhc0FFUyAmJiBjcHUuWDg2SGFzU1NFNDEgJiYgY3B1Llg4Nkhhc1NTU0UzIHx8CgljcHUuQVJNNjRIYXNBRVMgfHwgY3B1LlBQQzY0IHx8IGNwdS5QUEM2NGxlCgpmdW5jIGluaXQoKSB7CglpZiBjcHUuQU1ENjQgewoJCWltcGwuUmVnaXN0ZXIoImFlcyIsICJBRVMtTkkiLCBuaWMoImNnaTogYm9ndXMgaHR0cCByZXF1ZXN0IGluIHRlc3Q6ICIgKyBodHRwcmVxKQoJfQoJcmVxLlJlbW90ZUFkZHIgPSAiMS4yLjMuNDoxMjM0IgoJcmV0dXJuIHJlcQp9CgpmdW5jIHJ1bkNnaVRlc3QodCAqdGVzdGluZy5ULCBoICpIYW5kbGVyLAoJaHR0cHJlcSBzdHJpbmcsCglleHBlY3RlZE1hcCBtYXBbc3RyaW5nXXN0cmluZywgY2hlY2tzIC4uLmZ1bmMocmVxSW5mbyBtYXBbc3RyaW5nXXN0cmluZykpICpodHRwdGVzdC5SZXNwb25zZVJlY29yZGVyIHsKCXJ3IDo9IGh0dHB0ZXN0Lk5ld1JlY29yZGVyKCkKCXJlcSA6PSBuZXdSZXF1ZXN0KGh0dHByZXEpCgloLlNlcnZlSFRUUChydywgcmVxKQoJcnVuUmVzcG9uc2VDaGVja3ModCwgcncsIGV4cGVjdGVkTWFwLCBjaGVja3MuLi4pCglyZXR1cm4gcncKfQoKZnVuYyBydW5SZXNwb25zZUNoZWNrcyh0ICp0ZXN0aW5nLlQsIHJ3ICpodHRwdGVzdC5SZXNwb25zZVJlY29yZGVyLAoJZXhwZWN0ZWRNYXAgbWFwW3N0cmluZ11zdHJpbmcsIGNoZWNrcyAuLi5mdW5jKHJlcUluZm8gbWFwW3N0cmluZ11zdHJpbmcpKSB7CgkvLyBNYWtlIGEgbWFwIHRvIGhvbGQgdGhlIHRlc3QgbWFwIHRoYXQgdGhlIENHSSByZXR1cm5zLgoJbSA6PSBtYWtlKG1hcFtzdHJpbmddc3RyaW5nKQoJbVsiX2JvZHkiXSA9IHJ3LkJvZHkuU3RyaW5nKCkKCWxpbmVzUmVhZCA6PSAwCnJlYWRsaW5lczoKCWZvciB7CgkJbGluZSwgZXJyIDo9IHJ3LkJvZHkuUmVhZFN0cmluZygnXG4nKQoJCXN3aXRjaCB7CgkJY2FzZSBlcnIgPT0gaW8uRU9GOgoJCQlicmVhayByZWFkbGluZXMKCQljYXNlIGVyciAhPSBuaWw6CgkJCXQuRmF0YWxmKCJ1bmV4cGVjdGVkIGVycm9yIHJlYWRpbmcgZnJvbSBDR0k6ICV2IiwgZXJyKQoJCX0KCQlsaW5lc1JlYWQrKwoJCXRyaW1tZWRMaW5lIDo9IHN0cmluZ3MuVHJpbVJpZ2h0KGxpbmUsICJcclxuIikKCQlrLCB2LCBvayA6PSBzdHJpbmdzLkN1dCh0cmltbWVkTGluZSwgIj0iKQoJCWlmICFvayB7CgkJCXQuRmF0YWxmKCJVbmV4cGVjdGVkIHJlc3BvbnNlIGZyb20gaW52YWxpZCBsaW5lIG51bWJlciAldjogJXE7IGV4aXN0aW5nIG1hcD0ldiIsCgkJCQlsaW5lc1JlYWQsIGxpbmUsIG0pCgkJfQoJCW1ba10gPSB2Cgl9CgoJZm9yIGtleSwgZXhwZWN0ZWQgOj0gcmFuZ2UgZXhwZWN0ZWRNYXAgewoJCWdvdCA6PSBtW2tleV0KCQlpZiBrZXkgPT0gImN3ZCIgewoJCQkvLyBGb3IgV2luZG93cy4gZ29sYW5nLm9yZy9pc3N1ZS80NjQ1LgoJCQlmaTEsIF8gOj0gb3MuU3RhdChnb3QpCgkJCWZpMiwgXyA6PSBvcy5TdGF0KGV4cGVjdGVkKQoJCQlpZiBvcy5TYW1lRmlsZShmaTEsIGZpMikgewoJCQkJZ290ID0gZXhwZWN0ZWQKCQkJfQoJCX0KCQlpZiBnb3QgIT0gZXhwZWN0ZWQgewoJCQl0LkVycm9yZigiZm9yIGtleSAlcSBnb3QgJXE7IGV4cGVjdGVkICVxIiwga2V5LCBnb3QsIGV4cGVjdGVkKQoJCX0KCX0KCWZvciBfLCBjaGVjayA6PSByYW5nZSBjaGVja3MgewoJCWNoZWNrKG0pCgl9Cn0KCmZ1bmMgVGVzdENHSUJhc2ljR2V0KHQgKnRlc3RpbmcuVCkgewoJdGVzdGVudi5NdXN0SGF2ZUV4ZWModCkKCWggOj0gJkhhbmRsZXJ7CgkJUGF0aDogb3MuQXJnc1swXSwKCQlSb290OiAiL3Rlc3QuY2dpIiwKCX0KCWV4cGVjdGVkTWFwIDo9IG1hcFtzdHJpbmddc3RyaW5newoJCSJ0ZXN0IjogICAgICAgICAgICAgICAgICAiSGVsbG8gQ0dJIiwKCQkicGFyYW0tYSI6ICAgICAgICAgICAgICAgImIiLAoJCSJwYXJhbS1mb28iOiAgICAgICAgICAgICAiYmFyIiwKCQkiZW52LUdBVEVXQVlfSU5URVJGQUNFIjogIkNHSS8xLjEiLAoJCSJlbnYtSFRUUF9IT1NUIjogICAgICAgICAiZXhhbXBsZS5jb206ODAiLAoJCSJlbnYtUEFUSF9JTkZPIjogICAgICAgICAiIiwKCQkiZW52LVFVRVJZX1NUUklORyI6ICAgICAgImZvbz1iYXImYT1iIiwKCQkiZW52LVJFTU9URV9BRERSIjogICAgICAgIjEuMi4zLjQiLAoJCU5ldygic3RyaW5nIGNhbm5vdCBoYXZlIDAgaW5zaWRlIikKCQkJfQoJCX0KCQlzcyArPSBzICsgIlx4MDAiCgl9Cgl2IDo9IHV0ZjE2LkVuY29kZShbXXJ1bmUoc3MgKyAiXHgwMCIpKQoJYnVmIDo9ICgqWzEgPDwgMjldYnl0ZSkodW5zYWZlLlBvaW50ZXIoJnZbMF0pKVs6IGxlbih2KSoyIDogbGVuKHYpKjJdCglyZXR1cm4gay5zZXRWYWx1ZShuYW1lLCBNVUxUSV9TWiwgYnVmKQp9CgovLyBTZXRCaW5hcnlWYWx1ZSBzZXRzIHRoZSBkYXRhIGFuZCB0eXBlIG9mIGEgbmFtZSB2YWx1ZQovLyB1bmRlciBrZXkgayB0byB2YWx1ZSBhbmQgQklOQVJZLgpmdW5jIChrIEtleSkgU2V0QmluYXJ5VmFsdWUobmFtZSBzdHJpbmcsIHZhbHVlIFtdYnl0ZSkgZXJyb3IgewoJcmV0dXJuIGsuc2V0VmFsdWUobmFtZSwgQklOQVJZLCB2YWx1ZSkKfQoKLy8gRGVsZXRlVmFsdWUgcmVtb3ZlcyBhIG5hbWVkIHZhbHVlIGZyb20gdGhlIGtleSBrLgpmdW5jIChrIEtleSkgRGVsZXRlVmFsdWUobmFtZSBzdHJpbmcpIGVycm9yIHsKCXJldHVybiByZWdEZWxldGVWYWx1ZShzeXNjYWxsLkhhbmRsZShrKSwgc3lzY2FsbC5TdHJpbmdUb1VURjE2UHRyKG5hbWUpKQp9CgovLyBSZWFkVmFsdWVOYW1lcyByZXR1cm5zIHRoZSB2YWx1ZSBuYW1lcyBvZiBrZXkgay4KZnVuYyAoayBLZXkpIFJlYWRWYWx1ZU5hbWVzKCkgKFtdc3RyaW5nLCBlcnJvcikgewoJa2ksIGVyciA6PSBrLlN0YXQoKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgluYW1lcyA6PSBtYWtlKFtdc3RyaW5nLCAwLCBraS5WYWx1ZUNvdW50KQoJYnVmIDo9IG1ha2UoW111aW50MTYsIGtpLk1heFZhbHVlTmFtZUxlbisxKSAvLyBleHRyYSByb29tIGZvciB0ZXJtaW5hdGluZyBudWxsIGNoYXJhY3Rlcgpsb29wSXRlbXM6Cglmb3IgaSA6PSB1aW50MzIoMCk7IDsgaSsrIHsKCQlsIDo9IHVpbnQzMihsZW4oYnVmKSkKCQlmb3IgewoJCQllcnIgOj0gcmVnRW51bVZhbHVlKHN5c2NhbGwuSGFuZGxlKGspLCBpLCAmYnVmWzBdLCAmbCwgbmlsLCBuaWwsIG5pbCwgbmlsKQoJCQlpZiBlcnIgPT0gbmlsIHsKCQkJCWJyZWFrCgkJCX0KCQkJaWYgZXJyID09IHN5c2NhbGwuRVJST1JfTU9SRV9EQVRBIHsKCQkJCS8vIERvdWJsZSBidWZmZXIgc2l6ZSBhbmQgdHJ5IGFnYWluLgoJCQkJbCA9IHVpbnQzMigyICogbGVuKGJ1ZikpCgkJCQlidWYgPSBtYWtlKFtddWludDE2LCBsKQoJCQkJY29udGludWUKCQkJfQoJCQlpZiBlcnIgPT0gX0VSUk9SX05PX01PUkVfSVRFTVMgewoJCQkJYnJlYWsgbG9vcEl0ZW1zCgkJCX0KCQkJcmV0dXJuIG5hbWVzLCBlcnIKCQl9CgkJbmFtZXMgPSBhcHBlbmQobmFtZXMsIHN5c2NhbGwuVVRGMTZUb1N0cmluZyhidWZbOmxdKSkKCX0KCXJldHVybiBuYW1lcywgbmlsCn0KLy8gQ29weXJpZ2h0IDIwMjMgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCi8vZ286YnVpbGQgKCF3aW5kb3dzICYmICFzb2xhcmlzKSB8fCBpbGx1bW9zCgpwYWNrYWdlIG5ldAoKaW1wb3J0ICJzeXNjYWxsIgoKLy8gU2V0S2VlcEFsaXZlQ29uZmlnIGNvbmZpZ3VyZXMga2VlcC1hbGl2ZSBtZXNzYWdlcyBzZW50IGJ5IHRoZSBvcGVyYXRpbmcgc3lzdGVtLgpmdW5jIChjICpUQ1BDb25uKSBTZXRLZWVwQWxpdmVDb25maWcoY29uZmlnIEtlZXBBbGl2ZUNvbmZpZykgZXJyb3IgewoJaWYgIWMub2soKSB7CgkJcmV0dXJuIHN5c2NhbGwuRUlOVkFMCgl9CgoJaWYgZXJyIDo9IHNldEtlZXBBbGl2ZShjLmZkLCBjb25maWcuRW5hYmxlKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuICZPcEVycm9ye09wOiAic2V0IiwgTmV0OiBjLmZkLm5ldCwgU291cmNlOiBjLmZkLmxhZGRyLCBBZGRyOiBjLmZkLnJhZGRyLCBFcnIiYWJjIiwgImFiYyJ9LAoJeyJBYkMxMjMiLCAiYWJjMTIzIn0sCgl7ImF6QVowOV8iLCAiYXphejA5XyJ9LAoJeyJsb25nU3RyaW5Hd2l0SG1peG9mc21hTExhbmRjQXBzIiwgImxvbmdzdHJpbmd3aXRobWl4b2ZzbWFsbGFuZGNhcHMifSwKCXsicmVuYW4gYmFzdG9zIDkzIEFPU0RBSkRKQUlESkFJREFKSWFpZHNqamFpZGlqYWRzamlhZGppT09LS08iLCAicmVuYW4gYmFzdG9zIDkzIGFvc2RhamRqYWlkamFpZGFqaWFpZHNqamFpZGlqYWRzamlhZGppb29ra28ifSwKCXsiTE9OR1x1MkM2RlNUUklOR1x1MkM2RldJVEhcdTJDNkZOT05BU0NJSVx1MkM2RkNIQVJTIiwgImxvbmdcdTAyNTBzdHJpbmdcdTAyNTB3aXRoXHUwMjUwbm9uYXNjaWlcdTAyNTBjaGFycyJ9LAoJeyJcdTJDNkRcdTJDNkRcdTJDNkRcdTJDNkRcdTJDNkQiLCAiXHUwMjUxXHUwMjUxXHUwMjUxXHUwMjUxXHUwMjUxIn0sIC8vIHNocmlua3Mgb25lIGJ5dGUgcGVyIGNoYXIKCXsiQVx1MDA4MFxVMDAxMEZGRkYiLCAiYVx1MDA4MFxVMDAxMEZGRkYifSwgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZXN0IHV0ZjguUnVuZVNlbGYgYW5kIHV0ZjguTWF4UnVuZQp9Cgpjb25zdCBzcGFjZSA9ICJcdFx2XHJcZlxuXHUwMDg1XHUwMGEwXHUyMDAwXHUzMDAwIgoKdmFyIHRyaW1TcGFjZVRlc3RzID0gW11TdHJpbmdUZXN0ewoJeyIiLCAiIn0sCgl7ImFiYyIsICJhYmMifSwKCXtzcGFjZSArICJhYmMiICsgc3BhY2UsICJhYmMifSwKCXsiICIsICIifSwKCXsiIFx0XHJcbiBcdFx0XHJcclxuXG4gIiwgIiJ9LAoJeyIgXHRcclxuIHhcdFx0XHJcclxuXG4gIiwgIngifSwKCXsiIFx1MjAwMFx0XHJcbiB4XHRcdFxyXHJcbnlcbiBcdTMwMDAiLCAieFx0XHRcclxyXG55In0sCgl7IjEgXHRcclxuMiIsICIxIFx0XHJcbjIifSwKCXsiIHhceDgwIiwgInhceDgwIn0sCgl7IiB4XHhjMCIsICJ4XHhjMCJ9LAoJeyJ4IFx4YzBceGMwICIsICJ4IFx4YzBceGMwIn0sCgl7InggXHhjMCIsICJ4IFx4YzAifSwKCXsieCBceGMwICIsICJ4IFx4YzAifSwKCXsieCBceGMwXHhjMCAiLCAieCBceGMwXHhjMCJ9LAoJeyJ4IOKYulx4YzBceGMwICIsICJ4IOKYulx4YzBceGMwIn0sCgl7Ingg4pi6ICIsICJ4IOKYuiJ9LAp9CgpmdW5jIHRlblJ1bmVzKGNoIHJ1bmUpIHN0cmluZyB7CglyIDo9IG1ha2UoW11ydW5lLCAxMCkKCWZvciBpIDo9IHJhbmdlIHIgewoJCXJbaV0gPSBjaAoJfQoJcmV0dXJuIHN0cmluZyhyKQp9CgovLyBVc2VyLWRlZmluZWQgc2VsZi1pbnZlcnNlIG1hcHBpbmcgZnVuY3Rpb24KZnVuYyByb3QxMyhyIHJ1bmUpIHJ1bmUgewoJc3RlcCA6PSBydW5lKDEzKQoJaWYgciA+PSAnYScgJiYgciA8PSAneicgewoJCXJldHVybiAoKHIgLSAnYScgKyBzdGVwKSAlIDI2KSArICdhJwoJfQoJaWYgciA+PSAnQScgJiYgciA8PSAnWicgewoJCXJldHVybiAoKHIgLSAnQScgKyBzdGVwKSAlIDI2KSArICdBJwoJfQoJcmV0dXJuIHIKfQoKZnVuYyBUZXN0TWFwKHQgKnRlc3RpbmcuVCkgewoJLy8gUnVuIGEgY291cGxlIG9mIGF3ZnVsIGdyb3d0aC9zaHJpbmthZ2UgdGVzdHMKCWEgOj0gdGVuUnVuZXMoJ2EnKQoJLy8gMS4gR3Jvdy4gVGhpcyB0cmlnZ2VycyB0d28gcmVhbGxvY2F0aW9ucyBpbiBNYXAuCgltYXhSdW5lIDo9IGZ1bmMocnVuZSkgcnVuZSB7IHJldHVybiB1bmljb2RlLk1heFJ1bmUgfQoJbSA6PSBNYXAobWF4UnVuZSwgYSkKCWV4cGVjdCA6PSB0ZW5SdW5lcyh1bmljb2RlLk1heFJ1bmUpCglpZiBtICE9IGV4cGVjdCB7CgkJdC5FcnJvcmYoImdyb3dpbmc6IGV4cGVjdGVkICVxIGdvdCAlcSIsIGV4cGVjdCwgbSkKCX0KCgkvLyAyLiBTaHJpbmsKCW1pblJ1bmUgOj0gZnVuYyhydW5lKSBydW5lIHsgcmV0dXJuICdhJyB9CgltID0gTWFwKG1pblJ1bmUsIHRlblJ1bmVzKHVuaWNvZGUuTWF4UnVuZSkpCglleHBlY3QgPSBhCglpZiBtICE9IGV4cGVjdCB7CgkJdC5FcnJvcmYoInNocmlua2luZzogcmVsYXRlZCB0byBpbmhlcml0ZWQgaW5pdGlhbGl6YXRpb24gZXhwcmVzc2lvbnMgbXVzdCBhcHBlYXIgYXQKLy8gdGhlIGNvbnN0YW50IGlkZW50aWZpZXIgYmVpbmcgZGVjbGFyZWQsIG5vdCBhdCB0aGUgb3JpZ2luYWwgZXhwcmVzc2lvbgovLyAoaXNzdWVzICM0Mjk5MSwgIzQyOTkyKS4KY29uc3QgKAoJXyBieXRlID0gMjU1ICsgaW90YQoJLyogc29tZSBnYXAgKi8KCV8gLy8gRVJST1IgIm92ZXJmbG93cyIKCS8qIHNvbWUgZ2FwICovCgkvKiBzb21lIGdhcCAqLyBfIC8qIEVSUk9SICJvdmVyZmxvd3MiICovOyBfIC8qIEVSUk9SICJvdmVyZmxvd3MiICovCgkvKiBzb21lIGdhcCAqLwoJXyA9IDI1NSArIGlvdGEKCV8gPSBieXRlIC8qIEVSUk9SICJvdmVyZmxvd3MiICovICgyNTUpICsgaW90YQoJXyAvKiBFUlJPUiAib3ZlcmZsb3dzIiAqLwopCgovLyBUZXN0IGNhc2VzIGZyb20gaXNzdWUuCmNvbnN0ICgKCW9rID0gYnl0ZShpb3RhICsgMjUzKQoJYmFkCgliYXJuCgliYXJkIC8vIEVSUk9SICJvdmVyZmxvd3MiCikKCmNvbnN0ICgKCWMgPSBsZW4oWzEgLSBpb3RhXWludHt9KQoJZAoJZSAvLyBFUlJPUiAiaW52YWxpZCBhcnJheSBsZW5ndGgiCglmIC8vIEVSUk9SICJpbnZhbGlkIGFycmF5IGxlbmd0aCIKKQoKLy8gVGVzdCB0aGF0IGlkZW50aWZpZXJzIGluIGltcGxpY2l0IChvbWl0dGVkKSBSSFMKLy8gZXhwcmVzc2lvbnMgb2YgY29uc3RhbnQgZGVjbGFyYXRpb25zIGFyZSByZXNvbHZlZAovLyBpbiB0aGUgY29ycmVjdCBjb250ZXh0OyBzZWUgaXNzdWVzICM0OTE1NywgIzUzNTg1Lgpjb25zdCBYID0gMgoKZnVuYyBfKCkgewoJY29uc3QgKAoJCUEgICAgPSBpb3RhIC8vIDAKCQlpb3RhID0gaW90YSAvLyAxCgkJQiAgICAgICAgICAgLy8gMSAoaW90YSBpcyBkZWNsYXJlZCBsb2NhbGx5IG9uIHByZXYuIGxpbmUpCgkJQyAgICAgICAgICAgLy8gMQoJKQoJYXNzZXJ0KEEgPT0gMCAmJiBCID09IDEgJiYgQyA9PSAxKQoKCWNvbnN0ICgKCQlYID0gWCArIFgKCQlZCgkJWiA9IGlvdGEKCSkKCWFzc2VydChYID09IDQgJiYgWSA9PSA4ICYmIFogPT0gMSkKfQoKLy8gVE9ETyhncmkpIG1vdmUgZXh0cmEgdGVzdHMgZnJvbSB0ZXN0ZGF0YS9jb25zdDAuc3JjIGludG8gaGVyZQovLyBDb3B5cmlnaHQgMjAyMSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSB0YXIKCmltcG9ydCAoCgkiYnl0ZXMiCgkiaW8iCgkidGVzdGluZyIKKQoKZnVuYyBGdXp6UmVhZGVyKGYgKnRlc3RpbmcuRikgewoJYiA6PSBieXRlcy5OZXdCdWZmZXIobmlsKQoJdyA6PSBOZXdXcml0ZXIoYikKCWlucCA6PSBbXWJ5dGUoIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQsIHNlZCBkbyBlaXVzbW9kIHRlbXBvciBpbmNpZGlkdW50IHV0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxpcXVhLiBVdCBlbmltIGFkIG1pbmltIHZlbmlhbSwgcXVpcyBub3N0cnVkIGV4ZXJjaXRhdGlvbiB1bGxhbWNvIGxhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhIGNvbW1vZG8gY29uc2VxdWF0LiBEdWlzIGF1dGUgaXJ1cmUgZG9sb3IgaW4gcmVwcmVoZW5kZXJpdCBpbiB2b2x1cHRhdGUgdmVsaXQgZXNzZSBjaWxsdW0gZG9sb3JlIGV1IGZ1Z2lhdCBudWxsYSBwYXJpYXR1ci4gRXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQgY3VwaWRhdGF0IG5vbiBwcm9pZGVudCwgc3VudCBpbiBjdWxwYSBxdWkgb2ZmaWNpYSBkZXNlcnVudCBtb2xsaXQgYW5pbSBpZCBlc3QgbGFib3J1bS4iKQoJZXJyIDo9IHcuV3JpdGVIZWFkZXIoJkhlYWRlcnsKCQlOYW1lOiAibG9yZW0udHh0IiwKCQlNb2RlOiAwNjAwLAoJCVNpemU6IGludDY0KGxlbihpbnApKXNhcnkgYnV0IHNldCBpdCBhbnl3YXkuCglhcmNoaXZlLCBlcnIgOj0gci5ydW5HaXQoY3R4LCAiZ2l0IiwgIi1jIiwgImNvcmUuYXV0b2NybGY9aW5wdXQiLCAiLWMiLCAiY29yZS5lb2w9bGYiLCAiYXJjaGl2ZSIsICItLWZvcm1hdD16aXAiLCAiLS1wcmVmaXg9cHJlZml4LyIsICItLWVuZC1vZi1vcHRpb25zIiwgaW5mby5OYW1lLCBhcmdzKQoJaWYgZXJyICE9IG5pbCB7CgkJaWYgYnl0ZXMuQ29udGFpbnMoZXJyLigqUnVuRXJyb3IpLlN0ZGVyciwgW11ieXRlKCJkaWQgbm90IG1hdGNoIGFueSBmaWxlcyIpKSB7CgkJCXJldHVybiBuaWwsIGZzLkVyck5vdEV4aXN0CgkJfQoJCXJldHVybiBuaWwsIGVycgoJfQoKCXJldHVybiBpby5Ob3BDbG9zZXIoYnl0ZXMuTmV3UmVhZGVyKGFyY2hpdmUpKSwgbmlsCn0KCi8vIGVuc3VyZUdpdEF0dHJpYnV0ZXMgbWFrZXMgc3VyZSBleHBvcnQtc3Vic3QgYW5kIGV4cG9ydC1pZ25vcmUgZmVhdHVyZXMgYXJlCi8vIGRpc2FibGVkIGZvciB0aGlzIHJlcG8uIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmUgcnVuIHByaW9yIHRvIHJ1bm5pbmcgZ2l0Ci8vIGFyY2hpdmUgc28gdGhhdCB6aXAgZmlsZXMgYXJlIGdlbmVyYXRlZCB0aGF0IHByb2R1Y2UgY29uc2lzdGVudCB6aXBoYXNoZXMKLy8gZm9yIGEgZ2l2ZW4gcmV2aXNpb24sIGluZGVwZW5kZW50IG9mIHZhcmlhYmxlcyBzdWNoIGFzIGdpdCB2ZXJzaW9uIGFuZCB0aGUKLy8gc2l6ZSBvZiB0aGUgcmVwby4KLy8KLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZ29sYW5nL2dvL2lzc3Vlcy8yNzE1MwpmdW5jIGVuc3VyZUdpdEF0dHJpYnV0ZXMocmVwb0RpciBzdHJpbmcpIChlcnIgZXJyb3IpIHsKCWNvbnN0IGF0dHIgPSAiXG4qIC1leHBvcnQtc3Vic3QgLWV4cG9ydC1pZ25vcmVcbiIKCglkIDo9IHJlcG9EaXIgKyAiL2luZm8iCglwIDo9IGQgKyAiL2F0dHJpYnV0ZXMiCgoJaWYgZXJyIDo9IG9zLk1rZGlyQWxsKGQsIDA3NTUpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gZXJyCgl9CgoJZiwgZXJyIDo9IG9zLk9wZW5GaWxlKHAsIG9zLk9fQ1JFQVRFfG9zLk9fQVBQRU5EfG9zLk9fUkRXUiwgMDY2NikKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBlcnIKCX0KCWRlZmVyIGZ1bmMoKSB7CgkJY2xvc2VFcnIgOj0gZi5DbG9zZSgpCgkJaWYgY2xvc2VFcnIgIT0gbmlsIHsKCQkJZXJyID0gY2xvc2VFcnIKCQl9Cgl9KCkKCgliLCBlcnIgOj0gaW8uUmVhZEFsbChmKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIGVycgoJfQoJaWYgIWJ5dGVzLkhhc1N1ZmZpeChiLCBbXWJ5dGUoYXR0cikpIHsKCQlfLCBlcnIgOj0gZi5Xcml0ZVN0cmluZyhhdHRyKQoJCXJldHVybiBlcnIKCX0KCglyZXR1cm4gbmlsCn0KCmZ1bmMgKHIgKmdpdFJlcG8pIHJ1bkdpdChjdHggY29udGV4dC5Db250ZXh0LCBjbWRsaW5lIC4uLmFueSkgKFtdYnl0ZSwgZXJyb3IpIHsKCWFyZ3MgOj0gUnVuQXJnc3tjbWRsaW5lOiBjbWRsaW5lLCBkaXI6IHIuZGlyLCBsb2NhbDogci5sb2NhbH0KCWlmICFyLmxvY2FsIHsKCQkvLyBNYW51YWxseSBzdXBwbHkgR0lUX0RJUiBzbyBHaXQgd29ya3Mgd2l0aCBzYWZlLmJhcmVSZXBvc2l0b3J5PWV4cGxpY2l0IHNldC4KCQkvLyBUaGlzIGlzIG5lY2Vzc2FyeSBvbmx5IGZvciByZW1vdGUgcmVwb3NpdG9yaWVzIGFzIHRoZXkgYXJlIGluaXRpYWxpemVkIHdpdGggZ2l0IGluaXQgLS1iYXJlLgoJCWFyZ3MuZW52ID0gW11zdHJpbmd7IkdJVF9ESVI9IiArIHIuZGlyfQoJfQoJcmV0dXJuIFJ1bldpdGhBcmdzKGN0eCwgYXJncykKfQoKLy8gQ2FwdHVyZSB0aGUgbWFqb3IsIG1pbm9yIGFuZCAob3B0aW9uYWxseSkgcGF0Y2ggdmVyc2lvbiwgYnV0IGlnbm9yZSBhbnl0aGluZyBsYXRlcgp2YXIgZ2l0VmVyc0xpbmVFeHRyYWN0ID0gcmVnZXhwLk11c3RDb21waWxlKGBnaXQgdmVyc2lvblxzKyhcZCtcLlxkKyg/OlwuXGQrKT8pYCkKCmZ1bmMgZ2l0VmVyc2lvbigpIChzdHVybiBkaXJuYW1lLCBiYXNlbmFtZQp9CgpmdW5jIGRpcm5hbWUocGF0aCBzdHJpbmcpIHN0cmluZyB7Cgl2b2wgOj0gZmlsZXBhdGhsaXRlLlZvbHVtZU5hbWUocGF0aCkKCWkgOj0gbGVuKHBhdGgpIC0gMQoJZm9yIGkgPj0gbGVuKHZvbCkgJiYgIUlzUGF0aFNlcGFyYXRvcihwYXRoW2ldKSB7CgkJaS0tCgl9CglkaXIgOj0gcGF0aFtsZW4odm9sKSA6IGkrMV0KCWxhc3QgOj0gbGVuKGRpcikgLSAxCglpZiBsYXN0ID4gMCAmJiBJc1BhdGhTZXBhcmF0b3IoZGlyW2xhc3RdKSB7CgkJZGlyID0gZGlyWzpsYXN0XQoJfQoJaWYgZGlyID09ICIiIHsKCQlkaXIgPSAiLiIKCX0KCXJldHVybiB2b2wgKyBkaXIKfQoKLy8gZml4TG9uZ1BhdGggcmV0dXJucyB0aGUgZXh0ZW5kZWQtbGVuZ3RoIChcXD9cLXByZWZpeGVkKSBmb3JtIG9mCi8vIHBhdGggd2hlbiBuZWVkZWQsIGluIG9yZGVyIHRvIGF2b2lkIHRoZSBkZWZhdWx0IDI2MCBjaGFyYWN0ZXIgZmlsZQovLyBwYXRoIGxpbWl0IGltcG9zZWQgYnkgV2luZG93cy4gSWYgdGhlIHBhdGggaXMgc2hvcnQgZW5vdWdoIG9yIGFscmVhZHkKLy8gaGFzIHRoZSBleHRlbmRlZC1sZW5ndGggcHJlZml4LCBmaXhMb25nUGF0aCByZXR1cm5zIHBhdGggdW5tb2RpZmllZC4KLy8gSWYgdGhlIHBhdGggaXMgcmVsYXRpdmUgYW5kIGpvaW5pbmcgaXQgd2l0aCB0aGUgY3VycmVudCB3b3JraW5nCi8vIGRpcmVjdG9yeSByZXN1bHRzIGluIGEgcGF0aCB0aGF0IGlzIHRvbyBsb25nLCBmaXhMb25nUGF0aCByZXR1cm5zCi8vIHRoZSBhYnNvbHV0ZSBwYXRoIHdpdGggdGhlIGV4dGVuZGVkLWxlbmd0aCBwcmVmaXguCi8vCi8vIFNlZSBodHRwczovL2xlYXJuLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy93aW4zMi9maWxlaW8vbmFtaW5nLWEtZmlsZSNtYXhpbXVtLXBhdGgtbGVuZ3RoLWxpbWl0YXRpb24KZnVuYyBmaXhMb25nUGF0aChwYXRoIHN0cmluZykgc3RyaW5nIHsKCWlmIHdpbmRvd3MuQ2FuVXNlTG9uZ1BhdGhzIHsKCQlyZXR1cm4gcGF0aAoJfQoJcmV0dXJuIGFkZEV4dGVuZGVkUHJlZml4KHBhdGgpCn0KCi8vIGFkZEV4dGVuZGVkUHJlZml4IGFkZHMgdGhlIGV4dGVuZGVkIHBhdGggcHJlZml4IChcXD9cKSB0byBwYXRoLgpmdW5jIGFkZEV4dGVuZGVkUHJlZml4KHBhdGggc3RyaW5nKSBzdHJpbmcgewoJaWYgbGVuKHBhdGgpID49IDQgewoJCWlmIHBhdGhbOjRdID09IGBcPz9cYCB7CgkJCS8vIEFscmVhZHkgZXh0ZW5kZWQgd2l0aCBcPz9cCgkJCXJldHVybiBwYXRoCgkJfQoJCWlmIElzUGF0aFNlcGFyYXRvcihwYXRoWzBdKSAmJiBJc1BhdGhTZXBhcmF0b3IocGF0aFsxXSkgJiYgcGF0aFsyXSA9PSAnPycgJiYgSXNQYXRoU2VwYXJhdG9yKHBhdGhbM10pIHsKCQkJLy8gQWxyZWFkeSBleHRlbmRlZCB3aXRoIFxcP1wgb3IgYW55IGNvbWJpbmF0aW9uIG9mIGRpcmVjdG9yeSBzZXBhcmF0b3JzLgoJCQlyZXR1cm4gcGF0aAoJCX0KCX0KCgkvLyBEbyBub3RoaW5nIChhbmQgZG9uJ3QgYWxsb2NhdGUpIGlmIHRoZSBwYXRoIGlzICJzaG9ydCIuCgkvLyBFbXBpcmljYWxseSAoYXQgbGVhc3Qgb24gdGhlIFdpbmRvd3MgU2VydmVyIDIwMTMgYnVpbGRlciksCgkvLyB0aGUga2VybmVsIGlzIGFyYml0cmFyaWx5IG9rYXkgd2l0aCA8IDI0OCBieXRlcy4gVGhhdAoJLy8gbWF0Y2hlcyB3aGF0IHRoZSBkb2NzIGFib3ZlIHNheToKCS8vICJXaGVuIHVzaW5nIGFuIEFQSSB0byBjcmVhdGUgYSBkaXJlY3RvcnksIHRoZSBzcGVjaWZpZWQKCS8vIHBhdGggY2Fubm90IGJlIHNvIGxvbmcgdGhhdCB5b3UgY2Fubm90IGFwcGVuZCBhbiA4LjMgZmlsZQoJLy8gbmFtZSAodGhhdCBpcywgdGhlIGRpcmVjdG9yeSBuYW1lIGNhbm5vdCBleGNlZWQgTUFYX1BBVEgKCS8vIG1pbnVzIDEyKS4iIFNpbmNlIE1BWF9QQVRIIGlzIDI2MCwgMjYwIC0gMTIgPSAyNDguCgkvLwoJLy8gVGhlIE1TRE4gZG9jcyBhcHBlYXIgdG8gc2F5IHRoYXQgYSBub2NoZWNrVmFsKGxpbmUsIGNvdW50IHVpbnQzMiwgdmFsIGludCkgaW50IHsKCWIgOj0gYmxvY2t7CgkJY291bnQsCgkJbGluZSwKCX0KCWNvdW50ZXJzW2JdID0gdHJ1ZQoJcmV0dXJuIHZhbAp9Cgp2YXIgUEFTUyA9IHRydWUKCi8vIHZlcmlmeSBjaGVja3MgdGhlIGV4cGVjdGVkIGNvdW50cyBhZ2FpbnN0IHRoZSBhY3R1YWwuIEl0IHJ1bnMgYWZ0ZXIgdGhlIHRlc3QgaGFzIGNvbXBsZXRlZC4KZnVuYyB2ZXJpZnkoKSB7Cglmb3IgYiA6PSByYW5nZSBjb3VudGVycyB7CgkJZ290LCBpbmRleCA6PSBjb3VudChiLmxpbmUpCgkJaWYgYi5jb3VudCA9PSBhbnl0aGluZyAmJiBnb3QgIT0gMCB7CgkJCWdvdCA9IGFueXRoaW5nCgkJfQoJCWlmIGdvdCAhPSBiLmNvdW50IHsKCQkJZm10LkZwcmludGYob3MuU3RkZXJyLCAidGVzdF9nbzolZCBleHBlY3RlZCBjb3VudCAlZCBnb3QgJWQgW2NvdW50ZXIgJWRdXG4iLCBiLmxpbmUsIGIuY291bnQsIGdvdCwgaW5kZXgpCgkJCVBBU1MgPSBmYWxzZQoJCX0KCX0KCXZlcmlmeVBhbmljKCkKCWlmICFQQVNTIHsKCQlmbXQuRnByaW50Zihvcy5TdGRlcnIsICJGQUlMXG4iKQoJCW9zLkV4aXQoMikKCX0KfQoKLy8gdmVyaWZ5UGFuaWMgaXMgYSBzcGVjaWFsIGNoZWNrIGZvciB0aGUga25vd24gY291bnRlciB0aGF0IHNob3VsZCBiZQovLyBhZnRlciB0aGUgcGFuaWMgY2FsbCBpbiB0ZXN0UGFuaWMuCmZ1bmMgdmVyaWZ5UGFuaWMoKSB7CglpZiBjb3ZlclRlc3QuQ291bnRbcGFuaWNJbmRleC0xXSAhPSAxIHsKCQkvLyBTYW5pdHkgY2hlY2sgZm9yIHRlc3QgYmVmb3JlIHBhbmljLgoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgImJhZCBiZWZvcmUgcGFuaWMiKQoJCVBBU1MgPSBmYWxzZQoJfQoJaWYgY292ZXJUZXN0LkNvdW50W3BhbmljSW5kZXhdICE9IDAgewoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgImJhZCBhdCBwYW5pYzogJWQgc2hvdWxkIGJlIDBcbiIsIGNvdmVyVGVzdC5Db3VudFtwYW5pY0luZGV4XSkKCQlQQVNTID0gZmFsc2UKCX0KCWlmIGNvdmVyVGVzdC5Db3VudFtwYW5pY0luZGV4KzFdICE9IDEgewoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgImJhZCBhZnRlciBwYW5pYyIpCgkJUEFTUyA9IGZhbHNlCgl9Cn0KCi8vIGNvdW50IHJldHVybnMgdGhlIGNvdW50IGFuZCBpbmRleCBmb3IgdGhlIGNvdW50ZXIgYXQgdGhlIHNwZWNpZmllZCBsaW5lLgpmdW5jIGNvdW50KGxpbmUgdWludDMyKSAodWludDMyLCBpbnQpIHsKCS8vIExpbmVhciBzZWFyY2ggaXMgZmluZS4gQ2hvb3NlIHBlcmZlY3QgZml0IG92ZXIgYXBwcm94aW1hdGUuCgkvLyBXZSBjYW4gaGF2ZSBhIGNsb3NpbmcgYnJhY2UgZm9yIGEgcmFuZ2Ugb24gdGhlIHNhbWUgbGluZSBhcyBhIGNvbmRpdGlvbiBmb3IgYW4gImVsc2UgaWYiCgkvLyBhbmQgd2UgZG9uJ3Qgd2FudCB0aGF0IGJyYWNlIHRvIHN0ZWFsIHRoZSBjb3VudCBmb3IgdGhlIGNvbmRpdGlvbiBvbiB0aGUgImlmIi4KCS8vIFRoZXJlZm9yZSB3ZSB0ZXN0IGZvciBhIHBlcmZlY3QgKGxvPT1saW5lICYmIGhpPT1saW5lKSBtYXRjaCwgYnV0IGlmIHdlIGNhbid0CgkvLyBmaW5kIHRoYXQgd2UgdGFrZSB0aGUgZmlyc3QgaW1wZXJmZWN0IG1hdGNoLgoJaW5kZXggOj0gLTEKCWluZGV4TG8gOj0gdWludDMyKDFlOSkKCWZvciBpIDo9IHJhbmdlIGNvdmVyVGVzdC5Db3VudCB7CgkJbG8sIGhpIDo9IGNvdmVyVGVzdC5Qb3NbMyppXSwgY292ZXJUZXN0LlBvc1szKmkrMV0KCQlpZiBsbyA9PSBsaW5lICYmIGxpbmUgPT0gaGkgewoJCQlyZXR1cm4gY292ZXJUZXN0LkNvdW50W2ldLCBpCgkJfQoJCS8vIENob29zZSB0aGUgZWFybGllc3QgbWF0Y2ggKHRoZSBjb3VudGVycyBhcmUgaW4gdW5wcmVkaWN0YWJsZSBvcmRlcikuCgkJaWYgbG8gPD0gbGluZSAmJiBsaW5lIDw9IGhpICYmIGluZGV4TG8gPiBsbyB7CgkJCWluZGV4ID0gaQoJCQlpbmRleExvID0gbG8KCQl9Cgl9CglpZiBpbmRlc2VsZgovL2dvOmxpbmtuYW1lIGxpYnB0aHJlYWRfa2lsbCBsaWJwdGhyZWFkX2tpbGwKCnZhciAoCgkvL2xpYmMKCWxpYmNfX0Vycm5vLAoJbGliY19jbG9ja19nZXR0aW1lLAoJbGliY19jbG9zZSwKCWxpYmNfZXhpdCwKCWxpYmNfZ2V0cGlkLAoJbGliY19nZXRzeXN0ZW1jZmcsCglsaWJjX2tpbGwsCglsaWJjX21hZHZpc2UsCglsaWJjX21hbGxvYywKCWxpYmNfbW1hcCwKCWxpYmNfbXByb3RlY3QsCglsaWJjX211bm1hcCwKCWxpYmNfb3BlbiwKCWxpYmNfcGlwZSwKCWxpYmNfcmFpc2UsCglsaWJjX3JlYWQsCglsaWJjX3NjaGVkX3lpZWxkLAoJbGliY19zZW1faW5pdCwKCWxpYmNfc2VtX3Bvc3QsCglsaWJjX3NlbV90aW1lZHdhaXQsCglsaWJjX3NlbV93YWl0LAoJbGliY19zZXRpdGltZXIsCglsaWJjX3NpZ2FjdGlvbiwKCWxpYmNfc2lnYWx0c3RhY2ssCglsaWJjX3N5c2NvbmYsCglsaWJjX3VzbGVlcCwKCWxpYmNfd3JpdGUsCglsaWJjX2dldHVpZCwKCWxpYmNfZ2V0ZXVpZCwKCWxpYmNfZ2V0Z2lkLAoJbGliY19nZXRlZ2lkLAoJLy9saWJwdGhyZWFkCglsaWJwdGhyZWFkX19fcHRoX2luaXQsCglsaWJwdGhyZWFkX2F0dHJfZGVzdHJveSwKCWxpYnB0aHJlYWRfYXR0cl9pbml0LAoJbGlicHRocmVhZF9hdHRyX2dldHN0YWNrc2l6ZSwKCWxpYnB0aHJlYWRfYXR0cl9zZXRzdGFja3NpemUsCglsaWJwdGhyZWFkX2F0dHJfc2V0ZGV0YWNoc3RhdGUsCglsaWJwdGhyZWFkX2F0dHJfc2V0c3RhY2thZGRyLAoJbGlicHRocmVhZF9jcmVhdGUsCglsaWJwdGhyZWFkX3NpZ3RocmVhZG1hc2ssCglsaWJwdGhyZWFkX3NlbGYsCglsaWJwdGhyZWFkX2tpbGwgbGliRnVuYwopCgp0eXBlIGxpYkZ1bmMgdWludHB0cgoKLy8gYXNtc3lzY2FsbDYgY2FsbHMgdGhlIGxpYmMgc3ltYm9sIHVzaW5nIGEgQyBjb252ZW50aW9uLgovLyBJdCdzIGRlZmluZWQgaW4gc3lzX2FpeF9wcGM2NC5nby4KdmFyIGFzbXN5c2NhbGw2IGxpYkZ1bmMKCi8vIHN5c2NhbGxYIGZ1bmN0aW9ucyBtdXN0IGFsd2F5cyBiZSBjYWxsZWQgd2l0aCBnICE9IG5pbCBhbmQgbSAhPSBuaWwsCi8vIGFzIGl0IHJlbGllcyBvbiBnLm0ubGliY2FsbCB0byBwYXNzIGFyZ3VtZW50cyB0byBhc21jZ29jYWxsLgovLyBUaGUgZmV3IGNhc2VzIHdoZXJlIHN5c2NhbGxzIGhhdmVuJ3QgYSBnIG9yIGEgbSBtdXN0IGNhbGwgdGhlaXIgZXF1aXZhbGVudAovLyBmdW5jdGlvbiBpbiBzeXNfYWl4X3BwYzY0LnMgdG8gaGFuZGxlIHRoZW0uCgovL2dvOm5vd3JpdGViYXJyaWVyCi8vZ286bm9zcGxpdApmdW5jIHN5c2NhbGwwKGZuICpsaWJGdW5jKSAociwgZXJyIHVpbnRwdHIpIHsKCWdwIDo9IGdldGcoKQoJbXAgOj0gZ3AubQoJcmVzZXRMaWJjYWxsIDo9IHRydWUKCWlmIG1wLmxpYmNhbGxzcCA9PSAwIHsKCQltcC5saWJjYWxsZy5zZXQoZ3ApCgkJbXAubGliY2FsbHBjID0gc3lzLkdldENhbGxlclBDKCkKCQkvLyBzcCBtdXN0IGJlIHRoZSBsYXN0LCBiZWNhdXNlIG9uY2UgYXN5bmMgY3B1IHByb2ZpbGVyIGZpbmRzCgkJLy8gYWxsIHRocmVlIHZhbHVlcyB0byBiZSBub24temVybywgaXQgd2lsbCB1c2UgdGhlbQoJCW1wLmxpYmNhbGxzcCA9IHN5cy5HZXRDYWxsZXJTUCgpCgl9IGVsc2UgewoJCXJlc2V0TGliY2FsbCA9IGZhbHNlIC8vIFNlZSBjb21tZW50IGluIHN5c19kYXJ3aW4uZ286bGliY0NhbGwKCX0KCgljIDo9IGxpYmNhbGx7CgkJZm46ICAgdWludHB0cih1bnNhZmUuUG9pbnRlcihmbikpLAoJCW46ICAgIDAsCgkJYXJnczogdWludHB0cih1bnNhZmUuUG9pbnRlcigmZm4pKSwgLy8gaXQncyB1bnVzZWQgYnV0IG11c3QgYmUgbm9uLW5pbCwgb3RoZXJ3aXNlIGNyYXNoZXMKCX0KCglhc21jZ29jYWxsKHVuc2FmZS5Qb2ludGVyKCZhc21zeXNjYWxsNiksIHVuc2FmZS5Qb2ludGVyKCZjKSkKCglpZiByZXNldExpYmNhbGwgewoJCW1wLmxpYmNhbGxzcCA9IDAKCX0KCglyZXR1cm4gYy5yMSwgYy5lcnIKfWFsL3J1bnRpbWUvZ2MiCgkiaW50ZXJuYWwvcnVudGltZS9zeXMiCgkiaW50ZXJuYWwvdHJhY2UvdHJhY2V2MiIKKQoKLy8gQmF0Y2ggdHlwZSB2YWx1ZXMgZm9yIHRoZSBhbGxvYy9mcmVlIGV4cGVyaW1lbnQuCmNvbnN0ICgKCXRyYWNlQWxsb2NGcmVlVHlwZXNCYXRjaCA9IGlvdGEgLy8gQ29udGFpbnMgdHlwZXMuIFt7aWQsIGFkZHJlc3MsIHNpemUsIHB0cnNwYW4sIG5hbWUgbGVuZ3RoLCBuYW1lIHN0cmluZ30gLi4uXQoJdHJhY2VBbGxvY0ZyZWVJbmZvQmF0Y2ggICAgICAgICAvLyBDb250YWlucyBpbmZvIGZvciBpbnRlcnByZXRpbmcgZXZlbnRzLiBbbWluIGhlYXAgYWRkciwgcGFnZSBzaXplLCBtaW4gaGVhcCBhbGlnbiwgbWluIHN0YWNrIGFsaWduXQopCgovLyB0cmFjZVNuYXBzaG90TWVtb3J5IHRha2VzIGEgc25hcHNob3Qgb2YgYWxsIHJ1bnRpbWUgbWVtb3J5IHRoYXQgdGhlcmUgYXJlIGV2ZW50cyBmb3IKLy8gKGhlYXAgc3BhbnMsIGhlYXAgb2JqZWN0cywgZ29yb3V0aW5lIHN0YWNrcywgZXRjLikgYW5kIHdyaXRlcyBvdXQgZXZlbnRzIGZvciB0aGVtLgovLwovLyBUaGUgd29ybGQgbXVzdCBiZSBzdG9wcGVkIGFuZCB0cmFjaW5nIG11c3QgYmUgZW5hYmxlZCB3aGVuIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkLgpmdW5jIHRyYWNlU25hcHNob3RNZW1vcnkoZ2VuIHVpbnRwdHIpIHsKCWFzc2VydFdvcmxkU3RvcHBlZCgpCgoJLy8gV3JpdGUgYSBiYXRjaCBjb250YWluaW5nIGluZm9ybWF0aW9uIHRoYXQnbGwgYmUgbmVjZXNzYXJ5IHRvCgkvLyBpbnRlcnByZXQgdGhlIGV2ZW50cy4KCXZhciBmbHVzaGVkIGJvb2wKCXcgOj0gdW5zYWZlVHJhY2VFeHBXcml0ZXIoZ2VuLCBuaWwsIHRyYWNldjIuQWxsb2NGcmVlKQoJdywgZmx1c2hlZCA9IHcuZW5zdXJlKDEgKyA0KnRyYWNlQnl0ZXNQZXJOdW1iZXIpCglpZiBmbHVzaGVkIHsKCQkvLyBBbm5vdGF0ZSB0aGUgYmF0Y2ggYXMgY29udGFpbmluZyBhZGRpdGlvbmFsIGluZm8uCgkJdy5ieXRlKGJ5dGUodHJhY2VBbGxvY0ZyZWVJbmZvQmF0Y2gpKQoJfQoKCS8vIEVtaXQgaW5mby4KCXcudmFyaW50KHRyYWNlLm1pblBhZ2VIZWFwQWRkcikKCXcudmFyaW50KHVpbnQ2NChwYWdlU2l6ZSkpCgl3LnZhcmludCh1aW50NjQoZ2MuTWluSGVhcEFsaWduKSkKCXcudmFyaW50KHVpbnQ2NChmaXhlZFN0YWNrKSkKCgkvLyBGaW5pc2ggd3JpdGluZyB0aGUgYmF0Y2guCgl3LmZsdXNoKCkuZW5kKCkKCgkvLyBTdGFydCB0cmFjaW5nLgoJdHJhY2UgOj0gdHJhY2VBY3F1aXJlKCkKCWlmICF0cmFjZS5vaygpIHsKCQl0aHJvdygidHJhY2VTbmFwc2hvdE1lbW9yeTogdHJhY2luZyBpcyBub3QgZW5hYmxlZCIpCgl9CgoJLy8gV3JpdGUgb3V0IGFsbCB0aGUgaGVhcCBzcGFucyBhbmQgaGVhcCBvYmplY3RzLgoJZm9yIF8sIHMgOj0gcmFuZ2UgbWhlYXBfLmFsbHNwYW5zIHsKCQlpZiBzLnN0YXRlLmdldCgpID09IG1TcGFuRGVhZCB7CgkJCWNvbnRpbnVlCgkJfQoJCS8vIEl0J3Mgc29tZSBraW5kIG9mIHNwYW4sIHNvIHRyYWNlIHRoYXQgaXQgZXhpc3RzLgoJCXRyYWNlLlNwYW5FeGlzdHMocykKCgkJLy8gV3JpdGUgb3V0IGFsbG9jYXRlZCBvYmplY3RzIGlmIGl0J3MgYSBoZWFwIHNwYW4uCgkJaWYgcy5zdGF0ZS5nZXQoKSAhPSBtU3BhbkluVXNlIHsKCQkJY29udGludWUKCQl9CgoJCS8vIEZpbmQgYWxsIGFsbG9jYXRlZCBvYmplY3RzLgoJCWFiaXRzIDo9IHMuYWxsb2NCaXRzRm9ySW5kZXgoMCkKCQlmb3IgaSA6PSB1aW50cHRyKDApOyBpIDwgdWludHB0cihzLm5lbGVtcyk7IGkrKyB7CgkJCWlmIGFiaXRzLmluZGV4IDwgdWludHB0cihzLmZyZWVpbmRleCkgfHwgYWJpdHMuaXNNYXJrZWQoKSB7CgkJCQl4IDo9IHMuYmFzZSgpICsgaSpzLmVsZW1zaXplCgkJCQl0cmFjZS5IZWFwT2JqZWN0RXhpc3RzKHgsIHMudHlwZVBvaW50ZXJzT2ZVbmNoZWNrZWQoeCkudHlwKQoJCQl9CgkJCWFiaXRzLmFkdmFuY2UoKQp4MTAKCVJUVl9TU1RIUkVTSCAgICAgICAgICAgICAgICAgICAgICA9IDB4MjAKCVJVU0FHRV9DSElMRFJFTiAgICAgICAgICAgICAgICAgICA9IC0weDEKCVJVU0FHRV9TRUxGICAgICAgICAgICAgICAgICAgICAgICA9IDB4MAoJU0NNX0NSRURTICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0CglTQ01fUklHSFRTICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCVNDTV9USU1FU1RBTVAgICAgICAgICAgICAgICAgICAgICA9IDB4OAoJU0hVVF9SRCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgwCglTSFVUX1JEV1IgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIKCVNIVVRfV1IgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MQoJU0lPQ0FERE1VTFRJICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDkwNjkzMQoJU0lPQ0FERFJUICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDM4NzIwYQoJU0lPQ0FJRkFERFIgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDQwNjkxYQoJU0lPQ0FMSUZBRERSICAgICAgICAgICAgICAgICAgICAgID0gMHg4MTE4NjkxYwoJU0lPQ0FUTUFSSyAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0MDA0NzMwNwoJU0lPQ0RFTE1VTFRJICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDkwNjkzMgoJU0lPQ0RFTFJUICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDM4NzIwYgoJU0lPQ0RJRkFERFIgICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDkwNjkxOQoJU0lPQ0RJRlBIWUFERFIgICAgICAgICAgICAgICAgICAgID0gMHg4MDkwNjk0OQoJU0lPQ0RMSUZBRERSICAgICAgICAgICAgICAgICAgICAgID0gMHg4MTE4NjkxZQoJU0lPQ0dEUlZTUEVDICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDI4Njk3YgoJU0lPQ0dFVFBGU1lOQyAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjlmOAoJU0lPQ0dFVFNHQ05UICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDIwNzUzNAoJU0lPQ0dFVFZJRkNOVCAgICAgICAgICAgICAgICAgICAgID0gMHhjMDI4NzUzMwoJU0lPQ0dISVdBVCAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0MDA0NzMwMQoJU0lPQ0dJRkFERFIgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkyMQoJU0lPQ0dJRkFERFJQUkVGICAgICAgICAgICAgICAgICAgID0gMHhjMDk4NjkyMAoJU0lPQ0dJRkFMSUFTICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDQwNjkxYgoJU0lPQ0dJRkJSREFERFIgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkyMwoJU0lPQ0dJRkNBUCAgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDIwNjk3NgoJU0lPQ0dJRkNPTkYgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDEwNjkyNgoJU0lPQ0dJRkRBVEEgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDk4Njk4NQoJU0lPQ0dJRkRMVCAgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjk3NwoJU0lPQ0dJRkRTVEFERFIgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkyMgoJU0lPQ0dJRkZMQUdTICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkxMQoJU0lPQ0dJRkdFTkVSSUMgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkzYQoJU0lPQ0dJRk1FRElBICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDMwNjkzNgoJU0lPQ0dJRk1FVFJJQyAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkxNwoJU0lPQ0dJRk1UVSAgICAgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjk3ZQoJU0lPQ0dJRk5FVE1BU0sgICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjkyNQoJU0lPQ0dJRlBEU1RBRERSICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjk0OAoJU0lPQ0dJRlBTUkNBRERSICAgICAgICAgICAgICAgICAgID0gMHhjMDkwNjk0NwoJU0lPQ0dMSUZBRERSICAgICAgICAgICAgICAgICAgICAgID0gMHhjMTE4NjkxZAoJU0lPQ0dMSUZQPSAweGEwMAoJRVRIRVJUWVBFX0lFRUVQVVBBVCAgICAgICAgICAgICAgID0gMHhhMDEKCUVUSEVSVFlQRV9JTUxCTCAgICAgICAgICAgICAgICAgICA9IDB4NGM0MgoJRVRIRVJUWVBFX0lNTEJMRElBRyAgICAgICAgICAgICAgID0gMHg0MjRjCglFVEhFUlRZUEVfSVAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwMAoJRVRIRVJUWVBFX0lQQVMgICAgICAgICAgICAgICAgICAgID0gMHg4NzZjCglFVEhFUlRZUEVfSVBWNiAgICAgICAgICAgICAgICAgICAgPSAweDg2ZGQKCUVUSEVSVFlQRV9JUFggICAgICAgICAgICAgICAgICAgICA9IDB4ODEzNwoJRVRIRVJUWVBFX0lQWE5FVyAgICAgICAgICAgICAgICAgID0gMHg4MDM3CglFVEhFUlRZUEVfS0FMUEFOQSAgICAgICAgICAgICAgICAgPSAweDg1ODIKCUVUSEVSVFlQRV9MQU5CUklER0UgICAgICAgICAgICAgICA9IDB4ODAzOAoJRVRIRVJUWVBFX0xBTlBST0JFICAgICAgICAgICAgICAgID0gMHg4ODg4CglFVEhFUlRZUEVfTEFUICAgICAgICAgICAgICAgICAgICAgPSAweDYwMDQKCUVUSEVSVFlQRV9MQkFDSyAgICAgICAgICAgICAgICAgICA9IDB4OTAwMAoJRVRIRVJUWVBFX0xJVFRMRSAgICAgICAgICAgICAgICAgID0gMHg4MDYwCglFVEhFUlRZUEVfTE9HSUNSQUZUICAgICAgICAgICAgICAgPSAweDgxNDgKCUVUSEVSVFlQRV9MT09QQkFDSyAgICAgICAgICAgICAgICA9IDB4OTAwMAoJRVRIRVJUWVBFX01BVFJBICAgICAgICAgICAgICAgICAgID0gMHg4MDdhCglFVEhFUlRZUEVfTUFYICAgICAgICAgICAgICAgICAgICAgPSAweGZmZmYKCUVUSEVSVFlQRV9NRVJJVCAgICAgICAgICAgICAgICAgICA9IDB4ODA3YwoJRVRIRVJUWVBFX01JQ1AgICAgICAgICAgICAgICAgICAgID0gMHg4NzNhCglFVEhFUlRZUEVfTU9QREwgICAgICAgICAgICAgICAgICAgPSAweDYwMDEKCUVUSEVSVFlQRV9NT1BSQyAgICAgICAgICAgICAgICAgICA9IDB4NjAwMgoJRVRIRVJUWVBFX01PVE9ST0xBICAgICAgICAgICAgICAgID0gMHg4MThkCglFVEhFUlRZUEVfTVBMUyAgICAgICAgICAgICAgICAgICAgPSAweDg4NDcKCUVUSEVSVFlQRV9NUExTX01DQVNUICAgICAgICAgICAgICA9IDB4ODg0OAoJRVRIRVJUWVBFX01VTVBTICAgICAgICAgICAgICAgICAgID0gMHg4MTNmCglFVEhFUlRZUEVfTkJQQ0MgICAgICAgICAgICAgICAgICAgPSAweDNjMDQKCUVUSEVSVFlQRV9OQlBDTEFJTSAgICAgICAgICAgICAgICA9IDB4M2MwOQoJRVRIRVJUWVBFX05CUENMUkVRICAgICAgICAgICAgICAgID0gMHgzYzA1CglFVEhFUlRZUEVfTkJQQ0xSU1AgICAgICAgICAgICAgICAgPSAweDNjMDYKCUVUSEVSVFlQRV9OQlBDUkVRICAgICAgICAgICAgICAgICA9IDB4M2MwMgoJRVRIRVJUWVBFX05CUENSU1AgICAgICAgICAgICAgICAgID0gMHgzYzAzCglFVEhFUlRZUEVfTkJQREcgICAgICAgICAgICAgICAgICAgPSAweDNjMDcKCUVUSEVSVFlQRV9OQlBER0IgICAgICAgICAgICAgICAgICA9IDB4M2MwOAoJRVRIRVJUWVBFX05CUERMVEUgICAgICAgICAgICAgICAgID0gMHgzYzBhCglFVEhFUlRZUEVfTkJQUkFSICAgICAgICAgICAgICAgICAgPSAweDNjMGMKCUVUSEVSVFlQRV9OQlBSQVMgICAgICAgICAgICAgICAgICA9IDB4M2MwYgoJRVRIRVJUWVBFX05CUFJTVCAgICAgICAgICAgICAgICAgID0gMHgzYzBkCglFVEhFUlRZUEVfTkJQU0NEICAgICAgICAgICAgICAgICAgPSAweDNjMDEKCUVUSEVSVFlQRV9OQlBWQ0QgICAgICAgICAgICAgICAgICA9IDB4M2MwMAoJRVRIRVJUWVBFX05CUyAgICAgICAgICAgICAgICAgICAgID0gMHg4MDIKCUVUSEVSVFlQRV9OQ0QgICAgICAgICAgICAgICAgICAgICA9IDB4ODE0OQoJRVRIRVJUWVBFX05FU1RBUiAgICAgICAgICAgICAgICAgID0gMHg4MDA2CglFVEhFUlRZUEVfTkVUQkVVSSAgICAgICAgICAgICAgICAgPSAweDgxOTEKCUVUSEVSVFlQRV9OT1ZFTEwgICBzIGEgdGhlb3JldGljYWwgcmVmYWN0b3JpbmcKLy8gb2YgdGhlIHR5cGUgY2hlY2tlciBpbiB3aGljaCB0aGV5IGFyZSBlbWl0dGVkIGluIGV4YWN0bHkgb25lIHBsYWNlLiBGb3IKLy8gZXhhbXBsZSwgdGhlIHR5cGUgY2hlY2tlciBlbWl0cyBkaWZmZXJlbnQgZXJyb3IgbWVzc2FnZXMgZm9yICJ0b28gbWFueQovLyBhcmd1bWVudHMiIGFuZCAidG9vIGZldyBhcmd1bWVudHMiLCBidXQgb25lIGNhbiBpbWFnaW5lIGFuIGFsdGVybmF0aXZlIHR5cGUKLy8gY2hlY2tlciB3aGVyZSB0aGlzIGNoZWNrIGluc3RlYWQganVzdCBlbWl0cyBhIHNpbmdsZSAid3JvbmcgbnVtYmVyIG9mCi8vIGFyZ3VtZW50cyIsIHNvIHRoZXNlIGVycm9ycyBzaG91bGQgaGF2ZSB0aGUgc2FtZSBjb2RlLgovLwovLyBFcnJvciBjb2RlIG5hbWVzIHNob3VsZCBiZSBhcyBicmllZiBhcyBwb3NzaWJsZSB3aGlsZSByZXRhaW5pbmcgYWNjdXJhY3kgYW5kCi8vIGRpc3RpbmN0aXZlbmVzcy4gSW4gbW9zdCBjYXNlcyBuYW1lcyBzaG91bGQgc3RhcnQgd2l0aCBhbiBhZGplY3RpdmUKLy8gZGVzY3JpYmluZyB0aGUgbmF0dXJlIG9mIHRoZSBlcnJvciAoZS5nLiAiaW52YWxpZCIsICJ1bnVzZWQiLCAibWlzcGxhY2VkIiksCi8vIGFuZCBlbmQgd2l0aCBhIG5vdW4gaWRlbnRpZnlpbmcgdGhlIHJlbGV2YW50IGxhbmd1YWdlIG9iamVjdC4gRm9yIGV4YW1wbGUsCi8vICJEdXBsaWNhdGVEZWNsIiBvciAiSW52YWxpZFNsaWNlRXhwciIuIEZvciBicmV2aXR5LCBuYW1pbmcgZm9sbG93cyB0aGUKLy8gY29udmVudGlvbiB0aGF0ICJiYWQiIGltcGxpZXMgYSBwcm9ibGVtIHdpdGggc3ludGF4LCBhbmQgImludmFsaWQiIGltcGxpZXMgYQovLyBwcm9ibGVtIHdpdGggdHlwZXMuCgpjb25zdCAoCgkvLyBJbnZhbGlkU3ludGF4VHJlZSBvY2N1cnMgaWYgYW4gaW52YWxpZCBzeW50YXggdHJlZSBpcyBwcm92aWRlZAoJLy8gdG8gdGhlIHR5cGUgY2hlY2tlci4gSXQgc2hvdWxkIG5ldmVyIGhhcHBlbi4KCUludmFsaWRTeW50YXhUcmVlIEVycm9yQ29kZSA9IC0xCikKCmNvbnN0ICgKCV8gRXJyb3JDb2RlID0gaW90YQoKCS8vIFRlc3QgaXMgcmVzZXJ2ZWQgZm9yIGVycm9ycyB0aGF0IG9ubHkgYXBwbHkgd2hpbGUgaW4gc2VsZi10ZXN0IG1vZGUuCglUZXN0CgoJLyogcGFja2FnZSBuYW1lcyAqLwoKCS8vIEJsYW5rUGtnTmFtZSBvY2N1cnMgd2hlbiBhIHBhY2thZ2UgbmFtZSBpcyB0aGUgYmxhbmsgaWRlbnRpZmllciAiXyIuCgkvLwoJLy8gUGVyIHRoZSBzcGVjOgoJLy8gICJUaGUgUGFja2FnZU5hbWUgbXVzdCBub3QgYmUgdGhlIGJsYW5rIGlkZW50aWZpZXIuIgoJQmxhbmtQa2dOYW1lCgoJLy8gTWlzbWF0Y2hlZFBrZ05hbWUgb2NjdXJzIHdoZW4gYSBmaWxlJ3MgcGFja2FnZSBuYW1lIGRvZXNuJ3QgbWF0Y2ggdGhlCgkvLyBwYWNrYWdlIG5hbWUgYWxyZWFkeSBlc3RhYmxpc2hlZCBieSBvdGhlciBmaWxlcy4KCU1pc21hdGNoZWRQa2dOYW1lCgoJLy8gSW52YWxpZFBrZ1VzZSBvY2N1cnMgd2hlbiBhIHBhY2thZ2UgaWRlbnRpZmllciBpcyB1c2VkIG91dHNpZGUgb2YgYQoJLy8gc2VsZWN0b3IgZXhwcmVzc2lvbi4KCS8vCgkvLyBFeGFtcGxlOgoJLy8gIGltcG9ydCAiZm10IgoJLy8KCS8vICB2YXIgXyA9IGZtdAoJSW52YWxpZFBrZ1VzZQoKCS8qIGltcG9ydHMgKi8KCgkvLyBCYWRJbXBvcnRQYXRoIG9jY3VycyB3aGVuIGFuIGltcG9ydCBwYXRoIGlzIG5vdCB2YWxpZC4KCUJhZEltcG9ydFBhdGgKCgkvLyBCcm9rZW5JbXBvcnQgb2NjdXJzIHdoZW4gaW1wb3J0aW5nIGEgcGFja2FnZSBmYWlscy4KCS8vCgkvLyBFeGFtcGxlOgoJLy8gIGltcG9ydCAiYW1pc3NpbmdwYWNrYWdlIgoJQnJva2VuSW1wb3J0CgoJLy8gSW1wb3J0Q1JlbmFtZWQgb2NjdXJzIHdoZW4gdGhlIHNwZWNpYWwgaW1wb3J0ICJDIiBpcyByZW5hbWVkLiAiQyIgaXMgYQoJLy8gcHNldWRvLXBhY2thZ2UsIGFuaWxkIGdvZXhwZXJpbWVudC5qc29udjIKCnBhY2thZ2UganNvbgoKaW1wb3J0ICgKCSJieXRlcyIKCSJjbXAiCgkiZXJyb3JzIgoJImZtdCIKCSJtYXRoIgoJIm1hdGgvYml0cyIKCSJyZWZsZWN0IgoJInN0cmNvbnYiCgkic3RyaW5ncyIKCSJ0aW1lIgoKCSJlbmNvZGluZy9qc29uL2ludGVybmFsIgoJImVuY29kaW5nL2pzb24vaW50ZXJuYWwvanNvbmZsYWdzIgoJImVuY29kaW5nL2pzb24vaW50ZXJuYWwvanNvbm9wdHMiCgkiZW5jb2RpbmcvanNvbi9pbnRlcm5hbC9qc29ud2lyZSIKCSJlbmNvZGluZy9qc29uL2pzb250ZXh0IgopCgp2YXIgKAoJdGltZUR1cmF0aW9uVHlwZSA9IHJlZmxlY3QuVHlwZUZvclt0aW1lLkR1cmF0aW9uXSgpCgl0aW1lVGltZVR5cGUgICAgID0gcmVmbGVjdC5UeXBlRm9yW3RpbWUuVGltZV0oKQopCgpmdW5jIG1ha2VUaW1lQXJzaGFsZXIoZm5jcyAqYXJzaGFsZXIsIHQgcmVmbGVjdC5UeXBlKSAqYXJzaGFsZXIgewoJLy8gSWRlYWxseSwgdGltZSB0eXBlcyB3b3VsZCBpbXBsZW1lbnQgTWFyc2hhbGVyVG8gYW5kIFVubWFyc2hhbGVyRnJvbSwKCS8vIGJ1dCB0aGF0IHdvdWxkIGluY3VyIGEgZGVwZW5kZW5jeSBvbiBwYWNrYWdlIGpzb24gZnJvbSBwYWNrYWdlIHRpbWUuCgkvLyBHaXZlbiBob3cgd2lkZWx5IHVzZWQgdGltZSBpcywgaXQgaXMgbW9yZSBhY2NlcHRhYmxlIHRoYXQgd2UgaW5jdXIgYQoJLy8gZGVwZW5kZW5jeSBvbiB0aW1lIGZyb20ganNvbi4KCS8vCgkvLyBJbmplY3RpbmcgdGhlIGFyc2hhbGluZyBmdW5jdGlvbmFsaXR5IGxpa2UgdGhpcyB3aWxsIG5vdCBiZSBpZGVudGljYWwKCS8vIHRvIGFjdHVhbGx5IGRlY2xhcmluZyBtZXRob2RzIG9uIHRoZSB0aW1lIHR5cGVzIHNpbmNlIGVtYmVkZGluZyBvZiB0aGUKCS8vIHRpbWUgdHlwZXMgd2lsbCBub3QgYmUgYWJsZSB0byBmb3J3YXJkIHRoaXMgZnVuY3Rpb25hbGl0eS4KCXN3aXRjaCB0IHsKCWNhc2UgdGltZUR1cmF0aW9uVHlwZToKCQlmbmNzLm5vbkRlZmF1bHQgPSB0cnVlCgkJbWFyc2hhbE5hbm8gOj0gZm5jcy5tYXJzaGFsCgkJZm5jcy5tYXJzaGFsID0gZnVuYyhlbmMgKmpzb250ZXh0LkVuY29kZXIsIHZhIGFkZHJlc3NhYmxlVmFsdWUsIG1vICpqc29ub3B0cy5TdHJ1Y3QpIGVycm9yIHsKCQkJeGUgOj0gZXhwb3J0LkVuY29kZXIoZW5jKQoJCQl2YXIgbSBkdXJhdGlvbkFyc2hhbGVyCgkJCWlmIG1vLkZvcm1hdCAhPSAiIiAmJiBtby5Gb3JtYXREZXB0aCA9PSB4ZS5Ub2tlbnMuRGVwdGgoKSB7CgkJCQlpZiAhbS5pbml0Rm9ybWF0KG1vLkZvcm1hdCkgewoJCQkJCXJldHVybiBuZXdJbnZhbGlkRm9ybWF0RXJyb3IoZW5jLCB0KQoJCQkJfQoJCQl9IGVsc2UgaWYgbW8uRmxhZ3MuR2V0KGpzb25mbGFncy5Gb3JtYXREdXJhdGlvbkFzTmFubykgewoJCQkJcmV0dXJuIG1hcnNoYWxOYW5vKGVuYywgdmEsIG1vKQoJCQl9IGVsc2UgewoJCQkJLy8gVE9ETyhodHRwczovL2dvLmRldi9pc3N1ZS83MTYzMSk6IERlY2lkZSBvbiBkZWZhdWx0IGR1cmF0aW9uIHJlcHJlc2VudGF0aW9uLgoJCQkJcmV0dXJuIG5ld01hcnNoYWxFcnJvckJlZm9yZShlbmMsIHQsIGVycm9ycy5OZXcoIm5vIGRlZmF1bHQgcmVwcmVzZW50YXRpb247IHNwZWNpZnkgYW4gZXhwbGljaXQgZm9ybWF0IikpCgkJCX0KCgkJCW0udGQsIF8gPSByZWZsZWN0LlR5cGVBc3NlcnRbdGltZS5EdXJhdGlvbl0odmEuVmFsdWUpCgkJCWsgOj0gc3RyaW5nT3JOdW1iZXJLaW5kKCFtLmlzTnVtZXJpYygpIHx8IHhlLlRva2Vucy5MYXN0Lk5lZWRPYmplY3ROYW1lKCkgfHwgbW8uRmxhZ3MuR2V0KGpzb25mbGFncy5TdHJpbmdpZnlOdW1iZXJzKSkKCQkJaWYgZXJyIDo9IHhlLkFwcGVuZFJhdyhrLCB0cnVlLCBtLmFwcGVuZE1hcnNoYWwpOyBlcnIgIT0gbmlsIHsKCQkJCWlmICFpc1N5bnRhY3RpY0Vycm9yKGVycikgJiYgIWV4cG9ydC5Jc0lPRXJyb3IoZXJyKSB7CgkJCQkJZXJyID0gbmV3TWllZCBpZi9zd2l0Y2ggY29uZGl0aW9uICdjb25kJwovLyB0byBzZWUgaWYgaXQgcmVmZXJzIHRvIGxvY2FscyBkZWZpbmVkIGJ5IGEgKHBvdGVudGlhbGx5IGlubGluYWJsZSkKLy8gZnVuY3Rpb24gY2FsbCBhdCBjYWxsIHNpdGUgQywgYW5kIGlmIHNvLCB3aGV0aGVyICdjb25kJyBjb250YWlucwovLyBvbmx5IGNvbWJpbmF0aW9ucyBvZiBzaW1wbGUgcmVmZXJlbmNlcyB0byBhbGwgb2YgdGhlIG5hbWVzIGluCi8vICduYW1lcycgd2l0aCBzZWxlY3RlZCBjb25zdGFudHMgKyBvcGVyYXRvcnMuIElmIHRoZXNlIGNyaXRlcmlhIGFyZQovLyBtZXQsIHRoZW4gd2UgYWRqdXN0IHRoZSBzY29yZSBmb3IgY2FsbCBzaXRlIEMgdG8gcmVmbGVjdCB0aGUKLy8gZmFjdCB0aGF0IGlubGluaW5nIHdpbGwgZW5hYmxlIGRlYWRjb2RlIGFuZC9vciBjb25zdGFudCBwcm9wYWdhdGlvbi4KLy8gTm90ZTogZm9yIHRoaXMgaGV1cmlzdGljIHRvIGtpY2sgaW4sIHRoZSBuYW1lcyBpbiBxdWVzdGlvbiBoYXZlIHRvCi8vIGJlIGFsbCBmcm9tIHRoZSBzYW1lIGNhbGxzaXRlLiBFeGFtcGxlczoKLy8KLy8JICBxLCByIDo9IGJheigpCSAgICB4LCB5IDo9IGZvbygpCi8vCSAgc3dpdGNoIHErciB7CQlhLCBiLCBjIDo9IGJhcigpCi8vCQkuLi4JCQkgICAgaWYgeCAmJiB5ICYmIGEgJiYgYiAmJiBjIHsKLy8JICB9CQkJCQkgICAuLi4KLy8JCQkJCSAgICB9Ci8vCi8vIEZvciB0aGUgY2FsbCB0byAiYmF6IiBhYm92ZSB3ZSBhcHBseSBhIHNjb3JlIGFkanVzdG1lbnQsIGJ1dCBub3QKLy8gZm9yIHRoZSBjYWxscyB0byAiZm9vIiBvciAiYmFyIi4KZnVuYyAocnVhICpyZXN1bHRVc2VBbmFseXplcikgZm9sZENoZWNrUmVzdWx0cyhjb25kIGlyLk5vZGUpIHsKCW5hbWVzVXNlZCA6PSBjb2xsZWN0TmFtZXNVc2VkKGNvbmQpCglpZiBsZW4obmFtZXNVc2VkKSA9PSAwIHsKCQlyZXR1cm4KCX0KCXZhciBjcyAqQ2FsbFNpdGUKCWZvciBfLCBuIDo9IHJhbmdlIG5hbWVzVXNlZCB7CgkJcnBjcywgZm91bmQgOj0gcnVhLnJlc3VsdE5hbWVUYWJbbl0KCQlpZiAhZm91bmQgewoJCQlyZXR1cm4KCQl9CgkJaWYgY3MgIT0gbmlsICYmIHJwY3MuZGVmY3MgIT0gY3MgewoJCQlyZXR1cm4KCQl9CgkJY3MgPSBycGNzLmRlZmNzCgkJaWYgcnBjcy5wcm9wcyZSZXN1bHRBbHdheXNTYW1lQ29uc3RhbnQgPT0gMCB7CgkJCXJldHVybgoJCX0KCX0KCWlmIGRlYnVnVHJhY2UmZGVidWdUcmFjZVNjb3JpbmcgIT0gMCB7CgkJbmxzIDo9IGZ1bmMobmwgW10qaXIuTmFtZSkgc3RyaW5nIHsKCQkJciA6PSAiIgoJCQlmb3IgXywgbiA6PSByYW5nZSBubCB7CgkJCQlyICs9ICIgIiArIG4uU3ltKCkuTmFtZQoJCQl9CgkJCXJldHVybiByCgkJfQoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgIj0tPSBjYWxsaW5nIFNob3VsZEZvbGRJZk5hbWVDb25zdGFudCBvbiBuYW1lcz17JXN9IGNvbmQ9JXZcbiIsIG5scyhuYW1lc1VzZWQpLCBjb25kKQoJfQoKCWlmICFTaG91bGRGb2xkSWZOYW1lQ29uc3RhbnQoY29uZCwgbmFtZXNVc2VkKSB7CgkJcmV0dXJuCgl9CglhZGogOj0gcmV0dXJuRmVlZHNDb25zdFRvSWZBZGoKCWNzLlNjb3JlLCBjcy5TY29yZU1hc2sgPSBhZGp1c3RTY29yZShhZGosIGNzLlNjb3JlLCBjcy5TY29yZU1hc2spCn0KCmZ1bmMgY29sbGVjdE5hbWVzVXNlZChleHByIGlyLk5vZGUpIFtdKmlyLk5hbWUgewoJcmVzIDo9IFtdKmlyLk5hbWV7fQoJaXIuVmlzaXQoZXhwciwgZnVuYyhuIGlyLk5vZGUpIHsKCQlpZiBuLk9wKCkgIT0gaXIuT05BTUUgewoJCQlyZXR1cm4KCQl9CgkJbm4gOj0gbi4oKmlyLk5hbWUpCgkJaWYgbm4uQ2xhc3MgIT0gaXIuUEFVVE8gewoJCQlyZXR1cm4KCQl9CgkJcmVzID0gYXBwZW5kKHJlcywgbm4pCgl9KQoJcmV0dXJuIHJlcwp9CgpmdW5jIChydWEgKnJlc3VsdFVzZUFuYWx5emVyKSByZXR1cm5IYXNQcm9wKG5hbWUgKmlyLk5hbWUsIHByb3AgUmVzdWx0UHJvcEJpdHMpICpjaGVkIHRocm91Z2ggYW5vdGhlciBwYXRoLiBUaGlzIGlzIGRvbmUgdG8gc2ltcGxpZnkgdGhlIGdyYXBoCi8vIHdoaWxlIHByZXNlcnZpbmcgY29ubmVjdGl2aXR5LgpmdW5jIChnICpHcmFwaCkgUmVtb3ZlUmVkdW5kYW50RWRnZXMoKSB7CgkvLyBXYWxrIHRoZSBub2RlcyBhbmQgb3V0Z29pbmcgZWRnZXMgaW4gcmV2ZXJzZSBvcmRlciB0byBwcmVmZXIKCS8vIHJlbW92aW5nIGVkZ2VzIHdpdGggdGhlIGxvd2VzdCB3ZWlnaHQuCglmb3IgaSA6PSBsZW4oZy5Ob2Rlcyk7IGkgPiAwOyBpLS0gewoJCW4gOj0gZy5Ob2Rlc1tpLTFdCgkJaW4gOj0gbi5Jbi5Tb3J0KCkKCQlmb3IgaiA6PSBsZW4oaW4pOyBqID4gMDsgai0tIHsKCQkJZSA6PSBpbltqLTFdCgkJCWlmICFlLlJlc2lkdWFsIHsKCQkJCS8vIERvIG5vdCByZW1vdmUgZWRnZXMgaGVhdmllciB0aGFuIGEgbm9uLXJlc2lkdWFsIGVkZ2UsIHRvCgkJCQkvLyBhdm9pZCBwb3RlbnRpYWwgY29uZnVzaW9uLgoJCQkJYnJlYWsKCQkJfQoJCQlpZiBpc1JlZHVuZGFudEVkZ2UoZSkgewoJCQkJZGVsZXRlKGUuU3JjLk91dCwgZS5EZXN0KQoJCQkJZGVsZXRlKGUuRGVzdC5JbiwgZS5TcmMpCgkJCX0KCQl9Cgl9Cn0KCi8vIGlzUmVkdW5kYW50RWRnZSBkZXRlcm1pbmVzIGlmIHRoZXJlIGlzIGEgcGF0aCB0aGF0IGFsbG93cyBlLlNyYwovLyB0byByZWFjaCBlLkRlc3QgYWZ0ZXIgcmVtb3ZpbmcgZS4KZnVuYyBpc1JlZHVuZGFudEVkZ2UoZSAqRWRnZSkgYm9vbCB7CglzcmMsIG4gOj0gZS5TcmMsIGUuRGVzdAoJc2VlbiA6PSBtYXBbKk5vZGVdYm9vbHtuOiB0cnVlfQoJcXVldWUgOj0gTm9kZXN7bn0KCWZvciBsZW4ocXVldWUpID4gMCB7CgkJbiA6PSBxdWV1ZVswXQoJCXF1ZXVlID0gcXVldWVbMTpdCgkJZm9yIF8sIGllIDo9IHJhbmdlIG4uSW4gewoJCQlpZiBlID09IGllIHx8IHNlZW5baWUuU3JjXSB7CgkJCQljb250aW51ZQoJCQl9CgkJCWlmIGllLlNyYyA9PSBzcmMgewoJCQkJcmV0dXJuIHRydWUKCQkJfQoJCQlzZWVuW2llLlNyY10gPSB0cnVlCgkJCXF1ZXVlID0gYXBwZW5kKHF1ZXVlLCBpZS5TcmMpCgkJfQoJfQoJcmV0dXJuIGZhbHNlCn0KCi8vIG5vZGVTb3J0ZXIgaXMgYSBtZWNoYW5pc20gdXNlZCB0byBhbGxvdyBhIHJlcG9ydCB0byBiZSBzb3J0ZWQKLy8gaW4gZGlmZmVyZW50IHdheXMuCnR5cGUgbm9kZVNvcnRlciBzdHJ1Y3QgewoJcnMgICBOb2RlcwoJbGVzcyBmdW5jKGwsIHIgKk5vZGUpIGJvb2wKfQoKZnVuYyAocyBub2RlU29ydGVyKSBMZW4oKSBpbnQgICAgICAgICAgIHsgcmV0dXJuIGxlbihzLnJzKSB9CmZ1bmMgKHMgbm9kZVNvcnRlcikgU3dhcChpLCBqIGludCkgICAgICB7IHMucnNbaV0sIHMucnNbal0gPSBzLnJzW2pdLCBzLnJzW2ldIH0KZnVuYyAocyBub2RlU29ydGVyKSBMZXNzKGksIGogaW50KSBib29sIHsgcmV0dXJuIHMubGVzcyhzLnJzW2ldLCBzLnJzW2pdKSB9CgovLyBTb3J0IHJlb3JkZXJzIGEgc2xpY2Ugb2Ygbm9kZXMgYmFzZWQgb24gdGhlIHNwZWNpZmllZCBvcmRlcmluZwovLyBjcml0ZXJpYS4gVGhlIHJlc3VsdCBpcyBzb3J0ZWQgaW4gZGVjcmVhc2luZyBvcmRlciBmb3IgKGFic29sdXRlKQovLyBudW1lcmljIHF1YW50aXRpZXMsIGFscGhhYmV0aWNhbGx5IGZvciB0ZXh0LCBhbmQgaW5jcmVhc2luZyBmb3IKLy8gYWRkcmVzc2VzLgpmdW5jIChucyBOb2RlcykgU29ydChvIE5vZGVPcmRlcikgZXJyb3IgewoJdmFyIHMgbm9kZVNvcnRlcgoKCXN3aXRjaCBvIHsKCWNhc2UgRmxhdE5hbWVPcmRlcjoKCQlzID0gbm9kZVNvcnRlcntucywKCQkJZnVuYyhsLCByICpOb2RlKSBib29sIHsKCQkJCWlmIGl2LCBqdiA6PSBhYnM2NChsLkZsYXQpLCBhYnM2NChyLkZsYXQpOyBpdiAhPSBqdiB7CgkJCQkJcmV0dXJuIGl2ID4ganYKCQkJCX0KCQkJCWVxdWFsLCBsZWZ0TGVzcyA6PSBsLkluZm8uY29tcGFyZVByaW50YWJsZU5hbWUoci5JbmZvKQoJCQkJaWYgIWVxdWFsY2Nlc3NmdWwuIElmIGl0IHJldHVybnMgZmFsc2UsIG5vIGRzdCBwaXhlbHMgd2VyZSBjaGFuZ2VkLgovLwovLyBUaGlzIGZ1bmN0aW9uIGFzc3VtZXMgdGhhdCByIGlzIGVudGlyZWx5IHdpdGhpbiBkc3QncyBib3VuZHMgYW5kIHRoZQovLyB0cmFuc2xhdGlvbiBvZiByIGZyb20gZHN0IGNvb3JkaW5hdGUgc3BhY2UgdG8gc3JjIGNvb3JkaW5hdGUgc3BhY2UgaXMKLy8gZW50aXJlbHkgd2l0aGluIHNyYydzIGJvdW5kcy4KZnVuYyBEcmF3WUNiQ3IoZHN0ICppbWFnZS5SR0JBLCByIGltYWdlLlJlY3RhbmdsZSwgc3JjICppbWFnZS5ZQ2JDciwgc3AgaW1hZ2UuUG9pbnQpIChvayBib29sKSB7CgkvLyBUaGlzIGZ1bmN0aW9uIGV4aXN0cyBpbiB0aGUgaW1hZ2UvaW50ZXJuYWwvaW1hZ2V1dGlsIHBhY2thZ2UgYmVjYXVzZSBpdAoJLy8gaXMgbmVlZGVkIGJ5IGJvdGggdGhlIGltYWdlL2RyYXcgYW5kIGltYWdlL2pwZWcgcGFja2FnZXMsIGJ1dCBpdCBkb2Vzbid0CgkvLyBzZWVtIHJpZ2h0IGZvciBvbmUgb2YgdGhvc2UgdHdvIHRvIGRlcGVuZCBvbiB0aGUgb3RoZXIuCgkvLwoJLy8gQW5vdGhlciBvcHRpb24gaXMgdG8gaGF2ZSB0aGlzIGNvZGUgYmUgZXhwb3J0ZWQgaW4gdGhlIGltYWdlIHBhY2thZ2UsCgkvLyBidXQgd2UnZCBuZWVkIHRvIG1ha2Ugc3VyZSB3ZSdyZSB0b3RhbGx5IGhhcHB5IHdpdGggdGhlIEFQSSAoZm9yIHRoZQoJLy8gcmVzdCBvZiBHbyAxIGNvbXBhdGliaWxpdHkpLCBhbmQgZGVjaWRlIGlmIHdlIHdhbnQgdG8gaGF2ZSBhIG1vcmUKCS8vIGdlbmVyYWwgcHVycG9zZSBEcmF3VG9SR0JBIG1ldGhvZCBmb3Igb3RoZXIgaW1hZ2UgdHlwZXMuIE9uZSBwb3NzaWJpbGl0eQoJLy8gaXM6CgkvLwoJLy8gZnVuYyAoc3JjICpZQ2JDcikgQ29weVRvUkdCQShkc3QgKlJHQkEsIGRyLCBzciBSZWN0YW5nbGUpIChlZmZlY3RpdmVEciwgZWZmZWN0aXZlU3IgUmVjdGFuZ2xlKQoJLy8KCS8vIGluIHRoZSBzcGlyaXQgb2YgdGhlIGJ1aWx0LWluIGNvcHkgZnVuY3Rpb24gZm9yIDEtZGltZW5zaW9uYWwgc2xpY2VzLAoJLy8gdGhhdCBhbHNvIGFsbG93ZWQgYSBDb3B5RnJvbVJHQkEgbWV0aG9kIGlmIG5lZWRlZC4KCgl4MCA6PSAoci5NaW4uWCAtIGRzdC5SZWN0Lk1pbi5YKSAqIDQKCXgxIDo9IChyLk1heC5YIC0gZHN0LlJlY3QuTWluLlgpICogNAoJeTAgOj0gci5NaW4uWSAtIGRzdC5SZWN0Lk1pbi5ZCgl5MSA6PSByLk1heC5ZIC0gZHN0LlJlY3QuTWluLlkKCXN3aXRjaCBzcmMuU3Vic2FtcGxlUmF0aW8gewpgCgpjb25zdCBwb3N0ID0gYAoJZGVmYXVsdDoKCQlyZXR1cm4gZmFsc2UKCX0KCXJldHVybiB0cnVlCn0KYAoKY29uc3Qgc3JhdGlvQ2FzZSA9IGAKCWNhc2UgaW1hZ2UuWUNiQ3JTdWJzYW1wbGVSYXRpbyVzOgoJCWZvciB5LCBzeSA6PSB5MCwgc3AuWTsgeSAhPSB5MTsgeSwgc3kgPSB5KzEsIHN5KzEgewoJCQlkcGl4IDo9IGRzdC5QaXhbeSpkc3QuU3RyaWRlOl0KCQkJeWkgOj0gKHN5LXNyYy5SZWN0Lk1pbi5ZKSpzcmMuWVN0cmlkZSArIChzcC5YIC0gc3JjLlJlY3QuTWluLlgpCgkJCSVzCgoJCQkJLy8gVGhpcyBpcyBhbiBpbmxpbmUgdmVyc2lvbiBvZiBpbWFnZS9jb2xvci95Y2Jjci5nbydzIGZ1bmMgWUNiQ3JUb1JHQi4KCQkJCXl5MSA6PSBpbnQzMihzcmMuWVt5aV0pICogMHgxMDEwMQoJCQkJY2IxIDo9IGludDMyKHNyYy5DYltjaV0pIC0gMTI4CgkJCQljcjEgOj0gaW50MzIoc3JjLkNyW2NpXSkgLSAxMjgKCgkJCQkvLyBUaGUgYml0IHR3aWRkbGluZyBiZWxvdyBpcyBlcXVpdmFsZW50IHRvCgkJCQkvLwoJCQkJLy8gciA6PSAoeXkxICsgOTE4ODEqY3IxKSA+PiAxNgoJCQkJLy8gaWYgciA8IDAgewoJCQkJLy8gICAgIHIgPSAwCgkJCQkvLyB9IGVsc2UgaWYgciA+IDB4ZmYgewoJCQkJLy8gICAgIHIgPSBeaW50MzIoMCkKCQkJCS8vIH0KCQkJCS8vCgkJCQkvLyBidXQgdXNlcyBmZXdlciBicmFuY2hlcyBhbmQgaXMgZmFzdGVyLnIgPiBsZW4ocmhzKSB7CgkJc3RtdCA6PSBzdG10LigqaXIuQXNzaWduTGlzdFN0bXQpCgkJc3RtdC5TZXRPcChpci5PQVMyRlVOQykKCQlyIDo9IHJoc1swXS4oKmlyLkNhbGxFeHByKQoJCXJ0eXAgOj0gci5UeXBlKCkKCgkJbWlzbWF0Y2hlZCA6PSBmYWxzZQoJCWZhaWxlZCA6PSBmYWxzZQoJCWZvciBpIDo9IHJhbmdlIGxocyB7CgkJCXJlc3VsdCA6PSBydHlwLkZpZWxkKGkpLlR5cGUKCQkJYXNzaWduVHlwZShpLCByZXN1bHQpCgoJCQlpZiBsaHNbaV0uVHlwZSgpID09IG5pbCB8fCByZXN1bHQgPT0gbmlsIHsKCQkJCWZhaWxlZCA9IHRydWUKCQkJfSBlbHNlIGlmIGxoc1tpXSAhPSBpci5CbGFua05vZGUgJiYgIXR5cGVzLklkZW50aWNhbChsaHNbaV0uVHlwZSgpLCByZXN1bHQpIHsKCQkJCW1pc21hdGNoZWQgPSB0cnVlCgkJCX0KCQl9CgkJaWYgbWlzbWF0Y2hlZCAmJiAhZmFpbGVkIHsKCQkJUmV3cml0ZU11bHRpVmFsdWVDYWxsKHN0bXQsIHIpCgkJfQoJCXJldHVybgoJfQoKCWZvciBpLCByIDo9IHJhbmdlIHJocyB7CgkJY2hlY2tMSFMoaSwgci5UeXBlKCkpCgkJaWYgbGhzW2ldLlR5cGUoKSAhPSBuaWwgewoJCQlyaHNbaV0gPSBBc3NpZ25Db252KHIsIGxoc1tpXS5UeXBlKCksICJhc3NpZ25tZW50IikKCQl9Cgl9Cn0KCmZ1bmMgcGx1cmFsKG4gaW50KSBzdHJpbmcgewoJaWYgbiA9PSAxIHsKCQlyZXR1cm4gIiIKCX0KCXJldHVybiAicyIKfQoKLy8gdGNDaGVja05pbCB0eXBlY2hlY2tzIGFuIE9DSEVDS05JTCBub2RlLgpmdW5jIHRjQ2hlY2tOaWwobiAqaXIuVW5hcnlFeHByKSBpci5Ob2RlIHsKCW4uWCA9IEV4cHIobi5YKQoJaWYgIW4uWC5UeXBlKCkuSXNQdHJTaGFwZWQoKSB7CgkJYmFzZS5GYXRhbGZBdChuLlBvcygpLCAiJUwgaXMgbm90IHBvaW50ZXIgc2hhcGVkIiwgbi5YKQoJfQoJcmV0dXJuIG4KfQoKLy8gdGNGb3IgdHlwZWNoZWNrcyBhbiBPRk9SIG5vZGUuCmZ1bmMgdGNGb3IobiAqaXIuRm9yU3RtdCkgaXIuTm9kZSB7CglTdG10cyhuLkluaXQoKSkKCW4uQ29uZCA9IEV4cHIobi5Db25kKQoJbi5Db25kID0gRGVmYXVsdExpdChuLkNvbmQsIG5pbCkKCWlmIG4uQ29uZCAhPSBuaWwgewoJCXQgOj0gbi5Db25kLlR5cGUoKQoJCWlmIHQgIT0gbmlsICYmICF0LklzQm9vbGVhbigpIHsKCQkJYmFzZS5FcnJvcmYoIm5vbi1ib29sICVMIHVzZWQgYXMgZm9yIGNvbmRpdGlvbiIsIG4uQ29uZCkKCQl9Cgl9CgluLlBvc3QgPSBTdG10KG4uUG9zdCkKCVN0bXRzKG4uQm9keSkKCXJldHVybiBuCn0KCi8vIHRjR29EZWZlciB0eXBlY2hlY2tzIChub3JtYWxpemVzKSBhbiBPR08vT0RFRkVSIHN0YXRlbWVudC4KZnVuYyB0Y0dvRGVmZXIobiAqaXIuR29EZWZlclN0bXQpIHsKCWNhbGwgOj0gbm9ybWFsaXplR29EZWZlckNhbGwobi5Qb3MoKSwgbi5PcCgpLCBuLkNhbGwsIG4uUHRySW5pdCgpKQoJY2FsbC5Hb0RlZmVyID0gdHJ1ZQoJbi5DYWxsID0gY2FsbAp9CgovLyBub3JtYWxpemVHb0RlZmVyQ2FsbCBub3JtYWxpemVzIGNhbGwgaW50byBhIG5vcm1hbCBmdW5jdGlvbiBjYWxsCi8vIHdpdGggbm8gYXJndW1lbnRzIGFuZCBubyByZXN1bHRzLCBzdWl0YWJsZSBmb3IgdXNlIGluIGFuIE9HTy9PREVGRVIKLy8gc3RhdGVtZW50LgovLwovLyBGb3IgZXhhbXBsZSwgaXQgbm9ybWFsaXplczoKLy8KLy8JZih4LCB5KQovLwovLyBpbnRvOgovLwovLwl4MSwgeTEgOj0geCwgeSAgICAgICAgICAvLyBhZGRlZCB0byBpbml0Ci8vCWZ1bmMoKSB7IGYoeDEsIHkxKSB9KCkgIC8vIHJlc3VsdApmdW5jIG5vcm1hbGl6ZUdvRGVmZXJDYWxsKHBvcyBzcmMuWFBvcywgb3AgaXIuT3AsIGNhbGwgaXIuTm9kZSwgaW5pdCAqaXIuTm9kZXMpICppci5DYWxsRXhwciB7Cglpbml0LkFwcGVuZChpci5UYWtlSW5pdChjYWxsKS4uLikKCglpZiBjYWxsLCBvayA6PSBjYWxsLigqaXIuQ2FsbEV4cHIpOyBvayAmJiBjYWxsLk9wKCkgPT0gaXIuT0NBTExGVU5DIHsKCQlzdC5TZWxlY3RvckV4cHI6CgkJaWQsIG9rIDo9IHQuWC4oKmFzdC5JZGVudCkKCQlpZiBvayAmJiBpZC5OYW1lID09ICJ1bnNhZmUiICYmIHQuU2VsLk5hbWUgPT0gIlBvaW50ZXIiIHsKCQkJcmV0dXJuICZUeXBle1NpemU6IHAuUHRyU2l6ZSwgQWxpZ246IHAuUHRyU2l6ZSwgQzogYygidm9pZCoiKX0KCQl9Cgl9CgllcnJvcl8oZS5Qb3MoKSwgIkdvIHR5cGUgbm90IHN1cHBvcnRlZCBpbiBleHBvcnQ6ICVzIiwgZ29mbXQoZSkpCglyZXR1cm4gJlR5cGV7U2l6ZTogNCwgQWxpZ246IDQsIEM6IGMoImludCIpfQp9Cgpjb25zdCBnY2NQcm9sb2cgPSBgCiNsaW5lIDEgImNnby1nY2MtcHJvbG9nIgovKgogIElmIHggYW5kIHkgYXJlIG5vdCBlcXVhbCwgdGhlIHR5cGUgd2lsbCBiZSBpbnZhbGlkCiAgKGhhdmUgYSBuZWdhdGl2ZSBhcnJheSBjb3VudCkgYW5kIGFuIGluc2NydXRhYmxlIGVycm9yIHdpbGwgY29tZQogIG91dCBvZiB0aGUgY29tcGlsZXIgYW5kIGhvcGVmdWxseSBtZW50aW9uICJuYW1lIi4KKi8KI2RlZmluZSBfX2Nnb19jb21waWxlX2Fzc2VydF9lcSh4LCB5LCBuYW1lKSB0eXBlZGVmIGNoYXIgbmFtZVsoeC15KSooeC15KSotMlVMKzFVTF07CgovKiBDaGVjayBhdCBjb21waWxlIHRpbWUgdGhhdCB0aGUgc2l6ZXMgd2UgdXNlIG1hdGNoIG91ciBleHBlY3RhdGlvbnMuICovCiNkZWZpbmUgX19jZ29fc2l6ZV9hc3NlcnQodCwgbikgX19jZ29fY29tcGlsZV9hc3NlcnRfZXEoc2l6ZW9mKHQpLCAoc2l6ZV90KW4sIF9jZ29fc2l6ZW9mXyMjdCMjX2lzX25vdF8jI24pCgpfX2Nnb19zaXplX2Fzc2VydChjaGFyLCAxKQpfX2Nnb19zaXplX2Fzc2VydChzaG9ydCwgMikKX19jZ29fc2l6ZV9hc3NlcnQoaW50LCA0KQp0eXBlZGVmIGxvbmcgbG9uZyBfX2Nnb19sb25nX2xvbmc7Cl9fY2dvX3NpemVfYXNzZXJ0KF9fY2dvX2xvbmdfbG9uZywgOCkKX19jZ29fc2l6ZV9hc3NlcnQoZmxvYXQsIDQpCl9fY2dvX3NpemVfYXNzZXJ0KGRvdWJsZSwgOCkKCmV4dGVybiBjaGFyKiBfY2dvX3RvcG9mc3RhY2sodm9pZCk7CgovKgogIFdlIHVzZSBwYWNrZWQgc3RydWN0cywgYnV0IHRoZXkgYXJlIGFsd2F5cyBhbGlnbmVkLgogIFRoZSBwcmFnbWFzIGFuZCBhZGRyZXNzLW9mLXBhY2tlZC1tZW1iZXIgYXJlIG9ubHkgcmVjb2duaXplZCBhcyB3YXJuaW5nCiAgZ3JvdXBzIGluIGNsYW5nIDQuMCssIHNvIGlnbm9yZSB1bmtub3duIHByYWdtYXMgZmlyc3QuCiovCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVd1bmtub3duLXByYWdtYXMiCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdwcmFnbWFzIgojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XYWRkcmVzcy1vZi1wYWNrZWQtbWVtYmVyIgojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XdW5rbm93bi13YXJuaW5nLW9wdGlvbiIKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV3VuYWxpZ25lZC1hY2Nlc3MiCgojaW5jbHVkZSA8ZXJybm8uaD4KI2luY2x1ZGUgPHN0cmluZy5oPgpgCgovLyBQcm9sb2d1ZSBkZWZpbmluZyBUU0FOIGZ1bmN0aW9ucyBpbiBDLgpjb25zdCBub1RzYW5Qcm9sb2cgPSBgCiNkZWZpbmUgQ0dPX05PX1NBTklUSVpFX1RIUkVBRAojZGVmaW5lIF9jZ29fdHNhbl9hY3F1aXJlKCkKI2RlZmluZSBfY2dvX3RzYW5fcmVsZWFzZSgpCmAKCi8vIFRoaXMgbXVzdCBtYXRjaCB0aGUgVFNBTiBjb2RlIGluIHJ1bnRpbWUvY2dvL2xpYmNnby5oLgovLyBUaGlzIGlzIHVzZWQgd2hlbiB0aGUgY29kZSBpcyBidWlsdCB3aXRoIHRoZSBDL0MrKyBUaHJlYWQgU0FOaXRpemVyLAovLyB3aGljaCBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIEdvIHJhY2UgZGV0ZWN0b3IuCi8vIF9fdHNhbl9hY3F1aXJlIHRlbGxzIFRTQU4gdGhhdCB3ZSBhcmUgYWNxdWlyaW5nIGEgbG9jayBvbiBhIHZhcmlhYmxlLAovLyBpbiB0aGlzIGNhc2UgX2Nnb19zeW5jLiBfMHgzRjk1MTMyMkFDOTI1NDdCCgk3LjM4NTU1MDg2MDgxNDAyODgzOTU3ZS0wMywgLy8gMHgzRjdFNDA0RkI2OEZFRkU4CgkyLjg5MDUxMzgzNjczNDE1NjI5MDkxZS0wMywgLy8gMHgzRjY3QUREOENDQjc5MjZCCgkxLjE5MjcwNzYzMTgzMzYyMDY3ODQ1ZS0wMywgLy8gMHgzRjUzOEE5NDExNkYzRjVECgk1LjEwMDY5NzkyMTUzNTExMzM2NjA4ZS0wNCwgLy8gMHgzRjQwQjZDNjg5Qjk5QzAwCgkyLjIwODYyNzkwNzEzOTA4Mzg1NTU3ZS0wNCwgLy8gMHgzRjJDRjJFQ0VEMTBFNTRECgkxLjA4MDExNTY3MjQ3NTgzOTM5OTU0ZS0wNCwgLy8gMHgzRjFDNTA4ODk4N0RGQjA3CgkyLjUyMTQ0NTY1NDUxMjU3MzI2OTM5ZS0wNSwgLy8gMHgzRUZBNzA3NDQyOENGQTUyCgk0LjQ4NjQwOTQ5NjE4OTE1MTYwMTUwZS0wNSwgLy8gMHgzRjA3ODU4RTkwQTQ1ODM3Cn0KdmFyIF9sZ2FtUiA9IFsuLi5dZmxvYXQ2NHsKCTEuMCwgICAgICAgICAgICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlcgoJMS4zOTIwMDUzMzQ2NzYyMTA0NTk1OGUrMDAsIC8vIDB4M0ZGNjQ1QTc2MkM0QUI3NAoJNy4yMTkzNTU0NzU2NzEzODA2OTUyNWUtMDEsIC8vIDB4M0ZFNzFBMTg5M0QzRENEQwoJMS43MTkzMzg2NTYzMjgwMzA3ODk5M2UtMDEsIC8vIDB4M0ZDNjAxRURDQ0ZCREYyNwoJMS44NjQ1OTE5MTcxNTY1MjkwMTM0NGUtMDIsIC8vIDB4M0Y5MzE3RUE3NDJFRDQ3NQoJNy43Nzk0MjQ5NjM4MTg5MzU5NjQzNGUtMDQsIC8vIDB4M0Y0OTdEREFDQTQxQTk1QgoJNy4zMjY2ODQzMDc0NDYyNTYzNjE4OWUtMDYsIC8vIDB4M0VERUJBRjdBNUIzODE0MAp9CnZhciBfbGdhbVMgPSBbLi4uXWZsb2F0NjR7CgktNy43MjE1NjY0OTAxNTMyODY1NTQ5NGUtMDIsIC8vIDB4QkZCM0M0NjdFMzdEQjBDOAoJMi4xNDk4MjQxNTk2MDYwODg1MjUwMWUtMDEsICAvLyAweDNGQ0I4NDhCMzZFMjA4NzgKCTMuMjU3Nzg3OTY0MDg5MzA5ODE3ODdlLTAxLCAgLy8gMHgzRkQ0RDk4RjRGMTM5RjU5CgkxLjQ2MzUwNDcyNjUyNDY0NDUyODA1ZS0wMSwgIC8vIDB4M0ZDMkJCOUNCRUU1RjJGNwoJMi42NjQyMjcwMzAzMzYzODYwOTU2MGUtMDIsICAvLyAweDNGOUI0ODFDN0U5Mzk5NjEKCTEuODQwMjg0NTE0MDczMzc3MTU2NTJlLTAzLCAgLy8gMHgzRjVFMjZCNjczNjhGMjM5CgkzLjE5NDc1MzI2NTg0MTAwODY3NjE3ZS0wNSwgIC8vIDB4M0YwMEJGRUNERDE3RTk0NQp9CnZhciBfbGdhbVQgPSBbLi4uXWZsb2F0NjR7Cgk0LjgzODM2MTIyNzIzODEwMDQ3MDQyZS0wMSwgIC8vIDB4M0ZERUY3MkJDOEVFMzhBMgoJLTEuNDc1ODc3MjI5OTQ1OTM5MTE3NTJlLTAxLCAvLyAweEJGQzJFNDI3OERDNkM1MDkKCTYuNDYyNDk0MDIzOTEzMzM4NTQ3NzhlLTAyLCAgLy8gMHgzRkIwOEI0Mjk0RDU0MTlCCgktMy4yNzg4NTQxMDc1OTg1OTY0OTU2NWUtMDIsIC8vIDB4QkZBMEM5QThERjM1QjcxMwoJMS43OTcwNjc1MDgxMTgyMDM4NzEyNmUtMDIsICAvLyAweDNGOTI2NkU3OTcwQUY5RUMKCS0xLjAzMTQyMjQxMjk4MzQxNDM3NDUwZS0wMiwgLy8gMHhCRjg1MUY5RkJBOTFFQzZBCgk2LjEwMDUzODcwMjQ2MjkxMzMyNjM1ZS0wMywgIC8vIDB4M0Y3OEZDRTBFMzcwRTM0NAoJLTMuNjg0NTIwMTY3ODExMzgyNTY3NjBlLTAzLCAvLyAweEJGNkUyRUZGQjNFOTE0RDcKCTIuMjU5NjQ3ODA5MDA2MTI0NzIyNTBlLTAzLCAgLy8gMHgzRjYyODJEMzJFMTVDOTE1CgktMS40MDM0NjQ2OTk4OTIzMjg0MzgxM2UtMDMsIC8vIDB4QkY1NkZFOEVCRjJEMUFGMQoJOC44MTA4MTg4MjQzNzY1NDAxMTM4MmUtMDQsICAvLyAweDNGNENERjBDRUY2MUE4RTkKCS01LjM4NTk1MzA1MzU2NzQwNTQ2NzE1ZS0wNCwgLy8gMHhCRjQxQTYxMDlDNzNFMEVDCgkzLjE1NjMyMDcwOTAzNjI1OTUwMzYxZS0wNCwgIC8vIDB4M0YzNEFGNkQ2QzBFQkJGNwoJLTMuMTI3NTQxNjgzNzUxMjA4NjA1MThlLTA0LCAvLyAweEJGMzQ3RjI0RUNDMzhDMzgKCTMuMzU1MjkxOTI2M2xzYW5fdW5yZWdpc3Rlcl9yb290X3JlZ2lvbl9nbwovL2dvOmNnb19pbXBvcnRfc3RhdGljIF9fbHNhbl9kb19sZWFrX2NoZWNrX2dvCi8vIHJ1biAtZ2NmbGFncz0tZD1jb252ZXJ0aGFzaD1xeQoKLy8gQ29weXJpZ2h0IDIwMjAgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCi8vZ286YnVpbGQgIXdhc20gJiYgITM4NiAmJiAhYXJtICYmICFtaXBzCgovLyBUT0RPIGZpeCB0aGlzIHRvIHdvcmsgZm9yIHdhc20gYW5kIDMyLWJpdCBhcmNoaXRlY3R1cmVzLgovLyBEb2luZyBtb3JlIHRoYW4gdGhpcywgaG93ZXZlciwgZXhwYW5kcyB0aGUgY2hhbmdlLgoKcGFja2FnZSBtYWluCgppbXBvcnQgKAoJImZtdCIKCSJydW50aW1lIgopCgovLyBUaGlzIHRlc3QgY2hlY2tzIHRoYXQgY29udmVyc2lvbiBmcm9tIGZsb2F0cyB0byAodW5zaWduZWQpIDMyIGFuZCA2NC1iaXQKLy8gaW50ZWdlcnMgaGFzIHRoZSBzYW1lIHNlbnNpYmxlIGJlaGF2aW9yIGZvciBjb3JuZXIgY2FzZXMsIGFuZCB0aGF0IHRoZQovLyBjb252ZXJzaW9ucyB0byBzbWFsbGVyIGludGVnZXJzIGFncmVlLiAgQmVjYXVzZSBvdXRsaWVycyBhcmUgcGxhdGZvcm0tCi8vIGluZGVwZW5kZW50LCB0aGUgImdvbGRlbiB0ZXN0IiBmb3Igc21hbGxlciBpbnRlZ2VycyBpcyBtb3JlIGxpa2Ugb2YKLy8gYSAiZ29sZC1pc2ggdGVzdCIgYW5kIHN1YmplY3QgdG8gY2hhbmdlLgoKLy9nbzpub2lubGluZQpmdW5jIGlkW1QgYW55XSh4IFQpIFQgewoJcmV0dXJuIHgKfQoKLy9nbzpub2lubGluZQpmdW5jIHdhbnRbVCBjb21wYXJhYmxlXShuYW1lIHN0cmluZywgeCwgeSBUKSB7CglpZiB4ICE9IHkgewoJCV8sIF8sIGxpbmUsIF8gOj0gcnVudGltZS5DYWxsZXIoMSkKCQlmbXQuUHJpbnRsbigiRkFJTCBhdCBsaW5lIiwgbGluZSwgInZhciA9IiwgbmFtZSwgImdvdCA9IiwgeCwgIndhbnQgPSIsIHkpCgl9Cn0KCi8vZ286bm9pbmxpbmUKZnVuYyBsb2dbVCBjb21wYXJhYmxlXShuYW1lIHN0cmluZywgeCBUKSB7CglmbXQuUHJpbnRsbihuYW1lLCB4KQp9Cgpjb25zdCAoCgkvLyBwWCA9IG1heCBwb3NpdGl2ZSBzaWduZWQgWCBiaXQKCS8vIG5YID0gbWluIG5lZ2F0aXZlIHNpZ25lZCBYIGJpdAoJLy8gdVggPSBtYXggdW5zaWduZWQgWCBiaXQKCS8vIHRYID0gdHdvIHRvIHRoZSBYCglwMzIgPSAyMTQ3NDgzNjQ3CgluMzIgPSAtMjE0NzQ4MzY0OAoJdTMyID0gNDI5NDk2NzI5NQoJcDY0ID0gOTIyMzM3MjAzNjg1NDc3NTgwNwoJbjY0ID0gLTkyMjMzNzIwMzY4NTQ3NzU4MDgKCXU2NCA9IDE4NDQ2NzQ0MDczNzA5NTUxNjE1Cgl0NDQgPSAxIDw8IDQ0CikKCmZ1bmMgbWFpbigpIHsKCW9uZSA6PSAxLjAKCW1pbnVzMV8zMiA6PSBpZChmbG9hdDMyKC0xLjApKQoJbWludXMxXzY0IDo9IGlkKGZsb2F0NjQoLTEuMCkpCglwMzJfcGx1czRrX3BsdXMxIDo9IGlkKGZsb2F0MzIocDMyICsgNDA5NiArIDEpKSAvLyB3YW50IHRoaXMgdG8gYmUgcHJlY2lzZSBhbmQgZml0IGluIDI0IGJpdHMgbWFudGlzc2EKCXA2NF9wbHVzNGtfcGx1czEgOj0gaWQoZmxvYXQ2NChwNjQgKyA0MDk2ICsgMSkpIC8vIHdhbnQgdGhpcyB0byBiZSBwcmVjaXNlIGFuZCBmaXQgaW4gNTMgYml0cyBtYW50aXNzYQoJbjMyX21pbnVzNGsgOj0gaWQoZmxvYXQzMihuMzIgLSA0MDk2KSkKCW42NF9taW51czRrIDo9IGlkKGZsb2F0NjQobjY0IC0gNDA5NikpCglpbmZfMzIgOj0gaWQoZmxvYXQzMihvbmUgLyAwKSkKCWluZl82NCA6PSBpZChmbG9hdDY0KG9uZSAvIDApKQoJbmluZl8zMiA6PSBpZChmbG9hdDMyKC1vbmUgLyAwKSkKCW5pbmZfNjQgOj0gaWQoZmxvYXQ2NCgtb25lIC8gMCkpCgoJLy8gaW50MzIgY29udmVyc2lvbnMKCWludDMyVGVzdHNybiBmcm9tIG1lbWNsci4gZ3Auc2NoZWQgd2lsbAoJLy8gYWN0IGFzIGEgcGlnZW9uaG9sZSBmb3Igb3VyIGFjdHVhbCByZXR1cm4uCglsbyA6PSBnZXRnKCkuc3RhY2subG8KCXN5c3RlbXN0YWNrKGZ1bmMoKSB7CgkJLy8gTm90ZSwgdGhpcyBzeXN0ZW1zdGFjayBjYWxsIGhhcHBlbnMgd2l0aGluIHRoZSBzZWNyZXQgbW9kZSwKCQkvLyBzbyB3ZSBkb24ndCBoYXZlIHRvIGNhbGwgb3V0IHRvIGVyYXNlIG91ciByZWdpc3RlcnMsIHRoZSBzeXN0ZW1zdGFjawoJCS8vIGNvZGUgd2lsbCBkbyB0aGF0LgoJCW1wIDo9IGFjcXVpcmVtKCkKCQlzcCA6PSBtcC5jdXJnLnNjaGVkLnNwCgkJLy8gd2UgbmVlZCB0byBrZWVwIHN5c3RlbXN0YWNrIHJldHVybiBvbiB0b3Agb2YgdGhlIHN0YWNrIGJlaW5nIGNsZWFyZWQKCQkvLyBmb3IgdHJhY2ViYWNrCgkJc3AgLT0gZ29hcmNoLlB0clNpemUKCQkvLyBUT0RPOiBrZWVwIHNvbWUgc29ydCBvZiBsb3cgd2F0ZXIgbWFyayBzbyB0aGF0IHdlIGRvbid0IGhhdmUKCQkvLyB0byB6ZXJvIGEgcG90ZW50aWFsbHkgbGFyZ2Ugc3RhY2sgaWYgd2UgdXNlZCBqdXN0IGEgbGl0dGxlCgkJLy8gYml0IG9mIGl0LiBUaGF0IHdpbGwgYWxsb3cgdXMgdG8gdXNlIGEgaGlnaGVyIHZhbHVlIGZvcgoJCS8vIGxvIHRoYW4gZ3Auc3RhY2subG8uCgkJbWVtY2xyTm9IZWFwUG9pbnRlcnModW5zYWZlLlBvaW50ZXIobG8pLCBzcC1sbykKCQlyZWxlYXNlbShtcCkKCX0pCgkvLyBEb24ndCBwdXQgYW55IGNvZGUgaGVyZTogdGhlIHN0YWNrIGZyYW1lJ3MgY29udGVudHMgYXJlIGdvbmUhCn0KCi8vIGFkZFNlY3JldCByZWNvcmRzIHRoZSBmYWN0IHRoYXQgd2UgbmVlZCB0byB6ZXJvIHAgaW1tZWRpYXRlbHkKLy8gd2hlbiBpdCBpcyBmcmVlZC4KZnVuYyBhZGRTZWNyZXQocCB1bnNhZmUuUG9pbnRlciwgc2l6ZSB1aW50cHRyKSB7CgkvLyBUT0RPKGRtbyk6IGZpZ3VyZSBvdXQgdGhlIGNvc3Qgb2YgdGhlc2UuIFRoZXNlIGFyZSBtb3N0bHkKCS8vIGludGVuZGVkIHRvIGNhdGNoIGFsbG9jYXRpb25zIHRoYXQgaGFwcGVuIHZpYSB0aGUgcnVudGltZQoJLy8gdGhhdCB0aGUgdXNlciBoYXMgbm8gY29udHJvbCBvdmVyIGFuZCBub3QgYmlnIGJ1ZmZlcnMgdGhhdCB1c2VyCgkvLyBjb2RlIGlzIGFsbG9jYXRpbmcuIFRoZSBjb3N0IHNob3VsZCBiZSByZWxhdGl2ZWx5IGxvdywKCS8vIGJ1dCB3ZSBoYXZlIHJ1biBpbnRvIGEgd2FsbCB3aXRoIG90aGVyIHNwZWNpYWwgYWxsb2NhdGlvbnMgYmVmb3JlLgoJbG9jaygmbWhlYXBfLnNwZWNpYWxsb2NrKQoJcyA6PSAoKnNwZWNpYWxTZWNyZXQpKG1oZWFwXy5zcGVjaWFsU2VjcmV0QWxsb2MuYWxsb2MoKSkKCXMuc3BlY2lhbC5raW5kID0gX0tpbmRTcGVjaWFsU2VjcmV0CglzLnNpemUgPSBzaXplCgl1bmxvY2soJm1oZWFwXy5zcGVjaWFsbG9jaykKCWFkZHNwZWNpYWwocCwgJnMuc3BlY2lhbCwgZmFsc2UpCn0KCi8vIHNlbmQgYSBuby1vcCBzaWduYWwgdG8gYW4gTSBmb3IgdGhlIHB1cnBvc2VzIG9mCi8vIGNsb2JiZXJpbmcgdGhlIHNpZ25hbCBzdGFjawovLwovLyBVc2Ugc2lncHJlZW1wdC4gSWYgd2UgZG9uJ3QgaGF2ZSBhIHByZWVtcHRpb24gcXVldWVkLCB0aGlzIGp1c3QKLy8gdHVybnMgaW50byBhIG5vLW9wCmZ1bmMgbm9vcFNpZ25hbChtcCAqbSkgewoJc2lnbmFsTShtcCwgc2lnUHJlZW1wdCkKfQoKLy8gc2VjcmV0X2dldFN0YWNrIHJldHVybnMgdGhlIG1lbW9yeSByYW5nZSBvZiB0aGUKLy8gY3VycmVudCBnb3JvdXRpbmUncyBzdGFjay4KLy8gRm9yIHRlc3Rpbmcgb25seS4KLy8gTm90ZSB0aGF0IHRoaXMgaXMga2luZCBvZiB0cmlja3ksIGFzIHRoZSBnb3JvdXRpbmUgY2FuCi8vIGJlIGNvcGllZCBhbmQvb3IgZXhpdCBiZWZvcmUgdGhlIHJlc3VsdCBpcyB1c2VkLCBhdCB3aGljaAovLyBwb2ludCBpdCBtYXkgbm8gbG9uZ2VyIGJlIHZhbGlkLgovLwovL2dvOmxpbmtuYW1lIHNlY2xvYWRzIGluc3RlYWQgb2YgYWxsIGluIG9uZSBiYXRjaCksIGFuZCBpdCBtaWdodCBhZGQgYSBsaXR0bGUgb3ZlcmhlYWQKCS8vIHRvIGxvb2sgdXAgdGhlIGRvd25sb2FkcyBmcm9tIHRoZSBmaXJzdCBiYXRjaCBpbiB0aGUgbW9kdWxlIGNhY2hlIHdoZW4KCS8vIHdlIHNlZSB0aGVtIGFnYWluIGluIHRoZSBzZWNvbmQgYmF0Y2guIE9uIHRoZSBvdGhlciBoYW5kLCBpdCdzIHdheSBzaW1wbGVyCgkvLyB0byBpbXBsZW1lbnQsIGFuZCBub3QgcmVhbGx5IGFueSBtb3JlIGV4cGVuc2l2ZSBpZiB0aGUgdXNlciBpcyByZXF1ZXN0aW5nCgkvLyBubyBleHBsaWNpdCBhcmd1bWVudHMgKHRoZWlyIGdvLm1vZCBmaWxlIHNob3VsZCBhbHJlYWR5IGxpc3QgYW4gYXBwcm9wcmlhdGUKCS8vIHRvb2xjaGFpbiB2ZXJzaW9uKSBvciBvbmx5IG9uZSBtb2R1bGUgKGFzIGlzIHVzZWQgYnkgdGhlIEdvIE1vZHVsZSBQcm94eSkuCgoJaWYgaW5mb3NFcnIgIT0gbmlsIHsKCQlzdyA6PSB0b29sY2hhaW4uTmV3U3dpdGNoZXIobW9kdWxlTG9hZGVyU3RhdGUpCgkJc3cuRXJyb3IoaW5mb3NFcnIpCgkJaWYgc3cuTmVlZFN3aXRjaCgpIHsKCQkJc3cuU3dpdGNoKGN0eCkKCQl9CgkJLy8gT3RoZXJ3aXNlLCB3YWl0IHRvIHJlcG9ydCBpbmZvc0VyciBhZnRlciB3ZSBoYXZlIGRvd25sb2FkZWQKCQkvLyB3aGVuIHdlIGNhbi4KCX0KCglpZiAhaGF2ZUV4cGxpY2l0QXJncyAmJiBtb2Rsb2FkLldvcmtGaWxlUGF0aChtb2R1bGVMb2FkZXJTdGF0ZSkgPT0gIiIgewoJCS8vICdnbyBtb2QgZG93bmxvYWQnIGlzIHNvbWV0aW1lcyBydW4gd2l0aG91dCBhcmd1bWVudHMgdG8gcHJlLXBvcHVsYXRlIHRoZQoJCS8vIG1vZHVsZSBjYWNoZS4gSW4gbW9kdWxlcyB0aGF0IGFyZW4ndCBhdCBnbyAxLjE3IG9yIGhpZ2hlciwgaXQgbWF5IGZldGNoCgkJLy8gbW9kdWxlcyB0aGF0IGFyZW4ndCBuZWVkZWQgdG8gYnVpbGQgcGFja2FnZXMgaW4gdGhlIG1haW4gbW9kdWxlLiBUaGlzIGlzCgkJLy8gdXN1YWxseSBub3QgaW50ZW5kZWQsIHNvIGRvbid0IHNhdmUgc3VtcyBmb3IgZG93bmxvYWRlZCBtb2R1bGVzCgkJLy8gKGdvbGFuZy5vcmcvaXNzdWUvNDUzMzIpLiBXZSBkbyBzdGlsbCBmaXggaW5jb25zaXN0ZW5jaWVzIGluIGdvLm1vZAoJCS8vIHRob3VnaC4KCQkvLwoJCS8vIFRPRE8oIzY0MDA4KTogSW4gdGhlIGZ1dHVyZSwgcmVwb3J0IGFuIGVycm9yIGlmIGdvLm1vZCBvciBnby5zdW0gbmVlZCB0bwoJCS8vIGJlIHVwZGF0ZWQgYWZ0ZXIgbG9hZGluZyB0aGUgYnVpbGQgbGlzdC4gVGhpcyBtYXkgcmVxdWlyZSBzZXR0aW5nCgkJLy8gdGhlIG1vZGUgdG8gIm1vZCIgb3IgInJlYWRvbmx5IiBkZXBlbmRpbmcgb24gaGF2ZUV4cGxpY2l0QXJncy4KCQlpZiBlcnIgOj0gbW9kbG9hZC5Xcml0ZUdvTW9kKG1vZHVsZUxvYWRlclN0YXRlLCBjdHgsIG1vZGxvYWQuV3JpdGVPcHRze30pOyBlcnIgIT0gbmlsIHsKCQkJYmFzZS5GYXRhbChlcnIpCgkJfQoJfQoKCXZhciBkb3dubG9hZEVycnMgc3luYy5NYXAKCWZvciBfLCBpbmZvIDo9IHJhbmdlIGluZm9zIHsKCQlpZiBpbmZvLlJlcGxhY2UgIT0gbmlsIHsKCQkJaW5mbyA9IGluZm8uUmVwbGFjZQoJCX0KCQlpZiBpbmZvLlZlcnNpb24gPT0gIiIgJiYgaW5mby5FcnJvciA9PSBuaWwgewoJCQkvLyBtYWluIG1vZHVsZSBvciBtb2R1bGUgcmVwbGFjZWQgd2l0aCBmaWxlIHBhdGguCgkJCS8vIE5vdGhpbmcgdG8gZG93bmxvYWQuCgkJCWNvbnRpbnVlCgkJfQoJCW0gOj0gJk1vZHVsZUpTT057CgkJCVBhdGg6ICAgIGluZm8uUGF0aCwKCQkJVmVyc2lvbjogaW5mby5WZXJzaW9uLAoJCQlRdWVyeTogICBpbmZvLlF1ZXJ5LAoJCQlSZXVzZTogICBpbmZvLlJldXNlLAoJCQlPcmlnaW46ICBpbmZvLk9yaWdpbiwKCQl9CgkJbW9kcyA9IGFwcGVuZChtb2RzLCBtKQoJCWlmIGluZm8uRXJyb3IgIT0gbmlsIHsKCQkJbS5FcnJvciA9IGluZm8uRXJyb3IuRXJyCgkJCWNFX0FUVCAgICAgICAgICAgICAgICAgICAgID0gMHg4MDY5CglFVEhFUlRZUEVfQVRUU1RBTkZPUkQgICAgICAgICAgICAgPSAweDgwMDgKCUVUSEVSVFlQRV9BVVRPUEhPTiAgICAgICAgICAgICAgICA9IDB4ODA2YQoJRVRIRVJUWVBFX0FYSVMgICAgICAgICAgICAgICAgICAgID0gMHg4ODU2CglFVEhFUlRZUEVfQkNMT09QICAgICAgICAgICAgICAgICAgPSAweDkwMDMKCUVUSEVSVFlQRV9CT0ZMICAgICAgICAgICAgICAgICAgICA9IDB4ODEwMgoJRVRIRVJUWVBFX0NBQkxFVFJPTiAgICAgICAgICAgICAgID0gMHg3MDM0CglFVEhFUlRZUEVfQ0hBT1MgICAgICAgICAgICAgICAgICAgPSAweDgwNAoJRVRIRVJUWVBFX0NPTURFU0lHTiAgICAgICAgICAgICAgID0gMHg4MDZjCglFVEhFUlRZUEVfQ09NUFVHUkFQSElDICAgICAgICAgICAgPSAweDgwNmQKCUVUSEVSVFlQRV9DT1VOVEVSUE9JTlQgICAgICAgICAgICA9IDB4ODA2MgoJRVRIRVJUWVBFX0NST05VUyAgICAgICAgICAgICAgICAgID0gMHg4MDA0CglFVEhFUlRZUEVfQ1JPTlVTVkxOICAgICAgICAgICAgICAgPSAweDgwMDMKCUVUSEVSVFlQRV9EQ0EgICAgICAgICAgICAgICAgICAgICA9IDB4MTIzNAoJRVRIRVJUWVBFX0RERSAgICAgICAgICAgICAgICAgICAgID0gMHg4MDdiCglFVEhFUlRZUEVfREVCTkkgICAgICAgICAgICAgICAgICAgPSAweGFhYWEKCUVUSEVSVFlQRV9ERUNBTSAgICAgICAgICAgICAgICAgICA9IDB4ODA0OAoJRVRIRVJUWVBFX0RFQ0NVU1QgICAgICAgICAgICAgICAgID0gMHg2MDA2CglFVEhFUlRZUEVfREVDRElBRyAgICAgICAgICAgICAgICAgPSAweDYwMDUKCUVUSEVSVFlQRV9ERUNETlMgICAgICAgICAgICAgICAgICA9IDB4ODAzYwoJRVRIRVJUWVBFX0RFQ0RUUyAgICAgICAgICAgICAgICAgID0gMHg4MDNlCglFVEhFUlRZUEVfREVDRVhQRVIgICAgICAgICAgICAgICAgPSAweDYwMDAKCUVUSEVSVFlQRV9ERUNMQVNUICAgICAgICAgICAgICAgICA9IDB4ODA0MQoJRVRIRVJUWVBFX0RFQ0xUTSAgICAgICAgICAgICAgICAgID0gMHg4MDNmCglFVEhFUlRZUEVfREVDTVVNUFMgICAgICAgICAgICAgICAgPSAweDYwMDkKCUVUSEVSVFlQRV9ERUNORVRCSU9TICAgICAgICAgICAgICA9IDB4ODA0MAoJRVRIRVJUWVBFX0RFTFRBQ09OICAgICAgICAgICAgICAgID0gMHg4NmRlCglFVEhFUlRZUEVfRElERExFICAgICAgICAgICAgICAgICAgPSAweDQzMjEKCUVUSEVSVFlQRV9ETE9HMSAgICAgICAgICAgICAgICAgICA9IDB4NjYwCglFVEhFUlRZUEVfRExPRzIgICAgICAgICAgICAgICAgICAgPSAweDY2MQoJRVRIRVJUWVBFX0ROICAgICAgICAgICAgICAgICAgICAgID0gMHg2MDAzCglFVEhFUlRZUEVfRE9HRklHSFQgICAgICAgICAgICAgICAgPSAweDE5ODkKCUVUSEVSVFlQRV9EU01EICAgICAgICAgICAgICAgICAgICA9IDB4ODAzOQoJRVRIRVJUWVBFX0VDTUEgICAgICAgICAgICAgICAgICAgID0gMHg4MDMKCUVUSEVSVFlQRV9FTkNSWVBUICAgICAgICAgICAgICAgICA9IDB4ODAzZAoJRVRIRVJUWVBFX0VTICAgICAgICAgICAgICAgICAgICAgID0gMHg4MDVkCglFVEhFUlRZUEVfRVhDRUxBTiAgICAgICAgICAgICAgICAgPSAweDgwMTAKCUVUSEVSVFlQRV9FWFBFUkRBVEEgICAgICAgICAgICAgICA9IDB4ODA0OQoJRVRIRVJUWVBFX0ZMSVAgICAgICAgICAgICAgICAgICAgID0gMHg4MTQ2CglFVEhFUlRZUEVfRkxPV0NPTlRST0wgICAgICAgICAgICAgPSAweDg4MDgKCUVUSEVSVFlQRV9GUkFSUCAgICAgICAgICAgICAgICAgICA9IDB4ODA4CglFVEhFUlRZUEVfR0VORFlOICAgICAgICAgICAgICAgICAgPSAweDgwNjgKCUVUSEVSVFlQRV9IQVlFUyAgICAgICAgICAgICAgICAgICA9IDB4ODEzMAoJRVRIRVJUWVBFX0hJUFBJX0ZQICAgICAgICAgICAgICAgID0gMHg4MTgwCglFVEhFUlRZUEVfSElUQUNISSAgICAgICAgICAgICAgICAgPSAweDg4MjAKCUVUc3JjIGlzIGFuIGV4aXN0aW5nIGZpbGUgb24gdGhlIGRpc2suCgkvLyBJZiBpdCBpcyBhIGZpbGUsIGxldCByZWd1bGFyIHBwcm9mIG9wZW4gaXQuCgkvLyBJZiBpdCBpcyBub3QgYSBmaWxlLCB3aGVuIHRoZSBzcmMgY29udGFpbnMgYDpgCgkvLyAoZS5nLiBtZW1fMjAyMy0xMS0wMl8wMzo1NToyNCBvciBhYmM6MTIzL21lbV8yMDIzLTExLTAyXzAzOjU1OjI0KSwKCS8vIHVybC5QYXJzZSB3aWxsIHJlY29nbml6ZSBpdCBhcyBhIGxpbmsgYW5kIHVsdGltYXRlbHkgcmVwb3J0IGFuIGVycm9yLAoJLy8gc2ltaWxhciB0byBgYWJjOjEyMy9tZW1fMjAyMy0xMS0wMl8wMzo1NToyNDoKCS8vIEdldCAiaHR0cDovL2FiYzoxMjMvbWVtXzIwMjMtMTEtMDJfMDM6NTU6MjQiOiBkaWFsIHRjcDogbG9va3VwIGFiYzogbm8gc3VjaCBob3N0YAoJaWYgXywgb3BlbkVyciA6PSBvcy5TdGF0KHNyYyk7IG9wZW5FcnIgPT0gbmlsIHsKCQlyZXR1cm4gbmlsLCAiIiwgbmlsCgl9Cglzb3VyY2VVUkwsIHRpbWVvdXQgOj0gYWRqdXN0VVJMKHNyYywgZHVyYXRpb24sIHRpbWVvdXQpCglpZiBzb3VyY2VVUkwgPT0gIiIgewoJCS8vIENvdWxkIG5vdCByZWNvZ25pemUgVVJMLCBsZXQgcmVndWxhciBwcHJvZiBhdHRlbXB0IHRvIGZldGNoIHRoZSBwcm9maWxlIChlZy4gZnJvbSBhIGZpbGUpCgkJcmV0dXJuIG5pbCwgIiIsIG5pbAoJfQoJZm10LkZwcmludGxuKG9zLlN0ZGVyciwgIkZldGNoaW5nIHByb2ZpbGUgb3ZlciBIVFRQIGZyb20iLCBzb3VyY2VVUkwpCglpZiBkdXJhdGlvbiA+IDAgewoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgIlBsZWFzZSB3YWl0Li4uICgldilcbiIsIGR1cmF0aW9uKQoJfQoJcCwgZXJyIDo9IGdldFByb2ZpbGUoc291cmNlVVJMLCB0aW1lb3V0KQoJcmV0dXJuIHAsIHNvdXJjZVVSTCwgZXJyCn0KCmZ1bmMgZ2V0UHJvZmlsZShzb3VyY2Ugc3RyaW5nLCB0aW1lb3V0IHRpbWUuRHVyYXRpb24pICgqcHJvZmlsZS5Qcm9maWxlLCBlcnJvcikgewoJdXJsLCBlcnIgOj0gdXJsLlBhcnNlKHNvdXJjZSkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBuaWwsIGVycgoJfQoKCXZhciB0bHNDb25maWcgKnRscy5Db25maWcKCWlmIHVybC5TY2hlbWUgPT0gImh0dHBzK2luc2VjdXJlIiB7CgkJdGxzQ29uZmlnID0gJnRscy5Db25maWd7CgkJCUluc2VjdXJlU2tpcFZlcmlmeTogdHJ1ZSwKCQl9CgkJdXJsLlNjaGVtZSA9ICJodHRwcyIKCQlzb3VyY2UgPSB1cmwuU3RyaW5nKCkKCX0KCgljbGllbnQgOj0gJmh0dHAuQ2xpZW50ewoJCVRyYW5zcG9ydDogJmh0dHAuVHJhbnNwb3J0ewoJCQlSZXNwb25zZUhlYWRlclRpbWVvdXQ6IHRpbWVvdXQgKyA1KnRpbWUuU2Vjb25kLAoJCQlQcm94eTogICAgICAgICAgICAgICAgIGh0dHAuUHJveHlGcm9tRW52aXJvbm1lbnQsCgkJCVRMU0NsaWVudENvbmZpZzogICAgICAgdGxzQ29uZmlnLAoJCX0sCgl9CglyZXNwLCBlcnIgOj0gY2xpZW50LkdldChzb3VyY2UpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWRlZmVyIHJlc3AuQm9keS5DbG9zZSgpCglpZiByZXNwLlN0YXR1c0NvZGUgIT0gaHR0cC5TdGF0dXNPSyB7CgkJcmV0dXJuIG5pbCwgc3RhdHVzQ29kZUVycm9yKHJlc3ApCgl9CglyZXR1cm4gcHJvZmlsZS5QYXJzZShyZXNwLkJvZHkpCn0KCmZ1bmMgc3RhdHVzQ29kZUVycm9yKHJlc3AgKmh0dHAuUmVzcG9uc2UpIGVycm9yIHsKCWlmIHJlc3AuSGVhZGVyLkdldCgiWC1Hby1QcHJvZiIpICE9ICIiICYmIHN0cmluZ3MuQ29udGFpbnMocmVzcC5IZWFkZXIuR2V0KCJDb250ZW50LVR5cGUiKSwgInRleHQvcGxhaW4iKSB7CgkJLy8gZXJyb3IgaXMgZnJvbSBwcHJvZiBlbmRwb2ludAoJCWlmIGJvZHksIGVyciA6PSBpby5SZWFkQWxsKHJlc3AuQm9keSk7IGVyciA9PSBuaWwgewoJCQlyZXR1cm4gZm10LkVycm9yZigic2VydmVyIHJlc3BvbnNlOiAlcyAtICVzIiwgcmVzcC5TdGF0dXMsIGJvZHkpCjQwRUJCNUUzOTdFMDIzNzIKCTMuNTk3Njc1Mzg0MjUxMTQ0NzE0NjVlKzA0LCAgLy8gMHg0MEUxOTExODFGN0E1NEEwCgktNS4zNTQzNDI3NTYwMTk0NDc3MzM3MWUrMDMsIC8vIDB4QzBCNEVBNTdCRURCQzYwOQp9CgovLyBmb3IgeCBpbiBbNC41NDcsMi44NTcxXT0xL1swLjIxOTksMC4zNTAwMV0KdmFyIHEwUjMgPSBbNl1mbG9hdDY0ewoJNC4zNzc0MTAxNDA4OTczODYyMDkwNmUtMDksIC8vIDB4M0UzMkNEMDM2QURFQ0I4MgoJNy4zMjQxMTE4MDA0MjkxMTQ0NzE2M2UtMDIsIC8vIDB4M0ZCMkJGRUUwRThEMDg0MgoJMy4zNDQyMzEzNzUxNjE3MDcyMDkyOWUrMDAsIC8vIDB4NDAwQUMwRkM2MTE0OUNGNQoJNC4yNjIxODQ0MDc0NTQxMjY1MDAxN2UrMDEsIC8vIDB4NDA0NTRGOTg5NjJEQUVERAoJMS43MDgwODA5MTM0MDU2NTU5NjI4M2UrMDIsIC8vIDB4NDA2NTU5REJFMjVFRkQxRgoJMS42NjczMzk0ODY5NjY1MTE2ODU3NWUrMDIsIC8vIDB4NDA2NEQ3N0M4MUZBMjFFMAp9CnZhciBxMFMzID0gWzZdZmxvYXQ2NHsKCTQuODc1ODg3Mjk3MjQ1ODcxODIwOTFlKzAxLCAgLy8gMHg0MDQ4NjEyMkJGRTM0M0E2Cgk3LjA5Njg5MjIxMDU2NjA2MDE1NzM2ZSswMiwgIC8vIDB4NDA4NjJEODM4NjU0NEVCMwoJMy43MDQxNDgyMjYyMDExMTM2Mjk5NGUrMDMsICAvLyAweDQwQUNGMDRCRTQ0REZDNjMKCTYuNDYwNDI1MTY3NTI1Njg5MTc1ODJlKzAzLCAgLy8gMHg0MEI5M0M2Q0Q3Qzc2QTI4CgkyLjUxNjMzMzY4OTIwMzY4OTU3MzMzZSswMywgIC8vIDB4NDBBM0E4QUFEOTRGQjFDMAoJLTEuNDkyNDc0NTE4MzYxNTYzODY2NjJlKzAyLCAvLyAweEMwNjJBN0VCMjAxQ0Y0MEYKfQoKLy8gZm9yIHggaW4gWzIuODU3MCwyXT0xL1swLjM0OTksMC41XQp2YXIgcTBSMiA9IFs2XWZsb2F0NjR7CgkxLjUwNDQ0NDQ0ODg2OTgzMjcyMzc5ZS0wNywgLy8gMHgzRTg0MzEzQjU0Rjc2QkRCCgk3LjMyMjM0MjY1OTYzMDc5Mjc4MjcyZS0wMiwgLy8gMHgzRkIyQkVDNTNFODgzRTM0CgkxLjk5ODE5MTc0MDkzODE1OTk4ODE2ZSswMCwgLy8gMHgzRkZGRjg5N0U3Mjc3NzlDCgkxLjQ0OTU2MDI5MzQ3ODg1NzM1MzQ4ZSswMSwgLy8gMHg0MDJDRkRCRkFBRjk2RkU1CgkzLjE2NjYyMzE3NTA0NzgxNTQwODMzZSswMSwgLy8gMHg0MDNGQUE4RTI5RkJEQzRBCgkxLjYyNTI3MDc1NzEwOTI5MjY3NDE2ZSswMSwgLy8gMHg0MDMwNDBCMTcxODE0QkI0Cn0KdmFyIHEwUzIgPSBbNl1mbG9hdDY0ewoJMy4wMzY1NTg0ODM1NTIxOTE4NDQ5OGUrMDEsICAvLyAweDQwM0U1RDk2RjdDMDdBRUQKCTIuNjkzNDgxMTg2MDgwNDk4NDQ2MjRlKzAyLCAgLy8gMHg0MDcwRDU5MUU0RDE0QjQwCgk4LjQ0NzgzNzU3NTk1MzIwMTM5NDQ0ZSswMiwgIC8vIDB4NDA4QTY2NDUyMkIzQkYyMgoJOC44MjkzNTg0NTExMjQ4ODU1MDUxMmUrMDIsICAvLyAweDQwOEI5NzdDOUM1Q0MyMTQKCTIuMTI2NjYzODg1MTE3OTg4Mjg2MzFlKzAyLCAgLy8gMHg0MDZBOTU1MzBFMDAxMzY1CgktNS4zMTA5NTQ5Mzg4MjY2Njk0NjkxN2UrMDAsIC8vIDB4QzAxNTNFNkFGOEIzMjkzMQp9CgpmdW5jIHF6ZXJvKHggZmxvYXQ2NCkgZmxvYXQ2NCB7Cgl2YXIgcCwgcSAqWzZdZmxvYXQ2NAoJaWYgeCA+PSA4IHsKCQlwID0gJnEwUjgKCQlxID0gJnEwUzgKCX0gZWxzZSBpZiB4ID49IDQuNTQ1NCB7CgkJcCA9ICZxMFI1CgkJcSA9ICZxMFM1Cgl9IGVsc2UgaWYgeCA+PSAyLjg1NzEgewoJCXAgPSAmcTBSMwoJCXEgPSAmcTBTMwoJfSBlbHNlIGlmIHggPj0gMiB7CgkJcCA9ICZxMFIyCgkJcSA9ICZxMFMyCgl9Cgl6IDo9IDEgLyAoeCAqIHgpCglyIDo9IHBbMF0gKyB6KihwWzFdK3oqKHBbMl0reioocFszXSt6KihwWzRdK3oqcFs1XSkpKSkKCXMgOj0gMSArIHoqKHFbMF0reioocVsxXSt6KihxWzJdK3oqKHFbM10reioocVs0XSt6KnFbNV0pKSkpKQoJcmV0dXJuICgtMC4xMjUgKyByL3MpIC8geAp9Ci8vIENvcHlyaWdodCAyMDE2IFRoZSB2YXIgY21kR3JhcGggPSAmYmFzZS5Db21tYW5kewoJVXNhZ2VMaW5lOiAiZ28gbW9kIGdyYXBoIFstZ289dmVyc2lvbl0gWy14XSIsCglTaG9ydDogICAgICJwcmludCBtb2R1bGUgcmVxdWlyZW1lbnQgZ3JhcGgiLAoJTG9uZzogYApHcmFwaCBwcmludHMgdGhlIG1vZHVsZSByZXF1aXJlbWVudCBncmFwaCAod2l0aCByZXBsYWNlbWVudHMgYXBwbGllZCkKaW4gdGV4dCBmb3JtLiBFYWNoIGxpbmUgaW4gdGhlIG91dHB1dCBoYXMgdHdvIHNwYWNlLXNlcGFyYXRlZCBmaWVsZHM6IGEgbW9kdWxlCmFuZCBvbmUgb2YgaXRzIHJlcXVpcmVtZW50cy4gRWFjaCBtb2R1bGUgaXMgaWRlbnRpZmllZCBhcyBhIHN0cmluZyBvZiB0aGUgZm9ybQpwYXRoQHZlcnNpb24sIGV4Y2VwdCBmb3IgdGhlIG1haW4gbW9kdWxlLCB3aGljaCBoYXMgbm8gQHZlcnNpb24gc3VmZml4LgoKVGhlIC1nbyBmbGFnIGNhdXNlcyBncmFwaCB0byByZXBvcnQgdGhlIG1vZHVsZSBncmFwaCBhcyBsb2FkZWQgYnkgdGhlCmdpdmVuIEdvIHZlcnNpb24sIGluc3RlYWQgb2YgdGhlIHZlcnNpb24gaW5kaWNhdGVkIGJ5IHRoZSAnZ28nIGRpcmVjdGl2ZQppbiB0aGUgZ28ubW9kIGZpbGUuCgpUaGUgLXggZmxhZyBjYXVzZXMgZ3JhcGggdG8gcHJpbnQgdGhlIGNvbW1hbmRzIGdyYXBoIGV4ZWN1dGVzLgoKU2VlIGh0dHBzOi8vZ29sYW5nLm9yZy9yZWYvbW9kI2dvLW1vZC1ncmFwaCBmb3IgbW9yZSBhYm91dCAnZ28gbW9kIGdyYXBoJy4KCWAsCglSdW46IHJ1bkdyYXBoLAp9Cgp2YXIgKAoJZ3JhcGhHbyBnb1ZlcnNpb25GbGFnCikKCmZ1bmMgaW5pdCgpIHsKCWNtZEdyYXBoLkZsYWcuVmFyKCZncmFwaEdvLCAiZ28iLCAiIikKCWNtZEdyYXBoLkZsYWcuQm9vbFZhcigmY2ZnLkJ1aWxkWCwgIngiLCBmYWxzZSwgIiIpCgliYXNlLkFkZENoZGlyRmxhZygmY21kR3JhcGguRmxhZykKCWJhc2UuQWRkTW9kQ29tbW9uRmxhZ3MoJmNtZEdyYXBoLkZsYWcpCn0KCmZ1bmMgcnVuR3JhcGgoY3R4IGNvbnRleHQuQ29udGV4dCwgY21kICpiYXNlLkNvbW1hbmQsIGFyZ3MgW11zdHJpbmcpIHsKCW1vZHVsZUxvYWRlclN0YXRlIDo9IG1vZGxvYWQuTmV3U3RhdGUoKQoJbW9kdWxlTG9hZGVyU3RhdGUuSW5pdFdvcmtmaWxlKCkKCglpZiBsZW4oYXJncykgPiAwIHsKCQliYXNlLkZhdGFsZigiZ286ICdnbyBtb2QgZ3JhcGgnIGFjY2VwdHMgbm8gYXJndW1lbnRzIikKCX0KCW1vZHVsZUxvYWRlclN0YXRlLkZvcmNlVXNlTW9kdWxlcyA9IHRydWUKCW1vZHVsZUxvYWRlclN0YXRlLlJvb3RNb2RlID0gbW9kbG9hZC5OZWVkUm9vdAoKCWdvVmVyc2lvbiA6PSBncmFwaEdvLlN0cmluZygpCglpZiBnb1ZlcnNpb24gIT0gIiIgJiYgZ292ZXIuQ29tcGFyZShnb3Zlci5Mb2NhbCgpLCBnb1ZlcnNpb24pIDwgMCB7CgkJdG9vbGNoYWluLlN3aXRjaE9yRmF0YWwobW9kdWxlTG9hZGVyU3RhdGUsIGN0eCwgJmdvdmVyLlRvb05ld0Vycm9yewoJCQlXaGF0OiAgICAgICItZ28gZmxhZyIsCgkJCUdvVmVyc2lvbjogZ29WZXJzaW9uLAoJCX0pCgl9CgoJbWcsIGVyciA6PSBtb2Rsb2FkLkxvYWRNb2RHcmFwaChtb2R1bGVMb2FkZXJTdGF0ZSwgY3R4LCBnb1ZlcnNpb24pCglpZiBlcnIgIT0gbmlsIHsKCQliYXNlLkZhdGFsKGVycikKCX0KCgl3IDo9IGJ1ZmlvLk5ld1dyaXRlcihvcy5TdGRvdXQpCglkZWZlciB3LkZsdXNoKCkKCglmb3JtYXQgOj0gZnVuYyhtIG1vZHVsZS5WZXJzaW9uKSB7CgkJdy5Xcml0ZVN0cmluZyhtLlBhdGgpCgkJaWYgbS5WZXJzaW9uICE9ICIiIHsKCQkJdy5Xcml0ZVN0cmluZygiQCIpCgkJCXcuV3JpdGVTdHJpbmcobS5WZXJzaW9uKQoJCX0KCX0KCgltZy5XYWxrQnJlYWR0aEZpcnN0KGZ1bmMobSBtb2R1bGUuVmVyc2lvbikgewoJCXJlcXMsIF8gOj0gbWcuUmVxdWlyZWRCeShtKQoJCWZvciBfLCByIDo9IHJhbmdlIHJlcXMgewoJCQlmb3JtYXQobSkKCQkJdy5Xcml0ZUJ5dGUoJyAnKQoJCQlmb3JtYXQocikKeDFkCglJUFY2X0ZMT1dJTkZPX01BU0sgICAgICAgICAgICAgICAgPSAweGZmZmZmZjBmCglJUFY2X0ZMT1dMQUJFTF9NQVNLICAgICAgICAgICAgICAgPSAweGZmZmYwZjAwCglJUFY2X0ZSQUdUVEwgICAgICAgICAgICAgICAgICAgICAgPSAweDc4CglJUFY2X0hMSU1ERUMgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUlQVjZfSE9QTElNSVQgICAgICAgICAgICAgICAgICAgICA9IDB4MmYKCUlQVjZfSE9QT1BUUyAgICAgICAgICAgICAgICAgICAgICA9IDB4MzEKCUlQVjZfSVBDT01QX0xFVkVMICAgICAgICAgICAgICAgICA9IDB4M2MKCUlQVjZfSk9JTl9HUk9VUCAgICAgICAgICAgICAgICAgICA9IDB4YwoJSVBWNl9MRUFWRV9HUk9VUCAgICAgICAgICAgICAgICAgID0gMHhkCglJUFY2X01BWEhMSU0gICAgICAgICAgICAgICAgICAgICAgPSAweGZmCglJUFY2X01BWFBBQ0tFVCAgICAgICAgICAgICAgICAgICAgPSAweGZmZmYKCUlQVjZfTUlOSE9QQ09VTlQgICAgICAgICAgICAgICAgICA9IDB4NDEKCUlQVjZfTU1UVSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NTAwCglJUFY2X01VTFRJQ0FTVF9IT1BTICAgICAgICAgICAgICAgPSAweGEKCUlQVjZfTVVMVElDQVNUX0lGICAgICAgICAgICAgICAgICA9IDB4OQoJSVBWNl9NVUxUSUNBU1RfTE9PUCAgICAgICAgICAgICAgID0gMHhiCglJUFY2X05FWFRIT1AgICAgICAgICAgICAgICAgICAgICAgPSAweDMwCglJUFY2X09QVElPTlMgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUlQVjZfUEFUSE1UVSAgICAgICAgICAgICAgICAgICAgICA9IDB4MmMKCUlQVjZfUElQRVggICAgICAgICAgICAgICAgICAgICAgICA9IDB4M2YKCUlQVjZfUEtUSU5GTyAgICAgICAgICAgICAgICAgICAgICA9IDB4MmUKCUlQVjZfUE9SVFJBTkdFICAgICAgICAgICAgICAgICAgICA9IDB4ZQoJSVBWNl9QT1JUUkFOR0VfREVGQVVMVCAgICAgICAgICAgID0gMHgwCglJUFY2X1BPUlRSQU5HRV9ISUdIICAgICAgICAgICAgICAgPSAweDEKCUlQVjZfUE9SVFJBTkdFX0xPVyAgICAgICAgICAgICAgICA9IDB4MgoJSVBWNl9SRUNWRFNUT1BUUyAgICAgICAgICAgICAgICAgID0gMHgyOAoJSVBWNl9SRUNWRFNUUE9SVCAgICAgICAgICAgICAgICAgID0gMHg0MAoJSVBWNl9SRUNWSE9QTElNSVQgICAgICAgICAgICAgICAgID0gMHgyNQoJSVBWNl9SRUNWSE9QT1BUUyAgICAgICAgICAgICAgICAgID0gMHgyNwoJSVBWNl9SRUNWUEFUSE1UVSAgICAgICAgICAgICAgICAgID0gMHgyYgoJSVBWNl9SRUNWUEtUSU5GTyAgICAgICAgICAgICAgICAgID0gMHgyNAoJSVBWNl9SRUNWUlRIRFIgICAgICAgICAgICAgICAgICAgID0gMHgyNgoJSVBWNl9SRUNWVENMQVNTICAgICAgICAgICAgICAgICAgID0gMHgzOQoJSVBWNl9SVEFCTEUgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDIxCglJUFY2X1JUSERSICAgICAgICAgICAgICAgICAgICAgICAgPSAweDMzCglJUFY2X1JUSERSRFNUT1BUUyAgICAgICAgICAgICAgICAgPSAweDIzCglJUFY2X1JUSERSX0xPT1NFICAgICAgICAgICAgICAgICAgPSAweDAKCUlQVjZfUlRIRFJfU1RSSUNUICAgICAgICAgICAgICAgICA9IDB4MQoJSVBWNl9SVEhEUl9UWVBFXzAgICAgICAgICAgICAgICAgID0gMHgwCglJUFY2X1NPQ0tPUFRfUkVTRVJWRUQxICAgICAgICAgICAgPSAweDMKCUlQVjZfVENMQVNTICAgICAgICAgICAgICAgICAgICAgICA9IDB4M2QKCUlQVjZfVU5JQ0FTVF9IT1BTICAgICAgICAgICAgICAgICA9IDB4NAoJSVBWNl9VU0VfTUlOX01UVSAgICAgICAgICAgICAgICAgID0gMHgyYQoJSVBWNl9WNk9OTFkgICAgICAgICAgICAgICAgICAgICAgID0gMHgxYgoJSVBWNl9WRVJTSU9OICAgICAgICAgICAgICAgICAgICAgID0gMHg2MAoJSVBWNl9WRVJTSU9OX01BU0sgICAgICAgICAgICAgICAgID0gMHhmMAoJSVBfQUREX01FTUJFUlNISVAgICBudCBvZjoKLy8KLy8Jb2xkID0gKmFkZHIKLy8JKmFkZHIgPSBuZXcKLy8JcmV0dXJuIG9sZAovLwovLyBUaGUgY29tcGFyZS1hbmQtc3dhcCBvcGVyYXRpb24sIGltcGxlbWVudGVkIGJ5IHRoZSBDb21wYXJlQW5kU3dhcFQKLy8gZnVuY3Rpb25zLCBpcyB0aGUgYXRvbWljIGVxdWl2YWxlbnQgb2Y6Ci8vCi8vCWlmICphZGRyID09IG9sZCB7Ci8vCQkqYWRkciA9IG5ldwovLwkJcmV0dXJuIHRydWUKLy8JfQovLwlyZXR1cm4gZmFsc2UKLy8KLy8gVGhlIGFkZCBvcGVyYXRpb24sIGltcGxlbWVudGVkIGJ5IHRoZSBBZGRUIGZ1bmN0aW9ucywgaXMgdGhlIGF0b21pYwovLyBlcXVpdmFsZW50IG9mOgovLwovLwkqYWRkciArPSBkZWx0YQovLwlyZXR1cm4gKmFkZHIKLy8KLy8gVGhlIGxvYWQgYW5kIHN0b3JlIG9wZXJhdGlvbnMsIGltcGxlbWVudGVkIGJ5IHRoZSBMb2FkVCBhbmQgU3RvcmVUCi8vIGZ1bmN0aW9ucywgYXJlIHRoZSBhdG9taWMgZXF1aXZhbGVudHMgb2YgInJldHVybiAqYWRkciIgYW5kCi8vICIqYWRkciA9IHZhbCIuCi8vCi8vIEluIHRoZSB0ZXJtaW5vbG9neSBvZiBbdGhlIEdvIG1lbW9yeSBtb2RlbF0sIGlmIHRoZSBlZmZlY3Qgb2YKLy8gYW4gYXRvbWljIG9wZXJhdGlvbiBBIGlzIG9ic2VydmVkIGJ5IGF0b21pYyBvcGVyYXRpb24gQiwKLy8gdGhlbiBBIOKAnHN5bmNocm9uaXplcyBiZWZvcmXigJ0gQi4KLy8gQWRkaXRpb25hbGx5LCBhbGwgdGhlIGF0b21pYyBvcGVyYXRpb25zIGV4ZWN1dGVkIGluIGEgcHJvZ3JhbQovLyBiZWhhdmUgYXMgdGhvdWdoIGV4ZWN1dGVkIGluIHNvbWUgc2VxdWVudGlhbGx5IGNvbnNpc3RlbnQgb3JkZXIuCi8vIFRoaXMgZGVmaW5pdGlvbiBwcm92aWRlcyB0aGUgc2FtZSBzZW1hbnRpY3MgYXMKLy8gQysrJ3Mgc2VxdWVudGlhbGx5IGNvbnNpc3RlbnQgYXRvbWljcyBhbmQgSmF2YSdzIHZvbGF0aWxlIHZhcmlhYmxlcy4KLy8KLy8gW3RoZSBHbyBtZW1vcnkgbW9kZWxdOiBodHRwczovL2dvLmRldi9yZWYvbWVtCnBhY2thZ2UgYXRvbWljCgppbXBvcnQgKAoJInVuc2FmZSIKKQoKLy8gQlVHKHJzYyk6IE9uIDM4NiwgdGhlIDY0LWJpdCBmdW5jdGlvbnMgdXNlIGluc3RydWN0aW9ucyB1bmF2YWlsYWJsZSBiZWZvcmUgdGhlIFBlbnRpdW0gTU1YLgovLwovLyBPbiBub24tTGludXggQVJNLCB0aGUgNjQtYml0IGZ1bmN0aW9ucyB1c2UgaW5zdHJ1Y3Rpb25zIHVuYXZhaWxhYmxlIGJlZm9yZSB0aGUgQVJNdjZrIGNvcmUuCi8vCi8vIE9uIEFSTSwgMzg2LCBhbmQgMzItYml0IE1JUFMsIGl0IGlzIHRoZSBjYWxsZXIncyByZXNwb25zaWJpbGl0eSB0byBhcnJhbmdlCi8vIGZvciA2NC1iaXQgYWxpZ25tZW50IG9mIDY0LWJpdCB3b3JkcyBhY2Nlc3NlZCBhdG9taWNhbGx5IHZpYSB0aGUgcHJpbWl0aXZlCi8vIGF0b21pYyBmdW5jdGlvbnMgKHR5cGVzIFtJbnQ2NF0gYW5kIFtVaW50NjRdIGFyZSBhdXRvbWF0aWNhbGx5IGFsaWduZWQpLgovLyBUaGUgZmlyc3Qgd29yZCBpbiBhbiBhbGxvY2F0ZWQgc3RydWN0LCBhcnJheSwgb3Igc2xpY2U7IGluIGEgZ2xvYmFsCi8vIHZhcmlhYmxlOyBvciBpbiBhIGxvY2FsIHZhcmlhYmxlIChiZWNhdXNlIG9uIDMyLWJpdCBhcmNoaXRlY3R1cmVzLCB0aGUKLy8gc3ViamVjdCBvZiA2NC1iaXQgYXRvbWljIG9wZXJhdGlvbnMgd2lsbCBlc2NhcGUgdG8gdGhlIGhlYXApIGNhbiBiZQovLyByZWxpZWQgdXBvbiB0byBiZSA2NC1iaXQgYWxpZ25lZC4KCi8vIFN3YXBJbnQzMiBhdG9taWNhbGx5IHN0b3JlcyBuZXcgaW50byAqYWRkciBhbmQgcmV0dXJucyB0aGUgcHJldmlvdXMgKmFkZHIgdmFsdWUuCi8vIENvbnNpZGVyIHVzaW5nIHRoZSBtb3JlIGVyZ29ub21pYyBhbmQgbGVzcyBlcnJvci1wcm9uZSBbSW50MzIuU3dhcF0gaW5zdGVhZC4KLy8KLy9nbzpub2VzY2FwZQpmdW5jIFN3YXBJbnQzMihhZGRyICppbnQzMiwgbmV3IGludDMyKSAob2xkIGludDMyKQoKLy8gU3dhcFVpbnQzbGxzW2tdLlJvb3QgJiYgIWlzRW1wdHlJbmxpbmVkQ2FsbChrLCBjYWxscykgewoJCQkJa2lkcyA9IGFwcGVuZChraWRzLCBrKQoJCQl9CgkJfQoJfQoJcmV0dXJuIGtpZHMKfQoKZnVuYyBpbmxpbmVkVmFyVGFibGUoaW5sY2FsbHMgKklubENhbGxzKSBtYXBbKlZhcl1ib29sIHsKCXZhcnMgOj0gbWFrZShtYXBbKlZhcl1ib29sKQoJZm9yIF8sIGljIDo9IHJhbmdlIGlubGNhbGxzLkNhbGxzIHsKCQlmb3IgXywgdiA6PSByYW5nZSBpYy5JbmxWYXJzIHsKCQkJdmFyc1t2XSA9IHRydWUKCQl9Cgl9CglyZXR1cm4gdmFycwp9CgovLyBUaGUgcy5TY29wZXMgc2xpY2UgY29udGFpbnMgdmFyaWFibGVzIHdlcmUgb3JpZ2luYWxseSBwYXJ0IG9mIHRoZQovLyBmdW5jdGlvbiBiZWluZyBlbWl0dGVkLCBhcyB3ZWxsIGFzIHZhcmlhYmxlcyB0aGF0IHdlcmUgaW1wb3J0ZWQKLy8gZnJvbSB2YXJpb3VzIGNhbGxlZSBmdW5jdGlvbnMgZHVyaW5nIHRoZSBpbmxpbmluZyBwcm9jZXNzLiBUaGlzCi8vIGZ1bmN0aW9uIHBydW5lcyBvdXQgYW55IHZhcmlhYmxlcyBmcm9tIHRoZSBsYXR0ZXIgY2F0ZWdvcnkgKHNpbmNlCi8vIHRoZXkgd2lsbCBiZSBlbWl0dGVkIGFzIHBhcnQgb2YgRFdBUkYgaW5saW5lZF9zdWJyb3V0aW5lIERJRXMpIGFuZAovLyB0aGVuIGdlbmVyYXRlcyBzY29wZXMgZm9yIHZhcnMgaW4gdGhlIGZvcm1lciBjYXRlZ29yeS4KZnVuYyBwdXRQcnVuZWRTY29wZXMoY3R4dCBDb250ZXh0LCBzICpGblN0YXRlLCBmbmFiYnJldiBpbnQpIGVycm9yIHsKCWlmIGxlbihzLlNjb3BlcykgPT0gMCB7CgkJcmV0dXJuIG5pbAoJfQoJc2NvcGVzIDo9IG1ha2UoW11TY29wZSwgbGVuKHMuU2NvcGVzKSwgbGVuKHMuU2NvcGVzKSkKCXB2YXJzIDo9IGlubGluZWRWYXJUYWJsZSgmcy5JbmxDYWxscykKCWZvciBrLCBzIDo9IHJhbmdlIHMuU2NvcGVzIHsKCQl2YXIgcHJ1bmVkIFNjb3BlID0gU2NvcGV7UGFyZW50OiBzLlBhcmVudCwgUmFuZ2VzOiBzLlJhbmdlc30KCQlmb3IgaSA6PSAwOyBpIDwgbGVuKHMuVmFycyk7IGkrKyB7CgkJCV8sIGZvdW5kIDo9IHB2YXJzW3MuVmFyc1tpXV0KCQkJaWYgIWZvdW5kIHsKCQkJCXBydW5lZC5WYXJzID0gYXBwZW5kKHBydW5lZC5WYXJzLCBzLlZhcnNbaV0pCgkJCX0KCQl9CgkJc2xpY2VzLlNvcnRGdW5jKHBydW5lZC5WYXJzLCBieUNoaWxkSW5kZXhDbXApCgkJc2NvcGVzW2tdID0gcHJ1bmVkCgl9CgoJcy5kaWN0SW5kZXhUb09mZnNldCA9IHB1dHBhcmFtdHlwZXMoY3R4dCwgcywgc2NvcGVzLCBmbmFiYnJldikKCgl2YXIgZW5jYnVmIFsyMF1ieXRlCglpZiBwdXRzY29wZShjdHh0LCBzLCBzY29wZXMsIDAsIGZuYWJicmV2LCBlbmNidWZbOjBdKSA8IGludDMyKGxlbihzY29wZXMpKSB7CgkJcmV0dXJuIGVycm9ycy5OZXcoIm11bHRpcGxlIHRvcGxldmVsIHNjb3BlcyIpCgl9CglyZXR1cm4gbmlsCn0KCi8vIEVtaXQgRFdBUkYgYXR0cmlidXRlcyBhbmQgY2hpbGQgRElFcyBmb3IgYW4gJ2Fic3RyYWN0JyBzdWJwcm9ncmFtLgovLyBUaGUgYWJzdHJhY3Qgc3VicHJvZ3JhbSBESUUgZm9yIGEgZnVuY3Rpb24gY29udGFpbnMgaXRzCi8vIGxvY2F0aW9uLWluZGVwZW5kZW50IGF0dHJpYnV0ZXMgKG5hbWUsIHR5cGUsIGV0YykuIE90aGVyIGluc3RhbmNlcwovLyBvZiB0aGUgZnVuY3Rpb24gKGFueSBpbmxpbmVkIGNvcHkgb2YgaXQsIG9yIHRoZSBzaW5nbGUgb3V0LW9mLWxpbmUKLy8gJ2NvbmNyZXRlJyBpbnN0YW5jZSkgd2lsbCBjb250YWluIGEgcG9pbnRlciBiYWNrIHRvIHRoaXMgYWJzdHJhY3QKLy8gRElFIChhcyBhIHNwYWNlLXNhdmluZyBtZWFzdXJlLCBzbyB0aGF0IG5hbWUvdHlwZSBldGMgZG9lc24ndCBoYXZlCi8vIHRvIGJlIHJlcGVhdGVkIGZvciBlYWNoIGlubGluZWQgY29weSkuCmZ1bmMgUHV0QWJzdHJhY3RGdW5jKGN0eHQgQ29udGV4dCwgcyAqRm5TdGF0ZSkgZXJyb3IgewoJaWYgbG9nRHdhcmYgewoJCWN0eHQuTE5URElWID0gMHgyCglfRlBFX0lOVE9WRiA9IDB4MQoJX0ZQRV9GTFRESVYgPSAweDMKCV9GUEVfRkxUT1ZGID0gMHg0CglfRlBFX0ZMVFVORCA9IDB4NQoJX0ZQRV9GTFRSRVMgPSAweDYKCV9GUEVfRkxUSU5WID0gMHg3CglfRlBFX0ZMVFNVQiA9IDB4OAoKCV9CVVNfQURSQUxOID0gMHgxCglfQlVTX0FEUkVSUiA9IDB4MgoJX0JVU19PQkpFUlIgPSAweDMKCglfU0VHVl9NQVBFUlIgPSAweDEKCV9TRUdWX0FDQ0VSUiA9IDB4MgoKCV9JVElNRVJfUkVBTCAgICA9IDB4MAoJX0lUSU1FUl9WSVJUVUFMID0gMHgxCglfSVRJTUVSX1BST0YgICAgPSAweDIKCglfRVZfQUREICAgICAgID0gMHgxCglfRVZfREVMRVRFICAgID0gMHgyCglfRVZfRU5BQkxFICAgID0gMHg0CglfRVZfRElTQUJMRSAgID0gMHg4CglfRVZfQ0xFQVIgICAgID0gMHgyMAoJX0VWX1JFQ0VJUFQgICA9IDB4NDAKCV9FVl9FUlJPUiAgICAgPSAweDQwMDAKCV9FVl9FT0YgICAgICAgPSAweDgwMDAKCV9FVkZJTFRfUkVBRCAgPSAtMHgxCglfRVZGSUxUX1dSSVRFID0gLTB4MgoJX0VWRklMVF9VU0VSICA9IC0weGIKCglfTk9URV9UUklHR0VSID0gMHgxMDAwMDAwCikKCnR5cGUgcnRwcmlvIHN0cnVjdCB7CglfdHlwZSB1aW50MTYKCXByaW8gIHVpbnQxNgp9Cgp0eXBlIHRocnBhcmFtIHN0cnVjdCB7CglzdGFydF9mdW5jIHVpbnRwdHIKCWFyZyAgICAgICAgdW5zYWZlLlBvaW50ZXIKCXN0YWNrX2Jhc2UgdWludHB0cgoJc3RhY2tfc2l6ZSB1aW50cHRyCgl0bHNfYmFzZSAgIHVuc2FmZS5Qb2ludGVyCgl0bHNfc2l6ZSAgIHVpbnRwdHIKCWNoaWxkX3RpZCAgdW5zYWZlLlBvaW50ZXIgLy8gKmludDMyCglwYXJlbnRfdGlkICppbnQzMgoJZmxhZ3MgICAgICBpbnQzMgoJcnRwICAgICAgICAqcnRwcmlvCglzcGFyZSAgICAgIFszXXVpbnRwdHIKfQoKdHlwZSB0aHJlYWQgaW50MzIgLy8gbG9uZwoKdHlwZSBzaWdzZXQgc3RydWN0IHsKCV9fYml0cyBbNF11aW50MzIKfQoKdHlwZSBzdGFja3Qgc3RydWN0IHsKCXNzX3NwICAgIHVpbnRwdHIKCXNzX3NpemUgIHVpbnRwdHIKCXNzX2ZsYWdzIGludDMyCn0KCnR5cGUgc2lnaW5mbyBzdHJ1Y3QgewoJc2lfc2lnbm8gIGludDMyCglzaV9lcnJubyAgaW50MzIKCXNpX2NvZGUgICBpbnQzMgoJc2lfcGlkICAgIGludDMyCglzaV91aWQgICAgdWludDMyCglzaV9zdGF0dXMgaW50MzIKCXNpX2FkZHIgICB1aW50cHRyCglzaV92YWx1ZSAgWzRdYnl0ZQoJX3JlYXNvbiAgIFszMl1ieXRlCn0KCnR5cGUgbWNvbnRleHQgc3RydWN0IHsKCW1jX29uc3RhY2sgICAgICAgdWludDMyCgltY19ncyAgICAgICAgICAgIHVpbnQzMgoJbWNfZnMgICAgICAgICAgICB1aW50MzIKCW1jX2VzICAgICAgICAgICAgdWludDMyCgltY19kcyAgICAgICAgICAgIHVpbnQzMgoJbWNfZWRpICAgICAgICAgICB1aW50MzIKCW1jX2VzaSAgICAgICAgICAgdWludDMyCgltY19lYnAgICAgICAgICAgIHVpbnQzMgoJbWNfaXNwICAgICAgICAgICB1aW50MzIKCW1jX2VieCAgICAgICAgICAgdWludDMyCgltY19lZHggICAgICAgICAgIHVpbnQzMgoJbWNfZWN4ICAgICAgICAgICB1aW50MzIKCW1jX2VheCAgICAgICAgICAgdWludDMyCgltY190cmFwbm8gICAgICAgIHVpbnQzMgoJbWNfZXJyICAgICAgICAgICB1aW50MzIKCW1jX2VpcCAgICAgICAgICAgdWludDMyCgltY19jcyAgICAgICAgICAgIHVpbnQzMgoJbWNfZWZsYWdzICAgICAgICB1aW50MzIKCW1jX2VzcCAgICAgICAgICAgdWludDMyCgltY19zcyAgICAgICAgICAgIHVpbnQzMgoJbWNfbGVuICAgICAgICAgICB1aW50MzIKCW1jX2ZwZm9ybWF0ICAgICAgdWludDMyCgltY19vd25lZGZwICAgICAgIHVpbnQzMgoJbWNfZmxhZ3MgICAgICAgICB1aW50MzIKCW1jX2Zwc3RhdGUgICAgICAgWzEyOF11aW50MzIKCW1jX2ZzYmFzZSAgICAgICAgdWludDMyCgltY19nc2Jhc2UgICAgICAgIHVpbnQzMgoJbWNfeGZwdXN0YXRlLjEiCglpZiBidWlsZGNmZy5HT0FSQ0ggPT0gIm1pcHM2NGxlIiB7CgkJYXJjaCA9IHN5cy5BcmNoTUlQUzY0TEUKCQltdXNsID0gIi9saWIvbGQtbXVzbC1taXBzNjRlbC5zby4xIgoJfQoKCXRoZUFyY2ggOj0gbGQuQXJjaHsKCQlGdW5jYWxpZ246ICAgICAgICBmdW5jQWxpZ24sCgkJTWF4YWxpZ246ICAgICAgICAgbWF4QWxpZ24sCgkJTWluYWxpZ246ICAgICAgICAgbWluQWxpZ24sCgkJRHdhcmZyZWdzcDogICAgICAgZHdhcmZSZWdTUCwKCQlEd2FyZnJlZ2xyOiAgICAgICBkd2FyZlJlZ0xSLAoJCUFkZGR5bnJlbDogICAgICAgIGFkZGR5bnJlbCwKCQlBcmNoaW5pdDogICAgICAgICBhcmNoaW5pdCwKCQlBcmNocmVsb2M6ICAgICAgICBhcmNocmVsb2MsCgkJQXJjaHJlbG9jdmFyaWFudDogYXJjaHJlbG9jdmFyaWFudCwKCQlFeHRyZWxvYzogICAgICAgICBleHRyZWxvYywKCQlHZW50ZXh0OiAgICAgICAgICBnZW50ZXh0LAoJCU1hY2hvcmVsb2MxOiAgICAgIG1hY2hvcmVsb2MxLAoKCQlFTEY6IGxkLkVMRkFyY2h7CgkJCUxpbnV4ZHlubGQ6ICAgICAiL2xpYjY0L2xkNjQuc28uMSIsCgkJCUxpbnV4ZHlubGRNdXNsOiBtdXNsLAoJCQlGcmVlYnNkZHlubGQ6ICAgIlhYWCIsCgkJCU9wZW5ic2RkeW5sZDogICAiL3Vzci9saWJleGVjL2xkLnNvIiwKCQkJTmV0YnNkZHlubGQ6ICAgICJYWFgiLAoJCQlEcmFnb25mbHlkeW5sZDogIlhYWCIsCgkJCVNvbGFyaXNkeW5sZDogICAiWFhYIiwKCgkJCVJlbG9jMTogICAgZWxmcmVsb2MxLAoJCQlSZWxvY1NpemU6IDI0LAoJCQlTZXR1cFBMVDogIGVsZnNldHVwcGx0LAoKCQkJLy8gSGlzdG9yaWNhbGx5IEdOVSBsZCBjcmVhdGVzIGEgcmVhZC1vbmx5CgkJCS8vIC5keW5hbWljIHNlY3Rpb24uCgkJCUR5bmFtaWNSZWFkT25seTogdHJ1ZSwKCQl9LAoJfQoKCXJldHVybiBhcmNoLCB0aGVBcmNoCn0KCmZ1bmMgYXJjaGluaXQoY3R4dCAqbGQuTGluaykgewoJc3dpdGNoIGN0eHQuSGVhZFR5cGUgewoJZGVmYXVsdDoKCQlsZC5FeGl0ZigidW5rbm93biAtSCBvcHRpb246ICV2IiwgY3R4dC5IZWFkVHlwZSkKCgljYXNlIG9iamFiaS5IcGxhbjk6IC8qIHBsYW4gOSAqLwoJCWxkLkhFQURSID0gMzIKCQlpZiAqbGQuRmxhZ1JvdW5kID09IC0xIHsKCQkJKmxkLkZsYWdSb3VuZCA9IDE2ICogMTAyNAoJCX0KCQlpZiAqbGQuRmxhZ1RleHRBZGRyID09IC0xIHsKCQkJKmxkLkZsYWdUZXh0QWRkciA9IGxkLlJuZCgxNioxMDI0LCAqbGQuRmxhZ1JvdW5kKSArIGludDY0KGxkLkhFQURSKQoJCX0KCgljYXNlIG9iamFiaS5IbGludXgsIC8qIG1pcHM2NCBlbGYgKi8KCQlvYmphYmkuSG9wZW5ic2Q6CgkJbGQuRWxmaW5pdChjdHh0KQoJCWxkLkhFQURSID0gbGQuRUxGUkVTRVJWRQoJCWlmICpsZC5GbGFnUm91bmQgPT0gLTEgewoJCQkqbGQuRmxhZ1JvdW5kID0gMHgxMDAwMAoJCX0KCQlpZiAqbGQuRmxhZ1RleHRBZGRyID09IC0xIHsKCQkJKmxkLkZsYWdUZXh0QWRkciA9IGxkLlJuZCgweDEwMDAwLCAqbGQuRmxhZ1JvdW5kKSArIGludDY0KGxkLkhFQURSKQoJCX0KCX0KCglkeW5TeW1Db3VudCA9IDAKCWdvdExvY2FsQ291bnQgPSAwCglnb3RTeW1JbmRleCA9IDAKfQovLyBDb3B5cmlnaHQgMjAxMyBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gR2FyYmFnZSBjb2xsZWN0b3IgbGl2ZW5lc3MgYml0bWFwIGdlbmVyYXRpb24uCgovLyBUaGUgY29tbWFuZCBsaW5lIGZsYWcgLWxpdmUgY2F1c2VzIHRoaXMgY29kZSB0byBwcmludCBkZWJ1ZyBpbmZvcm1hdGlvbi4KLy8gVGhlIGxldmVscyBhcmU6Ci8vCi8vCS1saXZlIChha2EgLWxpdmU9MSk6IHByaW50IGxpdmVuZXNzIGxpc3RzIGFzIGNvZGUgd2FybmluZ3MgYXQgc19mYXN0MzIodHlwICphYmkuTWFwVHlwZSwgbSAqTWFwLCBrZXkgdWludDMyKSB1bnNhZmUuUG9pbnRlciB7CglpZiBtID09IG5pbCB7CgkJcGFuaWMoZXJyTmlsQXNzaWduKQoJfQoJaWYgcmFjZS5FbmFibGVkIHsKCQljYWxsZXJwYyA6PSBzeXMuR2V0Q2FsbGVyUEMoKQoJCXBjIDo9IGFiaS5GdW5jUENBQklJbnRlcm5hbChydW50aW1lX21hcGFzc2lnbl9mYXN0MzIpCgkJcmFjZS5Xcml0ZVBDKHVuc2FmZS5Qb2ludGVyKG0pLCBjYWxsZXJwYywgcGMpCgl9CglpZiBtLndyaXRpbmcgIT0gMCB7CgkJZmF0YWwoImNvbmN1cnJlbnQgbWFwIHdyaXRlcyIpCgl9CgoJayA6PSBrZXkKCWhhc2ggOj0gdHlwLkhhc2hlcihhYmkuTm9Fc2NhcGUodW5zYWZlLlBvaW50ZXIoJmspKSwgbS5zZWVkKQoKCS8vIFNldCB3cml0aW5nIGFmdGVyIGNhbGxpbmcgSGFzaGVyLCBzaW5jZSBIYXNoZXIgbWF5IHBhbmljLCBpbiB3aGljaAoJLy8gY2FzZSB3ZSBoYXZlIG5vdCBhY3R1YWxseSBkb25lIGEgd3JpdGUuCgltLndyaXRpbmcgXj0gMSAvLyB0b2dnbGUsIHNlZSBjb21tZW50IG9uIHdyaXRpbmcKCglpZiBtLmRpclB0ciA9PSBuaWwgewoJCW0uZ3Jvd1RvU21hbGwodHlwKQoJfQoKCWlmIG0uZGlyTGVuID09IDAgewoJCWlmIG0udXNlZCA8IGFiaS5NYXBHcm91cFNsb3RzIHsKCQkJZWxlbSA6PSBtLnB1dFNsb3RTbWFsbEZhc3QzMih0eXAsIGhhc2gsIGtleSkKCgkJCWlmIG0ud3JpdGluZyA9PSAwIHsKCQkJCWZhdGFsKCJjb25jdXJyZW50IG1hcCB3cml0ZXMiKQoJCQl9CgkJCW0ud3JpdGluZyBePSAxCgoJCQlyZXR1cm4gZWxlbQoJCX0KCgkJLy8gQ2FuJ3QgZml0IGFub3RoZXIgZW50cnksIGdyb3cgdG8gZnVsbCBzaXplIG1hcC4KCQltLmdyb3dUb1RhYmxlKHR5cCkKCX0KCgl2YXIgc2xvdEVsZW0gdW5zYWZlLlBvaW50ZXIKb3V0ZXI6Cglmb3IgewoJCS8vIFNlbGVjdCB0YWJsZS4KCQlpZHggOj0gbS5kaXJlY3RvcnlJbmRleChoYXNoKQoJCXQgOj0gbS5kaXJlY3RvcnlBdChpZHgpCgoJCXNlcSA6PSBtYWtlUHJvYmVTZXEoaDEoaGFzaCksIHQuZ3JvdXBzLmxlbmd0aE1hc2spCgoJCS8vIEFzIHdlIGxvb2sgZm9yIGEgbWF0Y2gsIGtlZXAgdHJhY2sgb2YgdGhlIGZpcnN0IGRlbGV0ZWQgc2xvdAoJCS8vIHdlIGZpbmQsIHdoaWNoIHdlJ2xsIHVzZSB0byBpbnNlcnQgdGhlIG5ldyBlbnRyeSBpZgoJCS8vIG5lY2Vzc2FyeS4KCQl2YXIgZmlyc3REZWxldGVkR3JvdXAgZ3JvdXBSZWZlcmVuY2UKCQl2YXIgZmlyc3REZWxldGVkU2xvdCB1aW50cHRyCgoJCWgySGFzaCA6PSBoMihoYXNoKQoJCWZvciA7IDsgc2VxID0gc2VxLm5leHQoKSB7CgkJCWcgOj0gdC5ncm91cHMuZ3JvdXAodHlwLCBzZXEub2Zmc2V0KQoJCQltYXRjaCA6PSBnLmN0cmxzKCkubWF0Y2hIMihoMkhhc2gpCgoJCQkvLyBMb29rIGZvciBhbiBleGlzdGluZyBzbG90IGNvbnRhaW5pbmcgdGhpcyBrZXkuCgkJCWZvciBtYXRjaCAhPSAwIHsKCQkJCWkgOj0gbWF0Y2guZmlyc3QoKQoKCQkJCXNsb3RLZXkgOj0gZy5rZXkodHlwLCBpKQoJCQkJaWYga2V5ID09ICooKnVpbnQzMikoc2xvdEtleSkgewoJCQkJCXNsb3RFbGVtID0gZy5lbGVtKHR5cCwgaSkKCgkJCQkJdC5jaGVja0ludmFyaWFudHModHlwLCBtKQoJCQkJCWJyZWFrIG91dGVyCgkJCQl9CgkJCQltYXRjaCA9IG1hdGNoLnJlbW92ZUZpcnN0KCkKCQkJfQoKCQkJLy8gTm8gZXhpc3Rpbmcgc2xvdCBmb3IgdGhpcyBrZXkgaW4gdGhpcyBncm91cC4gSXMgdGhpcyB0aGUgZW5kCgkJCS8vIG9mIHRoZSBwcm9iZSBzZXF1ZW5jZT8KCQkJbWF0Y2ggPSBnLmN0cmxzKCkubWF0Y2hFbXB0eU9yRGVsZXRlZCgpCgkJCWlmIG1hdGNoID09IDAgewoJCQkJY29udGludWUgLy8gbm90aGluZyBidXQgZmlsbGVkIHNsb3RzLiBLZWVwIHByb2JpbmcuCgkJCX0KCQkJaSA6PSBtYXRjaC5maXJzdCgpCgkJCWlmIGcuY3RybHMoKS5nZXQoaSkgPT0gY3RybERlbGV0ZWQgewogc2V0X3NwKHggdWludDY0KSAgIHsgYy5yZWdzKCkuc2NfcmVnc1syOV0gPSB4IH0KZnVuYyAoYyAqc2lnY3R4dCkgc2V0X2xpbmsoeCB1aW50NjQpIHsgYy5yZWdzKCkuc2NfcmVnc1szMV0gPSB4IH0KCmZ1bmMgKGMgKnNpZ2N0eHQpIHNldF9zaWdjb2RlKHggdWludDMyKSB7IGMuaW5mby5zaV9jb2RlID0gaW50MzIoeCkgfQpmdW5jIChjICpzaWdjdHh0KSBzZXRfc2lnYWRkcih4IHVpbnQ2NCkgewoJKigqdWludHB0cikoYWRkKHVuc2FmZS5Qb2ludGVyKGMuaW5mbyksIDIqZ29hcmNoLlB0clNpemUpKSA9IHVpbnRwdHIoeCkKfQovLyBDb3B5cmlnaHQgMjAyNSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy9nbzpidWlsZCB1bml4IHx8IHdpbmRvd3MKCnBhY2thZ2UgbmV0CgppbXBvcnQgKAoJImludGVybmFsL3BvbGwiCgkib3MiCgkic3lzY2FsbCIKKQoKZnVuYyBuZXdGaWxlRkQoZiAqb3MuRmlsZSkgKCpuZXRGRCwgZXJyb3IpIHsKCXMsIGVyciA6PSBkdXBGaWxlU29ja2V0KGYpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWZhbWlseSA6PSBzeXNjYWxsLkFGX1VOU1BFQwoJc290eXBlLCBlcnIgOj0gc3lzY2FsbC5HZXRzb2Nrb3B0SW50KHMsIHN5c2NhbGwuU09MX1NPQ0tFVCwgX1NPX1RZUEUpCglpZiBlcnIgIT0gbmlsIHsKCQlwb2xsLkNsb3NlRnVuYyhzKQoJCXJldHVybiBuaWwsIG9zLk5ld1N5c2NhbGxFcnJvcigiZ2V0c29ja29wdCIsIGVycikKCX0KCWxzYSwgZXJyIDo9IHN5c2NhbGwuR2V0c29ja25hbWUocykKCWlmIGVyciAhPSBuaWwgewoJCXBvbGwuQ2xvc2VGdW5jKHMpCgkJcmV0dXJuIG5pbCwgb3MuTmV3U3lzY2FsbEVycm9yKCJnZXRzb2NrbmFtZSIsIGVycikKCX0KCXJzYSwgXyA6PSBzeXNjYWxsLkdldHBlZXJuYW1lKHMpCglzd2l0Y2ggbHNhLih0eXBlKSB7CgljYXNlICpzeXNjYWxsLlNvY2thZGRySW5ldDQ6CgkJZmFtaWx5ID0gc3lzY2FsbC5BRl9JTkVUCgljYXNlICpzeXNjYWxsLlNvY2thZGRySW5ldDY6CgkJZmFtaWx5ID0gc3lzY2FsbC5BRl9JTkVUNgoJY2FzZSAqc3lzY2FsbC5Tb2NrYWRkclVuaXg6CgkJZmFtaWx5ID0gc3lzY2FsbC5BRl9VTklYCglkZWZhdWx0OgoJCXBvbGwuQ2xvc2VGdW5jKHMpCgkJcmV0dXJuIG5pbCwgc3lzY2FsbC5FUFJPVE9OT1NVUFBPUlQKCX0KCWZkLCBlcnIgOj0gbmV3RkQocywgZmFtaWx5LCBzb3R5cGUsICIiKQoJaWYgZXJyICE9IG5pbCB7CgkJcG9sbC5DbG9zZUZ1bmMocykKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWxhZGRyIDo9IGZkLmFkZHJGdW5jKCkobHNhKQoJcmFkZHIgOj0gZmQuYWRkckZ1bmMoKShyc2EpCglmZC5uZXQgPSBsYWRkci5OZXR3b3JrKCkKCWlmIGVyciA6PSBmZC5pbml0KCk7IGVyciAhPSBuaWwgewoJCWZkLkNsb3NlKCkKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWZkLnNldEFkZHIobGFkZHIsIHJhZGRyKQoJcmV0dXJuIGZkLCBuaWwKfQoKZnVuYyBmaWxlQ29ubihmICpvcy5GaWxlKSAoQ29ubiwgZXJyb3IpIHsKCWZkLCBlcnIgOj0gbmV3RmlsZUZEKGYpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCXN3aXRjaCBmZC5sYWRkci4odHlwZSkgewoJY2FzZSAqVENQQWRkcjoKCQlyZXR1cm4gbmV3VENQQ29ubihmZCwgZGVmYXVsdFRDUEtlZXBBbGl2ZUlkbGUsIEtlZXBBbGl2ZUNvbmZpZ3t9LCB0ZXN0UHJlSG9va1NldEtlZXBBbGl2ZSwgdGVzdEhvb2tTZXRLZWVwQWxpdmUpLCBuaWwKCWNhc2UgKlVEUEFkZHI6CgkJcmV0dXJuIG5ld1VEUENvbm4oZmQpLCBuaWwKCWNhc2UgKklQQWRkcjoKCQlyZXR1cm4gbmV3SVBDb25uKGZkKSwgbmlsCgljYXNlICpVbml4QWRkcjoKCQlyZXR1cm4gbmV3VW5peENvbm4ocmdzLCAiLCAiKQoJY2FzZSBCQ0NUUkw6CgkJaWYgaW50KGluc3QuQXJnc1swXS4oSW1tKSkmMjAgPT0gMjAgeyAvLyB1bmNvbmRpdGlvbmFsCgkJCXJldHVybiAiQkwgKENUUikiCgkJfQoJCXJldHVybiBvcCArICIgIiArIHN0cmluZ3MuSm9pbihhcmdzLCAiLCIpCgljYXNlIEJDQSwgQkNMLCBCQ0xBLCBCQ0xSTCwgQkNUQVIsIEJDVEFSTDoKCQlyZXR1cm4gb3AgKyAiICIgKyBzdHJpbmdzLkpvaW4oYXJncywgIiwiKQoJfQp9CgovLyBwbGFuOUFyZyBmb3JtYXRzIGFyZyAod2hpY2ggaXMgdGhlIGFyZ0luZGV4J3MgYXJnIGluIGluc3QpIGFjY29yZGluZyB0byBQbGFuIDkgcnVsZXMuCi8vCi8vIE5PVEU6IGJlY2F1c2UgUGxhbjlTeW50YXggaXMgdGhlIG9ubHkgY2FsbGVyIG9mIHRoaXMgZnVuYywgYW5kIGl0IHJlY2VpdmVzIGEgY29weQovLyBvZiBpbnN0LCBpdCdzIG9rIHRvIG1vZGlmeSBpbnN0LkFyZ3MgaGVyZS4KZnVuYyBwbGFuOUFyZyhpbnN0ICpJbnN0LCBhcmdJbmRleCBpbnQsIHBjIHVpbnQ2NCwgYXJnIEFyZywgc3ltbmFtZSBmdW5jKHVpbnQ2NCkgKHN0cmluZywgdWludDY0KSkgc3RyaW5nIHsKCS8vIHNwZWNpYWwgY2FzZXMgZm9yIGxvYWQvc3RvcmUgaW5zdHJ1Y3Rpb25zCglpZiBfLCBvayA6PSBhcmcuKE9mZnNldCk7IG9rIHsKCQlpZiBhcmdJbmRleCsxID09IGxlbihpbnN0LkFyZ3MpIHx8IGluc3QuQXJnc1thcmdJbmRleCsxXSA9PSBuaWwgewoJCQlwYW5pYyhmbXQuRXJyb3JmKCJ3cm9uZyB0YWJsZTogb2Zmc2V0IG5vdCBmb2xsb3dlZCBieSByZWdpc3RlciIpKQoJCX0KCX0KCXN3aXRjaCBhcmcgOj0gYXJnLih0eXBlKSB7CgljYXNlIFJlZzoKCQlpZiBpc0xvYWRTdG9yZU9wKGluc3QuT3ApICYmIGFyZ0luZGV4ID09IDEgJiYgYXJnID09IFIwIHsKCQkJcmV0dXJuICIwIgoJCX0KCQlpZiBhcmcgPT0gUjMwIHsKCQkJcmV0dXJuICJnIgoJCX0KCQlyZXR1cm4gc3RyaW5ncy5Ub1VwcGVyKGFyZy5TdHJpbmcoKSkKCWNhc2UgQ29uZFJlZzoKCQkvLyBUaGlzIG9wIGlzIGxlZnQgYXMgaXRzIG51bWVyaWNhbCB2YWx1ZSwgbm90IG1hcHBlZCBvbnRvIENSICsgY29uZGl0aW9uCgkJaWYgaW5zdC5PcCA9PSBJU0VMIHsKCQkJcmV0dXJuIGZtdC5TcHJpbnRmKCIkJWQiLCAoYXJnIC0gQ29uZDBMVCkpCgkJfQoJCWJpdCA6PSBbNF1zdHJpbmd7IkxUIiwgIkdUIiwgIkVRIiwgIlNPIn1bKGFyZy1Db25kMExUKSU0XQoJCWlmIGFyZyA8PSBDb25kMFNPIHsKCQkJcmV0dXJuIGJpdAoJCX0gZWxzZSBpZiBhcmcgPiBDb25kMFNPICYmIGFyZyA8PSBDb25kN1NPIHsKCQkJcmV0dXJuIGZtdC5TcHJpbnRmKCJDUiVkJXMiLCBpbnQoYXJnLUNvbmQwTFQpLzQsIGJpdCkKCQl9IGVsc2UgewoJCQlyZXR1cm4gZm10LlNwcmludGYoIkNSJWQiLCBpbnQoYXJnLUNSMCkpCgkJfQoJY2FzZSBJbW06CgkJcmV0dXJuIGZtdC5TcHJpbnRmKCIkJWQiLCBhcmcpCgljYXNlIFNwUmVnOgoJCXN3aXRjaCBhcmcgewoJCWNhc2UgODoKCQkJcmV0dXJuICJMUiIKCQljYXNlIDk6CgkJCXJldHVybiAiQ1RSIgoJCX0KCQlyZXR1cm4gZm10LlNwcmludGYoIlNQUiglZCkiLCBpbnQoYXJnKSkKCWNhc2UgUENSZWw6CgkJYWRkciA6PSBwYyArIHVpbnQ2NChpbnQ2NChhcmcpKQoJCXMsIGJhc2UgOj0gc3ltbmFtZShhZGRyKQoJCWlmIHMgIT0gIiIgJiYgYWRkciA9PSBiYXNlIHsKCQkJcmV0dXJuIGZtdC5TcHJpbnRmKCIlcyhTQikiLCBzKQoJCX0KCQlpZiBpbnN0Lk9wID09IEJMICYmIHMgIT0gIiIgJiYgKGFkZHItYmFzZSkgPT0gOCB7CgkJCS8vIFdoZW4gZGVjb2RpbmcgYW4gb2JqZWN0IGJ1aWx0IGZvciBQSUUsIGEgQ0FMTCB0YXJnZXRpbmcKCQkJLy8gYSBnbG9iYWwgZW50cnkgcG9pbnQgd2lsbCBiZSBhZGp1c3RlZCB0byB0aGUgbG9jYWwgZW50cnkKCQkJLy8gaWYgYW55LiBGb3Igbm93LCBhc3N1bWUgYW55IHN5bW5hbWUrOCBQQyBpcyBhIGxvY2FsIGNhbGwuCgkJCQoJezExNCwgIkVBTFJFQURZIiwgIm9wZXJhdGlvbiBhbHJlYWR5IGluIHByb2dyZXNzIn0sCgl7MTE1LCAiRUlOUFJPR1JFU1MiLCAib3BlcmF0aW9uIG5vdyBpbiBwcm9ncmVzcyJ9LAoJezExNiwgIkVTVEFMRSIsICJzdGFsZSBmaWxlIGhhbmRsZSJ9LAoJezExNywgIkVVQ0xFQU4iLCAic3RydWN0dXJlIG5lZWRzIGNsZWFuaW5nIn0sCgl7MTE4LCAiRU5PVE5BTSIsICJub3QgYSBYRU5JWCBuYW1lZCB0eXBlIGZpbGUifSwKCXsxMTksICJFTkFWQUlMIiwgIm5vIFhFTklYIHNlbWFwaG9yZXMgYXZhaWxhYmxlIn0sCgl7MTIwLCAiRUlTTkFNIiwgImlzIGEgbmFtZWQgdHlwZSBmaWxlIn0sCgl7MTIxLCAiRVJFTU9URUlPIiwgInJlbW90ZSBJL08gZXJyb3IifSwKCXsxMjIsICJFRFFVT1QiLCAiZGlzayBxdW90YSBleGNlZWRlZCJ9LAoJezEyMywgIkVOT01FRElVTSIsICJubyBtZWRpdW0gZm91bmQifSwKCXsxMjQsICJFTUVESVVNVFlQRSIsICJ3cm9uZyBtZWRpdW0gdHlwZSJ9LAoJezEyNSwgIkVDQU5DRUxFRCIsICJvcGVyYXRpb24gY2FuY2VsZWQifSwKCXsxMjYsICJFTk9LRVkiLCAicmVxdWlyZWQga2V5IG5vdCBhdmFpbGFibGUifSwKCXsxMjcsICJFS0VZRVhQSVJFRCIsICJrZXkgaGFzIGV4cGlyZWQifSwKCXsxMjgsICJFS0VZUkVWT0tFRCIsICJrZXkgaGFzIGJlZW4gcmV2b2tlZCJ9LAoJezEyOSwgIkVLRVlSRUpFQ1RFRCIsICJrZXkgd2FzIHJlamVjdGVkIGJ5IHNlcnZpY2UifSwKCXsxMzAsICJFT1dORVJERUFEIiwgIm93bmVyIGRpZWQifSwKCXsxMzEsICJFTk9UUkVDT1ZFUkFCTEUiLCAic3RhdGUgbm90IHJlY292ZXJhYmxlIn0sCgl7MTMyLCAiRVJGS0lMTCIsICJvcGVyYXRpb24gbm90IHBvc3NpYmxlIGR1ZSB0byBSRi1raWxsIn0sCgl7MTMzLCAiRUhXUE9JU09OIiwgIm1lbW9yeSBwYWdlIGhhcyBoYXJkd2FyZSBlcnJvciJ9LAp9CgovLyBTaWduYWwgdGFibGUKdmFyIHNpZ25hbExpc3QgPSBbLi4uXXN0cnVjdCB7CgludW0gIHN5c2NhbGwuU2lnbmFsCgluYW1lIHN0cmluZwoJZGVzYyBzdHJpbmcKfXsKCXsxLCAiU0lHSFVQIiwgImhhbmd1cCJ9LAoJezIsICJTSUdJTlQiLCAiaW50ZXJydXB0In0sCgl7MywgIlNJR1FVSVQiLCAicXVpdCJ9LAoJezQsICJTSUdJTEwiLCAiaWxsZWdhbCBpbnN0cnVjdGlvbiJ9LAoJezUsICJTSUdUUkFQIiwgInRyYWNlL2JyZWFrcG9pbnQgdHJhcCJ9LAoJezYsICJTSUdBQlJUIiwgImFib3J0ZWQifSwKCXs3LCAiU0lHQlVTIiwgImJ1cyBlcnJvciJ9LAoJezgsICJTSUdGUEUiLCAiZmxvYXRpbmcgcG9pbnQgZXhjZXB0aW9uIn0sCgl7OSwgIlNJR0tJTEwiLCAia2lsbGVkIn0sCgl7MTAsICJTSUdVU1IxIiwgInVzZXIgZGVmaW5lZCBzaWduYWwgMSJ9LAoJezExLCAiU0lHU0VHViIsICJzZWdtZW50YXRpb24gZmF1bHQifSwKCXsxMiwgIlNJR1VTUjIiLCAidXNlciBkZWZpbmVkIHNpZ25hbCAyIn0sCgl7MTMsICJTSUdQSVBFIiwgImJyb2tlbiBwaXBlIn0sCgl7MTQsICJTSUdBTFJNIiwgImFsYXJtIGNsb2NrIn0sCgl7MTUsICJTSUdURVJNIiwgInRlcm1pbmF0ZWQifSwKCXsxNiwgIlNJR1NUS0ZMVCIsICJzdGFjayBmYXVsdCJ9LAoJezE3LCAiU0lHQ0hMRCIsICJjaGlsZCBleGl0ZWQifSwKCXsxOCwgIlNJR0NPTlQiLCAiY29udGludWVkIn0sCgl7MTksICJTSUdTVE9QIiwgInN0b3BwZWQgKHNpZ25hbCkifSwKCXsyMCwgIlNJR1RTVFAiLCAic3RvcHBlZCJ9LAoJezIxLCAiU0lHVFRJTiIsICJzdG9wcGVkICh0dHkgaW5wdXQpIn0sCgl7MjIsICJTSUdUVE9VIiwgInN0b3BwZWQgKHR0eSBvdXRwdXQpIn0sCgl7MjMsICJTSUdVUkciLCAidXJnZW50IEkvTyBjb25kaXRpb24ifSwKCXsyNCwgIlNJR1hDUFUiLCAiQ1BVIHRpbWUgbGltaXQgZXhjZWVkZWQifSwKCXsyNSwgIlNJR1hGU1oiLCAiZmlsZSBzaXplIGxpbWl0IGV4Y2VlZGVkIn0sCgl7MjYsICJTSUdWVEFMUk0iLCAidmlydHVhbCB0aW1lcmhlIHJhbmdlIFswLCBvcmQoRyktMV0uIFNpbmNlIDIgKiBvcmQoRykgPiAywrLigbXigbYsIHdlIGNhbgoJLy8ganVzdCBjb25kaXRpb25hbGx5IHN1YnRyYWN0IG9yZChHKSwga2VlcGluZyB0aGUgcmVzdWx0IGlmIGl0IGRvZXNuJ3QKCS8vIHVuZGVyZmxvdy4KCXQwLCBiIDo9IGJpdHMuU3ViNjQoc1swXSwgMHhmM2I5Y2FjMmZjNjMyNTUxLCAwKQoJdDEsIGIgOj0gYml0cy5TdWI2NChzWzFdLCAweGJjZTZmYWFkYTcxNzllODQsIGIpCgl0MiwgYiA6PSBiaXRzLlN1YjY0KHNbMl0sIDB4ZmZmZmZmZmZmZmZmZmZmZiwgYikKCXQzLCBiIDo9IGJpdHMuU3ViNjQoc1szXSwgMHhmZmZmZmZmZjAwMDAwMDAwLCBiKQoJdE1hc2sgOj0gYiAtIDEgLy8gemVybyBpZiBzdWJ0cmFjdGlvbiB1bmRlcmZsb3dlZAoJc1swXSBePSAodDAgXiBzWzBdKSAmIHRNYXNrCglzWzFdIF49ICh0MSBeIHNbMV0pICYgdE1hc2sKCXNbMl0gXj0gKHQyIF4gc1syXSkgJiB0TWFzawoJc1szXSBePSAodDMgXiBzWzNdKSAmIHRNYXNrCgoJcmV0dXJuIHMsIG5pbAp9CgpmdW5jIChzICpwMjU2T3JkRWxlbWVudCkgQnl0ZXMoKSBbXWJ5dGUgewoJdmFyIG91dCBbMzJdYnl0ZQoJYnl0ZW9yZGVyLkJFUHV0VWludDY0KG91dFsyNDpdLCBzWzBdKQoJYnl0ZW9yZGVyLkJFUHV0VWludDY0KG91dFsxNjpdLCBzWzFdKQoJYnl0ZW9yZGVyLkJFUHV0VWludDY0KG91dFs4Ol0sIHNbMl0pCglieXRlb3JkZXIuQkVQdXRVaW50NjQob3V0WzpdLCBzWzNdKQoJcmV0dXJuIG91dFs6XQp9CgovLyBSc2ggcmV0dXJucyB0aGUgNjQgbGVhc3Qgc2lnbmlmaWNhbnQgYml0cyBvZiB4ID4+IG4uIG4gbXVzdCBiZSBsb3dlcgovLyB0aGFuIDI1Ni4gVGhlIHZhbHVlIG9mIG4gbGVha3MgdGhyb3VnaCB0aW1pbmcgc2lkZS1jaGFubmVscy4KZnVuYyAocyAqcDI1Nk9yZEVsZW1lbnQpIFJzaChuIGludCkgdWludDY0IHsKCWkgOj0gbiAvIDY0CgluID0gbiAlIDY0CglyZXMgOj0gc1tpXSA+PiBuCgkvLyBTaGlmdCBpbiB0aGUgbW9yZSBzaWduaWZpY2FudCBsaW1iLCBpZiBwcmVzZW50LgoJaWYgaSA6PSBpICsgMTsgaSA8IGxlbihzKSB7CgkJcmVzIHw9IHNbaV0gPDwgKDY0IC0gbikKCX0KCXJldHVybiByZXMKfQoKLy8gcDI1NlRhYmxlIGlzIGEgdGFibGUgb2YgdGhlIGZpcnN0IDE2IG11bHRpcGxlcyBvZiBhIHBvaW50LiBQb2ludHMgYXJlIHN0b3JlZAovLyBhdCBhbiBpbmRleCBvZmZzZXQgb2YgLTEgc28gWzhdUCBpcyBhdCBpbmRleCA3LCBQIGlzIGF0IDAsIGFuZCBbMTZdUCBpcyBhdCAxNS4KLy8gWzBdUCBpcyB0aGUgcG9pbnQgYXQgaW5maW5pdHkgYW5kIGl0J3Mgbm90IHN0b3JlZC4KdHlwZSBwMjU2VGFibGUgWzE2XVAyNTZQb2ludAoKLy8gU2VsZWN0IHNlbGVjdHMgdGhlIG4tdGggbXVsdGlwbGUgb2YgdGhlIHRhYmxlIGJhc2UgcG9pbnQgaW50byBwLiBJdCB3b3JrcyBpbgovLyBjb25zdGFudCB0aW1lLiBuIG11c3QgYmUgaW4gWzAsIDE2XS4gSWYgbiBpcyAwLCBwIGlzIHNldCB0byB0aGUgaWRlbnRpdHkgcG9pbnQuCmZ1bmMgKHRhYmxlICpwMjU2VGFibGUpIFNlbGVjdChwICpQMjU2UG9pbnQsIG4gdWludDgpIHsKCWlmIG4gPiAxNiB7CgkJcGFuaWMoIm5pc3RlYzogaW50ZXJuYWwgZXJyb3I6IHAyNTZUYWJsZSBjYWxsZWQgd2l0aCBvdXQtb2YtYm91bmRzIHZhbHVlIikKCX0KCXAuU2V0KE5ld1AyNTZQb2ludCgpKQoJZm9yIGkgOj0gdWludDgoMSk7IGkgPD0gMTY7IGkrKyB7CgkJY29uZCA6PSBjb25zdGFudHRpbWUuQnl0ZUVxKGksIG4pCgkJcC5TZWxlY3QoJnRhYmxlW2ktMV0sIHAsIGNvbmQpCgl9Cn0KCi8vIENvbXB1dGUgcG9wdWxhdGVzIHRoZSB0YWJsZSB0byB0aGUgZmlyc3QgMTYgbXVsdGlwbGVzIG9mIHEuCmZ1bmMgKHRhYmxlICpwMjU2VGFibGUpIENvbXB1dGUocSAqUDI1NlBvaW50KSAqcDI1NlRhYmxlIHsKCXRhYmxlWzBdLlNldChxKQoJZm9yIGkgOj0gMTsgaSA8IDE2OyBpICswIGRpZ2l0cycKCQkvLyAzNTAgZGVjaW1hbCBkaWdpdHMgZ2l2ZSB1cCB0byAxMDAwIGJpbmFyeSBkaWdpdHMuCgkJeyIwLjAzMTI1IiwgIjAuMTc2Nzc2Njk1Mjk2NjM2ODgxMTAwMjExMDkwNTI2MjEyMjU5ODIxMjA4OTg0NDIyMTE4NTA5MTQ3MDg0OTY3MjQ4ODQxNTU5ODA3NzYzMzc5ODU2Mjk4NDQxNzkwOTU1MTk2NTkxODc2NzMwNzc4ODY0MDM3MTI4MTE1NjA0NTA2OTgxMzQyMTUxNTgwNTE1MTg3MTM3NDkxOTc4OTI2NjUyODMzMjQwOTM4MTk5MDk0NDc0OTkzODEyNjQ0MDk3NzU3NTcxNDMzNzYzNjk0OTk2NDUwNzQ2Mjg0MzE2ODI0NjA3NzUxODQxMDY0Njc3MzMwMTExMTQ5ODI2MTk0MDQxMTUzODEwNTM4NTg5MjkwMTgxMzU0OTcwMzI1NDUzNDk5NDA2NDI1OTk4NzEwOTA2Njc0NTY4MjkxNDc2MTAzNzA1MDc3NTc2OTA3Mjk0MDQ5MzgxODQzMjE4NzkifSwKCQl7IjAuMTI1IiwgIjAuMzUzNTUzMzkwNTkzMjczNzYyMjAwNDIyMTgxMDUyNDI0NTE5NjQyNDE3OTY4ODQ0MjM3MDE4Mjk0MTY5OTM0NDk3NjgzMTE5NjE1NTI2NzU5NzEyNTk2ODgzNTgxOTEwMzkzMTgzNzUzNDYxNTU3NzI4MDc0MjU2MjMxMjA5MDEzOTYyNjg0MzAzMTYxMDMwMzc0Mjc0OTgzOTU3ODUzMzA1NjY2NDgxODc2Mzk4MTg4OTQ5OTg3NjI1Mjg4MTk1NTE1MTQyODY3NTI3Mzg5OTkyOTAxNDkyNTY4NjMzNjQ5MjE1NTAzNjgyMTI5MzU0NjYwMjIyMjk5NjUyMzg4MDgyMzA3NjIxMDc3MTc4NTgwMzYyNzA5OTQwNjUwOTA2OTk4ODEyODUxOTk3NDIxODEzMzQ5MTM2NTgyOTUyMjA3NDEwMTU1MTUzODE0NTg4MDk4NzYzNjg2NDM3NTcifSwKCQl7IjAuNSIsICIwLjcwNzEwNjc4MTE4NjU0NzUyNDQwMDg0NDM2MjEwNDg0OTAzOTI4NDgzNTkzNzY4ODQ3NDAzNjU4ODMzOTg2ODk5NTM2NjIzOTIzMTA1MzUxOTQyNTE5Mzc2NzE2MzgyMDc4NjM2NzUwNjkyMzExNTQ1NjE0ODUxMjQ2MjQxODAyNzkyNTM2ODYwNjMyMjA2MDc0ODU0OTk2NzkxNTcwNjYxMTMzMjk2Mzc1Mjc5NjM3Nzg5OTk3NTI1MDU3NjM5MTAzMDI4NTczNTA1NDc3OTk4NTgwMjk4NTEzNzI2NzI5ODQzMTAwNzM2NDI1ODcwOTMyMDQ0NDU5OTMwNDc3NjE2NDYxNTI0MjE1NDM1NzE2MDcyNTQxOTg4MTMwMTgxMzk5NzYyNTcwMzk5NDg0MzYyNjY5ODI3MzE2NTkwNDQxNDgyMDMxMDMwNzYyOTE3NjE5NzUyNzM3Mjg3NTE0In0sCgkJeyIyLjAiLCAiMS40MTQyMTM1NjIzNzMwOTUwNDg4MDE2ODg3MjQyMDk2OTgwNzg1Njk2NzE4NzUzNzY5NDgwNzMxNzY2Nzk3Mzc5OTA3MzI0Nzg0NjIxMDcwMzg4NTAzODc1MzQzMjc2NDE1NzI3MzUwMTM4NDYyMzA5MTIyOTcwMjQ5MjQ4MzYwNTU4NTA3MzcyMTI2NDQxMjE0OTcwOTk5MzU4MzE0MTMyMjI2NjU5Mjc1MDU1OTI3NTU3OTk5NTA1MDExNTI3ODIwNjA1NzE0NzAxMDk1NTk5NzE2MDU5NzAyNzQ1MzQ1OTY4NjIwMTQ3Mjg1MTc0MTg2NDA4ODkxOTg2MDk1NTIzMjkyMzA0ODQzMDg3MTQzMjE0NTA4Mzk3NjI2MDM2Mjc5OTUyNTE0MDc5ODk2ODcyNTMzOTY1NDYzMzE4MDg4Mjk2NDA2MjA2MTUyNTgzNTIzOTUwNTQ3NDU3NTAzIn0sCgkJeyIzLjAiLCAiMS43MzIwNTA4MDc1Njg4NzcyOTM1Mjc0NDYzNDE1MDU4NzIzNjY5NDI4MDUyNTM4MTAzODA2MjgwNTU4MDY5Nzk0NTE5MzMwMTY5MDg4MDAwMzcwODExNDYxODY3NTcyNDg1NzU2NzU2MjYxNDE0MTU0MDY3MDMwMjk5Njk5NDUwOTQ5OTg5NTI0Nzg4MTE2NTU1MTIwOTQzNzM2NDg1MjgwOTMyMzE5MDIzMDU1ODIwNjc5NzQ4MjAxMDEwODQ2NzQ5MjMyNjUwMTUzMTIzNDMyNjY5MDMzMjI4ODY2NTA2NzIyNTQ2Njg5MjE4Mzc5NzEyMjcwNDcxMzE2NjAzNjc4NjE1ODgwMTkwNDk5ODY1MzczNzk4NTkzODk0Njc2NTAzNDc1MDY1NzYwNTA3NTY2MTgzNDgxMjk2MDYxMDA5NDc2MDIxODcxOTAzMjUwODMxNDU4Mjk1MjM5NTk4In0sCgkJeyI0LjAiLCAiMi4wIn0sCgoJCXsiMXA1MTIiLCAiMXAyNTYifSwKCQl7IjRwMTAyNCIsICIycDUxMiJ9LAoJID0gNDExCglTWVNfVVRJTUVOU0FUX1RJTUU2NCAgICAgICAgICAgICA9IDQxMgoJU1lTX1BTRUxFQ1Q2X1RJTUU2NCAgICAgICAgICAgICAgPSA0MTMKCVNZU19QUE9MTF9USU1FNjQgICAgICAgICAgICAgICAgID0gNDE0CglTWVNfSU9fUEdFVEVWRU5UU19USU1FNjQgICAgICAgICA9IDQxNgoJU1lTX1JFQ1ZNTVNHX1RJTUU2NCAgICAgICAgICAgICAgPSA0MTcKCVNZU19NUV9USU1FRFNFTkRfVElNRTY0ICAgICAgICAgID0gNDE4CglTWVNfTVFfVElNRURSRUNFSVZFX1RJTUU2NCAgICAgICA9IDQxOQoJU1lTX1NFTVRJTUVET1BfVElNRTY0ICAgICAgICAgICAgPSA0MjAKCVNZU19SVF9TSUdUSU1FRFdBSVRfVElNRTY0ICAgICAgID0gNDIxCglTWVNfRlVURVhfVElNRTY0ICAgICAgICAgICAgICAgICA9IDQyMgoJU1lTX1NDSEVEX1JSX0dFVF9JTlRFUlZBTF9USU1FNjQgPSA0MjMKCVNZU19QSURGRF9TRU5EX1NJR05BTCAgICAgICAgICAgID0gNDI0CglTWVNfSU9fVVJJTkdfU0VUVVAgICAgICAgICAgICAgICA9IDQyNQoJU1lTX0lPX1VSSU5HX0VOVEVSICAgICAgICAgICAgICAgPSA0MjYKCVNZU19JT19VUklOR19SRUdJU1RFUiAgICAgICAgICAgID0gNDI3CglTWVNfT1BFTl9UUkVFICAgICAgICAgICAgICAgICAgICA9IDQyOAoJU1lTX01PVkVfTU9VTlQgICAgICAgICAgICAgICAgICAgPSA0MjkKCVNZU19GU09QRU4gICAgICAgICAgICAgICAgICAgICAgID0gNDMwCglTWVNfRlNDT05GSUcgICAgICAgICAgICAgICAgICAgICA9IDQzMQoJU1lTX0ZTTU9VTlQgICAgICAgICAgICAgICAgICAgICAgPSA0MzIKCVNZU19GU1BJQ0sgICAgICAgICAgICAgICAgICAgICAgID0gNDMzCglTWVNfUElERkRfT1BFTiAgICAgICAgICAgICAgICAgICA9IDQzNAoJU1lTX0NMT05FMyAgICAgICAgICAgICAgICAgICAgICAgPSA0MzUKCVNZU19DTE9TRV9SQU5HRSAgICAgICAgICAgICAgICAgID0gNDM2CglTWVNfT1BFTkFUMiAgICAgICAgICAgICAgICAgICAgICA9IDQzNwoJU1lTX1BJREZEX0dFVEZEICAgICAgICAgICAgICAgICAgPSA0MzgKCVNZU19GQUNDRVNTQVQyICAgICAgICAgICAgICAgICAgID0gNDM5CglTWVNfUFJPQ0VTU19NQURWSVNFICAgICAgICAgICAgICA9IDQ0MAoJU1lTX0VQT0xMX1BXQUlUMiAgICAgICAgICAgICAgICAgPSA0NDEKCVNZU19NT1VOVF9TRVRBVFRSICAgICAgICAgICAgICAgID0gNDQyCglTWVNfUVVPVEFDVExfRkQgICAgICAgICAgICAgICAgICA9IDQ0MwoJU1lTX0xBTkRMT0NLX0NSRUFURV9SVUxFU0VUICAgICAgPSA0NDQKCVNZU19MQU5ETE9DS19BRERfUlVMRSAgICAgICAgICAgID0gNDQ1CglTWVNfTEFORExPQ0tfUkVTVFJJQ1RfU0VMRiAgICAgICA9IDQ0NgoJU1lTX01FTUZEX1NFQ1JFVCAgICAgICAgICAgICAgICAgPSA0NDcKCVNZU19QUk9DRVNTX01SRUxFQVNFICAgICAgICAgICAgID0gNDQ4CglTWVNfRlVURVhfV0FJVFYgICAgICAgICAgICAgICAgICA9IDQ0OQoJU1lTX1NFVF9NRU1QT0xJQ1lfSE9NRV9OT0RFICAgICAgPSA0NTAKCVNZU19DQUNIRVNUQVQgICAgICAgICAgICAgICAgICAgID0gNDUxCglTWVNfRkNITU9EQVQyICAgICAgICAgICAgICAgICAgICA9IDQ1MgoJU1lTX01BUF9TSEFET1dfU1RBQ0sgICAgICAgICAgICAgPSA0NTMKCVNZU19GVVRFWF9XQUtFICAgICAgICAgICAgICAgICAgID0gNDU0CglTWVNfRlVURVhfV0FJVCAgICAgICAgICAgICAgICAgICA9IDQ1NQoJU1lTX0ZVVEVYX1JFUVVFVUUgICAgICAgICAgICAgICAgPSA0NTYKCVNZU19TVEFUTU9VTlQgICAgICAgICAgICAgICAgICAgID0gNDU3CglTWVNfTElTVE1PVU5UICAgICAgICAgICAgICAgICAgICA9IDQ1OAoJU1lTX0xTTV9HRVRfU0VMRl9BVFRSICAgICAgICAgICAgPSA0NTkKCVNZU19MU01fU0VUX1NFTEZfQVRUUiAgICAgICAgICAgID0gNDYwCglTWVNfTFNNX0xJU1RfTU9EVUxFUyAgICAgICAgICAgICA9IDQ2MQoJU2Nhc2UgSXNJbmYoeCwgMSk6CgkJcmV0dXJuIDAKCWNhc2UgeCA9PSAwOgoJCXJldHVybiBJbmYoLTEpCgl9CgoJaWYgeCA+PSAyIHsKCQlzLCBjIDo9IFNpbmNvcyh4KQoJCXNzIDo9IC1zIC0gYwoJCWNjIDo9IHMgLSBjCgoJCS8vIG1ha2Ugc3VyZSB4K3ggZG9lcyBub3Qgb3ZlcmZsb3cKCQlpZiB4IDwgTWF4RmxvYXQ2NC8yIHsKCQkJeiA6PSBDb3MoeCArIHgpCgkJCWlmIHMqYyA+IDAgewoJCQkJY2MgPSB6IC8gc3MKCQkJfSBlbHNlIHsKCQkJCXNzID0geiAvIGNjCgkJCX0KCQl9CgkJLy8geTEoeCkgPSBzcXJ0KDIvKHBpKngpKSoocDEoeCkqc2luKHgwKStxMSh4KSpjb3MoeDApKQoJCS8vIHdoZXJlIHgwID0geC0zcGkvNAoJCS8vICAgICBCZXR0ZXIgZm9ybXVsYToKCQkvLyAgICAgICAgIGNvcyh4MCkgPSBjb3MoeCljb3MoM3BpLzQpK3Npbih4KXNpbigzcGkvNCkKCQkvLyAgICAgICAgICAgICAgICAgPSAgMS9zcXJ0KDIpICogKHNpbih4KSAtIGNvcyh4KSkKCQkvLyAgICAgICAgIHNpbih4MCkgPSBzaW4oeCljb3MoM3BpLzQpLWNvcyh4KXNpbigzcGkvNCkKCQkvLyAgICAgICAgICAgICAgICAgPSAtMS9zcXJ0KDIpICogKGNvcyh4KSArIHNpbih4KSkKCQkvLyBUbyBhdm9pZCBjYW5jZWxsYXRpb24sIHVzZQoJCS8vICAgICBzaW4oeCkgKy0gY29zKHgpID0gLWNvcygyeCkvKHNpbih4KSAtKyBjb3MoeCkpCgkJLy8gdG8gY29tcHV0ZSB0aGUgd29yc2Ugb25lLgoKCQl2YXIgeiBmbG9hdDY0CgkJaWYgeCA+IFR3bzEyOSB7CgkJCXogPSAoMSAvIFNxcnRQaSkgKiBzcyAvIFNxcnQoeCkKCQl9IGVsc2UgewoJCQl1IDo9IHBvbmUoeCkKCQkJdiA6PSBxb25lKHgpCgkJCXogPSAoMSAvIFNxcnRQaSkgKiAodSpzcyArIHYqY2MpIC8gU3FydCh4KQoJCX0KCQlyZXR1cm4gegoJfQoJaWYgeCA8PSBUd29NNTQgeyAvLyB4IDwgMioqLTU0CgkJcmV0dXJuIC0oMiAvIFBpKSAvIHgKCX0KCXogOj0geCAqIHgKCXUgOj0gVTAwICsgeiooVTAxK3oqKFUwMit6KihVMDMreipVMDQpKSkKCXYgOj0gMSArIHoqKFYwMCt6KihWMDEreiooVjAyK3oqKFYwMyt6KlYwNCkpKSkKCXJldHVybiB4Kih1L3YpICsgKDIvUGkpKihKMSh4KSpMb2coeCktMS94KQp9CgovLyBGb3IgeCA+PSA4LCB0aGUgYXN5bXB0b3RpYyBleHBhbnNpb25zIG9mIHBvbmUgaXMKLy8gICAgICAxICsgMTUvMTI4IHMqKjIgLSA0NzI1LzIqKjE1IHMqKjQgLSAuLi4sIHdoZXJlIHMgPSAxL3guCi8vIFdlIGFwcHJveGltYXRlIHBvbmUgYnkKLy8gICAgICBwb25lKHgpID0gMSArIChSL1MpCi8vIHdoZXJlIFIgPSBwcjAgKyBwcjEqcyoqMiArIHByMipzKio0ICsgLi4uICsgcHI1KnMqKjEwCi8vICAgICAgIFMgPSAxICsgcHMwKnMqKjIgKyAuLi4gKyBwczQqcyoqMTAKLy8gYW5kCi8vICAgICAgfCBwb25lKHgpLTEtUi9TIHwgPD0gMioqKC02MC4wNikKCi8vIGZvciB4IGluIFtpbmYsIDhdPTEvWzAsMC4xMjVdCnZhciBwMVI4ID0gWzZdZmxvYXQ2NHsKCTAuMDAwMDAwMDAwMDAwMDAwMDAwMDBlKzAwLCAvLyAweDAwMDAwMDAwMDAwMDAwMDAKCTEuMTcxODc0OTk5OTk5ODg2NDc5NzBlLTAxLCAvLyAweDNGQkRGRkZGRkZGRkZDQ0UKCTEuMzIzOTQ4MDY1OTMwNzM1NzUxMjllKzAxLCAvLyAweDQwMkE3QTlEMzU3RjdGQ0UKCTQuMTIwNTE4NTQzMDczNzg1NjIyMjVlKzAyLCAvLyAweDQwNzlDMEQ0NjUyRUE1OTAKCTMuODc0NzQ1Mzg5MTM5NjA1MzIyMjdlKzAzLCAvLyAweDQwQUU0NTdEQTNBNTMyQ0MKCTcuOTE0NDc5NTQwMzE4OTE3MzE1NzRlKzAzLCAvLyAweDQwQkVFQTdBQzMyNzgyREQKfQp2YXIgcDFTOCA9IFs1XWZsb2F0NjR7CgkxLjE0MjA3MzcwMzc1Njc4NDA4NDM2ZSswMiwgLy8gMHg0MDVDOEQ0NThFNjU2Q0FDCgkzLjY1MDkzMDgzNDIwODUzNDYzMzk0ZSswMywgLy8gMHg0MEFDODVEQzk2NEQyNzRGCgkzLjY5NTYyMDYwMjY5MDMzNDYzNTU1ZSswNCwgLy8gMHg0MEUyMEI4Njk3QzVCQjdGCglpbWFsKCIzOTQwMjAwNjE5NjM5NDQ3OTIxMjI3OTA0MDEwMDE0MzYxMzgwNTA3OTczOTI3MDQ2NTQiICsKCQkJIjQ2NjY3OTQ2OTA1Mjc5NjI3NjU5Mzk5MTEzMjYzNTY5Mzk4OTU2MzA4MTUyMjk0OTEzNTU0NDMzNjUzOTQyNjQzIiksCgkJQjogYmlnRnJvbUhleCgiYjMzMTJmYTdlMjNlZTdlNDk4OGUwNTZiZTNmODJkMTkxODFkOWM2ZWZlODE0MTEyMDMxNDA4OCIgKwoJCQkiZjUwMTM4NzVhYzY1NjM5OGQ4YTJlZDE5ZDJhODVjOGVkZDNlYzJhZWYiKSwKCQlHeDogYmlnRnJvbUhleCgiYWE4N2NhMjJiZThiMDUzNzhlYjFjNzFlZjMyMGFkNzQ2ZTFkM2I2MjhiYTc5Yjk4NTlmNzQxIiArCgkJCSJlMDgyNTQyYTM4NTUwMmYyNWRiZjU1Mjk2YzNhNTQ1ZTM4NzI3NjBhYjciKSwKCQlHeTogYmlnRnJvbUhleCgiMzYxN2RlNGE5NjI2MmM2ZjVkOWU5OGJmOTI5MmRjMjlmOGY0MWRiZDI4OWExNDdjZTlkYTMxIiArCgkJCSIxM2I1ZjBiOGMwMGE2MGIxY2UxZDdlODE5ZDdhNDMxZDdjOTBlYTBlNWYiKSwKCX0KfQoKdmFyIHA1MjEgPSAmbmlzdEN1cnZlWypuaXN0ZWMuUDUyMVBvaW50XXsKCW5ld1BvaW50OiBuaXN0ZWMuTmV3UDUyMVBvaW50LAp9CgpmdW5jIGluaXRQNTIxKCkgewoJcDUyMS5wYXJhbXMgPSAmQ3VydmVQYXJhbXN7CgkJTmFtZTogICAgIlAtNTIxIiwKCQlCaXRTaXplOiA1MjEsCgkJLy8gU1AgODAwLTE4NiwgU2VjdGlvbiAzLjIuMS41CgkJUDogYmlnRnJvbURlY2ltYWwoIjY4NjQ3OTc2NjAxMzA2MDk3MTQ5ODE5MDA3OTkwODEzOTMyMTcyNjk0MzUzMDAxNDMzIiArCgkJCSIwNTQwOTM5NDQ2MzQ1OTE4NTU0MzE4MzM5NzY1NjA1MjEyMjU1OTY0MDY2MTQ1NDU1NDk3NzI5NjMxMTM5MTQ4IiArCgkJCSIwODU4MDM3MTIxOTg3OTk5NzE2NjQzODEyNTc0MDI4MjkxMTE1MDU3MTUxIiksCgkJTjogYmlnRnJvbURlY2ltYWwoIjY4NjQ3OTc2NjAxMzA2MDk3MTQ5ODE5MDA3OTkwODEzOTMyMTcyNjk0MzUzMDAxNDMzIiArCgkJCSIwNTQwOTM5NDQ2MzQ1OTE4NTU0MzE4MzM5NzY1NTM5NDI0NTA1Nzc0NjMzMzIxNzE5NzUzMjk2Mzk5NjM3MTM2IiArCgkJCSIzMzIxMTEzODY0NzY4NjEyNDQwMzgwMzQwMzcyODA4ODkyNzA3MDA1NDQ5IiksCgkJQjogYmlnRnJvbUhleCgiMDA1MTk1M2ViOTYxOGUxYzlhMWY5MjlhMjFhMGI2ODU0MGVlYTJkYTcyNWI5OWIzMTVmM2I4IiArCgkJCSJiNDg5OTE4ZWYxMDllMTU2MTkzOTUxZWM3ZTkzN2IxNjUyYzBiZDNiYjFiZjA3MzU3M2RmODgzZDJjMzRmMWVmIiArCgkJCSI0NTFmZDQ2YjUwM2YwMCIpLAoJCUd4OiBiaWdGcm9tSGV4KCIwMGM2ODU4ZTA2YjcwNDA0ZTljZDllM2VjYjY2MjM5NWI0NDI5YzY0ODEzOTA1M2ZiNTIxZjgiICsKCQkJIjI4YWY2MDZiNGQzZGJhYTE0YjVlNzdlZmU3NTkyOGZlMWRjMTI3YTJmZmE4ZGUzMzQ4YjNjMTg1NmE0MjliZjkiICsKCQkJIjdlN2UzMWMyZTViZDY2IiksCgkJR3k6IGJpZ0Zyb21IZXgoIjAxMTgzOTI5NmE3ODlhM2JjMDA0NWM4YTVmYjQyYzdkMWJkOTk4ZjU0NDQ5NTc5YjQ0NjgxNyIgKwoJCQkiYWZiZDE3MjczZTY2MmM5N2VlNzI5OTVlZjQyNjQwYzU1MGI5MDEzZmFkMDc2MTM1M2M3MDg2YTI3MmMyNDA4OCIgKwoJCQkiYmU5NDc2OWZkMTY2NTAiKSwKCX0KfQoKLy8gbmlzdEN1cnZlIGlzIGEgQ3VydmUgaW1wbGVtZW50YXRpb24gYmFzZWQgb24gYSBuaXN0ZWMgUG9pbnQuCi8vCi8vIEl0J3MgYSB3cmFwcGVyIHRoYXQgZXhwb3NlcyB0aGUgYmlnLkludC1iYXNlZCBDdXJ2ZSBpbnRlcmZhY2UgYW5kIGVuY29kZXMgdGhlCi8vIGxlZ2FjeSBpZGlvc3luY3Jhc2llcyBpdCByZXF1aXJlcywgc3VjaCBhcyBpbnZhbGlkIGFuZCBpbmZpbml0eSBwb2ludAovLyBoYW5kbGluZy4KLy8KLy8gVG8gaW50ZXJhY3Qgd2l0aCB0aGUgbmlzdGVjIHBhY2thZ2UsIHBvaW50cyBhcmUgZW5jb2RlZCBpbnRvIGFuZCBkZWNvZGVkIGZyb20KLy8gcHJvcGVybHkgZm9ybWF0dGVkIGJ5dGUgc2xpIDAsIDEsIDQsIDE3OSwgMCwgMCwgMCwgMiwKCQkxNDUsIDk2LCAwLCA0LCA4LCAxMDgsIDAsIDAsIDAsIDAsCgl9CgoJLy8gVGVzdCBEYXRhIG1ldGhvZC4KCWIsIGVyciA6PSBzZWMuRGF0YSgpCglpZiBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsKGVycikKCX0KCWlmICFieXRlcy5FcXVhbCh3YW50RGF0YSwgYikgewoJCXQuRmF0YWxmKCJ3YW50IGRhdGEgJXgsIGdvdCAleCIsIHdhbnREYXRhLCBiKQoJfQoKCS8vIFRlc3QgT3BlbiBtZXRob2QgYW5kIHNlZWtpbmcuCglidWYsIGhhdmUsIGNvdW50IDo9IG1ha2UoW11ieXRlLCBsZW4oYikpLCBtYWtlKFtdYm9vbCwgbGVuKGIpKSwgMAoJc2YgOj0gc2VjLk9wZW4oKQoJaWYgZ290LCBlcnIgOj0gc2YuU2VlaygwLCBpby5TZWVrRW5kKTsgZ290ICE9IGludDY0KGxlbihiKSkgfHwgZXJyICE9IG5pbCB7CgkJdC5GYXRhbGYoIndhbnQgc2VlayBlbmQgJWQsIGdvdCAlZCBlcnJvciAldiIsIGxlbihiKSwgZ290LCBlcnIpCgl9CglpZiBuLCBlcnIgOj0gc2YuUmVhZChidWYpOyBuICE9IDAgfHwgZXJyICE9IGlvLkVPRiB7CgkJdC5GYXRhbGYoIndhbnQgRU9GIHdpdGggMCBieXRlcywgZ290ICV2IHdpdGggJWQgYnl0ZXMiLCBlcnIsIG4pCgl9Cglwb3MgOj0gaW50NjQobGVuKGJ1ZikpCglmb3IgY291bnQgPCBsZW4oYnVmKSB7CgkJLy8gQ29uc3RydWN0IHJhbmRvbSBzZWVrIGFyZ3VtZW50cy4KCQl3aGVuY2UgOj0gcmFuZC5JbnRuKDMpCgkJdGFyZ2V0IDo9IHJhbmQuSW50NjNuKGludDY0KGxlbihidWYpKSkKCQl2YXIgb2Zmc2V0IGludDY0CgkJc3dpdGNoIHdoZW5jZSB7CgkJY2FzZSBpby5TZWVrU3RhcnQ6CgkJCW9mZnNldCA9IHRhcmdldAoJCWNhc2UgaW8uU2Vla0N1cnJlbnQ6CgkJCW9mZnNldCA9IHRhcmdldCAtIHBvcwoJCWNhc2UgaW8uU2Vla0VuZDoKCQkJb2Zmc2V0ID0gdGFyZ2V0IC0gaW50NjQobGVuKGJ1ZikpCgkJfQoJCXBvcywgZXJyID0gc2YuU2VlayhvZmZzZXQsIHdoZW5jZSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJdC5GYXRhbChlcnIpCgkJfQoJCWlmIHBvcyAhPSB0YXJnZXQgewoJCQl0LkZhdGFsZigid2FudCBwb3NpdGlvbiAlZCwgZ290ICVkIiwgdGFyZ2V0LCBwb3MpCgkJfQoKCQkvLyBSZWFkIGRhdGEgZnJvbSB0aGUgbmV3IHBvc2l0aW9uLgoJCWVuZCA6PSBwb3MgKyAxNgoJCWlmIGVuZCA+IGludDY0KGxlbihidWYpKSB7CgkJCWVuZCA9IGludDY0KGxlbihidWYpKQoJCX0KCQluLCBlcnIgOj0gaW8uUmVhZEZ1bGwoc2YsIGJ1Zltwb3M6ZW5kXSkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJdC5GYXRhbChlcnIpCgkJfQoJCWZvciBpIDo9IDA7IGkgPCBuOyBpKysgewoJCQlpZiAhaGF2ZVtwb3NdIHsKCQkJCWhhdmVbcG9zXSA9IHRydWUKCQkJCWNvdW50KysKCQkJfQoJCQlwb3MrKwoJCX0KCX0KCWlmICFieXRlcy5FcXVhbCh3YW50RGF0YSwgYnVmKSB7CgkJdC5GYXRhbGYoIndhbnQgZGF0YSAleCwgZ290ICV4Iiwgd2FudERhdGEsIGJ1ZikKCX0KfQoKZnVuYyBUZXN0Tm9TZWN0aW9uT3ZlcmxhcHModCAqdGVzdGluZy5UKSB7CgkvLyBFbnN1cmUgY21kL2xpbmsgb3V0cHV0cyBzZWN0aW9ucyB3aXRob3V0IG92ZXJsYXBzLgoJc3dpdGNoIHJ1bnRpbWUuR09PUyB7CgljYXNlICJhaXgiLCAiYW5kcm9pZCIsICJkYXJ3aW4iLCAiaW9zIiwgImpzIiwgInBsYW45IiwgIndpbmRvd3MiLCAid2FzaXAxIjoKCQl0LlNraXBmKCJjbWQvbGluayBkb2Vzbid0IHByb2R1Y2UgRUxGIGJpbmFyaWVzIG9uICVzIiwgcnVudGltZS5HT09TKQoJfQoJXyA9IG5ldC5SZXNvbHZlSVBBZGRyIC8vIGZvcmNlIGR5bmFtaWMgbGlua2FnZQoJZiwgZXJyIDo9IE9wZW4ob3MuQXJnc1swXSkKCWlmIGVyciAhPSBuaWwgewoJCXQuRXJyb3IoZXJyKQoJCXJldHVybgoJfQoJZm9yIGksIHNpIDo9IHJhbmdlIGYuU2VjdGlvbnMgewoJCXNpaCA6PSBzaS5TZWN0aW9uSGVhZGVyCgkJaWYgc2loLlR5cGUgPT0gU0hUX05PQnMsICJIVFRQMiIpCgl9CglpZiBwLlVuZW5jcnlwdGVkSFRUUDIoKSB7CgkJcyA9IGFwcGVuZChzLCAiVW5lbmNyeXB0ZWRIVFRQMiIpCgl9CglyZXR1cm4gInsiICsgc3RyaW5ncy5Kb2luKHMsICIsIikgKyAifSIKfQoKLy8gaW5jb21wYXJhYmxlIGlzIGEgemVyby13aWR0aCwgbm9uLWNvbXBhcmFibGUgdHlwZS4gQWRkaW5nIGl0IHRvIGEgc3RydWN0Ci8vIG1ha2VzIHRoYXQgc3RydWN0IGFsc28gbm9uLWNvbXBhcmFibGUsIGFuZCBnZW5lcmFsbHkgZG9lc24ndCBhZGQKLy8gYW55IHNpemUgKGFzIGxvbmcgYXMgaXQncyBmaXJzdCkuCnR5cGUgaW5jb21wYXJhYmxlIFswXWZ1bmMoKQoKLy8gbWF4SW50NjQgaXMgdGhlIGVmZmVjdGl2ZSAiaW5maW5pdGUiIHZhbHVlIGZvciB0aGUgU2VydmVyIGFuZAovLyBUcmFuc3BvcnQncyBieXRlLWxpbWl0aW5nIHJlYWRlcnMuCmNvbnN0IG1heEludDY0ID0gMTw8NjMgLSAxCgovLyBhTG9uZ1RpbWVBZ28gaXMgYSBub24temVybyB0aW1lLCBmYXIgaW4gdGhlIHBhc3QsIHVzZWQgZm9yCi8vIGltbWVkaWF0ZSBjYW5jZWxsYXRpb24gb2YgbmV0d29yayBvcGVyYXRpb25zLgp2YXIgYUxvbmdUaW1lQWdvID0gdGltZS5Vbml4KDEsIDApCgovLyBvbWl0QnVuZGxlZEhUVFAyIGlzIHNldCBieSBvbWl0aHR0cDIuZ28gd2hlbiB0aGUgbmV0aHR0cG9taXRodHRwMgovLyBidWlsZCB0YWcgaXMgc2V0LiBUaGF0IG1lYW5zIGgyX2J1bmRsZS5nbyBpc24ndCBjb21waWxlZCBpbiBhbmQgd2UKLy8gc2hvdWxkbid0IHRyeSB0byB1c2UgaXQuCnZhciBvbWl0QnVuZGxlZEhUVFAyIGJvb2wKCi8vIFRPRE8oYnJhZGZpdHopOiBtb3ZlIGNvbW1vbiBzdHVmZiBoZXJlLiBUaGUgb3RoZXIgZmlsZXMgaGF2ZSBhY2N1bXVsYXRlZAovLyBnZW5lcmljIGh0dHAgc3R1ZmYgaW4gcmFuZG9tIHBsYWNlcy4KCi8vIGNvbnRleHRLZXkgaXMgYSB2YWx1ZSBmb3IgdXNlIHdpdGggY29udGV4dC5XaXRoVmFsdWUuIEl0J3MgdXNlZCBhcwovLyBhIHBvaW50ZXIgc28gaXQgZml0cyBpbiBhbiBpbnRlcmZhY2V7fSB3aXRob3V0IGFsbG9jYXRpb24uCnR5cGUgY29udGV4dEtleSBzdHJ1Y3QgewoJbmFtZSBzdHJpbmcKfQoKZnVuYyAoayAqY29udGV4dEtleSkgU3RyaW5nKCkgc3RyaW5nIHsgcmV0dXJuICJuZXQvaHR0cCBjb250ZXh0IHZhbHVlICIgKyBrLm5hbWUgfQoKLy8gR2l2ZW4gYSBzdHJpbmcgb2YgdGhlIGZvcm0gImhvc3QiLCAiaG9zdDpwb3J0Iiwgb3IgIltpcHY2OjphZGRyZXNzXTpwb3J0IiwKLy8gcmV0dXJuIHRydWUgaWYgdGhlIHN0cmluZyBpbmNsdWRlcyBhIHBvcnQuCmZ1bmMgaGFzUG9ydChzIHN0cmluZykgYm9vbCB7IHJldHVybiBzdHJpbmdzLkxhc3RJbmRleChzLCAiOiIpID4gc3RyaW5ncy5MYXN0SW5kZXgocywgIl0iKSB9CgovLyByZW1vdmVFbXB0eVBvcnQgc3RyaXBzIHRoZSBlbXB0eSBwb3J0IGluICI6cG9ydCIgdG8gIiIKLy8gYXMgbWFuZGF0ZWQgYnkgUkZDIDM5ODYgU2VjdGlvbiA2LjIuMy4KZnVuYyByZW1vdmVFbXB0eVBvcnQoaG9zdCBzdHJpbmcpIHN0cmluZyB7CglpZiBoYXNQb3J0KGhvc3QpIHsKCQlyZXR1cm4gc3RyaW5ncy5UcmltU3VmZml4KGhvc3QsICI6IikKCX0KCXJldHVybiBob3N0Cn0KCi8vIGlzVG9rZW4gcmVwb3J0cyB3aGV0aGVyIHYgaXMgYSB2YWxpZCB0b2tlbiAoaHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzI2MTYjc2VjdGlvbi0yLjIpLgpmdW5jIGlzVG9rZW4odiBzdHJpbmcpIGJvb2wgewoJLy8gRm9yIGhpc3RvcmljYWwgcmVhc29ucywgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgVmFsaWRIZWFkZXJGaWVsZE5hbWUgKHNlZSBpc3N1ZSAjNjcwMzEpLgoJcmV0dXJuIGh0dHBndXRzLlZhbGlkSGVhZGVyRmllbGROYW1lKHYpCn0KCi8vIHN0cmluZ0NvbnRhaW5zQ1RMQnl0ZSByZXBvcnRzIHdoZXRoZXIgcyBjb250YWlucyBhbnkgQVNDSUkgY29udHJvbCBjaGFyYWN0ZXIuCmZvcm1FcnJvcihlcnIsIHN5c2NhbGwuRU5PVENPTk4pIHsKCQkJCQl0LkVycm9yZigiIyVkOiAldiIsIGksIGVycikKCQkJCX0KCQkJfQoJCQljLkNsb3NlKCkKCQl9KGkpCgl9CgoJbG4uQ2xvc2UoKQoJd2cuV2FpdCgpCn0KCi8vIElzc3VlIDE5Mjg5LgovLyBUZXN0IHRoYXQgYSBjYW5jZWxlZCBEaWFsIGRvZXMgbm90IGNhdXNlIGEgc3Vic2VxdWVudCBEaWFsIHRvIHN1Y2NlZWQuCmZ1bmMgVGVzdFRDUFNwdXJpb3VzQ29ublNldHVwQ29tcGxldGlvbldpdGhDYW5jZWwodCAqdGVzdGluZy5UKSB7CgltdXN0SGF2ZUV4dGVybmFsTmV0d29yayh0KQoKCWRlZmVyIGRuc1dhaXRHcm91cC5XYWl0KCkKCXQuUGFyYWxsZWwoKQoJY29uc3QgdHJpZXMgPSAxMDAwMAoJdmFyIHdnIHN5bmMuV2FpdEdyb3VwCgl3Zy5BZGQodHJpZXMgKiAyKQoJc2VtIDo9IG1ha2UoY2hhbiBib29sLCA1KQoJZm9yIGkgOj0gMDsgaSA8IHRyaWVzOyBpKysgewoJCXNlbSA8LSB0cnVlCgkJY3R4LCBjYW5jZWwgOj0gY29udGV4dC5XaXRoQ2FuY2VsKGNvbnRleHQuQmFja2dyb3VuZCgpKQoJCWdvIGZ1bmMoKSB7CgkJCWRlZmVyIHdnLkRvbmUoKQoJCQl0aW1lLlNsZWVwKHRpbWUuRHVyYXRpb24ocmFuZC5JbnQ2M24oaW50NjQoNSAqIHRpbWUuTWlsbGlzZWNvbmQpKSkpCgkJCWNhbmNlbCgpCgkJfSgpCgkJZ28gZnVuYyhpIGludCkgewoJCQlkZWZlciB3Zy5Eb25lKCkKCQkJdmFyIGRpYWxlciBEaWFsZXIKCQkJLy8gVHJ5IHRvIGNvbm5lY3QgdG8gYSByZWFsIGhvc3Qgb24gYSBwb3J0CgkJCS8vIHRoYXQgaXQgaXMgbm90IGxpc3RlbmluZyBvbi4KCQkJXywgZXJyIDo9IGRpYWxlci5EaWFsQ29udGV4dChjdHgsICJ0Y3AiLCAiZ29sYW5nLm9yZzozIikKCQkJaWYgZXJyID09IG5pbCB7CgkJCQl0LkVycm9yZigiRGlhbCB0byB1bmJvdW5kIHBvcnQgc3VjY2VlZGVkIG9uIGF0dGVtcHQgJWQiLCBpKQoJCQl9CgkJCTwtc2VtCgkJfShpKQoJfQoJd2cuV2FpdCgpCn0KLy8gQ29weXJpZ2h0IDIwMTcgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCnBhY2thZ2UgdHJhY2VfdGVzdAoKaW1wb3J0ICgKCSJpbnRlcm5hbC90cmFjZSIKCSJpbnRlcm5hbC90cmFjZS90ZXN0dHJhY2UiCgkiaW8iCgkibWF0aCIKCSJ0ZXN0aW5nIgoJInRpbWUiCikKCi8vIGFlcSByZXR1cm5zIHRydWUgaWYgeCBhbmQgeSBhcmUgZXF1YWwgdXAgdG8gOCBkaWdpdHMgKDEgcGFydCBpbiAxMDAKLy8gbWlsbGlvbikuCmZ1bmMgYWVxKHgsIHkgZmxvYXQ2NCkgYm9vbCB7CglpZiB4IDwgMCAmJiB5IDwgMCB7CgkJeCwgeSA9IC14LCAteQoJfQoJY29uc3QgZGlnaXRzID0gOAoJZmFjdG9yIDo9IDEgLSBtYXRoLlBvdygxMCwgLWRpZ2l0cysxKQoJcmV0dXJuIHgqZmFjdG9yIDw9IHkgJiYgeSpmYWN0b3IgPD0geAp9CgpmdW5jIFRlc3RNTVUodCAqdGVzdGluZy5UKSB7Cgl0LlBhcmFsbGVsKCkKCgkvLyBNVQoJLy8gMS4wICAqKioqKiAgICoqKioqICAgKioqKioKCS8vIDAuNSAgICAgICogICAqICAgKiAgICoKCS8vIDAuMCAgICAgICoqKioqICAgKioqKioKCS8vICAgICAgMCAgIDEgICAyICAgMyAgIDQgICA1Cgl1dGlsIDo9IFtdW110cmFjZS5NdXRhdG9yVXRpbHt7CgkJezBlOSwgMX0sCgkJezFlOSwgMH0sCgkJezJlOSwgMX0sCgkJezNlOSwgMH0sCgkJezRlOSwgMX0sCgkJezVlOSwgMH0sCgl9fQoJbW11Q3VydmUgOj0gdHJhY2UuTmV3TU1VQ3VydmUodXRpbCkKCglmb3IgXywgdGVzdCA6PSByYW5nZSBbXXN0cnVjdCB7CgkJd2luZG93IHRpbWUuRHVyYXRpb24KCQl3YW50ICAgZmxvYXQ2NAoJCXdvcnN0ICBbXWZsb2F0NjQKCX17CgkJezAsIDAsIFtdZmxvYXQ2NHt9fSwKCQl7dGltZS5NaWxsaXNlY29uZCwgMCwgID0gYWRkTXVsKHIsIGEsIGIpCglpZiByLmxvICE9IDE2ODg4NDk4OTkwNjEzMDM1IHx8IHIuaGkgIT0gNjQwIHsKCQl0LkVycm9yZigid3JvbmcgYW5zd2VyOiAlZCArICVkKigyKio2NCkiLCByLmxvLCByLmhpKQoJfQp9CgpmdW5jIFRlc3RTZXRCeXRlc1JvdW5kVHJpcCh0ICp0ZXN0aW5nLlQpIHsKCWYxIDo9IGZ1bmMoaW4gWzMyXWJ5dGUsIGZlIEVsZW1lbnQpIGJvb2wgewoJCWZlLlNldEJ5dGVzKGluWzpdKQoKCQkvLyBNYXNrIHRoZSBtb3N0IHNpZ25pZmljYW50IGJpdCBhcyBpdCdzIGlnbm9yZWQgYnkgU2V0Qnl0ZXMuIChOb3cKCQkvLyBpbnN0ZWFkIG9mIGVhcmxpZXIgc28gd2UgY2hlY2sgdGhlIG1hc2tpbmcgaW4gU2V0Qnl0ZXMgaXMgd29ya2luZy4pCgkJaW5bbGVuKGluKS0xXSAmPSAoMSA8PCA3KSAtIDEKCgkJcmV0dXJuIGJ5dGVzLkVxdWFsKGluWzpdLCBmZS5CeXRlcygpKSAmJiBpc0luQm91bmRzKCZmZSkKCX0KCWlmIGVyciA6PSBxdWljay5DaGVjayhmMSwgbmlsKTsgZXJyICE9IG5pbCB7CgkJdC5FcnJvcmYoImZhaWxlZCBieXRlcy0+RkUtPmJ5dGVzIHJvdW5kLXRyaXA6ICV2IiwgZXJyKQoJfQoKCWYyIDo9IGZ1bmMoZmUsIHIgRWxlbWVudCkgYm9vbCB7CgkJci5TZXRCeXRlcyhmZS5CeXRlcygpKQoKCQkvLyBJbnRlbnRpb25hbGx5IG5vdCB1c2luZyBFcXVhbCBub3QgdG8gZ28gdGhyb3VnaCBCeXRlcyBhZ2Fpbi4KCQkvLyBDYWxsaW5nIHJlZHVjZSBiZWNhdXNlIGJvdGggR2VuZXJhdGUgYW5kIFNldEJ5dGVzIGNhbiBwcm9kdWNlCgkJLy8gbm9uLWNhbm9uaWNhbCByZXByZXNlbnRhdGlvbnMuCgkJZmUucmVkdWNlKCkKCQlyLnJlZHVjZSgpCgkJcmV0dXJuIGZlID09IHIKCX0KCWlmIGVyciA6PSBxdWljay5DaGVjayhmMiwgbmlsKTsgZXJyICE9IG5pbCB7CgkJdC5FcnJvcmYoImZhaWxlZCBGRS0+Ynl0ZXMtPkZFIHJvdW5kLXRyaXA6ICV2IiwgZXJyKQoJfQoKCS8vIENoZWNrIHNvbWUgZml4ZWQgdmVjdG9ycyBmcm9tIGRhbGVrCgl0eXBlIGZlUlRUZXN0IHN0cnVjdCB7CgkJZmUgRWxlbWVudAoJCWIgIFtdYnl0ZQoJfQoJdmFyIHRlc3RzID0gW11mZVJUVGVzdHsKCQl7CgkJCWZlOiBFbGVtZW50ezM1ODc0NDc0ODA1MjgxMCwgMTY5MTU4NDYxODI0MDk4MCwgOTc3NjUwMjA5Mjg1MzYxLCAxNDI5ODY1OTEyNjM3NzI0LCA1NjAwNDQ4NDQyNzg2NzZ9LAoJCQliOiAgW11ieXRlezc0LCAyMDksIDY5LCAxOTcsIDcwLCA3MCwgMTYxLCAyMjIsIDU2LCAyMjYsIDIyOSwgMTksIDExMiwgNjAsIDI1LCA5MiwgMTg3LCA3NCwgMjIyLCA1NiwgNTAsIDE1MywgNTEsIDIzMywgNDAsIDc0LCA1NywgNiwgMTYwLCAxODUsIDIxMywgMzF9LAoJCX0sCgkJewoJCQlmZTogRWxlbWVudHs4NDkyNjI3NDM0NDkwMywgNDczNjIwNjY2NTk5OTMxLCAzNjU1OTA0Mzg4NDU1MDQsIDEwMjg0NzAyODY4ODI0MjksIDIxNDY0OTkxODAzMzA5NzJ9LAoJCQliOiAgW11ieXRlezE5OSwgMjMsIDEwNiwgMTEyLCA2MSwgNzcsIDIxNiwgNzksIDE4NiwgNjAsIDExLCAxMTgsIDEzLCAxNiwgMTAzLCAxNSwgNDIsIDMyLCA4MywgMjUwLCA0NCwgNTcsIDIwNCwgMTk4LCA3OCwgMTk5LCAyNTMsIDExOSwgMTQ2LCAxNzIsIDMsIDEyMn0sCgkJfSwKCX0KCglmb3IgXywgdHQgOj0gcmFuZ2UgdGVzdHMgewoJCWIgOj0gdHQuZmUuQnl0ZXMoKQoJCWZlLCBfIDo9IG5ldyhFbGVtZW50KS5TZXRCeXRlcyh0dC5iKQoJCWlmICFieXRlcy5FcXVhbChiLCB0dC5iKSB8fCBmZS5FcXVhbCgmdHQuZmUpICE9IDEgewoJCQl0LkVycm9yZigiRmFpbGVkIGZpeGVkIHJvdW5kdHJpcDogJXYiLCB0dCkKCQl9Cgl9Cn0KCmZ1bmMgc3dhcEVuZGlhbm5lc3MoYnVmIFtdYnl0ZSkgW11ieXRlIHsKCWZvciBpIDo9IDA7IGkgPCBsZW4oYnVmKS8yOyBpKysgewoJCWJ1ZltpXSwgYnVmW2xlbihidWYpLWktMV0gPSBidWZbbGVuKGJ1ZiktaS0xXSwgYnVmW2ldCgl9CglyZXR1cm4gYnVmCn0KCmhvdXQgZm9sbG93aW5nIGxpbmtzCgkvLyBieSBqdXN0IGNhbGxpbmcgImZpLCBlcnIgOj0gb3MuTHN0YXQobmFtZSk7IGVyciA9PSBuaWwgJiYgZmkuSXNEaXIoKSIuCgkvLyBOb3RlIHRoYXQgUE9TSVggb25seSBkZWZpbmVzIHRoZSBzZW1hbnRpY3MgZm9yIHN5bWxpbmtzLCBub3QgZm9yCgkvLyBtb3VudCBwb2ludHMgb3Igb3RoZXIgc3Vycm9nYXRlIHJlcGFyc2UgcG9pbnRzLCBidXQgd2UgdHJlYXQgdGhlbQoJLy8gdGhlIHNhbWUgd2F5IGZvciBjb25zaXN0ZW5jeS4gQWxzbywgbW91bnQgcG9pbnRzIGNhbiBjb250YWluIGluZmluaXRlCgkvLyBsb29wcywgc28gaXQgaXMgbm90IHNhZmUgdG8gd2FsayB0aGVtIHdpdGhvdXQgc3BlY2lhbCBoYW5kbGluZy4KCWlmICFmcy5pc1JlcGFyc2VUYWdOYW1lU3Vycm9nYXRlKCkgewoJCWlmIGZzLkZpbGVBdHRyaWJ1dGVzJnN5c2NhbGwuRklMRV9BVFRSSUJVVEVfRElSRUNUT1JZICE9IDAgewoJCQltIHw9IE1vZGVEaXIgfCAwMTExCgkJfQoKCQlzd2l0Y2ggZnMuZmlsZXR5cGUgewoJCWNhc2Ugc3lzY2FsbC5GSUxFX1RZUEVfUElQRToKCQkJbSB8PSBNb2RlTmFtZWRQaXBlCgkJY2FzZSBzeXNjYWxsLkZJTEVfVFlQRV9DSEFSOgoJCQltIHw9IE1vZGVEZXZpY2UgfCBNb2RlQ2hhckRldmljZQoJCX0KCX0KCglpZiBmcy5GaWxlQXR0cmlidXRlcyZzeXNjYWxsLkZJTEVfQVRUUklCVVRFX1JFUEFSU0VfUE9JTlQgIT0gMCB7CgkJc3dpdGNoIGZzLlJlcGFyc2VUYWcgewoJCWNhc2Ugc3lzY2FsbC5JT19SRVBBUlNFX1RBR19TWU1MSU5LOgoJCQltIHw9IE1vZGVTeW1saW5rCgkJY2FzZSB3aW5kb3dzLklPX1JFUEFSU0VfVEFHX0FGX1VOSVg6CgkJCW0gfD0gTW9kZVNvY2tldAoJCWNhc2Ugd2luZG93cy5JT19SRVBBUlNFX1RBR19ERURVUDoKCQkJLy8gSWYgdGhlIERhdGEgRGVkdXBsaWNhdGlvbiBzZXJ2aWNlIGlzIGVuYWJsZWQgb24gV2luZG93cyBTZXJ2ZXIsIGl0cwoJCQkvLyBPcHRpbWl6YXRpb24gam9iIG1heSBjb252ZXJ0IHJlZ3VsYXIgZmlsZXMgdG8gSU9fUkVQQVJTRV9UQUdfREVEVVAKCQkJLy8gd2hlbmV2ZXIgdGhhdCBqb2IgcnVucy4KCQkJLy8KCQkJLy8gSG93ZXZlciwgREVEVVAgcmVwYXJzZSBwb2ludHMgcmVtYWluIHNpbWlsYXIgaW4gbW9zdCByZXNwZWN0cyB0bwoJCQkvLyByZWd1bGFyIGZpbGVzOiB0aGV5IGNvbnRpbnVlIHRvIHN1cHBvcnQgcmFuZG9tLWFjY2VzcyByZWFkcyBhbmQgd3JpdGVzCgkJCS8vIG9mIHBlcnNpc3RlbnQgZGF0YSwgYW5kIHRoZXkgc2hvdWxkbid0IGFkZCB1bmV4cGVjdGVkIGxhdGVuY3kgb3IKCQkJLy8gdW5hdmFpbGFiaWxpdHkgaW4gdGhlIHdheSB0aGF0IGEgbmV0d29yayBmaWxlc3lzdGVtIG1pZ2h0LgoJCQkvLwoJCQkvLyBHbyBwcm9ncmFtcyBtYXkgdXNlIE1vZGVJcnJlZ3VsYXIgdG8gZmlsdGVyIG91dCB1bnVzdWFsIGZpbGVzIChzdWNoIGFzCgkJCS8vIHJhdyBkZXZpY2UgZmlsZXMgb24gTGludXgsIFBPU0lYIEZJRk8gc3BlY2lhbCBmaWxlcywgYW5kIHNvIG9uKSwgc28KCQkJLy8gdG8gYXZvaWQgZmlsZXMgY2hhbmdpbmcgdW5wcmVkaWN0YWJseSBmcm9tIHJlZ3VsYXIgdG8gaXJyZWd1bGFyIHdlIHdpbGwKCQkJLy8gY29uc2lkZXIgREVEVVAgZmlsZXMgdG8gYmUgY2xvc2UgZW5vdWdoIHRvIHJlZ3VsYXIgdG8gdHJlYXQgYXMgc3VjaC4KCQlkZWZhdWx0OgoJCQltIHw9IE1vZGVJcnJlZ3VsYXIKCQl9Cgl9CglyZXR1cm4KfQoKLy8gbW9kZVByZUdvMV8yMyByZXR1cm5zIHRoZSBGaWxlTW9kZSBmb3IgdGhlIGZpbGVTdGF0LCB1c2luZyB0aGUgcHJlLUdvIDEuMjMKLy8gbG9naWMgZm9yIGRldGVybWluaW5nIHRoZSBmaWxlIG1vZGUuCi8vIFRoZSBsb2dpYyBpcyBzdWJ0bGUgYW5kIG5vdCB3ZWxsLWRvY3VtZW50ZWQsIHNvIGl0IGlzIGJldHRlciB0byBrZWVwIGl0Ci8vIHNlcGFyYXRlIGZyb20gdGhlIG5ldyBsb2dpYy4KZnVuYyAoZnMgKmZpbD0gMHg0ZAoJSUZUX0xBUEYgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg3NwoJSUZUX0xJTkVHUk9VUCAgICAgICAgICAgICAgICAgICAgID0gMHhkMgoJSUZUX0xPQ0FMVEFMSyAgICAgICAgICAgICAgICAgICAgID0gMHgyYQoJSUZUX0xPT1AgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxOAoJSUZUX01FRElBTUFJTE9WRVJJUCAgICAgICAgICAgICAgID0gMHg4YgoJSUZUX01GU0lHTElOSyAgICAgICAgICAgICAgICAgICAgID0gMHhhNwoJSUZUX01JT1gyNSAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyNgoJSUZUX01PREVNICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzMAoJSUZUX01QQyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg3MQoJSUZUX01QTFMgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhhNgoJSUZUX01QTFNUVU5ORUwgICAgICAgICAgICAgICAgICAgID0gMHg5NgoJSUZUX01TRFNMICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4ZgoJSUZUX01WTCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhiZgoJSUZUX01ZUklORVQgICAgICAgICAgICAgICAgICAgICAgID0gMHg2MwoJSUZUX05GQVMgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhhZgoJSUZUX05TSVAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxYgoJSUZUX09QVElDQUxDSEFOTkVMICAgICAgICAgICAgICAgID0gMHhjMwoJSUZUX09QVElDQUxUUkFOU1BPUlQgICAgICAgICAgICAgID0gMHhjNAoJSUZUX09USEVSICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxCglJRlRfUDEwICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGMKCUlGVF9QODAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZAoJSUZUX1BBUkEgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMgoJSUZUX1BGTE9HICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmNQoJSUZUX1BGU1lOQyAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmNgoJSUZUX1BMQyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhhZQoJSUZUX1BPTjE1NSAgICAgICAgICAgICAgICAgICAgICAgID0gMHhjZgoJSUZUX1BPTjYyMiAgICAgICAgICAgICAgICAgICAgICAgID0gMHhkMAoJSUZUX1BPUyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhhYgoJSUZUX1BQUCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxNwoJSUZUX1BQUE1VTFRJTElOS0JVTkRMRSAgICAgICAgICAgID0gMHg2YwoJSUZUX1BST1BBVE0gICAgICAgICAgICAgICAgICAgICAgID0gMHhjNQoJSUZUX1BST1BCV0FQMk1QICAgICAgICAgICAgICAgICAgID0gMHhiOAoJSUZUX1BST1BDTkxTICAgICAgICAgICAgICAgICAgICAgID0gMHg1OQoJSUZUX1BST1BET0NTV0lSRUxFU1NET1dOU1RSRUFNICAgID0gMHhiNQoJSUZUX1BST1BET0NTV0lSRUxFU1NNQUNMQVlFUiAgICAgID0gMHhiNAoJSUZUX1BST1BET0NTV0lSRUxFU1NVUFNUUkVBTSAgICAgID0gMHhiNgoJSUZUX1BST1BNVVggICAgICAgICAgICAgICAgICAgICAgID0gMHgzNgoJSUZUX1BST1BWSVJUVUFMICAgICAgICAgICAgICAgICAgID0gMHgzNQoJSUZUX1BST1BXSVJFTEVTU1AyUCAgICAgICAgICAgICAgID0gMHg5ZAoJSUZUX1BUUFNFUklBTCAgICAgICAgICAgICAgICAgICAgID0gMHgxNgoJSUZUX1BWQyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmMQoJSUZUX1EyOTMxICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhjOQoJSUZUX1FMTEMgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0NAoJSUZUX1JBRElPTUFDICAgICAgICAgICAgICAgICAgICAgID0gMHhiYwoJSUZUX1JBRFNMICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1ZgoJSUZUX1JFQUNIRFNMICAgICAgICAgICAgICAgICAgICAgID0gMHhjMAoJSUZUX1JGQzE0ODMgICAgICAgYSA9IFQxICsgVDIKLy8gfQovLwovLyBIMCA9IGEgKyBIMAovLyBIMSA9IGIgKyBIMQovLyBIMiA9IGMgKyBIMgovLyBIMyA9IGQgKyBIMwovLyBINCA9IGUgKyBINAovLyBINSA9IGYgKyBINQovLyBINiA9IGcgKyBINgovLyBINyA9IGggKyBINwoKY29uc3QgVGhhdFBlc2t5VW5pY29kZURvdCA9ICJcdTAwYjciCgp2YXIgX0sgPSBbXXVpbnQ2NHsKCTB4NDI4YTJmOThkNzI4YWUyMiwKCTB4NzEzNzQ0OTEyM2VmNjVjZCwKCTB4YjVjMGZiY2ZlYzRkM2IyZiwKCTB4ZTliNWRiYTU4MTg5ZGJiYywKCTB4Mzk1NmMyNWJmMzQ4YjUzOCwKCTB4NTlmMTExZjFiNjA1ZDAxOSwKCTB4OTIzZjgyYTRhZjE5NGY5YiwKCTB4YWIxYzVlZDVkYTZkODExOCwKCTB4ZDgwN2FhOThhMzAzMDI0MiwKCTB4MTI4MzViMDE0NTcwNmZiZSwKCTB4MjQzMTg1YmU0ZWU0YjI4YywKCTB4NTUwYzdkYzNkNWZmYjRlMiwKCTB4NzJiZTVkNzRmMjdiODk2ZiwKCTB4ODBkZWIxZmUzYjE2OTZiMSwKCTB4OWJkYzA2YTcyNWM3MTIzNSwKCTB4YzE5YmYxNzRjZjY5MjY5NCwKCTB4ZTQ5YjY5YzE5ZWYxNGFkMiwKCTB4ZWZiZTQ3ODYzODRmMjVlMywKCTB4MGZjMTlkYzY4YjhjZDViNSwKCTB4MjQwY2ExY2M3N2FjOWM2NSwKCTB4MmRlOTJjNmY1OTJiMDI3NSwKCTB4NGE3NDg0YWE2ZWE2ZTQ4MywKCTB4NWNiMGE5ZGNiZDQxZmJkNCwKCTB4NzZmOTg4ZGE4MzExNTNiNSwKCTB4OTgzZTUxNTJlZTY2ZGZhYiwKCTB4YTgzMWM2NmQyZGI0MzIxMCwKCTB4YjAwMzI3Yzg5OGZiMjEzZiwKCTB4YmY1OTdmYzdiZWVmMGVlNCwKCTB4YzZlMDBiZjMzZGE4OGZjMiwKCTB4ZDVhNzkxNDc5MzBhYTcyNSwKCTB4MDZjYTYzNTFlMDAzODI2ZiwKCTB4MTQyOTI5NjcwYTBlNmU3MCwKCTB4MjdiNzBhODU0NmQyMmZmYywKCTB4MmUxYjIxMzg1YzI2YzkyNiwKCTB4NGQyYzZkZmM1YWM0MmFlZCwKCTB4NTMzODBkMTM5ZDk1YjNkZiwKCTB4NjUwYTczNTQ4YmFmNjNkZSwKCTB4NzY2YTBhYmIzYzc3YjJhOCwKCTB4ODFjMmM5MmU0N2VkYWVlNiwKCTB4OTI3MjJjODUxNDgyMzUzYiwKCTB4YTJiZmU4YTE0Y2YxMDM2NCwKCTB4YTgxYTY2NGJiYzQyMzAwMSwKCTB4YzI0YjhiNzBkMGY4OTc5MSwKCTB4Yzc2YzUxYTMwNjU0YmUzMCwKCTB4ZDE5MmU4MTlkNmVmNTIxOCwKCTB4ZDY5OTA2MjQ1NTY1YTkxMCwKCTB4ZjQwZTM1ODU1NzcxMjAyYSwKCTB4MTA2YWEwNzAzMmJiZDFiOCwKCTB4MTlhNGMxMTZiOGQyZDBjOCwKCTB4MWUzNzZjMDg1MTQxYWI1MywKCTB4Mjc0ODc3NGNkZjhlZWI5OSwKCTB4MzRiMGJjYjVlMTliNDhhOCwKCTB4MzkxYzBjYjNjNWM5NWE2MywKCTB4NGVkOGFhNGFlMzQxOGFjYiwKCTB4NWI5Y2NhNGY3NzYzZTM3MywKCTB4NjgyZTZmZjNkNmIyYjhhMywKCTB4NzQ4ZjgyZWU1ZGVmYjJmYywKCTB4NzhhNTYzNmY0MzE3MmY2MCwKCTB4ODRjODc4MTRhMWYwYWI3MiwKCTB4OGNjNzAyMDgxYTY0MzllYywKCTB4OTBiZWZmZmEyMzYzMWUyOCwKCTB4YTQ1MDZjZWJkZTgyYmRlOSwKCTB4YmVmOWEzZjdiMmM2NzkxNSwKCTB4YzY3MTc4ZjJlMzcyNTMyYiwKCTB4Y2EyNzNlY2VlYTI2NjE5YywKCTB4ZDE4NmI4YzcyMWMwYzIwNywKCTB4ZWFkYTdkZDZjZGUwZWIxZSwKCTB4ZjU3ZDRmN2ZlZTZlZDE3OCwKCTB4MDZmMDY3YWE3MjE3NmZiYSwKCTB4MGE2MzdkYzVhMmM4OThhNiwKCTB4MTEzZjk4MDRiZWY5MGRhZSwKCTB4MWI3MTBiMzUxMzFjNDcxYiwKCTB4MjhkYjc3ZjUyMzA0N2Q4NCwKCTB4MzJjYWFiN2I0MGM3MjQ5MywKCTB4M2M5ZWJlMGExNWM5YmViYywKCTB4NDMxZDY3YzQ5YzEwMGQ0YywKCTB4NGNjNWQ0YmVjYjNlNDJiNiwKCTB4NTk3ZjI5OWNmYzY1N2UyYSwKCTB4NWZjYjZmYWIzYWQ2ZmFlYywKCTB4NmM0NDE5OGM0YTQ3NTgxNywKfQoKZnVuYyBtYWluKCkgewoJLy8gaHR0cHM6Ly9naXRodWIuY29tL21tY2xvdWdobGluL2F2by9pc3N1ZXMvNDUwCglvcy5TZXRlbnYoIkdPT1MiLCAibD0gMHg2MDA3CglFVEhFUlRZUEVfU0VDVFJBICAgICAgICAgICAgICAgICAgPSAweDg2ZGIKCUVUSEVSVFlQRV9TRUNVUkVEQVRBICAgICAgICAgICAgICA9IDB4ODc2ZAoJRVRIRVJUWVBFX1NHSVRXICAgICAgICAgICAgICAgICAgID0gMHg4MTdlCglFVEhFUlRZUEVfU0dfQk9VTkNFICAgICAgICAgICAgICAgPSAweDgwMTYKCUVUSEVSVFlQRV9TR19ESUFHICAgICAgICAgICAgICAgICA9IDB4ODAxMwoJRVRIRVJUWVBFX1NHX05FVEdBTUVTICAgICAgICAgICAgID0gMHg4MDE0CglFVEhFUlRZUEVfU0dfUkVTViAgICAgICAgICAgICAgICAgPSAweDgwMTUKCUVUSEVSVFlQRV9TSU1ORVQgICAgICAgICAgICAgICAgICA9IDB4NTIwOAoJRVRIRVJUWVBFX1NMT1dQUk9UT0NPTFMgICAgICAgICAgID0gMHg4ODA5CglFVEhFUlRZUEVfU05BICAgICAgICAgICAgICAgICAgICAgPSAweDgwZDUKCUVUSEVSVFlQRV9TTk1QICAgICAgICAgICAgICAgICAgICA9IDB4ODE0YwoJRVRIRVJUWVBFX1NPTklYICAgICAgICAgICAgICAgICAgID0gMHhmYWY1CglFVEhFUlRZUEVfU1BJREVSICAgICAgICAgICAgICAgICAgPSAweDgwOWYKCUVUSEVSVFlQRV9TUFJJVEUgICAgICAgICAgICAgICAgICA9IDB4NTAwCglFVEhFUlRZUEVfU1RQICAgICAgICAgICAgICAgICAgICAgPSAweDgxODEKCUVUSEVSVFlQRV9UQUxBUklTICAgICAgICAgICAgICAgICA9IDB4ODEyYgoJRVRIRVJUWVBFX1RBTEFSSVNNQyAgICAgICAgICAgICAgID0gMHg4NTJiCglFVEhFUlRZUEVfVENQQ09NUCAgICAgICAgICAgICAgICAgPSAweDg3NmIKCUVUSEVSVFlQRV9UQ1BTTSAgICAgICAgICAgICAgICAgICA9IDB4OTAwMgoJRVRIRVJUWVBFX1RFQyAgICAgICAgICAgICAgICAgICAgID0gMHg4MTRmCglFVEhFUlRZUEVfVElHQU4gICAgICAgICAgICAgICAgICAgPSAweDgwMmYKCUVUSEVSVFlQRV9UUkFJTCAgICAgICAgICAgICAgICAgICA9IDB4MTAwMAoJRVRIRVJUWVBFX1RSQU5TRVRIRVIgICAgICAgICAgICAgID0gMHg2NTU4CglFVEhFUlRZUEVfVFlNU0hBUkUgICAgICAgICAgICAgICAgPSAweDgwMmUKCUVUSEVSVFlQRV9VQkJTVCAgICAgICAgICAgICAgICAgICA9IDB4NzAwNQoJRVRIRVJUWVBFX1VCREVCVUcgICAgICAgICAgICAgICAgID0gMHg5MDAKCUVUSEVSVFlQRV9VQkRJQUdMT09QICAgICAgICAgICAgICA9IDB4NzAwMgoJRVRIRVJUWVBFX1VCREwgICAgICAgICAgICAgICAgICAgID0gMHg3MDAwCglFVEhFUlRZUEVfVUJOSVUgICAgICAgICAgICAgICAgICAgPSAweDcwMDEKCUVUSEVSVFlQRV9VQk5NQyAgICAgICAgICAgICAgICAgICA9IDB4NzAwMwoJRVRIRVJUWVBFX1ZBTElEICAgICAgICAgICAgICAgICAgID0gMHgxNjAwCglFVEhFUlRZUEVfVkFSSUFOICAgICAgICAgICAgICAgICAgPSAweDgwZGQKCUVUSEVSVFlQRV9WQVhFTE4gICAgICAgICAgICAgICAgICA9IDB4ODAzYgoJRVRIRVJUWVBFX1ZFRUNPICAgICAgICAgICAgICAgICAgID0gMHg4MDY3CglFVEhFUlRZUEVfVkVYUCAgICAgICAgICAgICAgICAgICAgPSAweDgwNWIKCUVUSEVSVFlQRV9WR0xBQiAgICAgICAgICAgICAgICAgICA9IDB4ODEzMQoJRVRIRVJUWVBFX1ZJTkVTICAgICAgICAgICAgICAgICAgID0gMHhiYWQKCUVUSEVSVFlQRV9WSU5FU0VDSE8gICAgICAgICAgICAgICA9IDB4YmFmCglFVEhFUlRZUEVfVklORVNMT09QICAgICAgICAgICAgICAgPSAweGJhZQoJRVRIRVJUWVBFX1ZJVEFMICAgICAgICAgICAgICAgICAgID0gMHhmZjAwCglFVEhFUlRZUEVfVkxBTiAgICAgICAgICAgICAgICAgICAgPSAweDgxMDAKCUVUSEVSVFlQRV9WTFRMTUFOICAgICAgICAgICAgICAgICA9IDB4ODA4MAoJRVRIRVJUWVBFX1ZQUk9EICAgICAgICAgICAgICAgICAgID0gMHg4MDVjCglFVEhFUlRZUEVfVlVSRVNFUlZFRCAgICAgICAgICAgICAgPSAweDgxNDcKCUVUSEVSVFlQRV9XQVRFUkxPTyAgICAgdGltZSwgbGV0J3Mgc3RvcCBhZnRlciBhIGNlcnRhaW4gYW1vdW50IG9mIHdvcmsuCgkvLwoJLy8gUGljayBhIHN0b3BwaW5nIHBvaW50IHN1Y2ggdGhhdCB3aGVuIHN1YnRyYWN0ZWQgZnJvbSB0b3RhbFdvcmsKCS8vIHdlIGdldCBhIG11bHRpcGxlIG9mIGEgcmVsYXRpdmVseSBsYXJnZSBwb3dlciBvZiAyLiB2ZXJpZnlTY2F2ZW5nZXJTdGF0ZQoJLy8gYWx3YXlzIG1ha2VzIGFuIGV4YWN0IGNoZWNrLCBidXQgdGhlIHNjYXZlbmdlciBtaWdodCBnbyBhIGxpdHRsZSBvdmVyLAoJLy8gd2hpY2ggaXMgT0suIElmIHRoaXMgYnJlYWtzIG9mdGVuIG9yIGdldHMgYW5ub3lpbmcgdG8gbWFpbnRhaW4sIG1vZGlmeQoJLy8gdmVyaWZ5U2NhdmVuZ2VyU3RhdGUuCglhdmFpbGFibGVXb3JrLlN0b3JlKHRvdGFsV29yaykKCXN0b3BwaW5nUG9pbnQgOj0gdWludDY0KDE8PDIwIC0gMypQaHlzUGFnZVNpemUpCglzdG9wQXQuU3RvcmUoc3RvcHBpbmdQb2ludCkKCXMuV2FrZSgpCglpZiAhcy5CbG9ja1VudGlsUGFya2VkKDJlOSAvKiAyIHNlY29uZHMgKi8pIHsKCQl0LkZhdGFsKCJ0aW1lZCBvdXQgd2FpdGluZyBmb3Igc2NhdmVuZ2VyIHRvIHJ1biB0byBjb21wbGV0aW9uIikKCX0KCS8vIFJ1biBhbm90aGVyIGNoZWNrLgoJdmVyaWZ5U2NhdmVuZ2VyU3RhdGUodCwgMip0b3RhbFdvcmsrKHRvdGFsV29yay1zdG9wcGluZ1BvaW50KSkKCgkvLyBDbGVhbiB1cC4KCXMuU3RvcCgpCn0KCmZ1bmMgVGVzdFNjYXZlbmdlSW5kZXgodCAqdGVzdGluZy5UKSB7CgkvLyBUaGlzIHRlc3Qgc3VpdGUgdGVzdHMgdGhlIHNjYXZlbmdlSW5kZXggZGF0YSBzdHJ1Y3R1cmUuCgoJLy8gbWFya0Z1bmMgaXMgYSBmdW5jdGlvbiB0aGF0IG1ha2VzIHRoZSBhZGRyZXNzIHJhbmdlIFtiYXNlLCBsaW1pdCkKCS8vIGF2YWlsYWJsZSBmb3Igc2NhdmVuZ2luZyBpbiBhIHRlc3QgaW5kZXguCgl0eXBlIG1hcmtGdW5jIGZ1bmMoYmFzZSwgbGltaXQgdWludHB0cikKCgkvLyBmaW5kRnVuYyBpcyBhIGZ1bmN0aW9uIHRoYXQgc2VhcmNoZXMgZm9yIHRoZSBuZXh0IGF2YWlsYWJsZSBwYWdlCgkvLyB0byBzY2F2ZW5nZSBpbiB0aGUgaW5kZXguIEl0IGFzc2VydHMgdGhhdCB0aGUgcGFnZSBpcyBmb3VuZCBpbgoJLy8gY2h1bmsgImNpIiBhdCBwYWdlICJvZmZzZXQuIgoJdHlwZSBmaW5kRnVuYyBmdW5jKGNpIENodW5rSWR4LCBvZmZzZXQgdWludCkKCgkvLyBUaGUgc3RydWN0dXJlIG9mIHRoZSB0ZXN0cyBiZWxvdyBpcyBhcyBmb2xsb3dzOgoJLy8KCS8vIHNldHVwIGNyZWF0ZXMgYSBmYWtlIHNjYXZlbmdlSW5kZXggdGhhdCBjYW4gYmUgbXV0YXRlZCBhbmQgcXVlcmllZCBieQoJLy8gdGhlIGZ1bmN0aW9ucyBpdCByZXR1cm5zLiBUaG9zZSBmdW5jdGlvbnMgY2FwdHVyZSB0aGUgdGVzdGluZy5UIHRoYXQKCS8vIHNldHVwIGlzIGNhbGxlZCB3aXRoLCBzbyB0aGV5J3JlIGJvdW5kIHRvIHRoZSBzdWJ0ZXN0IHRoZXkncmUgY3JlYXRlZCBpbi4KCS8vCgkvLyBUZXN0cyBhcmUgdGhlbiBvcmdhbml6ZWQgaW50byB0ZXN0IGNhc2VzIHdoaWNoIG1hcmsgc29tZSBwYWdlcyBhcwoJLy8gc2NhdmVuZ2UtYWJsZSB0aGVuIHRyeSB0byBmaW5kIHRoZW0uIFRlc3RzIGV4cGVjdCB0aGF0IHRoZSBpbml0aWFsCgkvLyBzdGF0ZSBvZiB0aGUgc2NhdmVuZ2VJbmRleCBoYXMgYWxsIG9mIHRoZSBjaHVua3MgYXMgZGVuc2UgaW4gdGhlIGxhc3QKCS8vIGdlbmVyYXRpb24gYW5kIGVtcHR5IHRvIHRoZSBzY2F2ZW5nZXIuCgkvLwoJLy8gVGhlcmUgYXJlIGEgZmV3IGFkZGl0aW9uYWwgdGVzdHMgdGhhdCBpbnRlcmxlYXZlIG1hcmsgYW5kIGZpbmQgb3BlcmF0aW9ucywKCS8vIHNvIHRoZXkncmUgZGVmaW5lZCBzZXBhcmF0ZWx5LCBidXQgdXNlIHRoZSBzYW1lIGluZnJhc3RydWN0dXJlLgoJc2V0dXAgOj0gZnVuYyh0ICp0ZXN0aW5nLlQsIGZvcmNlIGJvb2wpIChtYXJrIG1hcmtGdW5jLCBmaW5kIGZpbmRGdW5jLCBuZXh0KSA8IDIgJiYgZC5lcnIgPT0gbmlsIHsKCQl2YXIgbnVtQ29weSwgbnVtUmVhZCBpbnQKCQludW1Db3B5ID0gY29weShkLmFycls6XSwgZC5pbikgLy8gQ29waWVzIGVpdGhlciAwIG9yIDEgYnl0ZXMKCQludW1SZWFkLCBkLmVyciA9IGQuci5SZWFkKGQuYXJyW251bUNvcHk6XSkKCQlkLmluID0gZC5hcnJbOm51bUNvcHkrbnVtUmVhZF0KCQlpZiBkLmVyciA9PSBpby5FT0YgJiYgbGVuKGQuaW4pJTIgIT0gMCB7CgoJCQlpZiBhIDo9IHJldmVyc2VIZXhUYWJsZVtkLmluW2xlbihkLmluKS0xXV07IGEgPiAweDBmIHsKCQkJCWQuZXJyID0gSW52YWxpZEJ5dGVFcnJvcihkLmluW2xlbihkLmluKS0xXSkKCQkJfSBlbHNlIHsKCQkJCWQuZXJyID0gaW8uRXJyVW5leHBlY3RlZEVPRgoJCQl9CgkJfQoJfQoKCS8vIERlY29kZSBpbnRlcm5hbCBidWZmZXIgaW50byBvdXRwdXQgYnVmZmVyCglpZiBudW1BdmFpbCA6PSBsZW4oZC5pbikgLyAyOyBsZW4ocCkgPiBudW1BdmFpbCB7CgkJcCA9IHBbOm51bUF2YWlsXQoJfQoJbnVtRGVjLCBlcnIgOj0gRGVjb2RlKHAsIGQuaW5bOmxlbihwKSoyXSkKCWQuaW4gPSBkLmluWzIqbnVtRGVjOl0KCWlmIGVyciAhPSBuaWwgewoJCWQuaW4sIGQuZXJyID0gbmlsLCBlcnIgLy8gRGVjb2RlIGVycm9yOyBkaXNjYXJkIGlucHV0IHJlbWFpbmRlcgoJfQoKCWlmIGxlbihkLmluKSA8IDIgewoJCXJldHVybiBudW1EZWMsIGQuZXJyIC8vIE9ubHkgZXhwb3NlIGVycm9ycyB3aGVuIGJ1ZmZlciBmdWxseSBjb25zdW1lZAoJfQoJcmV0dXJuIG51bURlYywgbmlsCn0KCi8vIER1bXBlciByZXR1cm5zIGEgW2lvLldyaXRlQ2xvc2VyXSB0aGF0IHdyaXRlcyBhIGhleCBkdW1wIG9mIGFsbCB3cml0dGVuIGRhdGEgdG8KLy8gdy4gVGhlIGZvcm1hdCBvZiB0aGUgZHVtcCBtYXRjaGVzIHRoZSBvdXRwdXQgb2YgYGhleGR1bXAgLUNgIG9uIHRoZSBjb21tYW5kCi8vIGxpbmUuCmZ1bmMgRHVtcGVyKHcgaW8uV3JpdGVyKSBpby5Xcml0ZUNsb3NlciB7CglyZXR1cm4gJmR1bXBlcnt3OiB3fQp9Cgp0eXBlIGR1bXBlciBzdHJ1Y3QgewoJdyAgICAgICAgICBpby5Xcml0ZXIKCXJpZ2h0Q2hhcnMgWzE4XWJ5dGUKCWJ1ZiAgICAgICAgWzE0XWJ5dGUKCXVzZWQgICAgICAgaW50ICAvLyBudW1iZXIgb2YgYnl0ZXMgaW4gdGhlIGN1cnJlbnQgbGluZQoJbiAgICAgICAgICB1aW50IC8vIG51bWJlciBvZiBieXRlcywgdG90YWwKCWNsb3NlZCAgICAgYm9vbAp9CgpmdW5jIHRvQ2hhcihiIGJ5dGUpIGJ5dGUgewoJaWYgYiA8IDMyIHx8IGIgPiAxMjYgewoJCXJldHVybiAnLicKCX0KCXJldHVybiBiCn0KCmZ1bmMgKGggKmR1bXBlcikgV3JpdGUoZGF0YSBbXWJ5dGUpIChuIGludCwgZXJyIGVycm9yKSB7CglpZiBoLmNsb3NlZCB7CgkJcmV0dXJuIDAsIGVycm9ycy5OZXcoImVuY29kaW5nL2hleDogZHVtcGVyIGNsb3NlZCIpCgl9CgoJLy8gT3V0cHV0IGxpbmVzIGxvb2sgbGlrZToKCS8vIDAwMDAwMDEwICAyZSAyZiAzMCAzMSAzMiAzMyAzNCAzNSAgMzYgMzcgMzggMzkgM2EgM2IgM2MgM2QgIHwuLzAxMjM0NTY3ODk6Ozw9fAoJLy8gXiBvZmZzZXQgICAgICAgICAgICAgICAgICAgICAgICAgIF4gZXh0cmEgc3BhY2UgICAgICAgICAgICAgIF4gQVNDSUkgb2YgbGluZS4KCWZvciBpIDo9IHJhbmdlIGRhdGEgewoJCWlmIGgudXNlZCA9PSAwIHsKCQkJLy8gQXQgdGhlIGJlZ2lubmluZyBvZiBhIGxpbmUgd2UgcHJpbnQgdGhlIGN1cnJlbnQKCQkJLy8gb2Zmc2V0IGluIGhleC4KCQkJaC5idWZbMF0gPSBieXRlKGgubiA+PiAyNCkKCQkJaC5idWZbMV0gPSBieXRlKGgubiA+PiAxNikKCQkJaC5idWZbMl0gPSBieXRlKGgubiA+PiA4KQoJCQloLmJ1ZlszXSA9IGJ5dGUoaC5uKQoJCQlFbmNvZGUoaC5idWZbNDpdLCBoLmJ1Zls6NF0pCgkJCWguYnVmWzEyXSA9ICcgJwoJCQloLmJ1ZlsxM10gPSAnICcKCQkJXywgZXJyID0gaC53LldyaXRlKGguYnVmWzQ6XSkKCShlLCAiZHVwbGljYXRlIGNhc2UgJXMgaW4gdHlwZSBzd2l0Y2giLCBUcykKCQkJZXJyLmFkZGYob3RoZXIsICJwcmV2aW91cyBjYXNlIikKCQkJZXJyLnJlcG9ydCgpCgkJCWNvbnRpbnVlIEwKCQl9CgkJc2VlbltoYXNoXSA9IGUKCQlpZiBUICE9IG5pbCB7CgkJCWNoZWNrLnR5cGVBc3NlcnRpb24oZSwgeCwgVCwgdHJ1ZSkKCQl9Cgl9CgoJLy8gc3BlYzogIkluIGNsYXVzZXMgd2l0aCBhIGNhc2UgbGlzdGluZyBleGFjdGx5IG9uZSB0eXBlLCB0aGUgdmFyaWFibGUgaGFzIHRoYXQgdHlwZTsKCS8vIG90aGVyd2lzZSwgdGhlIHZhcmlhYmxlIGhhcyB0aGUgdHlwZSBvZiB0aGUgZXhwcmVzc2lvbiBpbiB0aGUgVHlwZVN3aXRjaEd1YXJkLgoJaWYgbGVuKHR5cGVzKSAhPSAxIHx8IFQgPT0gbmlsIHsKCQlUID0gVHlwW0ludmFsaWRdCgkJaWYgeCAhPSBuaWwgewoJCQlUID0geC50eXAKCQl9Cgl9CgoJYXNzZXJ0KFQgIT0gbmlsKQoJcmV0dXJuIFQKfQoKLy8gc3RtdCB0eXBlY2hlY2tzIHN0YXRlbWVudCBzLgpmdW5jIChjaGVjayAqQ2hlY2tlcikgc3RtdChjdHh0IHN0bXRDb250ZXh0LCBzIGFzdC5TdG10KSB7CgkvLyBzdGF0ZW1lbnRzIG11c3QgZW5kIHdpdGggdGhlIHNhbWUgdG9wIHNjb3BlIGFzIHRoZXkgc3RhcnRlZCB3aXRoCglpZiBkZWJ1ZyB7CgkJZGVmZXIgZnVuYyhzY29wZSAqU2NvcGUpIHsKCQkJLy8gZG9uJ3QgY2hlY2sgaWYgY29kZSBpcyBwYW5pY2tpbmcKCQkJaWYgcCA6PSByZWNvdmVyKCk7IHAgIT0gbmlsIHsKCQkJCXBhbmljKHApCgkJCX0KCQkJYXNzZXJ0KHNjb3BlID09IGNoZWNrLnNjb3BlKQoJCX0oY2hlY2suc2NvcGUpCgl9CgoJLy8gcHJvY2VzcyBjb2xsZWN0ZWQgZnVuY3Rpb24gbGl0ZXJhbHMgYmVmb3JlIHNjb3BlIGNoYW5nZXMKCWRlZmVyIGNoZWNrLnByb2Nlc3NEZWxheWVkKGxlbihjaGVjay5kZWxheWVkKSkKCgkvLyByZXNldCBjb250ZXh0IGZvciBzdGF0ZW1lbnRzIG9mIGlubmVyIGJsb2NrcwoJaW5uZXIgOj0gY3R4dCAmXiAoZmFsbHRocm91Z2hPayB8IGZpbmFsU3dpdGNoQ2FzZSB8IGluVHlwZVN3aXRjaCkKCglzd2l0Y2ggcyA6PSBzLih0eXBlKSB7CgljYXNlICphc3QuQmFkU3RtdCwgKmFzdC5FbXB0eVN0bXQ6CgkJLy8gaWdub3JlCgoJY2FzZSAqYXN0LkRlY2xTdG10OgoJCWNoZWNrLmRlY2xTdG10KHMuRGVjbCkKCgljYXNlICphc3QuTGFiZWxlZFN0bXQ6CgkJY2hlY2suaGFzTGFiZWwgPSB0cnVlCgkJY2hlY2suc3RtdChjdHh0LCBzLlN0bXQpCgoJY2FzZSAqYXN0LkV4cHJTdG10OgoJCS8vIHNwZWM6ICJXaXRoIHRoZSBleGNlcHRpb24gb2Ygc3BlY2lmaWMgYnVpbHQtaW4gZnVuY3Rpb25zLAoJCS8vIGZ1bmN0aW9uIGFuZCBtZXRob2QgY2FsbHMgYW5kIHJlY2VpdmUgb3BlcmF0aW9ucyBjYW4gYXBwZWFyCgkJLy8gaW4gc3RhdGVtZW50IGNvbnRleHQuIFN1Y2ggc3RhdGVtZW50cyBtYXkgYmUgcGFyZW50aGVzaXplZC4iCgkJdmFyIHggb3BlcmFuZAoJCWtpbmQgOj0gY2hlY2sucmF3RXhwcihuaWwsICZ4LCBzLlgsIG5pbCwgZmFsc2UpCgkJdmFyIG1zZyBzdHJpbmcKCQl2YXIgY29kZSBDb2RlCgkJc3dpdGNoIHgubW9kZSB7CgkJZGVmYXVsdDoKCQkJaWYga2luZCA9PSBzdGF0ZW1lbnQgewoJCQkJcmV0dXJuCgkJCX0KCQkJbXNnID0gImlzIG5vdCB1c2VkIgoJCQljb2RlID0gVW51c2VkRXhwcgoJCWNhc2UgYnVpbHRpbjoKCQkJbXNnID0gIm11c3QgYmUgY2FsbGVkIgoJCQljb2RlID0gVW5jYWxsZWRCdWlsdGluCgkJY2FzZSB0eXBleHByOgoJCQltc2cgPSAiaXMgbm90IGFuIGV4cHJlc3Npb24iCgkJCWNvZGUgPSBOb3RBbkV4cHIKCQl9CgkJY2hlY2suZXJyb3JmKCZ4LCBjb2RlLCAiJXMgJXMiLCAmeCwgbXNnKQoKCWNhc2UgKmFzdC5TZW5kU3RtdDoKCQl2YXIgY2gsIHZhbCBvcGVyYW5kCgkJY2hlY2suZXhwcihuaWwsICZjaCwgcy5DaGFuKQoJCWNoZWNrLmV4cHIobmlsLCAmdmFsLCBzLlZhbHVhY2UgWzRdYnl0ZSAvKiBpbl9hZGRyICovCn0KCnR5cGUgSVB2Nk1yZXEgc3RydWN0IHsKCU11bHRpYWRkciBbMTZdYnl0ZSAvKiBpbjZfYWRkciAqLwoJSW50ZXJmYWNlIHVpbnQzMgp9Cgp0eXBlIE1zZ2hkciBzdHJ1Y3QgewoJTmFtZSAgICAgICAqYnl0ZQoJTmFtZWxlbiAgICB1aW50MzIKCUlvdiAgICAgICAgKklvdmVjCglJb3ZsZW4gICAgIGludDMyCglDb250cm9sICAgICpieXRlCglDb250cm9sbGVuIHVpbnQzMgoJRmxhZ3MgICAgICBpbnQzMgp9Cgp0eXBlIENtc2doZHIgc3RydWN0IHsKCUxlbiAgIHVpbnQzMgoJTGV2ZWwgaW50MzIKCVR5cGUgIGludDMyCn0KCnR5cGUgSW5ldDZQa3RpbmZvIHN0cnVjdCB7CglBZGRyICAgIFsxNl1ieXRlIC8qIGluNl9hZGRyICovCglJZmluZGV4IHVpbnQzMgp9Cgp0eXBlIElQdjZNVFVJbmZvIHN0cnVjdCB7CglBZGRyIFJhd1NvY2thZGRySW5ldDYKCU10dSAgdWludDMyCn0KCnR5cGUgSUNNUHY2RmlsdGVyIHN0cnVjdCB7CglGaWx0IFs4XXVpbnQzMgp9Cgpjb25zdCAoCglTaXplb2ZTb2NrYWRkckluZXQ0ICAgID0gMHgxMAoJU2l6ZW9mU29ja2FkZHJJbmV0NiAgICA9IDB4MWMKCVNpemVvZlNvY2thZGRyQW55ICAgICAgPSAweDZjCglTaXplb2ZTb2NrYWRkclVuaXggICAgID0gMHg2YQoJU2l6ZW9mU29ja2FkZHJEYXRhbGluayA9IDB4MTQKCVNpemVvZkxpbmdlciAgICAgICAgICAgPSAweDgKCVNpemVvZklQTXJlcSAgICAgICAgICAgPSAweDgKCVNpemVvZklQdjZNcmVxICAgICAgICAgPSAweDE0CglTaXplb2ZNc2doZHIgICAgICAgICAgID0gMHgxYwoJU2l6ZW9mQ21zZ2hkciAgICAgICAgICA9IDB4YwoJU2l6ZW9mSW5ldDZQa3RpbmZvICAgICA9IDB4MTQKCVNpemVvZklQdjZNVFVJbmZvICAgICAgPSAweDIwCglTaXplb2ZJQ01QdjZGaWx0ZXIgICAgID0gMHgyMAopCgpjb25zdCAoCglQVFJBQ0VfVFJBQ0VNRSA9IDB4MAoJUFRSQUNFX0NPTlQgICAgPSAweDcKCVBUUkFDRV9LSUxMICAgID0gMHg4CikKCnR5cGUgS2V2ZW50X3Qgc3RydWN0IHsKCUlkZW50ICAgICB1aW50MzIKCUZpbHRlciAgICB1aW50MzIKCUZsYWdzICAgICB1aW50MzIKCUZmbGFncyAgICB1aW50MzIKCURhdGEgICAgICBpbnQ2NAoJVWRhdGEgICAgIGludDMyCglQYWRfY2dvXzAgWzRdYnl0ZQp9Cgp0eXBlIEZkU2V0IHN0cnVjdCB7CglCaXRzIFs4XXVpbnQzMgp9Cgpjb25zdCAoCglTaXplb2ZJZk1zZ2hkciAgICAgICAgID0gMHg5OAoJU2l6ZW9mSWZEYXRhICAgICAgICAgICA9IDB4ODgKCVNpemVvZklmYU1zZ2hkciAgICAgICAgPSAweDE4CglTaXplb2ZJZkFubm91bmNlTXNnaGRyID0gMHgxOAoJU2l6ZW9mUnRNc2doZHIgICAgICAgICA9IDB4NzgKCVNpemVvZlJ0TWV0cmljcyAgICAgICAgPSAweDUwCikKCnR5cGUgSWZNc2doZHIgc3RydWN0IHsKCU1zZ2xlbiAgICB1aW50MTYKCVZlcnNpb24gICB1aW50OAoJVHlwZSAgICAgIHVpbnQ4CglBZGRycyAgICAgaW50MzIKCUZsYWdzICAgICBpbnQzMgoJSW5kZXggICAgIHVpbnQxNgoJUGFkX2Nnb18wIFsyXWJ5dGUKCURhdGEgICAgICBJZkRhdGEKfQoKdHlwZSBJZkRhdGEgc3RydWN0IHsKCVR5cGUgICAgICAgdWludDgKCUFkZHJsZW4gICAgdWludDgKCUhkcmxlbiAgICAgdWludDgKCVBhZF9jZ29fMCAgWzFdYnl0ZQoJTGlua19zdGF0ZSBpbnQzMgoJTXR1ICAgICAgICB1aW50NjQKCU1ldHJpYyAgICAgdWludDY0CglCYXVkcmF0ZSAgIHVpbnQ2NAoJSXBhY2tldHMgICB1aW50NjQKCUllcnJvcnMgICAgdWludDY0CglPcGFja2V0cyAgIHVpbnQ2NAoJT2Vycm9ycyAgICB1aW50NjQKCUNvbGxpc2lvbnMgdWludDY0CglJYnl0ZXMgICAgIHVpbnQ2NAoJT2J5dGVzICAgICB1aW50NjQKCUltY2FzdHMgICAgdWludDY0CglPbWNhc3RzICAgIHVpbnQ2NAoJSXFkcm9wcyAgICB1aW50NjQKCU5vcHJvdG8gICAgdWludDY0CglMYXN0Y2hhbmdlIFRpbWVzcGVjCn0KCnR5cGUgSWZhY3RlcnMsIGFzIGRlZmluZWQKLy8gYnkgdGhlIFxzIGNoYXJhY3RlciBjbGFzcy4KLy8gU2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvR3VpZGUvUmVndWxhcl9leHByZXNzaW9ucy9DaGFyYWN0ZXJfY2xhc3Nlcy4KY29uc3QganNXaGl0ZXNwYWNlID0gIlxmXG5cclx0XHZcdTAwMjBcdTAwYTBcdTE2ODBcdTIwMDBcdTIwMDFcdTIwMDJcdTIwMDNcdTIwMDRcdTIwMDVcdTIwMDZcdTIwMDdcdTIwMDhcdTIwMDlcdTIwMGFcdTIwMjhcdTIwMjlcdTIwMmZcdTIwNWZcdTMwMDBcdWZlZmYiCgovLyBuZXh0SlNDdHggcmV0dXJucyB0aGUgY29udGV4dCB0aGF0IGRldGVybWluZXMgd2hldGhlciBhIHNsYXNoIGFmdGVyIHRoZQovLyBnaXZlbiBydW4gb2YgdG9rZW5zIHN0YXJ0cyBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBpbnN0ZWFkIG9mIGEgZGl2aXNpb24KLy8gb3BlcmF0b3I6IC8gb3IgLz0uCi8vCi8vIFRoaXMgYXNzdW1lcyB0aGF0IHRoZSB0b2tlbiBydW4gZG9lcyBub3QgaW5jbHVkZSBhbnkgc3RyaW5nIHRva2VucywgY29tbWVudAovLyB0b2tlbnMsIHJlZ3VsYXIgZXhwcmVzc2lvbiBsaXRlcmFsIHRva2Vucywgb3IgZGl2aXNpb24gb3BlcmF0b3JzLgovLwovLyBUaGlzIGZhaWxzIG9uIHNvbWUgdmFsaWQgYnV0IG5vbnNlbnNpY2FsIEphdmFTY3JpcHQgcHJvZ3JhbXMgbGlrZQovLyAieCA9ICsrL2Zvby9pIiB3aGljaCBpcyBxdWl0ZSBkaWZmZXJlbnQgdGhhbiAieCsrL2Zvby9pIiwgYnV0IGlzIG5vdCBrbm93biB0bwovLyBmYWlsIG9uIGFueSBrbm93biB1c2VmdWwgcHJvZ3JhbXMuIEl0IGlzIGJhc2VkIG9uIHRoZSBkcmFmdAovLyBKYXZhU2NyaXB0IDIuMCBsZXhpY2FsIGdyYW1tYXIgYW5kIHJlcXVpcmVzIG9uZSB0b2tlbiBvZiBsb29rYmVoaW5kOgovLyBodHRwczovL3d3dy5tb3ppbGxhLm9yZy9qcy9sYW5ndWFnZS9qczIwLTIwMDAtMDcvcmF0aW9uYWxlL3N5bnRheC5odG1sCmZ1bmMgbmV4dEpTQ3R4KHMgW11ieXRlLCBwcmVjZWRpbmcganNDdHgpIGpzQ3R4IHsKCS8vIFRyaW0gYWxsIEpTIHdoaXRlc3BhY2UgY2hhcmFjdGVycwoJcyA9IGJ5dGVzLlRyaW1SaWdodChzLCBqc1doaXRlc3BhY2UpCglpZiBsZW4ocykgPT0gMCB7CgkJcmV0dXJuIHByZWNlZGluZwoJfQoKCS8vIEFsbCBjYXNlcyBiZWxvdyBhcmUgaW4gdGhlIHNpbmdsZS1ieXRlIFVURi04IGdyb3VwLgoJc3dpdGNoIGMsIG4gOj0gc1tsZW4ocyktMV0sIGxlbihzKTsgYyB7CgljYXNlICcrJywgJy0nOgoJCS8vICsrIGFuZCAtLSBhcmUgbm90IHJlZ2V4cCBwcmVjZWRlcnMsIGJ1dCArIGFuZCAtIGFyZSB3aGV0aGVyCgkJLy8gdGhleSBhcmUgdXNlZCBhcyBpbmZpeCBvciBwcmVmaXggb3BlcmF0b3JzLgoJCXN0YXJ0IDo9IG4gLSAxCgkJLy8gQ291bnQgdGhlIG51bWJlciBvZiBhZGphY2VudCBkYXNoZXMgb3IgcGx1c2VzLgoJCWZvciBzdGFydCA+IDAgJiYgc1tzdGFydC0xXSA9PSBjIHsKCQkJc3RhcnQtLQoJCX0KCQlpZiAobi1zdGFydCkmMSA9PSAxIHsKCQkJLy8gUmVhY2hlZCBmb3IgdHJhaWxpbmcgbWludXMgc2lnbnMgc2luY2UgIi0tLSIgaXMgdGhlCgkJCS8vIHNhbWUgYXMgIi0tIC0iLgoJCQlyZXR1cm4ganNDdHhSZWdleHAKCQl9CgkJcmV0dXJuIGpzQ3R4RGl2T3AKCWNhc2UgJy4nOgoJCS8vIEhhbmRsZSAiNDIuIgoJCWlmIG4gIT0gMSAmJiAnMCcgPD0gc1tuLTJdICYmIHNbbi0yXSA8PSAnOScgewoJCQlyZXR1cm4ganNDdHhEaXZPcAoJCX0KCQlyZXR1cm4ganNDdHhSZWdleHAKCS8vIFN1ZmZpeGVzIGZvciBhbGwgcHVuY3R1YXRvcnMgZnJvbSBzZWN0aW9uIDcuNyBvZiB0aGUgbGFuZ3VhZ2Ugc3BlYwoJLy8gdGhhdCBvbmx5IGVuZCBiaW5hcnkgb3BlcmF0b3JzIG5vdCBoYW5kbGVkIGFib3ZlLgoJY2FzZSAnLCcsICc8JywgJz4nLCAnPScsICcqJywgJyUnLCAnJicsICd8JywgJ14nLCAnPyc6CgkJcmVkZXgobi5Qb3MoKSkgKyAxCgkJCQlpZiBuLklubEZvcm1hbCgpIHsKCQkJCQl0YWcgPSBkd2FyZi5EV19UQUdfZm9ybWFsX3BhcmFtZXRlcgoJCQkJfQoJCQl9CgkJfQoJCWRlY2xwb3MgOj0gYmFzZS5DdHh0LklubmVybW9zdFBvcyhuLlBvcygpKQoJCWR2YXIgOj0gJmR3YXJmLlZhcnsKCQkJTmFtZTogICAgICAgICAgbi5TeW0oKS5OYW1lLAoJCQlJc1JldHVyblZhbHVlOiBpc1JldHVyblZhbHVlLAoJCQlUYWc6ICAgICAgICAgICB0YWcsCgkJCVdpdGhMb2NsaXN0OiAgIHRydWUsCgkJCVN0YWNrT2Zmc2V0OiAgIGludDMyKG4uRnJhbWVPZmZzZXQoKSksCgkJCVR5cGU6ICAgICAgICAgIGJhc2UuQ3R4dC5Mb29rdXAodHlwZW5hbWUpLAoJCQlEZWNsRmlsZTogICAgICBkZWNscG9zLlJlbEZpbGVuYW1lKCksCgkJCURlY2xMaW5lOiAgICAgIGRlY2xwb3MuUmVsTGluZSgpLAoJCQlEZWNsQ29sOiAgICAgICBkZWNscG9zLlJlbENvbCgpLAoJCQlJbmxJbmRleDogICAgICBpbnQzMihpbmxJbmRleCksCgkJCUNoaWxkSW5kZXg6ICAgIC0xLAoJCQlEaWN0SW5kZXg6ICAgICBuLkRpY3RJbmRleCwKCQkJQ2xvc3VyZU9mZnNldDogY2xvc3VyZU9mZnNldChuLCBjbG9zdXJlVmFycyksCgkJfQoJCWlmIG4uRXNjKCkgPT0gaXIuRXNjSGVhcCB7CgkJCWlmIG4uSGVhcGFkZHIgPT0gbmlsIHsKCQkJCWJhc2UuRmF0YWxmKCJpbnZhbGlkIGhlYXAgYWxsb2NhdGVkIHZhciB3aXRob3V0IEhlYXBhZGRyIikKCQkJfQoJCQlkZWJ1ZyA6PSBmbi5EZWJ1Z0luZm8uKCpzc2EuRnVuY0RlYnVnKQoJCQlsaXN0IDo9IGNyZWF0ZUhlYXBEZXJlZkxvY2F0aW9uTGlzdChuLCBkZWJ1Zy5FbnRyeUlEKQoJCQlkdmFyLlB1dExvY2F0aW9uTGlzdCA9IGZ1bmMobGlzdFN5bSwgc3RhcnRQQyBkd2FyZi5TeW0pIHsKCQkJCWRlYnVnLlB1dExvY2F0aW9uTGlzdChsaXN0LCBiYXNlLkN0eHQsIGxpc3RTeW0uKCpvYmouTFN5bSksIHN0YXJ0UEMuKCpvYmouTFN5bSkpCgkJCX0KCQl9CgkJdmFycyA9IGFwcGVuZCh2YXJzLCBkdmFyKQoJCS8vIFJlY29yZCBnbyB0eXBlIHRvIGVuc3VyZSB0aGF0IGl0IGdldHMgZW1pdHRlZCBieSB0aGUgbGlua2VyLgoJCWZuc3ltLkZ1bmMoKS5SZWNvcmRBdXRvVHlwZShyZWZsZWN0ZGF0YS5UeXBlTGlua3N5bShuLlR5cGUoKSkpCgl9CgoJLy8gU29ydCBkZWNscyBhbmQgdmFycy4KCXNvcnREZWNsc0FuZFZhcnMoZm4sIGRlY2xzLCB2YXJzKQoKCXJldHVybiBkZWNscywgdmFycwp9CgovLyBzb3J0RGVjbHNBbmRWYXJzIHNvcnRzIHRoZSBkZWNsIGFuZCBkd2FyZiB2YXIgbGlzdHMgYWNjb3JkaW5nIHRvCi8vIHBhcmFtZXRlciBkZWNsYXJhdGlvbiBvcmRlciwgc28gYXMgdG8gaW5zdXJlIHRoYXQgd2hlbiBhIHN1YnByb2dyYW0KLy8gRElFIGlzIGVtaXR0ZWQsIGl0cyBwYXJhbWV0ZXIgY2hpbGRyZW4gYXBwZWFyIGluIGRlY2xhcmF0aW9uIG9yZGVyLgovLyBQcmlvciB0byB0aGUgYWR2ZW50IG9mIHRoZSByZWdpc3RlciBBQkksIHNvcnRpbmcgYnkgZnJhbWUgb2Zmc2V0Ci8vIHdvdWxkIGFjaGlldmUgdGhpczsgd2l0aCB0aGUgcmVnaXN0ZXIgd2Ugbm93IG5lZWQgdG8gZ28gYmFjayB0byB0aGUKLy8gb3JpZ2luYWwgZnVuY3Rpb24gc2lnbmF0dXJlLgpmdW5jIHNvcnREZWNsc0FuZFZhcnMoZm4gKmlyLkZ1bmMsIGRlY2xzIFtdKmlyLk5hbWUsIHZhcnMgW10qZHdhcmYuVmFyKSB7CglwYXJhbU9yZGVyIDo9IG1ha2UobWFwWyppci5OYW1lXWludCkKCWlkeCA6PSAxCglmb3IgXywgZiA6PSByYW5nZSBmbi5UeXBlKCkuUmVjdlBhcmFtc1Jlc3VsdHMoKSB7CgkJaWYgbiwgb2sgOj0gZi5ObmFtZS4oKmlyLk5hbWUpOyBvayB7CgkJCXBhcmFtT3JkZXJbbl0gPSBpZHgKCQkJaWR4KysKCQl9Cgl9Cglzb3J0LlN0YWJsZSh2YXJzQW5kRGVjbHN7ZGVjbHMsIHZhcnMsIHBhcmFtT3JkZXJ9KQp9Cgp0eXBlIHZhcnNBbmREZWNscyBzdHJ1Y3QgewoJZGVjbHMgICAKCQkJciwgXyA6PSBtb2R1bGVkYXRhLkFkZFJlbChvYmphYmkuUl9YQ09GRlJFRikKCQkJci5TZXRTeW0ocykKCQkJci5TZXRTaXoodWludDgoY3R4dC5BcmNoLlB0clNpemUpKQoJCX0KCQlhZGRSZWYoInJ1bnRpbWUucm9kYXRhIikKCQlhZGRSZWYoInJ1bnRpbWUuZXJvZGF0YSIpCgkJYWRkUmVmKCJydW50aW1lLmVwY2xudGFiIikKCQlhZGRSZWYoImdvOmZ1bmMuKiIpCgkJLy8gQXMgd2UgdXNlIHJlbGF0aXZlIGFkZHJlc3NpbmcgZm9yIHRleHQgc3ltYm9scyBpbiBmdW5jdGFiLCBpdCBpcwoJCS8vIGltcG9ydGFudCB0aGF0IHRoZSBvZmZzZXRzIHdlIGNvbXB1dGVkIHN0YXkgdW5jaGFuZ2VkIGJ5IHRoZSBleHRlcm5hbAoJCS8vIGxpbmtlciwgaS5lLiBhbGwgc3ltYm9scyBpbiBUZXh0cCBzaG91bGQgbm90IGJlIHJlbW92ZWQuCgkJLy8gTW9zdCBvZiB0aGVtIGFyZSBhY3R1YWxseSByZWZlcmVuY2VkIChvdXIgZGVhZGNvZGUgcGFzcyBlbnN1cmVzIHRoYXQpLAoJCS8vIGV4Y2VwdCBnbzpidWlsZGlkIHdoaWNoIGlzIGdlbmVyYXRlZCBsYXRlIGFuZCBub3QgdXNlZCBieSB0aGUgcHJvZ3JhbS4KCQlhZGRSZWYoImdvOmJ1aWxkaWQiKQoJfQoJaWYgY3R4dC5Jc0FJWCgpIHsKCQkvLyBPbiBBSVgsIGFuIFJfQUREUiByZWxvY2F0aW9uIGZyb20gYW4gUk9EQVRBIHN5bWJvbCB0byBhIERBVEEgc3ltYm9sCgkJLy8gZG9lcyBub3Qgd29yay4gU2VlIGRhdGEuZ286cmVsb2NzeW0sIGNhc2UgUl9BRERSLgoJCS8vIEhlcmUgd2UgcmVjb3JkIHRoZSB1bnJlbG9jYXRlZCBhZGRyZXNzIGluIGFpeFN0YXRpY0RhdGFCYXNlIChpdCBpcwoJCS8vIHVucmVsb2NhdGVkIGFzIGl0IGlzIGluIFJPREFUQSkgc28gd2UgY2FuIGNvbXB1dGUgdGhlIGRlbHRhIGF0CgkJLy8gcnVuIHRpbWUuCgkJc2IgOj0gbGRyLkNyZWF0ZVN5bUZvclVwZGF0ZSgicnVudGltZS5haXhTdGF0aWNEYXRhQmFzZSIsIDApCgkJc2IuU2V0U2l6ZSgwKQoJCXNiLkFkZEFkZHIoY3R4dC5BcmNoLCBsZHIuTG9va3VwKCJydW50aW1lLmRhdGEiLCAwKSkKCQlzYi5TZXRUeXBlKHN5bS5TUk9EQVRBKQoJfQoKCS8vIHRleHQgc2VjdGlvbiBpbmZvcm1hdGlvbgoJc2xpY2UodGV4dHNlY3Rpb25tYXBTeW0sIHVpbnQ2NChuc2VjdGlvbnMpKQoKCS8vIFRoZSBpdGFibGlua3Mgc2xpY2UKCWl0YWJsaW5rU3ltIDo9IGxkci5Mb29rdXAoInJ1bnRpbWUuaXRhYmxpbmsiLCAwKQoJbml0YWJsaW5rcyA6PSB1aW50NjQobGRyLlN5bVNpemUoaXRhYmxpbmtTeW0pKSAvIHVpbnQ2NChjdHh0LkFyY2guUHRyU2l6ZSkKCXNsaWNlKGl0YWJsaW5rU3ltLCBuaXRhYmxpbmtzKQoKCS8vIFRoZSBwdGFiIHNsaWNlCglpZiBwdGFiIDo9IGxkci5Mb29rdXAoImdvOnBsdWdpbi50YWJzIiwgMCk7IHB0YWIgIT0gMCAmJiBsZHIuQXR0clJlYWNoYWJsZShwdGFiKSB7CgkJbGRyLlNldEF0dHJMb2NhbChwdGFiLCB0cnVlKQoJCWlmIGxkci5TeW1UeXBlKHB0YWIpICE9IHN5bS5TUk9EQVRBIHsKCQkJcGFuaWMoZm10LlNwcmludGYoImdvOnBsdWdpbi50YWJzIGlzICV2LCBub3QgU1JPREFUQSIsIGxkci5TeW1UeXBlKHB0YWIpKSkKCQl9CgkJbmVudHJpZXMgOj0gdWludDY0KGxlbihsZHIuRGF0YShwdGFiKSkgLyA4KSAvLyBzaXplb2YobmFtZU9mZikgKyBzaXplb2YodHlwZU9mZikKCQlzbGljZShwdGFiLCBuZW50cmllcykKCX0gZWxzZSB7CgkJbmlsU2xpY2UoKQoJfQoKCWlmIGN0eHQuQnVpbGRNb2RlID09IEJ1aWxkTW9kZVBsdWdpbiB7CgkJYWRkZ29zdHJpbmcoY3R4dCwgbGRyLCBtb2R1bGVkYXRhLCAiZ286bGluay50aGlzcGx1Z2lucGF0aCIsIG9iamFiaS5QYXRoVG9QcmVmaXgoKmZsYWdQbHVnaW5QYXRoKSkKCgkJcGtnaGFzaGVzIDo9IGxkci5DcmVhdGVTeW1Gb3JVcGRhdGUoImdvOmxpbmsucGtnaGFzaGVzIiwgMCkKCQlwa2doYXNoZXMuU2V0TG9jYWwodHJ1ZSkKCQlwa2doYXNoZXMuU2V0VHJvcikgRXJyb3IoKSBzdHJpbmcgewoJcmV0dXJuIGVyci5NZXNzYWdlCn0KCmZ1bmMgKGVyciBmYWtlRXJyb3IpIFVud3JhcCgpIGVycm9yIHsKCXJldHVybiBlcnIuV3JhcHBlZAp9Cgp0eXBlIHRhYmxlIHN0cnVjdCB7CgltdSAgICAgIHN5bmMuTXV0ZXgKCWNvbG5hbWUgW11zdHJpbmcKCWNvbHR5cGUgW11zdHJpbmcKCXJvd3MgICAgW10qcm93Cn0KCmZ1bmMgKHQgKnRhYmxlKSBjb2x1bW5JbmRleChuYW1lIHN0cmluZykgaW50IHsKCXJldHVybiBzbGljZXMuSW5kZXgodC5jb2xuYW1lLCBuYW1lKQp9Cgp0eXBlIHJvdyBzdHJ1Y3QgewoJY29scyBbXWFueSAvLyBtdXN0IGJlIHNhbWUgc2l6ZSBhcyBpdHMgdGFibGUgY29sbmFtZSArIGNvbHR5cGUKfQoKdHlwZSBtZW1Ub3VjaGVyIGludGVyZmFjZSB7CgkvLyB0b3VjaE1lbSByZWFkcyAmIHdyaXRlcyBzb21lIG1lbW9yeSwgdG8gaGVscCBmaW5kIGRhdGEgcmFjZXMuCgl0b3VjaE1lbSgpCn0KCnR5cGUgZmFrZUNvbm4gc3RydWN0IHsKCWRiICpmYWtlREIgLy8gd2hlcmUgdG8gcmV0dXJuIG91cnNlbHZlcyB0bwoKCWN1cnJUeCAqZmFrZVR4CgoJLy8gRXZlcnkgb3BlcmF0aW9uIHdyaXRlcyB0byBsaW5lIHRvIGVuYWJsZSB0aGUgcmFjZSBkZXRlY3RvcgoJLy8gY2hlY2sgZm9yIGRhdGEgcmFjZXMuCglsaW5lIGludDY0CgoJLy8gU3RhdHMgZm9yIHRlc3RzOgoJbXUgICAgICAgICAgc3luYy5NdXRleAoJc3RtdHNNYWRlICAgaW50CglzdG10c0Nsb3NlZCBpbnQKCW51bVByZXBhcmUgIGludAoKCS8vIGJhZCBjb25uZWN0aW9uIHRlc3RzOyBzZWUgaXNCYWQoKQoJYmFkICAgICAgIGJvb2wKCXN0aWNreUJhZCBib29sCgoJc2tpcERpcnR5U2Vzc2lvbiBib29sIC8vIHRlc3RzIHRoYXQgdXNlIENvbm4gc2hvdWxkIHNldCB0aGlzIHRvIHRydWUuCgoJLy8gZGlydHlTZXNzaW9uIHRlc3RzIFJlc2V0U2Vzc2lvbiwgdHJ1ZSBpZiBhIHF1ZXJ5IGhhcyBleGVjdXRlZAoJLy8gdW50aWwgUmVzZXRTZXNzaW9uIGlzIGNhbGxlZC4KCWRpcnR5U2Vzc2lvbiBib29sCgoJLy8gVGhlIHdhaXRlciBpcyBjYWxsZWQgYmVmb3JlIGVhY2ggcXVlcnkuIE1heSBiZSB1c2VkIGluIHBsYWNlIG9mIHRoZSAiV0FJVCIKCS8vIGRpcmVjdGl2ZS4KCXdhaXRlciBmdW5jKGNvbnRleHQuQ29udGV4dCkKfQoKZnVuYyAoYyAqZmFrZUNvbm4pIHRvdWNoTWVtKCkgewoJYy5saW5lKysKfQoKZnVuYyAoYyAqZmFrZUNvbm4pIGluY3JTdGF0KHYgKmludCkgewoJYy5tdS5Mb2NrKCkKCSp2KysKCWMubXUuVW5sb2NrKCkKfQoKdHlwZSBmYWtlVHggc3RydWN0IHsKCWMgKmZha2VDb25uCn0KCnR5cGUgYm91bmRDb2wgc3RydWN0IHsKCUNvbHVtbiAgICAgIHN0cmluZwoJUGxhY2Vob2xkZXIgc3RyaW5nCglPcmRpbmFsICAgICBpbnQKfQoKdHlwZSBmYWtlU3RtdCBzdHJ1Y3QgewoJbWVtVG91Y2hlcgoJYyAqZmFrZUNvbm4KCXEgc3RyaW5nIC8vIGp1c3QgZm9yIGRlYnVnZ2luZwoKCWNtZCAgIHN0cmluZwoJdGFibGUgc3RyaW5nCglwYW5pYyBzdHJpbmcKCXdhaXQgIHRpbWUuRHVyYXRpb24KCgluZXh0ICpmYWtlU3RtdCAvLyB1c2VkIGZvciByZXR1cm5pbmcgbXVsdGlwbGUgcmVzdWx0cy4KCgljbG9zZWQgYm9vbAoKCWNvbE5hbWUgICAgICBbXXN0cmluZyAvLyB1c2VkIGJ5IENSRUFURSwgSU5TRVJULCBTRUxFQ1QgKHNlbGVjdGVkIGNvbHVtbnMpCgljb2xUeXBlICAgICAgW11zdHJpbmcgLy8gdXNlZCBieSBDUkVBVEUKCWNvbFZhbHVlICAgICBbXWFueSAgICAvLyB1c2VkIGJ5IElOU0VSVCAobWl4IG9mIHN0cmluZ3MgYW5kICI/IiBmb3IgYm91bmQgcGFyYW1zKQoJcGxhY2Vob2xkZXJzIGludCAgICAgIC8vIHVzZWQgYnkgSU5TRVJUL1NFTEVDVDogbnVtYmVyIG9mID8gcGFyYW1zCgoJd2hlcmVDb2wgW11ib3VuZENvbCAvLyB1c2VkIGJ5IFNFTEVDVCAoYWxsIHBsYWNlaG9sZGVycykKCglwbGFjZWhvbGRlckNvbnZlcnRlciBbXWRyeXplcntpbnNwZWN0LkFuYWx5emVyfSwKCVJ1bkRlc3BpdGVFcnJvcnM6IHRydWUsCglSdW46ICAgICAgICAgICAgICBydW4sCn0KCnZhciB3aGl0ZWxpc3QgPSB0cnVlCgpmdW5jIGluaXQoKSB7CglBbmFseXplci5GbGFncy5Cb29sVmFyKCZ3aGl0ZWxpc3QsICJ3aGl0ZWxpc3QiLCB3aGl0ZWxpc3QsICJ1c2UgY29tcG9zaXRlIHdoaXRlIGxpc3Q7IGZvciB0ZXN0aW5nIG9ubHkiKQp9CgovLyBydW5VbmtleWVkTGl0ZXJhbCBjaGVja3MgaWYgYSBjb21wb3NpdGUgbGl0ZXJhbCBpcyBhIHN0cnVjdCBsaXRlcmFsIHdpdGgKLy8gdW5rZXllZCBmaWVsZHMuCmZ1bmMgcnVuKHBhc3MgKmFuYWx5c2lzLlBhc3MpIChhbnksIGVycm9yKSB7CglpbnNwZWN0IDo9IHBhc3MuUmVzdWx0T2ZbaW5zcGVjdC5BbmFseXplcl0uKCppbnNwZWN0b3IuSW5zcGVjdG9yKQoKCW5vZGVGaWx0ZXIgOj0gW11hc3QuTm9kZXsKCQkoKmFzdC5Db21wb3NpdGVMaXQpKG5pbCksCgl9CglpbnNwZWN0LlByZW9yZGVyKG5vZGVGaWx0ZXIsIGZ1bmMobiBhc3QuTm9kZSkgewoJCWNsIDo9IG4uKCphc3QuQ29tcG9zaXRlTGl0KQoKCQl0eXAgOj0gcGFzcy5UeXBlc0luZm8uVHlwZXNbY2xdLlR5cGUKCQlpZiB0eXAgPT0gbmlsIHsKCQkJLy8gY2Fubm90IGRldGVybWluZSBjb21wb3NpdGUgbGl0ZXJhbHMnIHR5cGUsIHNraXAgaXQKCQkJcmV0dXJuCgkJfQoJCXR5cGVOYW1lIDo9IHR5cC5TdHJpbmcoKQoJCWlmIHdoaXRlbGlzdCAmJiB1bmtleWVkTGl0ZXJhbFt0eXBlTmFtZV0gewoJCQkvLyBza2lwIHdoaXRlbGlzdGVkIHR5cGVzCgkJCXJldHVybgoJCX0KCQl2YXIgc3RydWN0dXJhbFR5cGVzIFtddHlwZXMuVHlwZQoJCXN3aXRjaCB0eXAgOj0gdHlwZXMuVW5hbGlhcyh0eXApLih0eXBlKSB7CgkJY2FzZSAqdHlwZXMuVHlwZVBhcmFtOgoJCQl0ZXJtcywgZXJyIDo9IHR5cGVwYXJhbXMuU3RydWN0dXJhbFRlcm1zKHR5cCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gLy8gaW52YWxpZCB0eXBlCgkJCX0KCQkJZm9yIF8sIHRlcm0gOj0gcmFuZ2UgdGVybXMgewoJCQkJc3RydWN0dXJhbFR5cGVzID0gYXBwZW5kKHN0cnVjdHVyYWxUeXBlcywgdGVybS5UeXBlKCkpCgkJCX0KCQlkZWZhdWx0OgoJCQlzdHJ1Y3R1cmFsVHlwZXMgPSBhcHBlbmQoc3RydWN0dXJhbFR5cGVzLCB0eXApCgkJfQoKCQlmb3IgXywgdHlwIDo9IHJhbmdlIHN0cnVjdHVyYWxUeXBlcyB7CgkJCXN0cmN0LCBvayA6PSB0eXBlcGFyYW1zLkRlcmVmKHR5cCkuVW5kZXJseWluZygpLigqdHlwZXMuU3RydWN0KQoJCQlpZiAhb2sgewoJCQkJLy8gc2tpcCBub24tc3RydWN0IGNvbXBvc2l0ZSBsaXRlcmFscwoJCQkJY29udGludWUKCQkJfQoJCQlpZiBpc0xvY2FsVHlwZShwYXNzLCB0eXApIHsKCQkJCS8vIGFsbG93IHVua2V5ZWQgbG9jYWxseSBkZWZpbmVkIGNvbXBvc2l0ZSBsaXRlcmFsCgkJCQljb250aW51ZQoJCQl9CgoJCQkvLyBjaGVjayBpZiB0aGUgc3RydWN0IGNvbnRhaW5zIGFuIHVua2V5ZWQgZmllbGQKCQkJYWxsS2V5VmFsdWUgOj0gdHJ1ZQoJCQl2YXIgc3VnZ2VzdGVkRml4QXZhaWxhYmxlID0gbGVuKGNsLkVsdHMpID09IHN0cmN0Lk51bUZpZWxkcygpCgkJCXZhciBtaXNzaW5nS2V5cyBbXWFuYWx5c2lzLlRleHRFZGl0CgkJCWZvciBpLCBlIDo9IHJhbmdlIGNsLkVsdHMgewoJCQkJaWYgXywgb2sgOj0gZS4oKmFzdC5LZXlWYWx1ZUV4cHIpOyAhb2sgewoJCQkJCWFsbEtleVZhbHVlID0gZmFsc2UKCQkJCQlpZiBpID49IHN0cmN0Lk51bUZpZWxkcygpIHsKCQkJCQkJYnJlYWsKCQkJCQl9CgkJCQkJZmllbGQgOj0gc3RyY3QuRmllbGQoaSkKCQkJCQlpZiAhZmllbGQuRXhwb3J0ZWQoKSB7CgkJCQkJCS8vIEFkZGluZyB1bmV4cG9ydGVkIGZpZWxkIG5hbWVzIGZvciBzdHJ1Y3RzIG5vdCBkZWZpbmVkCgkJCQkJCS8vIGxvY2FsbHkgd2lsbCBub3Qgd29yay4KCQkJCQkJc3VnZ2VpbmFsIEMgY29kZSwgdGhlIGxvbmcgY29tbWVudCwgYW5kIHRoZSBjb25zdGFudHMKLy8gYmVsb3cgYXJlIGZyb20gaHR0cDovL25ldGxpYi5zYW5kaWEuZ292L2NlcGhlcy9jOXgtY29tcGxleC9jbG9nLmMuCi8vIFRoZSBnbyBjb2RlIGlzIGEgc2ltcGxpZmllZCB2ZXJzaW9uIG9mIHRoZSBvcmlnaW5hbCBDLgovLwovLyBDZXBoZXMgTWF0aCBMaWJyYXJ5IFJlbGVhc2UgMi44OiAgSnVuZSwgMjAwMAovLyBDb3B5cmlnaHQgMTk4NCwgMTk4NywgMTk4OSwgMTk5MiwgMjAwMCBieSBTdGVwaGVuIEwuIE1vc2hpZXIKLy8KLy8gVGhlIHJlYWRtZSBmaWxlIGF0IGh0dHA6Ly9uZXRsaWIuc2FuZGlhLmdvdi9jZXBoZXMvIHNheXM6Ci8vICAgIFNvbWUgc29mdHdhcmUgaW4gdGhpcyBhcmNoaXZlIG1heSBiZSBmcm9tIHRoZSBib29rIF9NZXRob2RzIGFuZAovLyBQcm9ncmFtcyBmb3IgTWF0aGVtYXRpY2FsIEZ1bmN0aW9uc18gKFByZW50aWNlLUhhbGwgb3IgU2ltb24gJiBTY2h1c3RlcgovLyBJbnRlcm5hdGlvbmFsLCAxOTg5KSBvciBmcm9tIHRoZSBDZXBoZXMgTWF0aGVtYXRpY2FsIExpYnJhcnksIGEKLy8gY29tbWVyY2lhbCBwcm9kdWN0LiBJbiBlaXRoZXIgZXZlbnQsIGl0IGlzIGNvcHlyaWdodGVkIGJ5IHRoZSBhdXRob3IuCi8vIFdoYXQgeW91IHNlZSBoZXJlIG1heSBiZSB1c2VkIGZyZWVseSBidXQgaXQgY29tZXMgd2l0aCBubyBzdXBwb3J0IG9yCi8vIGd1YXJhbnRlZS4KLy8KLy8gICBUaGUgdHdvIGtub3duIG1pc3ByaW50cyBpbiB0aGUgYm9vayBhcmUgcmVwYWlyZWQgaGVyZSBpbiB0aGUKLy8gc291cmNlIGxpc3RpbmdzIGZvciB0aGUgZ2FtbWEgZnVuY3Rpb24gYW5kIHRoZSBpbmNvbXBsZXRlIGJldGEKLy8gaW50ZWdyYWwuCi8vCi8vICAgU3RlcGhlbiBMLiBNb3NoaWVyCi8vICAgbW9zaGllckBuYS1uZXQub3JubC5nb3YKCi8vIENvbXBsZXggcG93ZXIgZnVuY3Rpb24KLy8KLy8gREVTQ1JJUFRJT046Ci8vCi8vIFJhaXNlcyBjb21wbGV4IEEgdG8gdGhlIGNvbXBsZXggWnRoIHBvd2VyLgovLyBEZWZpbml0aW9uIGlzIHBlciBBTVM1NSAjIDQuMi44LAovLyBhbmFseXRpY2FsbHkgZXF1aXZhbGVudCB0byBjcG93KGEseikgPSBjZXhwKHogY2xvZyhhKSkuCi8vCi8vIEFDQ1VSQUNZOgovLwovLyAgICAgICAgICAgICAgICAgICAgICBSZWxhdGl2ZSBlcnJvcjoKLy8gYXJpdGhtZXRpYyAgIGRvbWFpbiAgICAgIyB0cmlhbHMgICAgICBwZWFrICAgICAgICAgcm1zCi8vICAgIElFRUUgICAgICAtMTAsKzEwICAgICAzMDAwMCAgICAgICA5LjRlLTE1ICAgICAxLjVlLTE1CgovLyBQb3cgcmV0dXJucyB4Kip5LCB0aGUgYmFzZS14IGV4cG9uZW50aWFsIG9mIHkuCi8vIEZvciBnZW5lcmFsaXplZCBjb21wYXRpYmlsaXR5IHdpdGggW21hdGguUG93XToKLy8KLy8JUG93KDAsIMKxMCkgcmV0dXJucyAxKzBpCi8vCVBvdygwLCBjKSBmb3IgcmVhbChjKTwwIHJldHVybnMgSW5mKzBpIGlmIGltYWcoYykgaXMgemVybywgb3RoZXJ3aXNlIEluZitJbmYgaS4KZnVuYyBQb3coeCwgeSBjb21wbGV4MTI4KSBjb21wbGV4MTI4IHsKCWlmIHggPT0gMCB7IC8vIEd1YXJhbnRlZWQgYWxzbyB0cnVlIGZvciB4ID09IC0wLgoJCWlmIElzTmFOKHkpIHsKCQkJcmV0dXJuIE5hTigpCgkJfQoJCXIsIGkgOj0gcmVhbCh5KSwgaW1hZyh5KQoJCXN3aXRjaCB7CgkJY2FzZSByID09IDA6CgkJCXJldHVybiAxCgkJY2FzZSByIDwgMDoKCQkJaWYgaSA9PSAwIHsKCQkJCXJldHVybiBjb21wbGV4KG1hdGguSW5mKDEpLCAwKQoJCQl9CgkJCXJldHVybiBJbmYoKQoJCWNhc2UgciA+IDA6CgkJCXJldHVybiAwCgkJfQoJCXBhbmljKCJub3QgcmVhY2hlZCIpCgl9Cgltb2R1bHVzIDo9IEFicyh4KQoJaWYgbW9kdWx1cyA9PSAwIHsKCQlyZXR1cm4gY29tcGxleCgwLCAwKQoJfQoJciA6PSBtYXRoLlBvdyhtb2R1bHVzLCByZWFsKHkpKQoJYXJnIDo9IFBoYXNlKHgpCgl0aGV0YSA6PT0gMHg3ZAoJSUZUX0ZBU1RFVEhFUiAgICAgICAgICAgICAgICAgICAgID0gMHgzZQoJSUZUX0ZBU1RFVEhFUkZYICAgICAgICAgICAgICAgICAgID0gMHg0NQoJSUZUX0ZEREkgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmCglJRlRfRklCUkVDSEFOTkVMICAgICAgICAgICAgICAgICAgPSAweDM4CglJRlRfRlJBTUVSRUxBWUlOVEVSQ09OTkVDVCAgICAgICAgPSAweDNhCglJRlRfRlJBTUVSRUxBWU1QSSAgICAgICAgICAgICAgICAgPSAweDVjCglJRlRfRlJETENJRU5EUFQgICAgICAgICAgICAgICAgICAgPSAweGMxCglJRlRfRlJFTEFZICAgICAgICAgICAgICAgICAgICAgICAgPSAweDIwCglJRlRfRlJFTEFZRENFICAgICAgICAgICAgICAgICAgICAgPSAweDJjCglJRlRfRlJGMTZNRlJCVU5ETEUgICAgICAgICAgICAgICAgPSAweGEzCglJRlRfRlJGT1JXQVJEICAgICAgICAgICAgICAgICAgICAgPSAweDllCglJRlRfRzcwM0FUMk1CICAgICAgICAgICAgICAgICAgICAgPSAweDQzCglJRlRfRzcwM0FUNjRLICAgICAgICAgICAgICAgICAgICAgPSAweDQyCglJRlRfR0lGICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweGYwCglJRlRfR0lHQUJJVEVUSEVSTkVUICAgICAgICAgICAgICAgPSAweDc1CglJRlRfR1IzMDNJRFQgICAgICAgICAgICAgICAgICAgICAgPSAweGIyCglJRlRfR1IzMDNSRFQgICAgICAgICAgICAgICAgICAgICAgPSAweGIxCglJRlRfSDMyM0dBVEVLRUVQRVIgICAgICAgICAgICAgICAgPSAweGE0CglJRlRfSDMyM1BST1hZICAgICAgICAgICAgICAgICAgICAgPSAweGE1CglJRlRfSERIMTgyMiAgICAgICAgICAgICAgICAgICAgICAgPSAweDMKCUlGVF9IRExDICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4NzYKCUlGVF9IRFNMMiAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4YTgKCUlGVF9ISVBFUkxBTjIgICAgICAgICAgICAgICAgICAgICA9IDB4YjcKCUlGVF9ISVBQSSAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MmYKCUlGVF9ISVBQSUlOVEVSRkFDRSAgICAgICAgICAgICAgICA9IDB4MzkKCUlGVF9IT1NUUEFEICAgICAgICAgICAgICAgICAgICAgICA9IDB4NWEKCUlGVF9IU1NJICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MmUKCUlGVF9IWSAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4ZQoJSUZUX0lCTTM3MFBBUkNIQU4gICAgICAgICAgICAgICAgID0gMHg0OAoJSUZUX0lEU0wgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg5YQoJSUZUX0lFRUUxMzk0ICAgICAgICAgICAgICAgICAgICAgID0gMHg5MAoJSUZUX0lFRUU4MDIxMSAgICAgICAgICAgICAgICAgICAgID0gMHg0NwoJSUZUX0lFRUU4MDIxMiAgICAgICAgICAgICAgICAgICAgID0gMHgzNwoJSUZUX0lFRUU4MDIzQURMQUcgICAgICAgICAgICAgICAgID0gMHhhMQoJSUZUX0lGR1NOICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg5MQoJSUZUX0lNVCAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhiZQoJSUZUX0lORklOSUJBTkQgICAgICAgICAgICAgICAgICAgID0gMHhjNwoJSUZUX0lOVEVSTEVBVkUgICAgICAgICAgICAgICAgICAgID0gMHg3YwoJSUZUX0lQICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg3ZQoJSUZUX0lQRk9SV0FSRCAgICAgICAgICAgICAgICAgICAgID0gMHg4ZQoJSUZUX0lQT1ZFUkFUTSAgICAgICAgICAgICAgICAgICAgID0gMHg3MgoJSUZUX0lQT1ZFUkNETEMgICAgICAgICAgICAgICAgICAgID0gMHg2ZAoJSUZUX0lQT1ZFUkNMQVcgICAgICAgICAgICAgICAgICAgID0gMHg2ZQoJSUZUX0lQU1dJVENIICAgICAgICAgICAgICAgICAgICAgID0gMHg0ZQoJSUZUX0lTRE4gICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzZgoJSUZUX0lTRE5CQVNJQyAgICAgICAgICAgICAgICAgICAgID0gMHgxNAoJSUZUX0lTRE5QUklNQVJZICAgIAoKCVJFR0NUWFQgPSBSRUdfUjcKCVJFR1RNUCAgPSBSRUdfUjExCglSRUdTUCAgID0gUkVHX1IxMwoJUkVHTElOSyA9IFJFR19SMTQKCVJFR1BDICAgPSBSRUdfUjE1CgoJTkZSRUcgPSAxNgoJLyogY29tcGlsZXIgYWxsb2NhdGVzIHJlZ2lzdGVyIHZhcmlhYmxlcyBGMCB1cCAqLwoJLyogY29tcGlsZXIgYWxsb2NhdGVzIGV4dGVybmFsIHJlZ2lzdGVycyBGNyBkb3duICovCglGUkVHUkVUID0gUkVHX0YwCglGUkVHRVhUID0gUkVHX0Y3CglGUkVHVE1QID0gUkVHX0YxNQopCgovLyBodHRwOi8vaW5mb2NlbnRlci5hcm0uY29tL2hlbHAvdG9waWMvY29tLmFybS5kb2MuaWhpMDA0MGIvSUhJMDA0MEJfYWFkd2FyZi5wZGYKdmFyIEFSTURXQVJGUmVnaXN0ZXJzID0gbWFwW2ludDE2XWludDE2e30KCmZ1bmMgaW5pdCgpIHsKCS8vIGYgYXNzaWducyBkd2FyZnJlZ2lzdGVyc1tmcm9tOnRvXSA9IChiYXNlKTooc3RlcCoodG8tZnJvbSkrYmFzZSkKCWYgOj0gZnVuYyhmcm9tLCB0bywgYmFzZSwgc3RlcCBpbnQxNikgewoJCWZvciByIDo9IGZyb207IHIgPD0gdG87IHIrKyB7CgkJCUFSTURXQVJGUmVnaXN0ZXJzW3JdID0gc3RlcCooci1mcm9tKSArIGJhc2UKCQl9Cgl9CglmKFJFR19SMCwgUkVHX1IxNSwgMCwgMSkKCWYoUkVHX0YwLCBSRUdfRjE1LCA2NCwgMikgLy8gVXNlIGQwIHRocm91Z2ggRDE1LCBha2EgUzAsIFMyLCAuLi4sIFMzMAp9CgovLyBTcGVjaWFsIHJlZ2lzdGVycywgYWZ0ZXIgc3VidHJhY3Rpbmcgb2JqLlJCYXNlQVJNLCBiaXQgOSBpbmRpY2F0ZXMKLy8gYSBzcGVjaWFsIHJlZ2lzdGVyIGFuZCB0aGUgbG93IGJpdHMgc2VsZWN0IHRoZSByZWdpc3Rlci4KY29uc3QgKAoJUkVHX1NQRUNJQUwgPSBvYmouUkJhc2VBUk0gKyAxPDw5ICsgaW90YQoJUkVHX01CX1NZCglSRUdfTUJfU1QKCVJFR19NQl9JU0gKCVJFR19NQl9JU0hTVAoJUkVHX01CX05TSAoJUkVHX01CX05TSFNUCglSRUdfTUJfT1NICglSRUdfTUJfT1NIU1QKCglNQVhSRUcKKQoKY29uc3QgKAoJQ19OT05FID0gaW90YQoJQ19SRUcKCUNfUkVHUkVHCglDX1JFR1JFRzIKCUNfUkVHTElTVAoJQ19TSElGVCAgICAgLyogcmVnaXN0ZXIgc2hpZnQgUj4+eCAqLwoJQ19TSElGVEFERFIgLyogbWVtb3J5IGFkZHJlc3Mgd2l0aCBzaGlmdGVkIG9mZnNldCBSPj54KFIpICovCglDX0ZSRUcKCUNfUFNSCglDX0ZDUgoJQ19TUFIgLyogUkVHX01CX1NZICovCgoJQ19SQ09OICAgLyogMHhmZiByb3RhdGVkICovCglDX05DT04gICAvKiB+UkNPTiAqLwoJQ19SQ09OMkEgLyogT1Igb2YgdHdvIGRpc2pvaW50IENfUkNPTiBjb25zdGFudHMgKi8KCUNfUkNPTjJTIC8qIHN1YnRyYWN0aW9uIG9mIHR3byBkaXNqb2ludCBDX1JDT04gY29uc3RhbnRzICovCglDX1NDT04gICAvKiAweGZmZmYgKi8KCUNfTENPTgoJQ19MQ09OQUREUgoJQ19aRkNPTgoJQ19TRkNPTgoJQ19MRkNPTgoKCUNfUkFDT04gLyogPD0weGZmIHJvdGF0ZWQgY29uc3RhbnQgb2Zmc2V0IGZyb20gYXV0byAqLwoJQ19MQUNPTiAvKiBMYXJnZSBBdXRvIENPTnN0YW50LCBpLmUuIGxhcmdlIG9mZnNldCBmcm9tIFNQICovCgoJQ19TQlJBCglDX0xCUkEKCglDX0hBVVRPICAvKiBoYWxmd29yZCBpbnNuIG9mZnNldCAoLTB4ZmYgdG8gMHhmZikgKi8KCUNfRkFVVE8gIC8qIGZsb2F0IGluc24gb2Zmc2V0ICgwIHRvIDB4M2ZjLCB3b3JkIGFsaWduZWQpICovCglDX0hGQVVUTyAvKiBib3RoIEggYW5kIEYgKi8KCUNfU0FVVE8gIC8qIC0weGZmZiB0byAweGZmZiAqLwoJQ19MQVVUTwoKCUNfSE9SRUcKCUNfRk9SRUcKCUNfSEZPUkVHCglDX1NPUkVHCglDX1JPUkVHCglDX1NST1JFRyAvKiBib3RoIG5pbCBhbmQgUiAqLwoJQ19MT1JFRwoKCUNfUEMKCUNfU1AKCUNfSFJFRwoKCUNfQUREUiAvKiByZWZlcmVuY2UgdG8gcmVsb2NhdGFibGUgYWRkcmVzcyAqLwoKCS8vIFRMUyAidmFyIiBpbiBsb2NhbCBleGVjIG1vZGU6IHdpbGwgYmVjb21lIGEgY28vc3lzCXV0aW1lcyhwYXRoIHN0cmluZywgdGltZXMgKlsyXVRpbWV2YWwpIChlcnIgZXJyb3IpCgpmdW5jIHNldFRpbWVzcGVjKHNlYywgbnNlYyBpbnQ2NCkgVGltZXNwZWMgewoJcmV0dXJuIFRpbWVzcGVje1NlYzogc2VjLCBOc2VjOiBuc2VjfQp9CgpmdW5jIHNldFRpbWV2YWwoc2VjLCB1c2VjIGludDY0KSBUaW1ldmFsIHsKCXJldHVybiBUaW1ldmFse1NlYzogc2VjLCBVc2VjOiB1c2VjfQp9CgpmdW5jIElvcGVybShmcm9tIGludCwgbnVtIGludCwgb24gaW50KSAoZXJyIGVycm9yKSB7CglyZXR1cm4gRU5PU1lTCn0KCmZ1bmMgSW9wbChsZXZlbCBpbnQpIChlcnIgZXJyb3IpIHsKCXJldHVybiBFTk9TWVMKfQoKZnVuYyAociAqUHRyYWNlUmVncykgUEMoKSB1aW50NjQgeyByZXR1cm4gci5Qc3cuQWRkciB9CgpmdW5jIChyICpQdHJhY2VSZWdzKSBTZXRQQyhwYyB1aW50NjQpIHsgci5Qc3cuQWRkciA9IHBjIH0KCmZ1bmMgKGlvdiAqSW92ZWMpIFNldExlbihsZW5ndGggaW50KSB7Cglpb3YuTGVuID0gdWludDY0KGxlbmd0aCkKfQoKZnVuYyAobXNnaGRyICpNc2doZHIpIFNldENvbnRyb2xsZW4obGVuZ3RoIGludCkgewoJbXNnaGRyLkNvbnRyb2xsZW4gPSB1aW50NjQobGVuZ3RoKQp9CgpmdW5jIChtc2doZHIgKk1zZ2hkcikgU2V0SW92bGVuKGxlbmd0aCBpbnQpIHsKCW1zZ2hkci5Jb3ZsZW4gPSB1aW50NjQobGVuZ3RoKQp9CgpmdW5jIChjbXNnICpDbXNnaGRyKSBTZXRMZW4obGVuZ3RoIGludCkgewoJY21zZy5MZW4gPSB1aW50NjQobGVuZ3RoKQp9CgpmdW5jIChyc2EgKlJhd1NvY2thZGRyTkZDTExDUCkgU2V0U2VydmljZU5hbWVMZW4obGVuZ3RoIGludCkgewoJcnNhLlNlcnZpY2VfbmFtZV9sZW4gPSB1aW50NjQobGVuZ3RoKQp9CgovLyBMaW51eCBvbiBzMzkweCB1c2VzIHRoZSBvbGQgbW1hcCBpbnRlcmZhY2UsIHdoaWNoIHJlcXVpcmVzIGFyZ3VtZW50cyB0byBiZSBwYXNzZWQgaW4gYSBzdHJ1Y3QuCi8vIG1tYXAyIGFsc28gcmVxdWlyZXMgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCBpbiBhIHN0cnVjdDsgaXQgaXMgY3VycmVudGx5IG5vdCBleHBvc2VkIGluIDxhc20vdW5pc3RkLmg+LgpmdW5jIG1tYXAoYWRkciB1aW50cHRyLCBsZW5ndGggdWludHB0ciwgcHJvdCBpbnQsIGZsYWdzIGludCwgZmQgaW50LCBvZmZzZXQgaW50NjQpICh4YWRkciB1aW50cHRyLCBlcnIgZXJyb3IpIHsKCW1tYXBfYXJncyA6PSBbNl11aW50cHRye2FkZHIsIGxlbmd0aCwgdWludHB0cihwcm90KSwgdWludHB0cihmbGFncyksIHVpbnRwdHIoZmQpLCB1aW50cHRyKG9mZnNldCl9CglyMCwgXywgZTEgOj0gU3lzY2FsbChTWVNfTU1BUCwgdWludHB0cih1bnNhZmUuUG9pbnRlcigmbW1hcF9hcmdzWzBdKSksIDAsIDApCgl4YWRkciA9IHVpbnRwdHIocjApCglpZiBlMSAhPSAwIHsKCQllcnIgPSBlcnJub0VycihlMSkKCX0KCXJldHVybgp9CgovLyBPbiBzMzkweCBMaW51eCwgYWxsIHRoZSBzb2NrZXQgY2FsbHMgZ28gdGhyb3VnaCBhbiBleHRyYSBpbmRpcmVjdGlvbi4KLy8gVGhlIGFyZ3VtZW50cyB0byB0aGUgdW5kZXJseWluZyBzeXN0ZW0gY2FsbCAoU1lTX1NPQ0tFVENBTEwpIGFyZSB0aGUKLy8gbnVtYmVyIGJlbG93IGFuZCBhIHBvaW50ZXIgdG8gYW4gYXJyYXkgb2YgdWludHB0ci4KY29uc3QgKAoJLy8gc2VlIGxpbnV4L25ldC5oCgluZXRTb2NrZXQgICAgICA9IDEKCW5ldEJpbmQgICAgICAgID0gMgoJbmV0Q29ubmVjdCAgICAgPSAzCgluZXRMaXN0ZW4gICAgICA9IDQKCW5ldEFjY2VwdCAgICAgID0gNQoJbmV0R2V0U29ja05hbWUgPSA2CgluZXRHZXRQZWVyTmFtZSA9IDcKCW5ldFNvY2tldFBhaXIgID0gOAoJbmV0U2VuZCAgICAgICAgPSA5CgluZXRSZWN2ICAgICAgICA9IDEwCgluZXRTZW5kVG8gICAgICA9IDExCgluZXRSZWN2RnJvbSAgICA9IDEyCgluZXRTaHV0ZG93biAgICA9IDEzCgluZXRTZXRTb2NrT3B0ICA9IDE0CgluZXJldCwgdWludHB0cih0LkFsaWduXykpICsgdC5TaXplXwoJfQoJbnJldCA9IGFsaWduVXAobnJldCwgZ29hcmNoLlB0clNpemUpCgoJLy8gbWFrZSBzdXJlIHdlIGhhdmUgYSBmaW5hbGl6ZXIgZ29yb3V0aW5lCgljcmVhdGVmaW5nKCkKCgljYWxsZXJwYyA6PSBzeXMuR2V0Q2FsbGVyUEMoKQoJc3lzdGVtc3RhY2soZnVuYygpIHsKCQlpZiAhYWRkZmluYWxpemVyKGUuZGF0YSwgKCpmdW5jdmFsKShmLmRhdGEpLCBucmV0LCBmaW50LCBvdCkgewoJCQl0aHJvdygicnVudGltZS5TZXRGaW5hbGl6ZXI6IGZpbmFsaXplciBhbHJlYWR5IHNldCIpCgkJfQoJCWlmIGRlYnVnLmNoZWNrZmluYWxpemVycyAhPSAwIHsKCQkJc2V0RmluYWxpemVyQ29udGV4dChlLmRhdGEsIG90LkVsZW0sIGNhbGxlcnBjLCAoKmZ1bmN2YWwpKGYuZGF0YSkuZm4pCgkJfQoJfSkKfQoKLy8gTWFyayBLZWVwQWxpdmUgYXMgbm9pbmxpbmUgc28gdGhhdCBpdCBpcyBlYXNpbHkgZGV0ZWN0YWJsZSBhcyBhbiBpbnRyaW5zaWMuCi8vCi8vZ286bm9pbmxpbmUKCi8vIEtlZXBBbGl2ZSBtYXJrcyBpdHMgYXJndW1lbnQgYXMgY3VycmVudGx5IHJlYWNoYWJsZS4KLy8gVGhpcyBlbnN1cmVzIHRoYXQgdGhlIG9iamVjdCBpcyBub3QgZnJlZWQsIGFuZCBpdHMgZmluYWxpemVyIGlzIG5vdCBydW4sCi8vIGJlZm9yZSB0aGUgcG9pbnQgaW4gdGhlIHByb2dyYW0gd2hlcmUgS2VlcEFsaXZlIGlzIGNhbGxlZC4KLy8KLy8gQSB2ZXJ5IHNpbXBsaWZpZWQgZXhhbXBsZSBzaG93aW5nIHdoZXJlIEtlZXBBbGl2ZSBpcyByZXF1aXJlZDoKLy8KLy8JdHlwZSBGaWxlIHN0cnVjdCB7IGQgaW50IH0KLy8JZCwgZXJyIDo9IHN5c2NhbGwuT3BlbigiL2ZpbGUvcGF0aCIsIHN5c2NhbGwuT19SRE9OTFksIDApCi8vCS8vIC4uLiBkbyBzb21ldGhpbmcgaWYgZXJyICE9IG5pbCAuLi4KLy8JcCA6PSAmRmlsZXtkfQovLwlydW50aW1lLlNldEZpbmFsaXplcihwLCBmdW5jKHAgKkZpbGUpIHsgc3lzY2FsbC5DbG9zZShwLmQpIH0pCi8vCXZhciBidWYgWzEwXWJ5dGUKLy8JbiwgZXJyIDo9IHN5c2NhbGwuUmVhZChwLmQsIGJ1Zls6XSkKLy8JLy8gRW5zdXJlIHAgaXMgbm90IGZpbmFsaXplZCB1bnRpbCBSZWFkIHJldHVybnMuCi8vCXJ1bnRpbWUuS2VlcEFsaXZlKHApCi8vCS8vIE5vIG1vcmUgdXNlcyBvZiBwIGFmdGVyIHRoaXMgcG9pbnQuCi8vCi8vIFdpdGhvdXQgdGhlIEtlZXBBbGl2ZSBjYWxsLCB0aGUgZmluYWxpemVyIGNvdWxkIHJ1biBhdCB0aGUgc3RhcnQgb2YKLy8gW3N5c2NhbGwuUmVhZF0sIGNsb3NpbmcgdGhlIGZpbGUgZGVzY3JpcHRvciBiZWZvcmUgc3lzY2FsbC5SZWFkIG1ha2VzCi8vIHRoZSBhY3R1YWwgc3lzdGVtIGNhbGwuCi8vCi8vIE5vdGU6IEtlZXBBbGl2ZSBzaG91bGQgb25seSBiZSB1c2VkIHRvIHByZXZlbnQgZmluYWxpemVycyBmcm9tCi8vIHJ1bm5pbmcgcHJlbWF0dXJlbHkuIEluIHBhcnRpY3VsYXIsIHdoZW4gdXNlZCB3aXRoIFt1bnNhZmUuUG9pbnRlcl0sCi8vIHRoZSBydWxlcyBmb3IgdmFsaWQgdXNlcyBvZiB1bnNhZmUuUG9pbnRlciBzdGlsbCBhcHBseS4KZnVuYyBLZWVwQWxpdmUoeCBhbnkpIHsKCS8vIEludHJvZHVjZSBhIHVzZSBvZiB4IHRoYXQgdGhlIGNvbXBpbGVyIGNhbid0IGVsaW1pbmF0ZS4KCS8vIFRoaXMgbWFrZXMgc3VyZSB4IGlzIGFsaXZlIG9uIGVudHJ5LiBXZSBuZWVkIHggdG8gYmUgYWxpdmUKCS8vIG9uIGVudHJ5IGZvciAiZGVmZXIgcnVudGltZS5LZWVwQWxpdmUoeCkiOyBzZWUgaXNzdWUgMjE0MDIuCglpZiBjZ29BbHdheXNGYWxzZSB7CgkJcHJpbnRsbih4KQoJfQp9Ci8vIEluZmVybm8gdXRpbHMvNWMvbGlzdC5jCi8vIGh0dHBzOi8vYml0YnVja2V0Lm9yZy9pbmZlcm5vLW9zL2luZmVybm8tb3Mvc3JjL21hc3Rlci91dGlscy81Yy9saXN0LmMKLy8KLy8JQ29weXJpZ2h0IMKpIDE5OTQtMTk5OSBMdWNlbnQgVGVjaG5vbG9naWVzIEluYy4gIEFsbCAJR2V0ZWdpZCgpIChlZ2lkIGludCkKLy9zeXNuYglHZXRldWlkKCkgKGV1aWQgaW50KQovL3N5c25iCUdldGdpZCgpIChnaWQgaW50KQovL3N5c25iCUdldHJsaW1pdChyZXNvdXJjZSBpbnQsIHJsaW0gKlJsaW1pdCkgKGVyciBlcnJvcikKLy9zeXNuYglHZXR1aWQoKSAodWlkIGludCkKLy9zeXMJTGNob3duKHBhdGggc3RyaW5nLCB1aWQgaW50LCBnaWQgaW50KSAoZXJyIGVycm9yKQovL3N5cwlMaXN0ZW4ocyBpbnQsIG4gaW50KSAoZXJyIGVycm9yKQovL3N5cwlQYXVzZSgpIChlcnIgZXJyb3IpCi8vc3lzCXByZWFkKGZkIGludCwgcCBbXWJ5dGUsIG9mZnNldCBpbnQ2NCkgKG4gaW50LCBlcnIgZXJyb3IpID0gU1lTX1BSRUFENjQKLy9zeXMJcHdyaXRlKGZkIGludCwgcCBbXWJ5dGUsIG9mZnNldCBpbnQ2NCkgKG4gaW50LCBlcnIgZXJyb3IpID0gU1lTX1BXUklURTY0Ci8vc3lzCVJlbmFtZWF0KG9sZGRpcmZkIGludCwgb2xkcGF0aCBzdHJpbmcsIG5ld2RpcmZkIGludCwgbmV3cGF0aCBzdHJpbmcpIChlcnIgZXJyb3IpCi8vc3lzCVNlZWsoZmQgaW50LCBvZmZzZXQgaW50NjQsIHdoZW5jZSBpbnQpIChvZmYgaW50NjQsIGVyciBlcnJvcikgPSBTWVNfTFNFRUsKCmZ1bmMgU2VsZWN0KG5mZCBpbnQsIHIgKkZkU2V0LCB3ICpGZFNldCwgZSAqRmRTZXQsIHRpbWVvdXQgKlRpbWV2YWwpIChuIGludCwgZXJyIGVycm9yKSB7Cgl2YXIgdHMgKlRpbWVzcGVjCglpZiB0aW1lb3V0ICE9IG5pbCB7CgkJdHMgPSAmVGltZXNwZWN7U2VjOiB0aW1lb3V0LlNlYywgTnNlYzogdGltZW91dC5Vc2VjICogMTAwMH0KCX0KCXJldHVybiBwc2VsZWN0NihuZmQsIHIsIHcsIGUsIHRzLCBuaWwpCn0KCi8vc3lzCXNlbmRmaWxlKG91dGZkIGludCwgaW5mZCBpbnQsIG9mZnNldCAqaW50NjQsIGNvdW50IGludCkgKHdyaXR0ZW4gaW50LCBlcnIgZXJyb3IpCi8vc3lzCXNldGZzZ2lkKGdpZCBpbnQpIChwcmV2IGludCwgZXJyIGVycm9yKQovL3N5cwlzZXRmc3VpZCh1aWQgaW50KSAocHJldiBpbnQsIGVyciBlcnJvcikKLy9zeXMJU2h1dGRvd24oZmQgaW50LCBob3cgaW50KSAoZXJyIGVycm9yKQovL3N5cwlTcGxpY2UocmZkIGludCwgcm9mZiAqaW50NjQsIHdmZCBpbnQsIHdvZmYgKmludDY0LCBsZW4gaW50LCBmbGFncyBpbnQpIChuIGludDY0LCBlcnIgZXJyb3IpCi8vc3lzCVN0YXRmcyhwYXRoIHN0cmluZywgYnVmICpTdGF0ZnNfdCkgKGVyciBlcnJvcikKLy9zeXMJU3luY0ZpbGVSYW5nZShmZCBpbnQsIG9mZiBpbnQ2NCwgbiBpbnQ2NCwgZmxhZ3MgaW50KSAoZXJyIGVycm9yKQovL3N5cwlUcnVuY2F0ZShwYXRoIHN0cmluZywgbGVuZ3RoIGludDY0KSAoZXJyIGVycm9yKQovL3N5cwlVc3RhdChkZXYgaW50LCB1YnVmICpVc3RhdF90KSAoZXJyIGVycm9yKQovL3N5cwlhY2NlcHQ0KHMgaW50LCByc2EgKlJhd1NvY2thZGRyQW55LCBhZGRybGVuICpfU29ja2xlbiwgZmxhZ3MgaW50KSAoZmQgaW50LCBlcnIgZXJyb3IpCi8vc3lzCWJpbmQocyBpbnQsIGFkZHIgdW5zYWZlLlBvaW50ZXIsIGFkZHJsZW4gX1NvY2tsZW4pIChlcnIgZXJyb3IpCi8vc3lzCWNvbm5lY3QocyBpbnQsIGFkZHIgdW5zYWZlLlBvaW50ZXIsIGFkZHJsZW4gX1NvY2tsZW4pIChlcnIgZXJyb3IpCi8vc3lzbmIJZ2V0Z3JvdXBzKG4gaW50LCBsaXN0ICpfR2lkX3QpIChubiBpbnQsIGVyciBlcnJvcikKLy9zeXNuYglzZXRncm91cHMobiBpbnQsIGxpc3QgKl9HaWRfdCkgKGVyciBlcnJvcikKLy9zeXMJZ2V0c29ja29wdChzIGludCwgbGV2ZWwgaW50LCBuYW1lIGludCwgdmFsIHVuc2FmZS5Qb2ludGVyLCB2YWxsZW4gKl9Tb2NrbGVuKSAoZXJyIGVycm9yKQovL3N5cwlzZXRzb2Nrb3B0KHMgaW50LCBsZXZlbCBpbnQsIG5hbWUgaW50LCB2YWwgdW5zYWZlLlBvaW50ZXIsIHZhbGxlbiB1aW50cHRyKSAoZXJyIGVycm9yKQovL3N5c25iCXNvY2tldChkb21haW4gaW50LCB0eXAgaW50LCBwcm90byBpbnQpZXN0IGlzbid0IGZ1bmRhbWVudGFsbHkgTGludXgtb25seSwgYnV0IGl0IG5lZWRzCgkJLy8gdG8ga25vdyBob3cgdG8gZW5hYmxlL2ZpbmQgY29yZSBmaWxlcyBvbiBlYWNoIE9TLgoJCXQuU2tpcCgiVGVzdCBvbmx5IHN1cHBvcnRlZCBvbiBMaW51eCIpCgl9CglpZiBydW50aW1lLkdPQVJDSCAhPSAiMzg2IiAmJiBydW50aW1lLkdPQVJDSCAhPSAiYW1kNjQiIHsKCQkvLyBUT0RPKGdvLmRldi9pc3N1ZS8yNTIxOCk6IE90aGVyIGFyY2hpdGVjdHVyZXMgdXNlIHNpZ3JldHVybgoJCS8vIHZpYSBWRFNPLCB3aGljaCB3ZSBzb21laG93IGRvbid0IGhhbmRsZSBjb3JyZWN0bHkuCgkJdC5Ta2lwKCJCYWNrdHJhY2UgdGhyb3VnaCBzaWduYWwgaGFuZGxlciBvbmx5IHdvcmtzIG9uIDM4NiBhbmQgYW1kNjQiKQoJfQoKCXRlc3RlbnYuU2tpcEZsYWt5KHQsIDY1MTM4KQoKCXRlc3RlbnYuTXVzdEhhdmVDR08odCkKCWNoZWNrR2RiRW52aXJvbm1lbnQodCkKCXQuUGFyYWxsZWwoKQoJY2hlY2tHZGJWZXJzaW9uKHQpCgoJY29yZVVzZXNQSUQgOj0gY2FuR2VuZXJhdGVDb3JlKHQpCgoJLy8gQnVpbGQgdGhlIHNvdXJjZSBjb2RlLgoJZGlyIDo9IHQuVGVtcERpcigpCglzcmMgOj0gZmlsZXBhdGguSm9pbihkaXIsICJtYWluLmdvIikKCWVyciA6PSBvcy5Xcml0ZUZpbGUoc3JjLCBbXWJ5dGUoY29yZUNyYXNoVGhyZWFkU291cmNlKSwgMDY0NCkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWxmKCJmYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICV2IiwgZXJyKQoJfQoJY21kIDo9IGV4ZWMuQ29tbWFuZCh0ZXN0ZW52LkdvVG9vbFBhdGgodCksICJidWlsZCIsICItbyIsICJhLmV4ZSIsICJtYWluLmdvIikKCWNtZC5EaXIgPSBkaXIKCW91dCwgZXJyIDo9IHRlc3RlbnYuQ2xlYW5DbWRFbnYoY21kKS5Db21iaW5lZE91dHB1dCgpCglpZiBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsZigiYnVpbGRpbmcgc291cmNlICV2XG4lcyIsIGVyciwgb3V0KQoJfQoKCS8vIFN0YXJ0IHRoZSB0ZXN0IGJpbmFyeS4KCWNtZCA9IHRlc3RlbnYuQ29tbWFuZCh0LCAiLi9hLmV4ZSIpCgljbWQuRGlyID0gZGlyCgl2YXIgb3V0cHV0IGJ5dGVzLkJ1ZmZlcgoJY21kLlN0ZG91dCA9ICZvdXRwdXQgLy8gZm9yIHRlc3QgbG9nZ2luZwoJY21kLlN0ZGVyciA9ICZvdXRwdXQKCglpZiBlcnIgOj0gY21kLlN0YXJ0KCk7IGVyciAhPSBuaWwgewoJCXQuRmF0YWxmKCJlcnJvciBzdGFydGluZyB0ZXN0IGJpbmFyeTogJXYiLCBlcnIpCgl9CgoJcGlkIDo9IGNtZC5Qcm9jZXNzLlBpZAoKCWVyciA9IGNtZC5XYWl0KCkKCXQuTG9nZigiY2hpbGQgb3V0cHV0OlxuJXMiLCBvdXRwdXQuU3RyaW5nKCkpCglpZiBlcnIgPT0gbmlsIHsKCQl0LkZhdGFsZigiV2FpdCBzdWNjZWVkZWQsIHdhbnQgU0lHQUJSVCIpCgl9CgllZSwgb2sgOj0gZXJyLigqZXhlYy5FeGl0RXJyb3IpCglpZiAhb2sgewoJCXQuRmF0YWxmKCJXYWl0IGVyciBnb3QgJVQgJXYsIHdhbnQgZXhlYy5FeGl0RXJyb3IiLCBlZSwgZWUpCgl9Cgl3cywgb2sgOj0gZWUuU3lzKCkuKHN5c2NhbGwuV2FpdFN0YXR1cykKCWlmICFvayB7CgkJdC5GYXRhbGYoIlN5cyBnb3QgJVQgJXYsIHdhbnQgc3lzY2FsbC5XYWl0U3RhdHVzIiwgZWUuU3lzKCksIGVlLlN5cygpKQoJfQoJaWYgd3MuU2lnbmFsKCkgIT0gc3lzY2FsbC5TSUdBQlJUIHsKCQl0LkZhdGFsZigiU2lnbmFsIGdvdCAlZCB3YW50IFNJR0FCUlQiLCB3cy5TaWduYWwoKSkKCX0KCWlmICF3cy5Db3JlRHVtcCgpIHsKCQl0LkZhdGFsZigiQ29yZUR1bXAgZ290ICV2IHdhbnQgdHJ1ZSIsIHdzLkNvcmVEdW1wKCkpCgl9CgoJY29yZUZpbGUgOj0gImNvcmUiCglpZiBjb3JlVXNlc1BJRCB7CgkJY29yZUZpbGUgKz0gZm10LlNwcmludGYoIi4lZCIsIHBpZCkKCX0KCgkvLyBFeGVjdXRlIGdkYiBjb21tYW5kcy4KCWFyZ3MgOj0gW11zdHJpbmd7Ii1ueCIsICItYmF0Y2giLAoJCSItaWV4IiwgImFkZC1hdXRvLWxvYS8vIGxpZ2h0d2VpZ2h0ICdzdm5zZXJ2ZScgYmluYXJ5IHRoYXQgaXMgdXN1YWxseSBwYWNrYWdlZCBhbG9uZyB3aXRoIHRoZSAnc3ZuJwovLyBjbGllbnQgYmluYXJ5LCB3aGVyZWFzIG9ubHkga25vd24gaW1wbGVtZW50YXRpb24gb2YgdGhlIFN1YnZlcnNpb24gSFRUUAovLyBwcm90b2NvbCBpcyB0aGUgbW9kX2Rhdl9zdm4gYXBhY2hlMiBtb2R1bGUuIEFwYWNoZTIgaGFzIGEgbG90IG9mIGRlcGVuZGVuY2llcwovLyBhbmQgYWxzbyBzZWVtcyB0byByZWx5IG9uIGdsb2JhbCBjb25maWd1cmF0aW9uIHZpYSB3ZWxsLWtub3duIGZpbGUgcGF0aHMsIHNvCi8vIGltcGxlbWVudGluZyBhIGhlcm1ldGljIHRlc3QgdXNpbmcgYXBhY2hlMiB3b3VsZCByZXF1aXJlIHRoZSB0ZXN0IHRvIHJ1biBpbiBhCi8vIGNvbXBsaWNhdGVkIGNvbnRhaW5lciBlbnZpcm9ubWVudCwgd2hpY2ggd291bGRuJ3QgYmUgbmVhcmx5IGFzCi8vIHN0cmFpZ2h0Zm9yd2FyZCBmb3IgR28gY29udHJpYnV0b3JzIHRvIHNldCB1cCBhbmQgdGVzdCBhZ2FpbnN0IG9uIHRoZWlyIGxvY2FsCi8vIG1hY2hpbmUuCnR5cGUgc3ZuSGFuZGxlciBzdHJ1Y3QgewoJc3ZuUm9vdCBzdHJpbmcgLy8gYSBkaXJlY3RvcnkgY29udGFpbmluZyBhbGwgc3ZuIHJlcG9zIHRvIGJlIHNlcnZlZAoJbG9nZ2VyICAqbG9nLkxvZ2dlcgoKCXBhdGhPbmNlICAgICBzeW5jLk9uY2UKCXN2bnNlcnZlUGF0aCBzdHJpbmcgLy8gdGhlIHBhdGggdG8gdGhlICdzdm5zZXJ2ZScgZXhlY3V0YWJsZQoJc3Zuc2VydmVFcnIgIGVycm9yCgoJbGlzdGVuT25jZSBzeW5jLk9uY2UKCXMgICAgICAgICAgY2hhbiAqc3ZuU3RhdGUgLy8gMS1idWZmZXJlZAp9CgovLyBBbiBzdm5TdGF0ZSBkZXNjcmliZXMgdGhlIHN0YXRlIG9mIGEgcG9ydCBzZXJ2aW5nIHRoZSAnc3ZuOi8vJyBwcm90b2NvbC4KdHlwZSBzdm5TdGF0ZSBzdHJ1Y3QgewoJbGlzdGVuZXIgIG5ldC5MaXN0ZW5lcgoJbGlzdGVuRXJyIGVycm9yCgljb25ucyAgICAgbWFwW25ldC5Db25uXXN0cnVjdHt9CgljbG9zaW5nICAgYm9vbAoJZG9uZSAgICAgIGNoYW4gc3RydWN0e30KfQoKZnVuYyAoaCAqc3ZuSGFuZGxlcikgQXZhaWxhYmxlKCkgYm9vbCB7CgloLnBhdGhPbmNlLkRvKGZ1bmMoKSB7CgkJaC5zdm5zZXJ2ZVBhdGgsIGguc3Zuc2VydmVFcnIgPSBleGVjLkxvb2tQYXRoKCJzdm5zZXJ2ZSIpCgl9KQoJcmV0dXJuIGguc3Zuc2VydmVFcnIgPT0gbmlsCn0KCi8vIEhhbmRsZXIgcmV0dXJucyBhbiBodHRwLkhhbmRsZXIgdGhhdCBjaGVja3MgZm9yIHRoZSAidmN3ZWJzdm4iIHF1ZXJ5Ci8vIHBhcmFtZXRlciBhbmQgdGhlbiBzZXJ2ZXMgdGhlICdzdm46Ly8nIFVSTCBmb3IgdGhlIHJlcG9zaXRvcnkgYXQgdGhlCi8vIHJlcXVlc3RlZCBwYXRoLgovLyBUaGUgSFRUUCBjbGllbnQgaXMgZXhwZWN0ZWQgdG8gcmVhZCB0aGF0IFVSTCBhbmQgcGFzcyBpdCB0byB0aGUgJ3N2bicgY2xpZW50LgpmdW5jIChoICpzdm5IYW5kbGVyKSBIYW5kbGVyKGRpciBzdHJpbmcsIGVudiBbXXN0cmluZywgbG9nZ2VyICpsb2cuTG9nZ2VyKSAoaHR0cC5IYW5kbGVyLCBlcnJvcikgewoJaWYgIWguQXZhaWxhYmxlKCkgewoJCXJldHVybiBuaWwsIFNlcnZlck5vdEluc3RhbGxlZEVycm9ye25hbWU6ICJzdm4ifQoJfQoKCS8vIEdvIGFoZWFkIGFuZCBzdGFydCB0aGUgbGlzdGVuZXIgbm93LCBzbyB0aGF0IGlmIGl0IGZhaWxzIChmb3IgZXhhbXBsZSwgZHVlCgkvLyB0byBwb3J0IGV4aGF1c3Rpb24pIHdlIGNhbiByZXR1cm4gYW4gZXJyb3IgZnJvbSB0aGUgSGFuZGxlciBtZXRob2QgaW5zdGVhZAoJLy8gb2Ygc2VydmluZyBhbiBlcnJvciBmb3IgZWFjaCBpbmRpdmlkdWFsIEhUVFAgcmVxdWVzdC4KCWgubGlzdGVuT25jZS5EbyhmdW5jKCkgewoJCWgucyA9IG1ha2UoY2hhbiAqc3ZuU3RhdGUsIDEpCgkJbCwgZXJyIDo9IG5ldC5MaXN0ZW4oInRjcCIsICJsb2NhbGhvc3Q6MCIpCgkJZG9uZSA6PWZzLk1vZGVEaXIKCWNhc2UgVHlwZUZpZm86CgkJbW9kZSB8PSBmcy5Nb2RlTmFtZWRQaXBlCgl9CgoJcmV0dXJuIG1vZGUKfQoKZnVuYyAoZmkgaGVhZGVyRmlsZUluZm8pIFN0cmluZygpIHN0cmluZyB7CglyZXR1cm4gZnMuRm9ybWF0RmlsZUluZm8oZmkpCn0KCi8vIHN5c1N0YXQsIGlmIG5vbi1uaWwsIHBvcHVsYXRlcyBoIGZyb20gc3lzdGVtLWRlcGVuZGVudCBmaWVsZHMgb2YgZmkuCnZhciBzeXNTdGF0IGZ1bmMoZmkgZnMuRmlsZUluZm8sIGggKkhlYWRlciwgZG9OYW1lTG9va3VwcyBib29sKSBlcnJvcgoKY29uc3QgKAoJLy8gTW9kZSBjb25zdGFudHMgZnJvbSB0aGUgVVNUQVIgc3BlYzoKCS8vIFNlZSBodHRwOi8vcHVicy5vcGVuZ3JvdXAub3JnL29ubGluZXB1YnMvOTY5OTkxOTc5OS91dGlsaXRpZXMvcGF4Lmh0bWwjdGFnXzIwXzkyXzEzXzA2CgljX0lTVUlEID0gMDQwMDAgLy8gU2V0IHVpZAoJY19JU0dJRCA9IDAyMDAwIC8vIFNldCBnaWQKCWNfSVNWVFggPSAwMTAwMCAvLyBTYXZlIHRleHQgKHN0aWNreSBiaXQpCgoJLy8gQ29tbW9uIFVuaXggbW9kZSBjb25zdGFudHM7IHRoZXNlIGFyZSBub3QgZGVmaW5lZCBpbiBhbnkgY29tbW9uIHRhciBzdGFuZGFyZC4KCS8vIEhlYWRlci5GaWxlSW5mbyB1bmRlcnN0YW5kcyB0aGVzZSwgYnV0IEZpbGVJbmZvSGVhZGVyIHdpbGwgbmV2ZXIgcHJvZHVjZSB0aGVzZS4KCWNfSVNESVIgID0gMDQwMDAwICAvLyBEaXJlY3RvcnkKCWNfSVNGSUZPID0gMDEwMDAwICAvLyBGSUZPCgljX0lTUkVHICA9IDAxMDAwMDAgLy8gUmVndWxhciBmaWxlCgljX0lTTE5LICA9IDAxMjAwMDAgLy8gU3ltYm9saWMgbGluawoJY19JU0JMSyAgPSAwNjAwMDAgIC8vIEJsb2NrIHNwZWNpYWwgZmlsZQoJY19JU0NIUiAgPSAwMjAwMDAgIC8vIENoYXJhY3RlciBzcGVjaWFsIGZpbGUKCWNfSVNTT0NLID0gMDE0MDAwMCAvLyBTb2NrZXQKKQoKLy8gRmlsZUluZm9IZWFkZXIgY3JlYXRlcyBhIHBhcnRpYWxseS1wb3B1bGF0ZWQgW0hlYWRlcl0gZnJvbSBmaS4KLy8gSWYgZmkgZGVzY3JpYmVzIGEgc3ltbGluaywgRmlsZUluZm9IZWFkZXIgcmVjb3JkcyBsaW5rIGFzIHRoZSBsaW5rIHRhcmdldC4KLy8gSWYgZmkgZGVzY3JpYmVzIGEgZGlyZWN0b3J5LCBhIHNsYXNoIGlzIGFwcGVuZGVkIHRvIHRoZSBuYW1lLgovLwovLyBTaW5jZSBmcy5GaWxlSW5mbydzIE5hbWUgbWV0aG9kIG9ubHkgcmV0dXJucyB0aGUgYmFzZSBuYW1lIG9mCi8vIHRoZSBmaWxlIGl0IGRlc2NyaWJlcywgaXQgbWF5IGJlIG5lY2Vzc2FyeSB0byBtb2RpZnkgSGVhZGVyLk5hbWUKLy8gdG8gcHJvdmlkZSB0aGUgZnVsbCBwYXRoIG5hbWUgb2YgdGhlIGZpbGUuCi8vCi8vIElmIGZpIGltcGxlbWVudHMgW0ZpbGVJbmZvTmFtZXNdCi8vIEhlYWRlci5HbmFtZSBhbmQgSGVhZGVyLlVuYW1lCi8vIGFyZSBwcm92aWRlZCBieSB0aGUgbWV0aG9kcyBvZiB0aGUgaW50ZXJmYWNlLgpmdW5jIEZpbGVJbmZvSGVhZGVyKGZpIGZzLkZpbGVJbmZvLCBsaW5rIHN0cmluZykgKCpIZWFkZXIsIGVycm9yKSB7CglpZiBmaSA9PSBuaWwgewoJCXJldHVybiBuaWwsIGVycm9ycy5OZXcoImFyY2hpdmUvdGFyOiBGaWxlSW5mbyBpcyBuaWwiKQoJfQoJZm0gOj0gZmkuTW9kZSgpCgloIDo9ICZIZWFkZXJ7CgkJTmFtZTogICAgZmkuTmFtZSgpLAoJCU1vZFRpbWU6IGZpLk1vZFRpbWUoKSwKCQlNb2RlOiAgICBpbnQ2NChmbS5QZXJtKCkpLCAvLyBvcidkIHdpdGggY19JUyogY29uc3RhbnRzIGxhdGVyCgl9Cglzd2l0Y2ggewoJY2FzZSBmbS5Jc1JlZ3VsYXIoKToKCQloLlR5cGVmbGFnID0gVHlwZVJlZwoJCWguU2l6ZSA9IGZpLlNpemUoKQoJY2FzZSBmaS5Jc0RpcigpOgoJCWguVHlwZWZsYWcgPSBUeXBlRGlyCgkJaC5OYW1lICs9ICIvIgoJY2FzZSBmbSZmcy5Nb2RlU3ltbGluayAhPSAwOgoJCWguVHlwZWZsYWcgPSBUeXBlU3ltbGluawoJCWguTGlua25hbWUgPSBsaW5rCgljYXMgZHVtcC4KCQkJaW8uQ29weShpby5EaXNjYXJkLCByZXEuQm9keSkKCQkJcmVxLkJvZHkuQ2xvc2UoKQoJCX0KCQlzZWxlY3QgewoJCWNhc2UgZHIuYyA8LSBzdHJpbmdzLk5ld1JlYWRlcigiSFRUUC8xLjEgMjA0IE5vIENvbnRlbnRcclxuQ29ubmVjdGlvbjogY2xvc2VcclxuXHJcbiIpOgoJCWNhc2UgPC1xdWl0UmVhZENoOgoJCQkvLyBFbnN1cmUgZGVsZWdhdGVSZWFkZXIuUmVhZCBkb2Vzbid0IGJsb2NrIGZvcmV2ZXIgaWYgd2UgZ2V0IGFuIGVycm9yLgoJCQljbG9zZShkci5jKQoJCX0KCX0oKQoKCV8sIGVyciA6PSB0LlJvdW5kVHJpcChyZXFTZW5kKQoKCXJlcS5Cb2R5ID0gc2F2ZQoJaWYgZXJyICE9IG5pbCB7CgkJZHIuZXJyID0gZXJyCgkJY2xvc2UocXVpdFJlYWRDaCkKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCWR1bXAgOj0gYnVmLkJ5dGVzKCkKCgkvLyBJZiB3ZSB1c2VkIGEgZHVtbXkgYm9keSBhYm92ZSwgcmVtb3ZlIGl0IG5vdy4KCS8vIFRPRE86IGlmIHRoZSByZXEuQ29udGVudExlbmd0aCBpcyBsYXJnZSwgd2UgYWxsb2NhdGUgbWVtb3J5CgkvLyB1bm5lY2Vzc2FyaWx5IGp1c3QgdG8gc2xpY2UgaXQgb2ZmIGhlcmUuIEJ1dCB0aGlzIGlzIGp1c3QKCS8vIGEgZGVidWcgZnVuY3Rpb24sIHNvIHRoaXMgaXMgYWNjZXB0YWJsZSBmb3Igbm93LiBXZSBjb3VsZAoJLy8gZGlzY2FyZCB0aGUgYm9keSBlYXJsaWVyIGlmIHRoaXMgbWF0dGVycy4KCWlmIGR1bW15Qm9keSB7CgkJaWYgaSA6PSBieXRlcy5JbmRleChkdW1wLCBbXWJ5dGUoIlxyXG5cclxuIikpOyBpID49IDAgewoJCQlkdW1wID0gZHVtcFs6aSs0XQoJCX0KCX0KCXJldHVybiBkdW1wLCBuaWwKfQoKLy8gZGVsZWdhdGVSZWFkZXIgaXMgYSByZWFkZXIgdGhhdCBkZWxlZ2F0ZXMgdG8gYW5vdGhlciByZWFkZXIsCi8vIG9uY2UgaXQgYXJyaXZlcyBvbiBhIGNoYW5uZWwuCnR5cGUgZGVsZWdhdGVSZWFkZXIgc3RydWN0IHsKCWMgICBjaGFuIGlvLlJlYWRlcgoJZXJyIGVycm9yICAgICAvLyBvbmx5IHVzZWQgaWYgciBpcyBuaWwgYW5kIGMgaXMgY2xvc2VkLgoJciAgIGlvLlJlYWRlciAvLyBuaWwgdW50aWwgcmVjZWl2ZWQgZnJvbSBjCn0KCmZ1bmMgKHIgKmRlbGVnYXRlUmVhZGVyKSBSZWFkKHAgW11ieXRlKSAoaW50LCBlcnJvcikgewoJaWYgci5yID09IG5pbCB7CgkJdmFyIG9rIGJvb2wKCQlpZiByLnIsIG9rID0gPC1yLmM7ICFvayB7CgkJCXJldHVybiAwLCByLmVycgoJCX0KCX0KCXJldHVybiByLnIuUmVhZChwKQp9CgovLyBSZXR1cm4gdmFsdWUgaWYgbm9uZW1wdHksIGRlZiBvdGhlcndpc2UuCmZ1bmMgdmFsdWVPckRlZmF1bHQodmFsdWUsIGRlZiBzdHJpbmcpIHN0cmluZyB7CglpZiB2YWx1ZSAhPSAiIiB7CgkJcmV0dXJuIHZhbHVlCgl9CglyZXR1cm4gZGVmCn0KCnZhciByZXFXcml0ZUV4Y2x1ZGVIZWFkZXJEdW1wID0gbWFwW3N0cmluZ11ib29sewoJIkhvc3QiOiAgICAgICAgICAgICAgdHJ1ZSwgLy8gbm90IGluIEhlYWRlciBtYXAgYW55d2F5CgkiVHJhbnNmZXItRW5jb2RpbmciOiB0cnVlLAoJIlRyYWlsZXIiOiAgICAgICAgICAgdHJ1ZSwKfQoKLy8gRHVtcFJlcXVlc3QgcmV0dXJucyB0aGUgZ2l2ZW4gcmVxdWVzdCBpbiBpdHMgSFRUUC8xLnggd2lyZQovLyByZXByZXNlbnRhdGlvbi4gSXQgc2hvdWxkIG9ubHkgYmUgdXNlZCBieSBzZXJ2ZXJzIHRvIGRlYnVnIGNsaWVudAovLyByZXF1ZXN0cy4gVGhlIHJldHVybmVkIHJlcHJlc2VudGF0aW9uIGlzIGFuIGFwcHJveGltYXRpb24gb25seTsKLy8gc29tZSBkZXRhaWxzIG9mIHRoZSBpbml0aWFsIHJlcXVlc3QgYXJlIGxvc3Qgd2hpbGUgcGFyc2luZyBpdCBpbnRvCi8vIGFuIFtodHRwLlJlcXVlc3RdLiBJbiBwYXJ0aWN1bGFyLCB0aGUgb3JkZXIgYW5kIGNhc2Ugb2YgaGVhZGVyIGZpZWxkCi8vIG5hbWVzIGFyZSBsb3N0LiBUaGUgb3JkZXIgb2YgdmFsdWVzIGluIG11bHRpLXZhbHVlZCBoZWFkZXJzIGlzIGtlcHQKdGVyKSBGbHVzaCgpIHsKCS8vIFdyaXRlIGFueSByZW1haW5pbmcgcGFydGlhbCBsaW5lIHRvIHRoZSB1bmRlcmx5aW5nIHdyaXRlci4KCWlmIGYubGluZUJ1Zi5MZW4oKSA+IDAgewoJCWYudy5Xcml0ZShmLmxpbmVCdWYuQnl0ZXMoKSkKCQlmLmxpbmVCdWYuUmVzZXQoKQoJfQp9CgpmdW5jIChmICp0ZXN0SlNPTkZpbHRlcikgcHJvY2VzcyhsaW5lIFtdYnl0ZSkgewoJaWYgbGVuKGxpbmUpID4gMCAmJiBsaW5lWzBdID09ICd7JyB7CgkJLy8gUGxhdXNpYmxlIHRlc3QyanNvbiBvdXRwdXQuIFBhcnNlIGl0IGdlbmVyaWNhbGx5LgoJCS8vCgkJLy8gV2UgZ28gdG8gc29tZSBlZmZvcnQgaGVyZSB0byBwcmVzZXJ2ZSBrZXkgb3JkZXIgd2hpbGUgZG9pbmcgdGhpcwoJCS8vIGdlbmVyaWNhbGx5LiBUaGlzIHdpbGwgc3RheSByb2J1c3QgdG8gY2hhbmdlcyBpbiB0aGUgdGVzdDJqc29uCgkJLy8gc3RydWN0LCBvciBvdGhlciBhZGRpdGlvbnMgb3V0c2lkZSBvZiBpdC4gSWYgaHVtYW5zIGFyZSBldmVyIGxvb2tpbmcKCQkvLyBhdCB0aGUgb3V0cHV0LCBpdCdzIHJlYWxseSBuaWNlIHRvIGtlZXAgZmllbGQgb3JkZXIgYmVjYXVzZSBpdAoJCS8vIHByZXNlcnZlcyBhIGxvdCBvZiByZWd1bGFyaXR5IGluIHRoZSBvdXRwdXQuCgkJZGVjIDo9IGpzb24uTmV3RGVjb2RlcihieXRlcy5OZXdCdWZmZXIobGluZSkpCgkJZGVjLlVzZU51bWJlcigpCgkJdmFsLCBlcnIgOj0gZGVjb2RlSlNPTlZhbHVlKGRlYykKCQlpZiBlcnIgPT0gbmlsICYmIHZhbC5hdG9tID09IGpzb24uRGVsaW0oJ3snKSB7CgkJCS8vIFJld3JpdGUgdGhlIFBhY2thZ2UgZmllbGQuCgkJCWZvdW5kIDo9IGZhbHNlCgkJCWZvciBpIDo9IDA7IGkgPCBsZW4odmFsLnNlcSk7IGkgKz0gMiB7CgkJCQlpZiB2YWwuc2VxW2ldLmF0b20gPT0gIlBhY2thZ2UiIHsKCQkJCQlpZiBwa2csIG9rIDo9IHZhbC5zZXFbaSsxXS5hdG9tLihzdHJpbmcpOyBvayB7CgkJCQkJCXZhbC5zZXFbaSsxXS5hdG9tID0gcGtnICsgIjoiICsgZi52YXJpYW50CgkJCQkJCWZvdW5kID0gdHJ1ZQoJCQkJCQlicmVhawoJCQkJCX0KCQkJCX0KCQkJfQoJCQlpZiBmb3VuZCB7CgkJCQlkYXRhLCBlcnIgOj0ganNvbi5NYXJzaGFsKHZhbCkKCQkJCWlmIGVyciAhPSBuaWwgewoJCQkJCS8vIFNob3VsZCBuZXZlciBoYXBwZW4uCgkJCQkJcGFuaWMoZm10LlNwcmludGYoImZhaWxlZCB0byByb3VuZC10cmlwIEpTT04gJXE6ICVzIiwgbGluZSwgZXJyKSkKCQkJCX0KCQkJCWYudy5Xcml0ZShkYXRhKQoJCQkJLy8gQ29weSBhbnkgdHJhaWxpbmcgdGV4dC4gV2UgZXhwZWN0IGF0IG1vc3QgYSAiXG4iIGhlcmUsIGJ1dAoJCQkJLy8gdGhlcmUgY291bGQgYmUgb3RoZXIgdGV4dCBhbmQgd2Ugd2FudCB0byBmZWVkIHRoYXQgdGhyb3VnaC4KCQkJCWlvLkNvcHkoZi53LCBkZWMuQnVmZmVyZWQoKSkKCQkJCXJldHVybgoJCQl9CgkJfQoJfQoKCS8vIFNvbWV0aGluZyB3ZW50IHdyb25nLiBKdXN0IHBhc3MgdGhlIGxpbmUgdGhyb3VnaC4KCWYudy5Xcml0ZShsaW5lKQp9Cgp0eXBlIGpzb25WYWx1ZSBzdHJ1Y3QgewoJYXRvbSBqc29uLlRva2VuICAvLyBJZiBqc29uLkRlbGltLCB0aGVuIHNlcSB3aWxsIGJlIGZpbGxlZAoJc2VxICBbXWpzb25WYWx1ZSAvLyBJZiBhdG9tID09IGpzb24uRGVsaW0oJ3snKSwgYWx0ZXJuYXRpbmcgcGFpcnMKfQoKdmFyIGpzb25Qb3AgPSBlcnJvcnMuTmV3KCJlbmQgb2YgSlNPTiBzZXF1ZW5jZSIpCgpmdW5jIGRlY29kZUpTT05WYWx1ZShkZWMgKmpzb24uRGVjb2RlcikgKGpzb25WYWx1ZSwgZXJyb3IpIHsKCXQsIGVyciA6PSBkZWMuVG9rZW4oKQoJaWYgZXJyICE9IG5pbCB7CgkJaWYgZXJyID09IGlvLkVPRiB7CgkJCWVyciA9IGlvLkVyclVuZXhwZWN0ZWRFT0YKCQl9CgkJcmV0dXJuIGpzb25WYWx1ZXt9LCBlcnIKCX0KCglzd2l0Y2ggdCA6PSB0Lih0eXBlKSB7CgljYXNlIGpzb24uRGVsaW06CgkJaWYgdCA9PSAnfXRlLCBvZmYgaW50NjQpIChuIGludCwgZXJyIGVycm9yKSB7CglpZiBlcnIgOj0gZi53cml0ZUxvY2soKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIDAsIGVycgoJfQoJZGVmZXIgZi53cml0ZVVubG9jaygpCglpZiBsZW4oYikgPT0gMCB7CgkJcmV0dXJuIDAsIG5pbAoJfQoJcmV0dXJuIGZpeENvdW50KHN5c2NhbGwuUHdyaXRlKGYuc3lzZmQsIGIsIG9mZikpCn0KCi8vIHNlZWsgc2V0cyB0aGUgb2Zmc2V0IGZvciB0aGUgbmV4dCBSZWFkIG9yIFdyaXRlIG9uIGZpbGUgdG8gb2Zmc2V0LCBpbnRlcnByZXRlZAovLyBhY2NvcmRpbmcgdG8gd2hlbmNlOiAwIG1lYW5zIHJlbGF0aXZlIHRvIHRoZSBvcmlnaW4gb2YgdGhlIGZpbGUsIDEgbWVhbnMKLy8gcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgb2Zmc2V0LCBhbmQgMiBtZWFucyByZWxhdGl2ZSB0byB0aGUgZW5kLgovLyBJdCByZXR1cm5zIHRoZSBuZXcgb2Zmc2V0IGFuZCBhbiBlcnJvciwgaWYgYW55LgpmdW5jIChmICpGaWxlKSBzZWVrKG9mZnNldCBpbnQ2NCwgd2hlbmNlIGludCkgKHJldCBpbnQ2NCwgZXJyIGVycm9yKSB7CglpZiBlcnIgOj0gZi5pbmNyZWYoIiIpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gMCwgZXJyCgl9CglkZWZlciBmLmRlY3JlZigpCgkvLyBGcmVlIGNhY2hlZCBkaXJpbmZvLCBzbyB3ZSBhbGxvY2F0ZSBhIG5ldyBvbmUgaWYgd2UKCS8vIGFjY2VzcyB0aGlzIGZpbGUgYXMgYSBkaXJlY3RvcnkgYWdhaW4uIFNlZSAjMzU3NjcgYW5kICMzNzE2MS4KCWYuZGlyaW5mby5TdG9yZShuaWwpCglyZXR1cm4gc3lzY2FsbC5TZWVrKGYuc3lzZmQsIG9mZnNldCwgd2hlbmNlKQp9CgovLyBUcnVuY2F0ZSBjaGFuZ2VzIHRoZSBzaXplIG9mIHRoZSBuYW1lZCBmaWxlLgovLyBJZiB0aGUgZmlsZSBpcyBhIHN5bWJvbGljIGxpbmssIGl0IGNoYW5nZXMgdGhlIHNpemUgb2YgdGhlIGxpbmsncyB0YXJnZXQuCi8vIElmIHRoZXJlIGlzIGFuIGVycm9yLCBpdCB3aWxsIGJlIG9mIHR5cGUgWypQYXRoRXJyb3JdLgpmdW5jIFRydW5jYXRlKG5hbWUgc3RyaW5nLCBzaXplIGludDY0KSBlcnJvciB7Cgl2YXIgZCBzeXNjYWxsLkRpcgoKCWQuTnVsbCgpCglkLkxlbmd0aCA9IHNpemUKCgl2YXIgYnVmIFtzeXNjYWxsLlNUQVRGSVhMRU5dYnl0ZQoJbiwgZXJyIDo9IGQuTWFyc2hhbChidWZbOl0pCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gJlBhdGhFcnJvcntPcDogInRydW5jYXRlIiwgUGF0aDogbmFtZSwgRXJyOiBlcnJ9Cgl9CglpZiBlcnIgPSBzeXNjYWxsLldzdGF0KG5hbWUsIGJ1Zls6bl0pOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gJlBhdGhFcnJvcntPcDogInRydW5jYXRlIiwgUGF0aDogbmFtZSwgRXJyOiBlcnJ9Cgl9CglyZXR1cm4gbmlsCn0KCi8vIFJlbW92ZSByZW1vdmVzIHRoZSBuYW1lZCBmaWxlIG9yIGRpcmVjdG9yeS4KLy8gSWYgdGhlcmUgaXMgYW4gZXJyb3IsIGl0IHdpbGwgYmUgb2YgdHlwZSBbKlBhdGhFcnJvcl0uCmZ1bmMgUmVtb3ZlKG5hbWUgc3RyaW5nKSBlcnJvciB7CglpZiBlIDo9IHN5c2NhbGwuUmVtb3ZlKG5hbWUpOyBlICE9IG5pbCB7CgkJcmV0dXJuICZQYXRoRXJyb3J7T3A6ICJyZW1vdmUiLCBQYXRoOiBuYW1lLCBFcnI6IGV9Cgl9CglyZXR1cm4gbmlsCn0KCmZ1bmMgcmVuYW1lKG9sZG5hbWUsIG5ld25hbWUgc3RyaW5nKSBlcnJvciB7CglkaXJuYW1lIDo9IG9sZG5hbWVbOmJ5dGVhbGcuTGFzdEluZGV4Qnl0ZVN0cmluZyhvbGRuYW1lLCAnLycpKzFdCglpZiBzdHJpbmdzbGl0ZS5IYXNQcmVmaXgobmV3bmFtZSwgZGlybmFtZSkgewoJCW5ld25hbWUgPSBuZXduYW1lW2xlbihkaXJuYW1lKTpdCgl9IGVsc2UgewoJCXJldHVybiAmTGlua0Vycm9yeyJyZW5hbWUiLCBvbGRuYW1lLCBuZXduYW1lLCBFcnJJbnZhbGlkfQoJfQoKCS8vIElmIG5ld25hbWUgc3RpbGwgY29udGFpbnMgc2xhc2hlcyBhZnRlciByZW1vdmluZyB0aGUgb2xkbmFtZQoJLy8gcHJlZml4LCB0aGVzaW9ucwoJbm9kZSwgZXJyIDo9IHBhcnNlci5QYXJzZUV4cHJGcm9tKGZzZXQsICJldmFsIiwgZXhwciwgMCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiBUeXBlQW5kVmFsdWV7fSwgZXJyCgl9CgoJaW5mbyA6PSAmSW5mb3sKCQlUeXBlczogbWFrZShtYXBbYXN0LkV4cHJdVHlwZUFuZFZhbHVlKSwKCX0KCWVyciA9IENoZWNrRXhwcihmc2V0LCBwa2csIHBvcywgbm9kZSwgaW5mbykKCXJldHVybiBpbmZvLlR5cGVzW25vZGVdLCBlcnIKfQoKLy8gQ2hlY2tFeHByIHR5cGUgY2hlY2tzIHRoZSBleHByZXNzaW9uIGV4cHIgYXMgaWYgaXQgaGFkIGFwcGVhcmVkIGF0IHBvc2l0aW9uCi8vIHBvcyBvZiBwYWNrYWdlIHBrZy4gW1R5cGVdIGluZm9ybWF0aW9uIGFib3V0IHRoZSBleHByZXNzaW9uIGlzIHJlY29yZGVkIGluCi8vIGluZm8uIFRoZSBleHByZXNzaW9uIG1heSBiZSBhbiBpZGVudGlmaWVyIGRlbm90aW5nIGFuIHVuaW5zdGFudGlhdGVkIGdlbmVyaWMKLy8gZnVuY3Rpb24gb3IgdHlwZS4KLy8KLy8gSWYgcGtnID09IG5pbCwgdGhlIFtVbml2ZXJzZV0gc2NvcGUgaXMgdXNlZCBhbmQgdGhlIHByb3ZpZGVkCi8vIHBvc2l0aW9uIHBvcyBpcyBpZ25vcmVkLiBJZiBwa2cgIT0gbmlsLCBhbmQgcG9zIGlzIGludmFsaWQsCi8vIHRoZSBwYWNrYWdlIHNjb3BlIGlzIHVzZWQuIE90aGVyd2lzZSwgcG9zIG11c3QgYmVsb25nIHRvIHRoZQovLyBwYWNrYWdlLgovLwovLyBBbiBlcnJvciBpcyByZXR1cm5lZCBpZiBwb3MgaXMgbm90IHdpdGhpbiB0aGUgcGFja2FnZSBvcgovLyBpZiB0aGUgbm9kZSBjYW5ub3QgYmUgdHlwZS1jaGVja2VkLgovLwovLyBOb3RlOiBbRXZhbF0gYW5kIENoZWNrRXhwciBzaG91bGQgbm90IGJlIHVzZWQgaW5zdGVhZCBvZiBydW5uaW5nIENoZWNrCi8vIHRvIGNvbXB1dGUgdHlwZXMgYW5kIHZhbHVlcywgYnV0IGluIGFkZGl0aW9uIHRvIENoZWNrLCBhcyB0aGVzZQovLyBmdW5jdGlvbnMgaWdub3JlIHRoZSBjb250ZXh0IGluIHdoaWNoIGFuIGV4cHJlc3Npb24gaXMgdXNlZCAoZS5nLiwgYW4KLy8gYXNzaWdubWVudCkuIFRodXMsIHRvcC1sZXZlbCB1bnR5cGVkIGNvbnN0YW50cyB3aWxsIHJldHVybiBhbgovLyB1bnR5cGVkIHR5cGUgcmF0aGVyIHRoYW4gdGhlIHJlc3BlY3RpdmUgY29udGV4dC1zcGVjaWZpYyB0eXBlLgpmdW5jIENoZWNrRXhwcihmc2V0ICp0b2tlbi5GaWxlU2V0LCBwa2cgKlBhY2thZ2UsIHBvcyB0b2tlbi5Qb3MsIGV4cHIgYXN0LkV4cHIsIGluZm8gKkluZm8pIChlcnIgZXJyb3IpIHsKCS8vIGRldGVybWluZSBzY29wZQoJdmFyIHNjb3BlICpTY29wZQoJaWYgcGtnID09IG5pbCB7CgkJc2NvcGUgPSBVbml2ZXJzZQoJCXBvcyA9IG5vcG9zCgl9IGVsc2UgaWYgIXBvcy5Jc1ZhbGlkKCkgewoJCXNjb3BlID0gcGtnLnNjb3BlCgl9IGVsc2UgewoJCS8vIFRoZSBwYWNrYWdlIHNjb3BlIGV4dGVudCAocG9zaXRpb24gaW5mb3JtYXRpb24pIG1heSBiZQoJCS8vIGluY29ycmVjdCAoZmlsZXMgc3ByZWFkIGFjcm9zcyBhIHdpZGUgcmFuZ2Ugb2YgZnNldAoJCS8vIHBvc2l0aW9ucykgLSBpZ25vcmUgaXQgYW5kIGp1c3QgY29uc2lkZXIgaXRzIGNoaWxkcmVuCgkJLy8gKGZpbGUgc2NvcGVzKS4KCQlmb3IgXywgZnNjb3BlIDo9IHJhbmdlIHBrZy5zY29wZS5jaGlsZHJlbiB7CgkJCWlmIHNjb3BlID0gZnNjb3BlLklubmVybW9zdChwb3MpOyBzY29wZSAhPSBuaWwgewoJCQkJYnJlYWsKCQkJfQoJCX0KCQlpZiBzY29wZSA9PSBuaWwgfHwgZGVidWcgewoJCQlzIDo9IHNjb3BlCgkJCWZvciBzICE9IG5pbCAmJiBzICE9IHBrZy5zY29wZSB7CgkJCQlzID0gcy5wYXJlbnQKCQkJfQoJCQkvLyBzID09IG5pbCB8fCBzID09IHBrZy5zY29wZQoJCQlpZiBzID09IG5pbCB7CgkJCQlyZXR1cm4gZm10LkVycm9yZigibm8gcG9zaXRpb24gJXMgZm91bmQgaW4gcGFja2FnZSAlcyIsIGZzZXQuUG9zaXRpb24ocG9zKSwgcGtnLm5hNV1pbnQ4CglOb2RlbmFtZSAgIFs2NV1pbnQ4CglSZWxlYXNlICAgIFs2NV1pbnQ4CglWZXJzaW9uICAgIFs2NV1pbnQ4CglNYWNoaW5lICAgIFs2NV1pbnQ4CglEb21haW5uYW1lIFs2NV1pbnQ4Cn0KCnR5cGUgVXN0YXRfdCBzdHJ1Y3QgewoJVGZyZWUgIGludDMyCglUaW5vZGUgdWludDMyCglGbmFtZSAgWzZdaW50OAoJRnBhY2sgIFs2XWludDgKfQoKdHlwZSBFcG9sbEV2ZW50IHN0cnVjdCB7CglFdmVudHMgdWludDMyCglGZCAgICAgaW50MzIKCVBhZCAgICBpbnQzMgp9Cgpjb25zdCAoCglfQVRfRkRDV0QgICAgICAgICAgICA9IC0weDY0CglfQVRfUkVNT1ZFRElSICAgICAgICA9IDB4MjAwCglfQVRfU1lNTElOS19OT0ZPTExPVyA9IDB4MTAwCglfQVRfRUFDQ0VTUyAgICAgICAgICA9IDB4MjAwCglfQVRfRU1QVFlfUEFUSCAgICAgICA9IDB4MTAwMAopCgp0eXBlIHBvbGxGZCBzdHJ1Y3QgewoJRmQgICAgICBpbnQzMgoJRXZlbnRzICBpbnQxNgoJUmV2ZW50cyBpbnQxNgp9Cgp0eXBlIFRlcm1pb3Mgc3RydWN0IHsKCUlmbGFnICAgICB1aW50MzIKCU9mbGFnICAgICB1aW50MzIKCUNmbGFnICAgICB1aW50MzIKCUxmbGFnICAgICB1aW50MzIKCUxpbmUgICAgICB1aW50OAoJQ2MgICAgICAgIFszMl11aW50OAoJUGFkX2Nnb18wIFszXWJ5dGUKCUlzcGVlZCAgICB1aW50MzIKCU9zcGVlZCAgICB1aW50MzIKfQoKY29uc3QgKAoJVklOVFIgICAgPSAweDAKCVZRVUlUICAgID0gMHgxCglWRVJBU0UgICA9IDB4MgoJVktJTEwgICAgPSAweDMKCVZFT0YgICAgID0gMHg0CglWVElNRSAgICA9IDB4NQoJVk1JTiAgICAgPSAweDYKCVZTV1RDICAgID0gMHg3CglWU1RBUlQgICA9IDB4OAoJVlNUT1AgICAgPSAweDkKCVZTVVNQICAgID0gMHhhCglWRU9MICAgICA9IDB4YgoJVlJFUFJJTlQgPSAweGMKCVZESVNDQVJEID0gMHhkCglWV0VSQVNFICA9IDB4ZQoJVkxORVhUICAgPSAweGYKCVZFT0wyICAgID0gMHgxMAoJSUdOQlJLICAgPSAweDEKCUJSS0lOVCAgID0gMHgyCglJR05QQVIgICA9IDB4NAoJUEFSTVJLICAgPSAweDgKCUlOUENLICAgID0gMHgxMAoJSVNUUklQICAgPSAweDIwCglJTkxDUiAgICA9IDB4NDAKCUlHTkNSICAgID0gMHg4MAoJSUNSTkwgICAgPSAweDEwMAoJSVVDTEMgICAgPSAweDIwMAoJSVhPTiAgICAgPSAweDQwMAoJSVhBTlkgICAgPSAweDgwMAoJSVhPRkYgICAgPSAweDEwMDAKCUlNQVhCRUwgID0gMHgyMDAwCglJVVRGOCAgICA9IDB4NDAwMAoJT1BPU1QgICAgPSAweDEKCU9MQ1VDICAgID0gMHgyCglPTkxDUiAgICA9IDB4NAoJT0NSTkwgICAgPSAweDgKCU9OT0NSICAgID0gMHgxMAoJT05MUkVUICAgPSAweDIwCglPRklMTCAgICA9IDB4NDAKCU9GREVMICAgID0gMHg4MAoJQjAgICAgICAgPSAweDAKCUI1MCAgICAgID0gMHgxCglCNzUgICAgICA9IDB4MgoJQjExMCAgICAgPSAweDMKCUIxMzQgICAgID0gMHg0CglCMTUwICAgICA9IDB4NQoJQjIwMCAgICAgPSAweDYKCUIzMDAgICAgID0gMHg3CglCNjAwICAgICA9IDB4OAoJQjEyMDAgICAgPSAweDkKCUIxODAwICAgID0gMHhhCglCMjQwMCAgICA9IDB4YgoJQjQ4MDAgICAgPSAweGMKCUI5NjAwICAgID0gMHhkCglCMTkyMDAgICA9IDB4ZQoJQjM4NDAwICAgPSAweGYKCUNTSVpFICAgID0gMHgzMAoJQ1M1ICAgICAgPSAweDAKCUNTNiAgICAgID0gMHgxMAoJQ1M3ICAgICAgPSAweDIwCglDUzggICAgICA9IDB4MzAKCUNTVE9QQiAgID0gMHg0MAoJQ1JFQUQgICAgPSAweDgwCglQQVJFTkIgICA9IDB4MTAwCglQQVJPREQgICA9IDB4MjAwCglIVVBDTCAgICA9IDB4NDAwCglDTE9DQUwgICA9IDB4ODAwCglCNTc2MDAgICA9IDB4MTAwMQoJQjExNTIwMCAgPSAweDEwMDIKCUIyMzA0MDAgID0gMHgxMDAzCglCNDYwODAwICA9IDB4MTAwNAoJQjUwMDAwMCAgPSAweDEwMDUKCUI1NzYwMDAgID0gMHgxMDA2CglCOTIxNjAwICA9IDB4MTAwNwoJQjEwMDAwMDAgPSAweDEwMDgKCUIxMXZlbnQoJmV2ZW50ewoJCUFjdGlvbjogIm91dHB1dCIsCgkJT3V0cHV0OiAoKnRleHRCeXRlcykoJm91dCksCgl9KQp9CgovLyB3cml0ZUV2ZW50IHdyaXRlcyBhIHNpbmdsZSBldmVudC4KLy8gSXQgYWRkcyB0aGUgcGFja2FnZSwgdGltZSAoaWYgcmVxdWVzdGVkKSwgYW5kIHRlc3QgbmFtZSAoaWYgbmVlZGVkKS4KZnVuYyAoYyAqQ29udmVydGVyKSB3cml0ZUV2ZW50KGUgKmV2ZW50KSB7CgllLlBhY2thZ2UgPSBjLnBrZwoJaWYgYy5tb2RlJlRpbWVzdGFtcCAhPSAwIHsKCQl0IDo9IHRpbWUuTm93KCkKCQllLlRpbWUgPSAmdAoJfQoJaWYgZS5UZXN0ID09ICIiIHsKCQllLlRlc3QgPSBjLnRlc3ROYW1lCgl9CglqcywgZXJyIDo9IGpzb24uTWFyc2hhbChlKQoJaWYgZXJyICE9IG5pbCB7CgkJLy8gU2hvdWxkIG5vdCBoYXBwZW4gLSBldmVudCBpcyB2YWxpZCBmb3IganNvbi5NYXJzaGFsLgoJCWZtdC5GcHJpbnRmKGMudywgInRlc3Rqc29uIGludGVybmFsIGVycm9yOiAldlxuIiwgZXJyKQoJCXJldHVybgoJfQoJanMgPSBhcHBlbmQoanMsICdcbicpCgljLncuV3JpdGUoanMpCn0KCi8vIEEgbGluZUJ1ZmZlciBpcyBhbiBJL08gYnVmZmVyIHRoYXQgcmVhY3RzIHRvIHdyaXRlcyBieSBpbnZva2luZwovLyBpbnB1dC1wcm9jZXNzaW5nIGNhbGxiYWNrcyBvbiB3aG9sZSBsaW5lcyBvciAoZm9yIGxvbmcgbGluZXMgdGhhdAovLyBoYXZlIGJlZW4gc3BsaXQpIGxpbmUgZnJhZ21lbnRzLgovLwovLyBJdCBzaG91bGQgYmUgaW5pdGlhbGl6ZWQgd2l0aCBiIHNldCB0byBhIGJ1ZmZlciBvZiBsZW5ndGggMCBidXQgbm9uLXplcm8gY2FwYWNpdHksCi8vIGFuZCBsaW5lIGFuZCBwYXJ0IHNldCB0byB0aGUgZGVzaXJlZCBpbnB1dCBwcm9jZXNzb3JzLgovLyBUaGUgbGluZUJ1ZmZlciB3aWxsIGNhbGwgbGluZSh4KSBmb3IgYW55IHdob2xlIGxpbmUgeCAoaW5jbHVkaW5nIHRoZSBmaW5hbCBuZXdsaW5lKQovLyB0aGF0IGZpdHMgZW50aXJlbHkgaW4gY2FwKGIpLiBJdCB3aWxsIGhhbmRsZSBpbnB1dCBsaW5lcyBsb25nZXIgdGhhbiBjYXAoYikgYnkKLy8gY2FsbGluZyBwYXJ0KHgpIGZvciBzZWN0aW9ucyBvZiB0aGUgbGluZS4gVGhlIGxpbmUgd2lsbCBiZSBzcGxpdCBhdCBVVEY4IGJvdW5kYXJpZXMsCi8vIGFuZCB0aGUgZmluYWwgY2FsbCB0byBwYXJ0IGZvciBhIGxvbmcgbGluZSBpbmNsdWRlcyB0aGUgZmluYWwgbmV3bGluZS4KdHlwZSBsaW5lQnVmZmVyIHN0cnVjdCB7CgliICAgIFtdYnl0ZSAgICAgICAvLyBidWZmZXIKCW1pZCAgYm9vbCAgICAgICAgIC8vIHdoZXRoZXIgd2UncmUgaW4gdGhlIG1pZGRsZSBvZiBhIGxvbmcgbGluZQoJbGluZSBmdW5jKFtdYnl0ZSkgLy8gbGluZSBjYWxsYmFjawoJcGFydCBmdW5jKFtdYnl0ZSkgLy8gcGFydGlhbCBsaW5lIGNhbGxiYWNrCn0KCi8vIHdyaXRlIHdyaXRlcyBiIHRvIHRoZSBidWZmZXIuCmZ1bmMgKGwgKmxpbmVCdWZmZXIpIHdyaXRlKGIgW11ieXRlKSB7Cglmb3IgbGVuKGIpID4gMCB7CgkJLy8gQ29weSB3aGF0IHdlIGNhbiBpbnRvIGwuYi4KCQltIDo9IGNvcHkobC5iW2xlbihsLmIpOmNhcChsLmIpXSwgYikKCQlsLmIgPSBsLmJbOmxlbihsLmIpK21dCgkJYiA9IGJbbTpdCgoJCS8vIFByb2Nlc3MgbGluZXMgaW4gbC5iLgoJCWkgOj0gMAoJCWZvciBpIDwgbGVuKGwuYikgewoJCQlqLCB3IDo9IGluZGV4RU9MKGwuYltpOl0pCgkJCWlmIGogPCAwIHsKCQkJCWlmICFsLm1pZCB7CgkJCQkJaWYgaiA6PSBieXRlcy5JbmRleEJ5dGUobC5iW2k6XSwgJ1x0Jyk7IGogPj0gMCB7CgkJCQkJCWlmIGlzQmVuY2htYXJrTmFtZShieXRlcy5UcmltUmlnaHQobC5iW2k6aStqXSwgIiAiKSkgewoJCQkJCQkJbC5wYXJ0KGwuYltpIDogaStqKzFdKQoJCQkJCQkJbC5taWQgPSB0cnVlCgkJCQkJCQlpICs9IGogKyAxCgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQlicmVhawoJCQl9CgkJCWUgOj0gaSArIGogKyB3CgkJCWl0aW1lOiB0cnVlfSwKCQl7c3JjOiAidHNhbjE1LmdvIiwgbmVlZHNSdW50aW1lOiB0cnVlfSwKCQl7c3JjOiAidHNhbl90cmFjZWJhY2tjdHh0IiwgbmVlZHNSdW50aW1lOiB0cnVlfSwgLy8gU3ViZGlyZWN0b3J5Cgl9Cglmb3IgXywgdGMgOj0gcmFuZ2UgY2FzZXMgewoJCXRjIDo9IHRjCgkJbmFtZSA6PSBzdHJpbmdzLlRyaW1TdWZmaXgodGMuc3JjLCAiLmdvIikKCQl0LlJ1bihuYW1lLCBmdW5jKHQgKnRlc3RpbmcuVCkgewoJCQl0LlBhcmFsbGVsKCkKCgkJCWRpciA6PSBuZXdUZW1wRGlyKHQpCgkJCWRlZmVyIGRpci5SZW1vdmVBbGwodCkKCgkJCW91dFBhdGggOj0gZGlyLkpvaW4obmFtZSkKCQkJbXVzdFJ1bih0LCBjb25maWcuZ29DbWQoImJ1aWxkIiwgIi1vIiwgb3V0UGF0aCwgIi4vIitzcmNQYXRoKHRjLnNyYykpKQoKCQkJY21kQXJncyA6PSBbXXN0cmluZ3tvdXRQYXRofQoJCQlpZiBnb29zID09ICJsaW51eCIgewoJCQkJLy8gRGlzYWJsZSBBU0xSIGZvciBUU0FOLiBTZWUgaHR0cHM6Ly9nby5kZXYvaXNzdWUvNTk0MTguCgkJCQlvdXQsIGVyciA6PSBleGVjLkNvbW1hbmQoInVuYW1lIiwgIi1tIikuT3V0cHV0KCkKCQkJCWlmIGVyciAhPSBuaWwgewoJCQkJCXQuRmF0YWxmKCJmYWlsZWQgdG8gcnVuIGB1bmFtZSAtbWA6ICV2IiwgZXJyKQoJCQkJfQoJCQkJYXJjaCA6PSBzdHJpbmdzLlRyaW1TcGFjZShzdHJpbmcob3V0KSkKCQkJCWlmIF8sIGVyciA6PSBleGVjLkNvbW1hbmQoInNldGFyY2giLCBhcmNoLCAiLVIiLCAidHJ1ZSIpLk91dHB1dCgpOyBlcnIgIT0gbmlsIHsKCQkJCQkvLyBTb21lIHN5c3RlbXMgZG9uJ3QgaGF2ZSBwZXJtaXNzaW9uIHRvIHJ1biBgc2V0YXJjaGAuCgkJCQkJLy8gU2VlIGh0dHBzOi8vZ28uZGV2L2lzc3VlLzcwNDYzLgoJCQkJCXQuTG9nZigiZmFpbGVkIHRvIHJ1biBgc2V0YXJjaCAlcyAtUiB0cnVlYDogJXYiLCBhcmNoLCBlcnIpCgkJCQl9IGVsc2UgewoJCQkJCWNtZEFyZ3MgPSBbXXN0cmluZ3sic2V0YXJjaCIsIGFyY2gsICItUiIsIG91dFBhdGh9CgkJCQl9CgkJCX0KCQkJY21kIDo9IGhhbmdQcm9uZUNtZChjbWRBcmdzWzBdLCBjbWRBcmdzWzE6XS4uLikKCQkJaWYgdGMubmVlZHNSdW50aW1lIHsKCQkJCWNvbmZpZy5za2lwSWZSdW50aW1lSW5jb21wYXRpYmxlKHQpCgkJCX0KCQkJLy8gSWYgd2UgZG9uJ3Qgc2VlIGhhbHRfb25fZXJyb3IsIHRoZSBwcm9ncmFtCgkJCS8vIHdpbGwgb25seSBleGl0IG5vbi16ZXJvIGlmIHdlIGNhbGwgQy5leGl0LgoJCQljbWQuRW52ID0gYXBwZW5kKGNtZC5FbnZpcm9uKCksICJUU0FOX09QVElPTlM9aGFsdF9vbl9lcnJvcj0xIikKCQkJbXVzdFJ1bih0LCBjbWQpCgkJfSkKCX0KfQovLyBDb3B5cmlnaHQgMjAxNSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gVGVzdHMgc2hvcnQgY2lyY3VpdGluZy4KCnBhY2thZ2UgbWFpbgoKaW1wb3J0ICJ0ZXN0aW5nIgoKZnVuYyBhbmRfc3NhKGFyZzEsIGFyZzIgYm9vbCkgYm9vbCB7CglyZXR1cm4gYXJnMSAmJiByaWdodENhbGwoYXJnMikKfQoKZnVuYyBvcl9zc2EoYXJnMSwgYXJnMiBib29sKSBib29sIHsKCXJldHVybiBhcmcxIHx8IHJpZ2h0Q2FsbChhcmcyKQp9Cgp2YXIgcmlnaHRDYWxsZWQgYm9vbAoKLy9nbzpub2lubGluZQpmdW5jIHJpZ2h0Q2FsbCh2IGJvb2wpIGJvb2wgewoJcmlnaHRDYWxsZWQgPSB0cnVlCglyZXR1cm4gdgoJcGFuaWMoInVucmVhY2hlZCIpCn0KCmZ1bmMgdGVzdEFuZCh0ICp0ZXN0aW5nLlQsIGFyZzEsIGFyZzIsIHdhbnRSZXMgYm9vbCkgewoJdGVzdFNob3J0Q2lyY3VpdCh0LCAiQU5EIiwgYXJnMSwgYXJnMiwgYW5kX3NzYSwgYXJnMSwgd2FudFJlcykKfQpmdW5jIHRlc3RPcih0ICp0LAoJezUyLCAiRVhGVUxMIiwgImV4Y2hhbmdlIGZ1bGwifSwKCXs1MywgIkVOT0FOTyIsICJubyBhbm9kZSJ9LAoJezU0LCAiRUJBRFJRQyIsICJpbnZhbGlkIHJlcXVlc3QgY29kZSJ9LAoJezU1LCAiRUJBRFNMVCIsICJpbnZhbGlkIHNsb3QifSwKCXs1NiwgIkVERUFETE9DSyIsICJmaWxlIGxvY2tpbmcgZGVhZGxvY2sgZXJyb3IifSwKCXs1OSwgIkVCRk9OVCIsICJiYWQgZm9udCBmaWxlIGZvcm1hdCJ9LAoJezYwLCAiRU5PU1RSIiwgImRldmljZSBub3QgYSBzdHJlYW0ifSwKCXs2MSwgIkVOT0RBVEEiLCAibm8gZGF0YSBhdmFpbGFibGUifSwKCXs2MiwgIkVUSU1FIiwgInRpbWVyIGV4cGlyZWQifSwKCXs2MywgIkVOT1NSIiwgIm91dCBvZiBzdHJlYW1zIHJlc291cmNlcyJ9LAoJezY0LCAiRU5PTkVUIiwgIm1hY2hpbmUgaXMgbm90IG9uIHRoZSBuZXR3b3JrIn0sCgl7NjUsICJFTk9QS0ciLCAicGFja2FnZSBub3QgaW5zdGFsbGVkIn0sCgl7NjYsICJFUkVNT1RFIiwgIm9iamVjdCBpcyByZW1vdGUifSwKCXs2NywgIkVOT0xJTksiLCAibGluayBoYXMgYmVlbiBzZXZlcmVkIn0sCgl7NjgsICJFQURWIiwgImFkdmVydGlzZSBlcnJvciJ9LAoJezY5LCAiRVNSTU5UIiwgInNybW91bnQgZXJyb3IifSwKCXs3MCwgIkVDT01NIiwgImNvbW11bmljYXRpb24gZXJyb3Igb24gc2VuZCJ9LAoJezcxLCAiRVBST1RPIiwgInByb3RvY29sIGVycm9yIn0sCgl7NzMsICJFRE9URE9UIiwgIlJGUyBzcGVjaWZpYyBlcnJvciJ9LAoJezc0LCAiRU1VTFRJSE9QIiwgIm11bHRpaG9wIGF0dGVtcHRlZCJ9LAoJezc3LCAiRUJBRE1TRyIsICJiYWQgbWVzc2FnZSJ9LAoJezc4LCAiRU5BTUVUT09MT05HIiwgImZpbGUgbmFtZSB0b28gbG9uZyJ9LAoJezc5LCAiRU9WRVJGTE9XIiwgInZhbHVlIHRvbyBsYXJnZSBmb3IgZGVmaW5lZCBkYXRhIHR5cGUifSwKCXs4MCwgIkVOT1RVTklRIiwgIm5hbWUgbm90IHVuaXF1ZSBvbiBuZXR3b3JrIn0sCgl7ODEsICJFQkFERkQiLCAiZmlsZSBkZXNjcmlwdG9yIGluIGJhZCBzdGF0ZSJ9LAoJezgyLCAiRVJFTUNIRyIsICJyZW1vdGUgYWRkcmVzcyBjaGFuZ2VkIn0sCgl7ODMsICJFTElCQUNDIiwgImNhbiBub3QgYWNjZXNzIGEgbmVlZGVkIHNoYXJlZCBsaWJyYXJ5In0sCgl7ODQsICJFTElCQkFEIiwgImFjY2Vzc2luZyBhIGNvcnJ1cHRlZCBzaGFyZWQgbGlicmFyeSJ9LAoJezg1LCAiRUxJQlNDTiIsICIubGliIHNlY3Rpb24gaW4gYS5vdXQgY29ycnVwdGVkIn0sCgl7ODYsICJFTElCTUFYIiwgImF0dGVtcHRpbmcgdG8gbGluayBpbiB0b28gbWFueSBzaGFyZWQgbGlicmFyaWVzIn0sCgl7ODcsICJFTElCRVhFQyIsICJjYW5ub3QgZXhlYyBhIHNoYXJlZCBsaWJyYXJ5IGRpcmVjdGx5In0sCgl7ODgsICJFSUxTRVEiLCAiaW52YWxpZCBvciBpbmNvbXBsZXRlIG11bHRpYnl0ZSBvciB3aWRlIGNoYXJhY3RlciJ9LAoJezg5LCAiRU5PU1lTIiwgImZ1bmN0aW9uIG5vdCBpbXBsZW1lbnRlZCJ9LAoJezkwLCAiRUxPT1AiLCAidG9vIG1hbnkgbGV2ZWxzIG9mIHN5bWJvbGljIGxpbmtzIn0sCgl7OTEsICJFUkVTVEFSVCIsICJpbnRlcnJ1cHRlZCBzeXN0ZW0gY2FsbCBzaG91bGQgYmUgcmVzdGFydGVkIn0sCgl7OTIsICJFU1RSUElQRSIsICJzdHJlYW1zIHBpcGUgZXJyb3IifSwKCXs5MywgIkVOT1RFTVBUWSIsICJkaXJlY3Rvcnkgbm90IGVtcHR5In0sCgl7OTQsICJFVVNFUlMiLCAidG9vIG1hbnkgdXNlcnMifSwKCXs5NSwgIkVOT1RTT0NLIiwgInNvY2tldCBvcGVyYXRpb24gb24gbm9uLXNvY2tldCJ9LAoJezk2LCAiRURFU1RBRERSUkVRIiwgImRlc3RpbmF0aW9uIGFkZHJlc3MgcmVxdWlyZWQifSwKCXs5NywgIkVNU0dTSVpFIiwgIm1lc3NhZ2UgdG9vIGxvbmcifSwKCXs5OCwgIkVQUk9UT1RZUEUiLCAicHJvdG9jb2wgd3JvbmcgdHlwZSBmb3Igc29ja2V0In0sCgl7OTksICJFTk9QUk9UT09QVCIsICJwcm90b2NvbCBub3RudGVyIHdpZHRoCi8vIGRpZmZlcmVuY2VzIGFuZCBhbnkgZXhwZXJpbWVudHMuIFVzZSBjbWQvY29tcGlsZS9pbnRlcm5hbC9ydHR5cGUKLy8gb3IgdGhlIGZ1bmN0aW9ucyBpbiBjb21waWxldHlwZS5nbyB0byBhY2Nlc3MgdGhpcyB0eXBlIGluc3RlYWQuCi8vIChUT0RPOiB0aGlzIGFkbW9uaXRpb24gYXBwbGllcyB0byBldmVyeSB0eXBlIGluIHRoaXMgcGFja2FnZS4KLy8gUHV0IGl0IGluIHNvbWUgc2hhcmVkIGxvY2F0aW9uPykKdHlwZSBUeXBlIHN0cnVjdCB7CglTaXplXyAgICAgICB1aW50cHRyCglQdHJCeXRlcyAgICB1aW50cHRyIC8vIG51bWJlciBvZiAocHJlZml4KSBieXRlcyBpbiB0aGUgdHlwZSB0aGF0IGNhbiBjb250YWluIHBvaW50ZXJzCglIYXNoICAgICAgICB1aW50MzIgIC8vIGhhc2ggb2YgdHlwZTsgYXZvaWRzIGNvbXB1dGF0aW9uIGluIGhhc2ggdGFibGVzCglURmxhZyAgICAgICBURmxhZyAgIC8vIGV4dHJhIHR5cGUgaW5mb3JtYXRpb24gZmxhZ3MKCUFsaWduXyAgICAgIHVpbnQ4ICAgLy8gYWxpZ25tZW50IG9mIHZhcmlhYmxlIHdpdGggdGhpcyB0eXBlCglGaWVsZEFsaWduXyB1aW50OCAgIC8vIGFsaWdubWVudCBvZiBzdHJ1Y3QgZmllbGQgd2l0aCB0aGlzIHR5cGUKCUtpbmRfICAgICAgIEtpbmQgICAgLy8gd2hhdCBraW5kIG9mIHR5cGUgdGhpcyBpcyAoc3RyaW5nLCBpbnQsIC4uLikKCS8vIGZ1bmN0aW9uIGZvciBjb21wYXJpbmcgb2JqZWN0cyBvZiB0aGlzIHR5cGUKCS8vIChwdHIgdG8gb2JqZWN0IEEsIHB0ciB0byBvYmplY3QgQikgLT4gPT0/CglFcXVhbCBmdW5jKHVuc2FmZS5Qb2ludGVyLCB1bnNhZmUuUG9pbnRlcikgYm9vbAoJLy8gR0NEYXRhIHN0b3JlcyB0aGUgR0MgdHlwZSBkYXRhIGZvciB0aGUgZ2FyYmFnZSBjb2xsZWN0b3IuCgkvLyBOb3JtYWxseSwgR0NEYXRhIHBvaW50cyB0byBhIGJpdG1hc2sgdGhhdCBkZXNjcmliZXMgdGhlCgkvLyBwdHIvbm9ucHRyIGZpZWxkcyBvZiB0aGUgdHlwZS4gVGhlIGJpdG1hc2sgd2lsbCBoYXZlIGF0CgkvLyBsZWFzdCBQdHJCeXRlcy9wdHJTaXplIGJpdHMuCgkvLyBJZiB0aGUgVEZsYWdHQ01hc2tPbkRlbWFuZCBiaXQgaXMgc2V0LCBHQ0RhdGEgaXMgaW5zdGVhZCBhCgkvLyAqKmJ5dGUgYW5kIHRoZSBwb2ludGVyIHRvIHRoZSBiaXRtYXNrIGlzIG9uZSBkZXJlZmVyZW5jZSBhd2F5LgoJLy8gVGhlIHJ1bnRpbWUgd2lsbCBidWlsZCB0aGUgYml0bWFzayBpZiBuZWVkZWQuCgkvLyAoU2VlIHJ1bnRpbWUvdHlwZS5nbzpnZXRHQ01hc2suKQoJLy8gTm90ZTogbXVsdGlwbGUgdHlwZXMgbWF5IGhhdmUgdGhlIHNhbWUgdmFsdWUgb2YgR0NEYXRhLAoJLy8gaW5jbHVkaW5nIHdoZW4gVEZsYWdHQ01hc2tPbkRlbWFuZCBpcyBzZXQuIFRoZSB0eXBlcyB3aWxsLCBvZiBjb3Vyc2UsCgkvLyBoYXZlIHRoZSBzYW1lIHBvaW50ZXIgbGF5b3V0IChidXQgbm90IG5lY2Vzc2FyaWx5IHRoZSBzYW1lIHNpemUpLgoJR0NEYXRhICAgICpieXRlCglTdHIgICAgICAgTmFtZU9mZiAvLyBzdHJpbmcgZm9ybQoJUHRyVG9UaGlzIFR5cGVPZmYgLy8gdHlwZSBmb3IgcG9pbnRlciB0byB0aGlzIHR5cGUsIG1heSBiZSB6ZXJvCn0KCi8vIEEgS2luZCByZXByZXNlbnRzIHRoZSBzcGVjaWZpYyBraW5kIG9mIHR5cGUgdGhhdCBhIFR5cGUgcmVwcmVzZW50cy4KLy8gVGhlIHplcm8gS2luZCBpcyBub3QgYSB2YWxpZCBraW5kLgp0eXBlIEtpbmQgdWludDgKCmNvbnN0ICgKCUludmFsaWQgS2luZCA9IGlvdGEKCUJvb2wKCUludAoJSW50OAoJSW50MTYKCUludDMyCglJbnQ2NAoJVWludAoJVWludDgKCVVpbnQxNgoJVWludDMyCglVaW50NjQKCVVpbnRwdHIKCUZsb2F0MzIKCUZsb2F0NjQKCUNvbXBsZXg2NAoJQ29tcGxleDEyOAoJQXJyYXkKCUNoYW4KCUZ1bmMKCUludGVyZmFjZQoJTWFwCglQb2ludGVyCglTbGljZQoJU3RyaW5nCglTdHJ1Y3QKCVVuc2FmZVBvaW50ZXIKKQoKLy8gVEZsYWcgaWludG8gR28gYXQgbGVhc3Qgb25jZS4KCWZvciByYW5nZSBOIHsKCQlDLlNwaW5Ud2ljZUluTmV3Q1RocmVhZCgpCgl9CgoJLy8gU3luY2hyb25pemUgd2l0aCBzcGlubmluZyB0aHJlYWRzIHR3aWNlLgoJLy8KCS8vIFRoaXMgaGVscHMgY2F0Y2ggYmFkIGFjY291bnRpbmcgYnkgdGFraW5nIGF0IGxlYXN0IGEgY291cGxlIG90aGVyCgkvLyBjb2RlcGF0aHMgd2hpY2ggd291bGQgY2F1c2UgdGhlIGFjY291bnRpbmcgdG8gY2hhbmdlLgoJZm9yIGkgOj0gcmFuZ2UgMiB7CgkJLy8gTWFrZSBzdXJlIHRoZXkgcGFzcyB0aHJvdWdoIEdvLgoJCS8vIE4uQi4gUmVhZHkgaXMgY2FsbGVkIHR3aWNlIGJ5IHRoZSBuZXcgdGhyZWFkcy4KCQlmb3IgaiA6PSByYW5nZSBOIHsKCQkJPC1yZWFkeUNoCgkJCWlmIGogPT0gMiB7CgkJCQkvLyBUcnkgdG8gdHJpZ2dlciBhbiB1cGRhdGUgaW4gdGhlIGltbWVkaWF0ZSBTVFcgaGFuZG9mZiBjYXNlLgoJCQkJcnVudGltZS5SZWFkTWVtU3RhdHMoJm0pCgkJCX0KCQl9CgoJCS8vIE1ha2Ugc3VyZSB0aGV5J3JlIGJhY2sgaW4gQy4KCQlmb3IgQy5TcGlubmluZygpIDwgTiB7CgkJfQoKCQkvLyBEbyBzb21ldGhpbmcgdGhhdCBzdG9wcyB0aGUgd29ybGQgdG8gdGFrZSBhbGwgdGhlIFBzIGJhY2suCgkJcnVudGltZS5SZWFkTWVtU3RhdHMoJm0pCgoJCWlmIGkgPT0gMCB7CgkJCUMuUmVsZWFzZSgpCgkJfQoJfQoKCS8vIFJlYWQgbm90LWluLWdvLgoJcyA6PSBbXW1ldHJpY3MuU2FtcGxle3tOYW1lOiAiL3NjaGVkL2dvcm91dGluZXMvbm90LWluLWdvOmdvcm91dGluZXMifX0KCW1ldHJpY3MuUmVhZChzKQoJaWYgbiA6PSBzWzBdLlZhbHVlLlVpbnQ2NCgpOyBuICE9IDAgewoJCXByaW50bG4oImV4cGVjdGVkIDAgbm90LWluLWdvIGdvcm91dGluZXMsIGZvdW5kIiwgbikKCQlvcy5FeGl0KDIpCgl9CglwcmludGxuKCJPSyIpCn0KCnZhciBtIHJ1bnRpbWUuTWVtU3RhdHMKdmFyIHJlYWR5Q2ggPSBtYWtlKGNoYW4gYm9vbCkKCi8vZXhwb3J0IFJlYWR5CmZ1bmMgUmVhZHkoKSB7CglyZWFkeUNoIDwtIHRydWUKfQoKLy8gTm90SW5Hb01ldHJpY0Nnb0NhbGxBbmRDYWxsYmFjayB0ZXN0cyB0aGF0IHRocmVhZHMgdGhhdCBjYWxsZWQgaW50byBHbyBhcmUgbm90Ci8vIGtlZXBpbmcgdGhlIGNvdW50IG9mIG5vdC1pbi1nbyB0aHJlYWRzIG5lZ2F0aXZlLiBTcGVjaWZpY2FsbHksIG5lZWRtIHNldHMKLy8gaXNFeHRyYUluQyB0byBmYWxzZSwgYnJlYWtpbmcgc29tZSBvZiB0aGUgaW52YXJpYW50cyBiZWhpbmQgdGhlIG5vdC1pbi1nbwovLyBydW50aW1lL21ldHJpY3MgbWV0cmljLCBjYXVzaW5nIHRoZSB1bmRlcmx5aW5nIGNvdW50IHRvIGJyZWFrIGlmIHdlIGRvbid0Ci8vIGFjY291bnQgZm9yIHRoaXMuIEluIGdvLmRldi9jbC83MjY5NjQgdGhpcyBhbW91bnRzIHRvIG5Hc3lzY2FsbE5vUCBiZWluZyBuZWdhdGl2ZS4KLy8gVW5mb3J0dW5hdGVseSB0aGUgcnVudGltZS9tZXRyaWNzIHBhY2thZ2UgbWFza3MgYSBuZWdhdGl2ZSBuR3N5c2NhbGxOb1AgYmVjYXVzZQovLyBpdCBjYW4gdHJhbnNpZW50bHkgZ28gbmVnYXRpdmUgZHVlIHRvIGEgcmFjZS4gVGhlcmVmb3JlLCB0aGlzIHRlc3QgY2hlY2tzCi8vIHRoZSBjb25kaXRpb24gYnkgbWFraW5nIHN1cmUgbm90LWluLWdvIGlzIHBvc2l0aXZlIHdoZW4gd2UgZXhwZWN0IGl0IHRvIGJlLgovLyBUaGF0IGlzLCB0aHJlYWRzIGluIGEgY2dvIGNhbGxiYWNrIGFyZSAqbm90KiBjYW5jZWxsaW5nIG91dCB0aHJlYWRzIGluIGEKLy8gcmVndWxhciBjZ28gY2FsbC4KZnVuYyBOb3RJbkdvTWV0cmljQ2dvQ2FsbEFuZENhbGxiYWNrKCkgewoJY29uc3QgTiA9IDEwCgoJLy8gU3BpbiB1cCBzb21lIHRocmVhZHMgdGhhdCB3aWxsIGRvIGEgY2dvIGNhbGxiYWNrIGFuZCBqdXN0IHdhaXQgaW4gR28uCgkvLyBUaGVzZSB0aHJlYWRzIGFyZSB0aGUgb25lcyB3ZSdyZSB3b3JyaWVkIGFib3V0IGhhdmkgMHg4MDAwCglJRkZfTk9BUlAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDgwCglJRkZfTk9UUkFJTEVSUyAgICAgICAgICAgICAgICAgICAgPSAweDIwCglJRkZfT0FDVElWRSAgICAgICAgICAgICAgICAgICAgICAgPSAweDQwMAoJSUZGX1BPSU5UT1BPSU5UICAgICAgICAgICAgICAgICAgID0gMHgxMAoJSUZGX1BST01JU0MgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMDAKCUlGRl9SVU5OSU5HICAgICAgICAgICAgICAgICAgICAgICA9IDB4NDAKCUlGRl9TSU1QTEVYICAgICAgICAgICAgICAgICAgICAgICA9IDB4ODAwCglJRkZfVVAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSAweDEKCUlGTkFNU0laICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MTAKCUlGVF8xODIyICAgICAgICAgICAgICAgICAgICAgICAgICA9IDB4MgoJSUZUX0ExMk1QUFNXSVRDSCAgICAgICAgICAgICAgICAgID0gMHg4MgoJSUZUX0FBTDIgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhiYgoJSUZUX0FBTDUgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgzMQoJSUZUX0FEU0wgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1ZQoJSUZUX0FGTEFORTgwMjMgICAgICAgICAgICAgICAgICAgID0gMHgzYgoJSUZUX0FGTEFORTgwMjUgICAgICAgICAgICAgICAgICAgID0gMHgzYwoJSUZUX0FSQVAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1OAoJSUZUX0FSQ05FVCAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyMwoJSUZUX0FSQ05FVFBMVVMgICAgICAgICAgICAgICAgICAgID0gMHgyNAoJSUZUX0FTWU5DICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1NAoJSUZUX0FUTSAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgyNQoJSUZUX0FUTURYSSAgICAgICAgICAgICAgICAgICAgICAgID0gMHg2OQoJSUZUX0FUTUZVTkkgICAgICAgICAgICAgICAgICAgICAgID0gMHg2YQoJSUZUX0FUTUlNQSAgICAgICAgICAgICAgICAgICAgICAgID0gMHg2YgoJSUZUX0FUTUxPR0lDQUwgICAgICAgICAgICAgICAgICAgID0gMHg1MAoJSUZUX0FUTVJBRElPICAgICAgICAgICAgICAgICAgICAgID0gMHhiZAoJSUZUX0FUTVNVQklOVEVSRkFDRSAgICAgICAgICAgICAgID0gMHg4NgoJSUZUX0FUTVZDSUVORFBUICAgICAgICAgICAgICAgICAgID0gMHhjMgoJSUZUX0FUTVZJUlRVQUwgICAgICAgICAgICAgICAgICAgID0gMHg5NQoJSUZUX0JHUFBPTElDWUFDQ09VTlRJTkcgICAgICAgICAgID0gMHhhMgoJSUZUX0JSSURHRSAgICAgICAgICAgICAgICAgICAgICAgID0gMHhkMQoJSUZUX0JTQyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1MwoJSUZUX0NBUlAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHhmOAoJSUZUX0NDVEVNVUwgICAgICAgICAgICAgICAgICAgICAgID0gMHgzZAoJSUZUX0NFUFQgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHgxMwoJSUZUX0NFUyAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4NQoJSUZUX0NIQU5ORUwgICAgICAgICAgICAgICAgICAgICAgID0gMHg0NgoJSUZUX0NOUiAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg1NQoJSUZUX0NPRkZFRSAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4NAoJSUZUX0NPTVBPU0lURUxJTksgICAgICAgICAgICAgICAgID0gMHg5YgoJSUZUX0RDTiAgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg4ZAoJSUZUX0RJR0lUQUxQT1dFUkxJTkUgICAgICAgICAgICAgID0gMHg4YQoJSUZUX0RJR0lUQUxXUkFQUEVST1ZFUkhFQURDSEFOTkVMID0gMHhiYQoJSUZUX0RMU1cgICAgICAgICAgICAgICAgICAgICAgICAgID0gMHg0YQoJSUZUX0RPQ1NDQUJMRURPV05TVFJFQU0gICAgICAgICAgID0gMHg4MAoJSUZUX0RPQ1NDQUJMRU1BQ0xBWUVSICAgICAgICAgICAgID0gMHg3ZgoJSUZUX0RPQ1NDQUJMRVVQU1RSRUFUaGUgYWNjZXB0ZWQgZ3JhbW1hciBpcyBpZGVudGljYWwgdG8gSmF2YVNjcmlwdCdzIER1cmF0aW9uOgovLwovLwlodHRwczovL3RjMzkuZXMvcHJvcG9zYWwtdGVtcG9yYWwvI3Byb2QtRHVyYXRpb24KLy8KLy8gV2UgZm9sbG93IEphdmFTY3JpcHQncyBncmFtbWFyIGFzIEpTT04gaXRzZWxmIGlzIGRlcml2ZWQgZnJvbSBKYXZhU2NyaXB0LgovLyBUaGUgVGVtcG9yYWwuRHVyYXRpb24udG9KU09OIG1ldGhvZCBpcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYW4gb3V0cHV0Ci8vIHRoYXQgY2FuIGJlIHBhcnNlZCBieSB0aGlzIGZ1bmN0aW9uIHNvIGxvbmcgYXMgYXJpdGhtZXRpYyBpbiBKYXZhU2NyaXB0Ci8vIGRvIG5vdCB1c2UgYSBsYXJnZXN0VW5pdCB2YWx1ZSBoaWdoZXIgdGhhbiAiaG91cnMiICh3aGljaCBpcyB0aGUgZGVmYXVsdCkuCi8vIEV2ZW4gaWYgaXQgZG9lcywgdGhpcyB3aWxsIGRvIGEgYmVzdC1lZmZvcnQgcGFyc2luZyB3aXRoIGluYWNjdXJhdGUgdW5pdHMsCi8vIGJ1dCByZXBvcnQgW2VyckluYWNjdXJhdGVEYXRlVW5pdHNdLgpmdW5jIHBhcnNlRHVyYXRpb25JU084NjAxKGIgW11ieXRlKSAodGltZS5EdXJhdGlvbiwgZXJyb3IpIHsKCXZhciBpbnZhbGlkLCBvdmVyZmxvdywgaW5hY2N1cmF0ZSwgc2F3RnJhYyBib29sCgl2YXIgc3VtTmFub3MsIG4sIGNvIHVpbnQ2NAoKCS8vIGN1dEJ5dGVzIGlzIGxpa2UgW2J5dGVzLkN1dF0sIGJ1dCB1c2VzIGVpdGhlciBjMCBvciBjMSBhcyB0aGUgc2VwYXJhdG9yLgoJY3V0Qnl0ZXMgOj0gZnVuYyhiIFtdYnl0ZSwgYzAsIGMxIGJ5dGUpIChwcmVmaXgsIHN1ZmZpeCBbXWJ5dGUsIG9rIGJvb2wpIHsKCQlmb3IgaSwgYyA6PSByYW5nZSBiIHsKCQkJaWYgYyA9PSBjMCB8fCBjID09IGMxIHsKCQkJCXJldHVybiBiWzppXSwgYltpKzE6XSwgdHJ1ZQoJCQl9CgkJfQoJCXJldHVybiBiLCBuaWwsIGZhbHNlCgl9CgoJLy8gbWF5UGFyc2VVbml0IGF0dGVtcHRzIHRvIHBhcnNlIGFub3RoZXIgZGF0ZSBvciB0aW1lIG51bWJlcgoJLy8gaWRlbnRpZmllZCBieSB0aGUgZGVzSGkgYW5kIGRlc0xvIHVuaXQgY2hhcmFjdGVycy4KCS8vIElmIHRoZSBwYXJ0IGlzIGFic2VudCBmb3IgY3VycmVudCB1bml0LCBpdCByZXR1cm5zIGIgYXMgaXMuCgltYXlQYXJzZVVuaXQgOj0gZnVuYyhiIFtdYnl0ZSwgZGVzSGksIGRlc0xvIGJ5dGUsIHVuaXQgdGltZS5EdXJhdGlvbikgW11ieXRlIHsKCQludW1iZXIsIHN1ZmZpeCwgb2sgOj0gY3V0Qnl0ZXMoYiwgZGVzSGksIGRlc0xvKQoJCWlmICFvayB8fCBzYXdGcmFjIHsKCQkJcmV0dXJuIGIgLy8gZGVzaWduYXRvciBpcyBub3QgcHJlc2VudCBvciBhbHJlYWR5IHNhdyBmcmFjdGlvbiwgd2hpY2ggY2FuIG9ubHkgYmUgaW4gdGhlIGxhc3QgY29tcG9uZW50CgkJfQoKCQkvLyBQYXJzZSB0aGUgbnVtYmVyLgoJCS8vIEEgZnJhY3Rpb24gYWxsb3dlZCBmb3IgdGhlIGFjY3VyYXRlIHVuaXRzIGluIHRoZSBsYXN0IHBhcnQuCgkJd2hvbGUsIGZyYWMsIG9rIDo9IGN1dEJ5dGVzKG51bWJlciwgJy4nLCAnLCcpCgkJaWYgb2sgewoJCQlzYXdGcmFjID0gdHJ1ZQoJCQlpbnZhbGlkID0gaW52YWxpZCB8fCBsZW4oZnJhYykgPT0gbGVuKCIiKSB8fCB1bml0ID4gdGltZS5Ib3VyCgkJCWlmIHVuaXQgPT0gdGltZS5TZWNvbmQgewoJCQkJbiwgb2sgPSBwYXJzZVBhZGRlZEJhc2UxMChmcmFjLCB1aW50NjQodGltZS5TZWNvbmQpKQoJCQkJaW52YWxpZCA9IGludmFsaWQgfHwgIW9rCgkJCX0gZWxzZSB7CgkJCQlmLCBlcnIgOj0gc3RyY29udi5QYXJzZUZsb2F0KCIwLiIrc3RyaW5nKGZyYWMpLCA2NCkKCQkJCWludmFsaWQgPSBpbnZhbGlkIHx8IGVyciAhPSBuaWwgfHwgbGVuKGJ5dGVzLlRyaW0oZnJhY1tsZW4oIi4iKTpdLCAiMDEyMzQ1Njc4OSIpKSA+IDAKCQkJCW4gPSB1aW50NjQobWF0aC5Sb3VuZChmICogZmxvYXQ2NCh1bml0KSkpIC8vIG5ldmVyIG92ZXJmbG93cyBzaW5jZSBmLTY5XQp9Cgpjb25zdCBfU3luY01hcmtlcl9uYW1lID0gIkVPRkJvb2xJbnQ2NFVpbnQ2NFN0cmluZ1ZhbHVlVmFsUmVsb2NzUmVsb2NVc2VSZWxvY1B1YmxpY1Bvc1Bvc0Jhc2VPYmplY3RPYmplY3QxUGtnUGtnRGVmTWV0aG9kVHlwZVR5cGVJZHhUeXBlUGFyYW1OYW1lc1NpZ25hdHVyZVBhcmFtc1BhcmFtQ29kZU9ialN5bUxvY2FsSWRlbnRTZWxlY3RvclByaXZhdGVGdW5jRXh0VmFyRXh0VHlwZUV4dFByYWdtYUV4cHJMaXN0RXhwcnNFeHByRXhwclR5cGVBc3NpZ25PcEZ1bmNMaXRDb21wTGl0RGVjbEZ1bmNCb2R5T3BlblNjb3BlQ2xvc2VTY29wZUNsb3NlQW5vdGhlclNjb3BlRGVjbE5hbWVzRGVjbE5hbWVTdG10c0Jsb2NrU3RtdElmU3RtdEZvclN0bXRTd2l0Y2hTdG10UmFuZ2VTdG10Q2FzZUNsYXVzZUNvbW1DbGF1c2VTZWxlY3RTdG10RGVjbHNMYWJlbGVkU3RtdFVzZU9iakxvY2FsQWRkTG9jYWxMaW5rbmFtZVN0bXQxU3RtdHNFbmRMYWJlbE9wdExhYmVsTXVsdGlFeHByUlR5cGVDb252UlRUSSIKCnZhciBfU3luY01hcmtlcl9pbmRleCA9IFsuLi5ddWludDE2ezAsIDMsIDcsIDEyLCAxOCwgMjQsIDI5LCAzMiwgMzgsIDQzLCA1MSwgNTcsIDYwLCA2NywgNzMsIDgwLCA4MywgODksIDk1LCA5OSwgMTA2LCAxMjAsIDEyOSwgMTM1LCAxNDAsIDE0NywgMTUwLCAxNjAsIDE2OCwgMTc1LCAxODIsIDE4OCwgMTk1LCAyMDEsIDIwOSwgMjE0LCAyMTgsIDIyNiwgMjMyLCAyMzQsIDI0MSwgMjQ4LCAyNTIsIDI2MCwgMjY5LCAyNzksIDI5NiwgMzA1LCAzMTMsIDMxOCwgMzI3LCAzMzMsIDM0MCwgMzUwLCAzNTksIDM2OSwgMzc5LCAzODksIDM5NCwgNDA1LCA0MTYsIDQyNCwgNDMyLCA0MzcsIDQ0NSwgNDUwLCA0NTgsIDQ2NywgNDcyLCA0ODB9CgpmdW5jIChpIFN5bmNNYXJrZXIpIFN0cmluZygpIHN0cmluZyB7CglpIC09IDEKCWlmIGkgPCAwIHx8IGkgPj0gU3luY01hcmtlcihsZW4oX1N5bmNNYXJrZXJfaW5kZXgpLTEpIHsKCQlyZXR1cm4gIlN5bmNNYXJrZXIoIiArIHN0cmNvbnYuRm9ybWF0SW50KGludDY0KGkrMSksIDEwKSArICIpIgoJfQoJcmV0dXJuIF9TeW5jTWFya2VyX25hbWVbX1N5bmNNYXJrZXJfaW5kZXhbaV06X1N5bmNNYXJrZXJfaW5kZXhbaSsxXV0KfQovLyBDb3B5cmlnaHQgMjAyMSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSB0b2tlbl90ZXN0CgppbXBvcnQgKAoJImdvL2J1aWxkIgoJImdvL3Rva2VuIgoJIm1hdGgvcmFuZC92MiIKCSJvcyIKCSJwYXRoL2ZpbGVwYXRoIgoJInRlc3RpbmciCikKCmZ1bmMgQmVuY2htYXJrU2VhcmNoSW50cyhiICp0ZXN0aW5nLkIpIHsKCWRhdGEgOj0gbWFrZShbXWludCwgMTAwMDApCglmb3IgaSA6PSAwOyBpIDwgMTAwMDA7IGkrKyB7CgkJZGF0YVtpXSA9IGkKCX0KCWNvbnN0IHggPSA4CglpZiByIDo9IHRva2VuLlNlYXJjaEludHMoZGF0YSwgeCk7IHIgIT0geCB7CgkJYi5FcnJvcmYoImdvdCBpbmRleCA9ICVkOyB3YW50ICVkIiwgciwgeCkKCX0KCWIuUmVzZXRUaW1lcigpCglmb3IgaSA6PSAwOyBpIDwgYi5OOyBpKysgewoJCXRva2VuLlNlYXJjaEludHMoZGF0YSwgeCkKCX0KfQoKZnVuYyBCZW5jaG1hcmtGaWxlU2V0X1Bvc2l0aW9uKGIgKnRlc3RpbmcuQikgewoJcm5nIDo9IHJhbmQuTmV3KHJhbmQuTmV3UENHKHJhbmQuVWludDY0KCksIHJhbmQuVWludDY0KCkpKQoKCS8vIENyZWF0ZSBhIEZpbGVTZXQgYmFzZWQgb24gdGhlIGZpbGVzIG9mIG5ldC9odHRwLAoJLy8gYSBzaW5nbGUgbGFyZ2UgcGFja2FnZS4KCW5ldEhUVFBGc2V0IDo9IHRva2VuLk5ld0ZpbGVTZXQoKQoJcGtnLCBlcnIgOj0gYnVpbGQuRGVmYXVsdC5JbXBvcnQoIm5ldC9odHRwIiwgIiIsIDApCglpZkNvdW50ZXJDcnlwdEdlbmVyaWMoYiBCbG9jaywgb3V0LCBzcmMgW11ieXRlLCBjb3VudGVyICpbZ2NtQmxvY2tTaXplXWJ5dGUpIHsKCXZhciBtYXNrIFtnY21CbG9ja1NpemVdYnl0ZQoJZm9yIGxlbihzcmMpID49IGdjbUJsb2NrU2l6ZSB7CgkJYi5FbmNyeXB0KG1hc2tbOl0sIGNvdW50ZXJbOl0pCgkJZ2NtSW5jMzIoY291bnRlcikKCgkJc3VidGxlLlhPUkJ5dGVzKG91dCwgc3JjLCBtYXNrWzpdKQoJCW91dCA9IG91dFtnY21CbG9ja1NpemU6XQoJCXNyYyA9IHNyY1tnY21CbG9ja1NpemU6XQoJfQoJaWYgbGVuKHNyYykgPiAwIHsKCQliLkVuY3J5cHQobWFza1s6XSwgY291bnRlcls6XSkKCQlnY21JbmMzMihjb3VudGVyKQoJCXN1YnRsZS5YT1JCeXRlcyhvdXQsIHNyYywgbWFza1s6XSkKCX0KfQoKZnVuYyBnY21JbmMzMihjb3VudGVyQmxvY2sgKltnY21CbG9ja1NpemVdYnl0ZSkgewoJY3RyIDo9IGNvdW50ZXJCbG9ja1tsZW4oY291bnRlckJsb2NrKS00Ol0KCWJ5dGVvcmRlci5CRVB1dFVpbnQzMihjdHIsIGJ5dGVvcmRlci5CRVVpbnQzMihjdHIpKzEpCn0KCmZ1bmMgZ2NtQXV0aChvdXQgW11ieXRlLCBILCB0YWdNYXNrICpbZ2NtQmxvY2tTaXplXWJ5dGUsIGNpcGhlcnRleHQsIGFkZGl0aW9uYWxEYXRhIFtdYnl0ZSkgewoJbGVuQmxvY2sgOj0gbWFrZShbXWJ5dGUsIDE2KQoJYnl0ZW9yZGVyLkJFUHV0VWludDY0KGxlbkJsb2NrWzo4XSwgdWludDY0KGxlbihhZGRpdGlvbmFsRGF0YSkpKjgpCglieXRlb3JkZXIuQkVQdXRVaW50NjQobGVuQmxvY2tbODpdLCB1aW50NjQobGVuKGNpcGhlcnRleHQpKSo4KQoJUyA6PSBnY20uR0hBU0goSCwgYWRkaXRpb25hbERhdGEsIGNpcGhlcnRleHQsIGxlbkJsb2NrKQoJc3VidGxlLlhPUkJ5dGVzKG91dCwgUywgdGFnTWFza1s6XSkKfQoKLy8gc2xpY2VGb3JBcHBlbmQgdGFrZXMgYSBzbGljZSBhbmQgYSByZXF1ZXN0ZWQgbnVtYmVyIG9mIGJ5dGVzLiBJdCByZXR1cm5zIGEKLy8gc2xpY2Ugd2l0aCB0aGUgY29udGVudHMgb2YgdGhlIGdpdmVuIHNsaWNlIGZvbGxvd2VkIGJ5IHRoYXQgbWFueSBieXRlcyBhbmQgYQovLyBzZWNvbmQgc2xpY2UgdGhhdCBhbGlhc2VzIGludG8gaXQgYW5kIGNvbnRhaW5zIG9ubHkgdGhlIGV4dHJhIGJ5dGVzLiBJZiB0aGUKLy8gb3JpZ2luYWwgc2xpY2UgaGFzIHN1ZmZpY2llbnQgY2FwYWNpdHkgdGhlbiBubyBhbGxvY2F0aW9uIGlzIHBlcmZvcm1lZC4KZnVuYyBzbGljZUZvckFwcGVuZChpbiBbXWJ5dGUsIG4gaW50KSAoaGVhZCwgdGFpbCBbXWJ5dGUpIHsKCWlmIHRvdGFsIDo9IGxlbihpbikgKyBuOyBjYXAoaW4pID49IHRvdGFsIHsKCQloZWFkID0gaW5bOnRvdGFsXQoJfSBlbHNlIHsKCQloZWFkID0gbWFrZShbXWJ5dGUsIHRvdGFsKQoJCWNvcHkoaGVhZCwgaW4pCgl9Cgl0YWlsID0gaGVhZFtsZW4oaW4pOl0KCXJldHVybgp9Ci8vIG1rc3lzY2FsbC5wbCAtdGFncyBsaW51eCxhbWQ2NCBzeXNjYWxsX2xpbnV4LmdvIHN5c2NhbGxfbGludXhfYW1kNjQuZ28KLy8gQ29kZSBnZW5lcmF0ZWQgYnkgdGhlIGNvbW1hbmQgYWJvdmU7IERPIE5PVCBFRElULgoKLy9nbzpidWlsZCBsaW51eCAmJiBhbWQ2NAoKcGFja2FnZSBzeXNjYWxsCgppbXBvcnQgInVuc2FmZSIKCi8vIFRISVMgRklMRSBJUyBHRU5FUkFURUQgQlkgVEhFIENPTU1BTkQgQVQgVEhFIFRPUDsgRE8gTk9UIEVESVQKCmZ1bmMgZmFjY2Vzc2F0KGRpcmZkIGludCwgcGF0aCBzdHJpbmcsIG1vZGUgdWludDMyKSAoZXJyIGVycm9yKSB7Cgl2YXIgX3AwICpieXRlCglfcDAsIGVyciA9IEJ5dGVQdHJGcm9tU3RyaW5nKHBhdGgpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4KCX0KCV8sIF8sIGUxIDo9IFN5c2NhbGwoU1lTX0ZBQ0NFU1NBVCwgdWludHB0cihkaXJmZCksIHVpbnRwdHIodW5zYWZlLlBvaW50ZXIoX3AwKSksIHVpbnRwdHIobW9kZSkpCglpZiBlMSAhPSAwIHsKCQllcnIgPSBlcnJub0VycihlMSkKCX11bmMgYWJpZ2VuX3N5bmNfYXRvbWljX0NvbXBhcmVBbmRTd2FwVWludDY0KGFkZHIgKnVpbnQ2NCwgb2xkLCBuZXcgdWludDY0KSAoc3dhcHBlZCBib29sKQovLyBDb3B5cmlnaHQgMjAxNCBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLgovLwovLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgovLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKLy8KLy8gICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAovLwovLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgovLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoKLy8gUGFja2FnZSBncmFwaCBjb2xsZWN0cyBhIHNldCBvZiBzYW1wbGVzIGludG8gYSBkaXJlY3RlZCBncmFwaC4KcGFja2FnZSBncmFwaAoKaW1wb3J0ICgKCSJmbXQiCgkibWF0aCIKCSJwYXRoL2ZpbGVwYXRoIgoJInJlZ2V4cCIKCSJzb3J0IgoJInN0cmNvbnYiCgkic3RyaW5ncyIKCgkiZ2l0aHViLmNvbS9nb29nbGUvcHByb2YvcHJvZmlsZSIKKQoKdmFyICgKCS8vIFJlbW92ZXMgcGFja2FnZSBuYW1lIGFuZCBtZXRob2QgYXJndW1lbnRzIGZvciBKYXZhIG1ldGhvZCBuYW1lcy4KCS8vIFNlZSB0ZXN0cyBmb3IgZXhhbXBsZXMuCglqYXZhUmVnRXhwID0gcmVnZXhwLk11c3RDb21waWxlKGBeKD86W2Etel1cdypcLikqKFtBLVpdW1x3XCRdKlwuKD86PGluaXQ+fFthLXpdW1x3XCRdKig/OlwkXGQrKT8pKSg/Oig/OlwoKXwkKWApCgkvLyBSZW1vdmVzIHBhY2thZ2UgbmFtZSBhbmQgbWV0aG9kIGFyZ3VtZW50cyBmb3IgR28gZnVuY3Rpb24gbmFtZXMuCgkvLyBTZWUgdGVzdHMgZm9yIGV4YW1wbGVzLgoJZ29SZWdFeHAgPSByZWdleHAuTXVzdENvbXBpbGUoYF4oPzpbXHdcLVwuXStcLykrKFteLl0rXC4uKylgKQoJLy8gUmVtb3ZlcyBwb3RlbnRpYWwgbW9kdWxlIHZlcnNpb25zIGluIGEgcGFja2FnZSBwYXRoLgoJZ29WZXJSZWdFeHAgPSByZWdleHAuTXVzdENvbXBpbGUoYF4oLio/KS92KD86WzItOV18WzEtOV1bMC05XSspKFsuL10uKikkYCkKCS8vIFN0cmlwcyBDKysgbmFtZXNwYWNlIHByZWZpeCBmcm9tIGEgQysrIGZ1bmN0aW9uIC8gbWV0aG9kIG5hbWUuCgkvLyBOT1RFOiBNYWtlIHN1cmUgdG8ga2VlcCB0aGUgdGVtcGxhdGUgcGFyYW1ldGVycyBpbiB0aGUgbmFtZS4gTm9ybWFsbHksCgkvLyB0ZW1wbGF0ZSBwYXJhbWV0ZXJzIGFyZSBzdHJpcHBlZCBmcm9tIHRoZSBDKysgbmFtZXMgYnV0IHdoZW4KCS8vIC1zeW1ib2xpemU9ZGVtYW5nbGU9dGVtcGxhdGVzIGZsYWcgaXMgdXNlZCwgdGhleSB3aWxsIG5vdCBiZS4KCS8vIFNlZSB0ZXN0cyBmb3IgZXhhbXBsZXMuCgljcHBSZWdFeHAgICAgICAgICAgICAgICAgPSByZWdleHAuTXVzdENvbXBpbGUoYF4oPzpbX2EtekEtWl1cdyo6OikrKF8qW0EtWl1cdyo6On4/W19hLXpBLVpdXHcqKD86PC4qPik/KWApCgljcHBBbm9ueW1vdXNQcmVmaXhSZWdFeHAgPSByZWdleHAuTXVzdENvbXBpbGUoYF5cKGFub255bW91cyBuYW1lc3BhY2VcKTo6YCkKKQoKLy8gR3JhcGggc3VtbWFyaXplcyBhIHBlcmZvcm1hbmNlIHByb2ZpbGUgaW50byBhIGZvcm1hdCB0aGF0IGlzCi8vIHN1bG93IHRoZSByZWNvbW1lbmRhdGlvbnMgb2YgUkZDIDU4OTQsCi8vIFJGQyA1ODk1IGFuZCBVVFMgNDYuIEl0IGRvZXMgbm90IGFkZCB0aGUgQmlkaSBSdWxlLiBVc2UgdGhlIEJpZGlSdWxlIG9wdGlvbgovLyB0byBhZGQgdGhpcyBjaGVjay4KLy8KLy8gVGhlIG1hcHBpbmdzIGluY2x1ZGUgbm9ybWFsaXphdGlvbiBhbmQgbWFwcGluZyBjYXNlLCB3aWR0aCBhbmQgb3RoZXIKLy8gY29tcGF0aWJpbGl0eSBtYXBwaW5ncy4KZnVuYyBNYXBGb3JMb29rdXAoKSBPcHRpb24gewoJcmV0dXJuIGZ1bmMobyAqb3B0aW9ucykgewoJCW8ubWFwcGluZyA9IHZhbGlkYXRlQW5kTWFwCgkJU3RyaWN0RG9tYWluTmFtZSh0cnVlKShvKQoJCVZhbGlkYXRlTGFiZWxzKHRydWUpKG8pCgkJUmVtb3ZlTGVhZGluZ0RvdHModHJ1ZSkobykKCX0KfQoKdHlwZSBvcHRpb25zIHN0cnVjdCB7Cgl0cmFuc2l0aW9uYWwgICAgICBib29sCgl1c2VTVEQzUnVsZXMgICAgICBib29sCgljaGVja0h5cGhlbnMgICAgICBib29sCgljaGVja0pvaW5lcnMgICAgICBib29sCgl2ZXJpZnlETlNMZW5ndGggICBib29sCglyZW1vdmVMZWFkaW5nRG90cyBib29sCgoJdHJpZSAqaWRuYVRyaWUKCgkvLyBmcm9tUHVueSBjYWxscyB2YWxpZGF0aW9uIHJ1bGVzIHdoZW4gY29udmVydGluZyBBLWxhYmVscyB0byBVLWxhYmVscy4KCWZyb21QdW55IGZ1bmMocCAqUHJvZmlsZSwgcyBzdHJpbmcpIGVycm9yCgoJLy8gbWFwcGluZyBpbXBsZW1lbnRzIGEgdmFsaWRhdGlvbiBhbmQgbWFwcGluZyBzdGVwIGFzIGRlZmluZWQgaW4gUkZDIDU4OTUKCS8vIG9yIFVUUyA0NiwgdGFpbG9yZWQgdG8sIGZvciBleGFtcGxlLCBkb21haW4gcmVnaXN0cmF0aW9uIG9yIGxvb2t1cC4KCW1hcHBpbmcgZnVuYyhwICpQcm9maWxlLCBzIHN0cmluZykgKHN0cmluZywgZXJyb3IpCgoJLy8gYmlkaXJ1bGUsIGlmIHNwZWNpZmllZCwgY2hlY2tzIHdoZXRoZXIgcyBjb25mb3JtcyB0byB0aGUgQmlkaSBSdWxlCgkvLyBkZWZpbmVkIGluIFJGQyA1ODkzLgoJYmlkaXJ1bGUgZnVuYyhzIHN0cmluZykgYm9vbAp9CgovLyBBIFByb2ZpbGUgZGVmaW5lcyB0aGUgY29uZmlndXJhdGlvbiBvZiBhIElETkEgbWFwcGVyLgp0eXBlIFByb2ZpbGUgc3RydWN0IHsKCW9wdGlvbnMKfQoKZnVuYyBhcHBseShvICpvcHRpb25zLCBvcHRzIFtdT3B0aW9uKSB7Cglmb3IgXywgZiA6PSByYW5nZSBvcHRzIHsKCQlmKG8pCgl9Cn0KCi8vIE5ldyBjcmVhdGVzIGEgbmV3IFByb2ZpbGUuCi8vCi8vIFdpdGggbm8gb3B0aW9ucywgdGhlIHJldHVybmVkIFByb2ZpbGUgaXMgdGhlIG1vc3QgcGVybWlzc2l2ZSBhbmQgZXF1YWxzIHRoZQovLyBQdW55Y29kZSBQcm9maWxlLiBPcHRpb25zIGNhbiBiZSBwYXNzZWQgdG8gZnVydGhlciByZXN0cmljdCB0aGUgUHJvZmlsZS4gVGhlCi8vIE1hcEZvckxvb2t1cCBhbmQgVmFsaWRhdGVGb3JSZWdpc3RyYXRpb24gb3B0aW9ucyBzZXQgYSBjb2xsZWN0aW9uIG9mIG9wdGlvbnMsCi8vIGZvciBsb29rdXAgYW5kIHJlZ2lzdHJhdGlvbiBwdXJwb3NlcyByZXNwZWN0aXZlbHksIHdoaWNoIGNhbiBiZSB0YWlsb3JlZCBieQovLyBhZGRpbmcgbW9yZSBmaW5lLWdyYWluZWQgb3B0aW9ucywgd2hlcmUgbGF0ZXIgb3B0aW9ucyBvdmVycmlkZSBlYXJsaWVyCi8vIG9wdGlvbnMuCmZ1bmMgTmV3KG8gLi4uT3B0aW9uKSAqUHJvZmlsZSB7CglwIDo9ICZQcm9maWxle30KCWFwcGx5KCZwLm9wdGlvbnMsIG8pCglyZXR1cm4gcAp9CgovLyBUb0FTQ0lJIGNvbnZlcnRzIGEgZG9tYWluIG9yIGRvbWFpbiBsYWJlbCB0byBpdHMgQVNDSUkgZm9ybS4gRm9yIGV4YW1wbGUsCi8vIFRvQVNDSUkoImLDvGNoZXIuZXhhbXBsZS5jb20iKSBpcyAieG4tLWJjaGVyLWt2YS5leGFtcGxlLmNvbSIsIGFuZAovLyBUb0FTQ0lJKCJnb2xhbmciKSBpcyAiZ29sYW5nIi4gSWYgYW4gZXJyb3IgaXMgZW5jb3VudGVyZWQgaXQgd2lsbCByZXR1cm4KLy8gYW4gZSBtYWtlRnJhbWVzIHN5bnRoZXNpemVzIGEgW11wbHVnaW4uRnJhbWUgbGlzdCBmb3IgdGhlIHNwZWNpZmllZCBhZGRyZXNzLgoJLy8gVGhlIHJlc3VsdCB3aWxsIHR5cGljYWxseSBoYXZlIGxlbmd0aCAxLCBidXQgbWF5IGJlIGxvbmdlciBpZiBhZGRyZXNzIGNvcnJlc3BvbmRzCgkvLyB0byBpbmxpbmVkIGNhbGxzLgoJbWFrZUZyYW1lcyA6PSBmdW5jKGFkZHIgdWludDY0KSBbXXBsdWdpbi5GcmFtZSB7CgkJbG9jIDo9IGFkZHJzW2FkZHJdLmxvYwoJCXN0YWNrIDo9IG1ha2UoW11wbHVnaW4uRnJhbWUsIDAsIGxlbihsb2MuTGluZSkpCgkJZm9yIF8sIGxpbmUgOj0gcmFuZ2UgbG9jLkxpbmUgewoJCQlmbiA6PSBsaW5lLkZ1bmN0aW9uCgkJCWlmIGZuID09IG5pbCB7CgkJCQljb250aW51ZQoJCQl9CgkJCXN0YWNrID0gYXBwZW5kKHN0YWNrLCBwbHVnaW4uRnJhbWV7CgkJCQlGdW5jOiBmbi5OYW1lLAoJCQkJRmlsZTogZm4uRmlsZW5hbWUsCgkJCQlMaW5lOiBpbnQobGluZS5MaW5lKSwKCQkJfSkKCQl9CgkJcmV0dXJuIHN0YWNrCgl9CgoJZm9yIF8sIGFkZHIgOj0gcmFuZ2UgdW5wcm9jZXNzZWQgewoJCWZyYW1lcyA6PSBtYWtlRnJhbWVzKGFkZHIpCgkJeCA6PSBpbnN0cnVjdGlvbkluZm97CgkJCW9iakFkZHI6IGFkZHIsCgkJCWxlbmd0aDogIDEsCgkJCWRpc2FzbTogIHN5bnRoQXNtLAoJCX0KCQlpZiBsZW4oZnJhbWVzKSA+IDAgewoJCQl4LmZpbGUgPSBmcmFtZXNbMF0uRmlsZQoJCQl4LmxpbmUgPSBmcmFtZXNbMF0uTGluZQoJCX0KCQlzcC5pbnN0c1thZGRyXSA9IHgKCgkJc3AuYWRkU3RhY2soYWRkciwgZnJhbWVzKQoJfQp9CgovLyBzcGxpdEludG9SYW5nZXMgY29udmVydHMgdGhlIHNldCBvZiBhZGRyZXNzZXMgd2UgYXJlIGludGVyZXN0ZWQgaW4gaW50byBhIHNldCBvZiBhZGRyZXNzCi8vIHJhbmdlcyB0byBkaXNhc3NlbWJsZS4gSXQgYWxzbyByZXR1cm5zIHRoZSBzZXQgb2YgYWRkcmVzc2VzIGZvdW5kIHRoYXQgZGlkIG5vdCBoYXZlIGFuCi8vIGFzc29jaWF0ZWQgb2JqZWN0IGZpbGUgYW5kIHdlcmUgdGhlcmVmb3JlIG5vdCBhZGRlZCB0byBhbiBhZGRyZXNzIHJhbmdlLgpmdW5jIChzcCAqc291cmNlUHJpbnRlcikgc3BsaXRJbnRvUmFuZ2VzKHByb2YgKnByb2ZpbGUuUHJvZmlsZSwgYWRkck1hcCBtYXBbdWludDY0XWFkZHJJbmZvLCBmbGF0IG1hcFt1aW50NjRdaW50NjQpIChbXWFkZHJlc3NSYW5nZSwgW111aW50NjQpIHsKCS8vIFBhcnRpdGlvbiBhZGRyZXNzZXMgaW50byB0d28gc2V0czogb25lcyB3aXRoIGEga25vd24gb2JqZWN0IGZpbGUsIGFuZCBvbmVzIHdpdGhvdXQuCgl2YXIgYWRkcnMsIHVucHJvY2Vzc2VkIFtddWludDY0Cglmb3IgYWRkciwgaW5mbyA6PSByYW5nZSBhZGRyTWFwIHsKCQlpZiBpbmZvLm9iaiAhPSBuaWwgewoJCQlhZGRycyA9IGFwcGVuZChhZGRycywgYWRkcikKCQl9IGVsc2UgewoJCQl1bnByb2Nlc3NlZCA9IGFwcGVuZCh1bnByb2Nlc3NlZCwgYWRkcikKCQl9Cgl9CglzbGljZXMuU29ydChhZGRycykKCgljb25zdCBleHBhbmQgPSA1MDAgLy8gSG93IG11Y2ggdG8gZXhwYW5kIHJhbmdlIHRvIHBpY2sgdXAgbmVhcmJ5IGFkZHJlc3Nlcy4KCXZhciByZXN1bHQgW11hZGRyZXNzUmFuZ2UKCWZvciBpLCBuIDo9IDAsIGxlbihhZGRycyk7IGkgPCBuOyB7CgkJYmVnaW4sIGVuZCA6PSBhZGRyc1tpXSwgYWRkcnNbaV0KCQlzdW0gOj0gZmxhdFtiZWdpbl0KCQlpKysKCgkJaW5mbyA6PSBhZGRyTWFwW2JlZ2luXQoJCW0gOj0gaW5mby5sb2MuTWFwcGluZwoJCW9iaiA6PSBpbmZvLm9iaiAvLyBOb24tbmlsIGJlY2F1c2Ugb2YgdGhlIHBhcnRpdGlvbmluZyBkb25lIGFib3ZlLgoKCQkvLyBGaW5kIGZvbGxvd2luZyBhZGRyZXNzZXMgdGhhdCBhcmUgY2xvc2UgZW5vdWdoIHRvIGFkZHJzW2ldLgoJCWZvciBpIDwgbiAmJiBhZGRyc1tpXSA8PSBlbmQrMipleHBhbmQgJiYgYWRkcnNbaV0gPCBtLkxpbWl0IHsKIGVtaXQgYXMgcGFydAovLyBvZiBhIC8vZ286Y2dvX2ltcG9ydF9keW5hbWljIHByYWdtYS4gVGhlc2UgbmFtZXMgY29tZSBmcm9tIG9iamVjdAovLyBmaWxlcywgc28gdGhleSBtYXkgYmUgY29ycnVwdC4gV2UgYXJlIGdvaW5nIHRvIGVtaXQgdGhlbSB1bnF1b3RlZCwKLy8gc28gd2hpbGUgdGhleSBkb24ndCBuZWVkIHRvIGJlIHZhbGlkIHN5bWJvbCBuYW1lcyAoYW5kIGluIHNvbWUgY2FzZXMsCi8vIGludm9sdmluZyBzeW1ib2wgdmVyc2lvbnMsIHRoZXkgd29uJ3QgYmUpIHRoZXkgbXVzdCBjb250YWluIG9ubHkKLy8gZ3JhcGhpYyBjaGFyYWN0ZXJzIGFuZCBtdXN0IG5vdCBjb250YWluIEdvIGNvbW1lbnRzLgpmdW5jIGNoZWNrSW1wb3J0U3ltTmFtZShzIHN0cmluZykgewoJZm9yIF8sIGMgOj0gcmFuZ2UgcyB7CgkJaWYgIXVuaWNvZGUuSXNHcmFwaGljKGMpIHx8IHVuaWNvZGUuSXNTcGFjZShjKSB7CgkJCWZhdGFsZigiZHluYW1pYyBzeW1ib2wgJXEgY29udGFpbnMgdW5zdXBwb3J0ZWQgY2hhcmFjdGVyIiwgcykKCQl9Cgl9CglpZiBzdHJpbmdzLkNvbnRhaW5zKHMsICIvLyIpIHx8IHN0cmluZ3MuQ29udGFpbnMocywgIi8qIikgewoJCWZhdGFsZigiZHluYW1pYyBzeW1ib2wgJXEgY29udGFpbnMgR28gY29tbWVudCIsIHMpCgl9Cn0KCi8vIENvbnN0cnVjdCBhIGdjYyBzdHJ1Y3QgbWF0Y2hpbmcgdGhlIGdjIGFyZ3VtZW50IGZyYW1lLgovLyBBc3N1bWVzIHRoYXQgaW4gZ2NjLCBjaGFyIGlzIDEgYnl0ZSwgc2hvcnQgMiBieXRlcywgaW50IDQgYnl0ZXMsIGxvbmcgbG9uZyA4IGJ5dGVzLgovLyBUaGVzZSBhc3N1bXB0aW9ucyBhcmUgY2hlY2tlZCBieSB0aGUgZ2NjUHJvbG9nLgovLyBBbHNvIGFzc3VtZXMgdGhhdCBnYyBjb252ZW50aW9uIGlzIHRvIHdvcmQtYWxpZ24gdGhlCi8vIGlucHV0IGFuZCBvdXRwdXQgcGFyYW1ldGVycy4KZnVuYyAocCAqUGFja2FnZSkgc3RydWN0VHlwZShuICpOYW1lKSAoc3RyaW5nLCBpbnQ2NCkgewoJLy8gSXQncyBwb3NzaWJsZSBmb3IgdXMgdG8gc2VlIGEgdHlwZSB3aXRoIGEgdG9wLWxldmVsIGNvbnN0IGhlcmUsCgkvLyB3aGljaCB3aWxsIGdpdmUgdXMgYW4gdW51c2FibGUgc3RydWN0IHR5cGUuIFNlZSAjNzU3NTEuCgkvLyBUaGUgdG9wLWxldmVsIGNvbnN0IHdpbGwgYWx3YXlzIGFwcGVhciBhcyBhIGZpbmFsIHF1YWxpZmllciwKCS8vIGNvbnN0cnVjdGVkIGJ5IHR5cGVDb252LmxvYWRUeXBlIGluIHRoZSBkd2FyZi5RdWFsVHlwZSBjYXNlLgoJLy8gVGhlIHRvcC1sZXZlbCBjb25zdCBpcyBtZWFuaW5nbGVzcyBoZXJlIGFuZCBjYW4gc2ltcGx5IGJlIHJlbW92ZWQuCglzdHJpcENvbnN0IDo9IGZ1bmMocyBzdHJpbmcpIHN0cmluZyB7CgkJaSA6PSBzdHJpbmdzLkxhc3RJbmRleChzLCAiY29uc3QiKQoJCWlmIGkgPT0gLTEgewoJCQlyZXR1cm4gcwoJCX0KCgkJLy8gQSB0b3AtbGV2ZWwgY29uc3QgY2FuIG9ubHkgYmUgZm9sbG93ZWQgYnkgb3RoZXIgcXVhbGlmaWVycy4KCQlpZiByLCBvayA6PSBzdHJpbmdzLkN1dFN1ZmZpeChzLCAiY29uc3QiKTsgb2sgewoJCQlyZXR1cm4gc3RyaW5ncy5UcmltU3BhY2UocikKCQl9CgoJCXZhciBub25Db25zdCBbXXN0cmluZwoJCWZvciBfLCBmIDo9IHJhbmdlIHN0cmluZ3MuRmllbGRzKHNbaTpdKSB7CgkJCXN3aXRjaCBmIHsKCQkJY2FzZSAiY29uc3QiOgoJCQljYXNlICJyZXN0cmljdCIsICJ2b2xhdGlsZSI6CgkJCQlub25Db25zdCA9IGFwcGVuZChub25Db25zdCwgZikKCQkJZGVmYXVsdDoKCQkJCXJldHVybiBzCgkJCX0KCQl9CgoJCXJldHVybiBzdHJpbmdzLlRyaW1TcGFjZShzWzppXSkgKyAiICIgKyBzdHJpbmdzLkpvaW4obm9uQ29uc3QsICIgIikKCX0KCgl2YXIgYnVmIHN0cmluZ3MuQnVpbGRlcgoJZm10LkZwcmludCgmYnVmLCAic3RydWN0IHtcbiIpCglvZmYgOj0gaW50NjQoMCkKCWZvciBpLCB0IDo9IHJhbmdlIG4uRnVuY1R5cGUuUGFyYW1zIHsKCUxhcmdlKHQgKnRlc3RpbmcuVCkgewoJY29uc3QgTiA9IDEwMDAwMAoJY29uc3Qgb2Zmc2V0cyA9IDQKCW9rIDo9ICIxMzU3MmU5ZTI5NmNmZjUyYjc5YzUyMTQ4MzEzYzNhNSIgLy8gbWQ1c3VtIG9mICIwMTIzNDU2Nzg5IiAqIDEwMDAwCglibG9jayA6PSBtYWtlKFtdYnl0ZSwgTitvZmZzZXRzKQoJYyA6PSBOZXcoKQoJZm9yIG9mZnNldCA6PSAwOyBvZmZzZXQgPCBvZmZzZXRzOyBvZmZzZXQrKyB7CgkJZm9yIGkgOj0gMDsgaSA8IE47IGkrKyB7CgkJCWJsb2NrW29mZnNldCtpXSA9ICcwJyArIGJ5dGUoaSUxMCkKCQl9CgkJZm9yIGJsb2NrU2l6ZSA6PSAxMDsgYmxvY2tTaXplIDw9IE47IGJsb2NrU2l6ZSAqPSAxMCB7CgkJCWJsb2NrcyA6PSBOIC8gYmxvY2tTaXplCgkJCWIgOj0gYmxvY2tbb2Zmc2V0IDogb2Zmc2V0K2Jsb2NrU2l6ZV0KCQkJYy5SZXNldCgpCgkJCWZvciBpIDo9IDA7IGkgPCBibG9ja3M7IGkrKyB7CgkJCQljLldyaXRlKGIpCgkJCX0KCQkJcyA6PSBmbXQuU3ByaW50ZigiJXgiLCBjLlN1bShuaWwpKQoJCQlpZiBzICE9IG9rIHsKCQkJCXQuRmF0YWxmKCJtZDUgVGVzdEV4dHJhTGFyZ2Ugb2Zmc2V0PSVkLCBibG9ja1NpemU9JWQgPSAlcyB3YW50ICVzIiwgb2Zmc2V0LCBibG9ja1NpemUsIHMsIG9rKQoJCQl9CgkJfQoJfQp9CgovLyBUZXN0cyB0aGF0IGJsb2NrR2VuZXJpYyAocHVyZSBHbykgYW5kIGJsb2NrIChpbiBhc3NlbWJseSBmb3IgYW1kNjQsIDM4NiwgYXJtKSBtYXRjaC4KZnVuYyBUZXN0QmxvY2tHZW5lcmljKHQgKnRlc3RpbmcuVCkgewoJZ2VuLCBhc20gOj0gTmV3KCkuKCpkaWdlc3QpLCBOZXcoKS4oKmRpZ2VzdCkKCWJ1ZiA6PSBtYWtlKFtdYnl0ZSwgQmxvY2tTaXplKjIwKSAvLyBhcmJpdHJhcnkgZmFjdG9yCglyYW5kLlJlYWQoYnVmKQoJYmxvY2tHZW5lcmljKGdlbiwgYnVmKQoJYmxvY2soYXNtLCBidWYpCglpZiAqZ2VuICE9ICphc20gewoJCXQuRXJyb3IoImJsb2NrIGFuZCBibG9ja0dlbmVyaWMgcmVzdWx0ZWQgaW4gZGlmZmVyZW50IHN0YXRlcyIpCgl9Cn0KCi8vIFRlc3RzIGZvciB1bm1hcnNoYWxpbmcgaGFzaGVzIHRoYXQgaGF2ZSBoYXNoZWQgYSBsYXJnZSBhbW91bnQgb2YgZGF0YQovLyBUaGUgaW5pdGlhbCBoYXNoIGdlbmVyYXRpb24gaXMgb21pdHRlZCBmcm9tIHRoZSB0ZXN0LCBiZWNhdXNlIGl0IHRha2VzIGEgbG9uZyB0aW1lLgovLyBUaGUgdGVzdCBjb250YWlucyBzb21lIGFscmVhZHktZ2VuZXJhdGVkIHN0YXRlcywgYW5kIHRoZWlyIGV4cGVjdGVkIHN1bXMKLy8gVGVzdHMgYSBwcm9ibGVtIHRoYXQgaXMgb3V0bGluZWQgaW4gR2l0SHViIGlzc3VlICMyOTU0MQovLyBUaGUgcHJvYmxlbSBpcyB0cmlnZ2VyZWQgd2hlbiBhbiBhbW91bnQgb2YgZGF0YSBoYXMgYmVlbiBoYXNoZWQgZm9yIHdoaWNoCi8vIHRoZSBkYXRhIGxlbmd0aCBoYXMgYSAxIGluIHRoZSAzMm5kIGJpdC4gV2hlbiBjYXN0ZWQgdG8gaW50LCB0aGlzIGNoYW5nZXMKLy8gdGhlIHNpZ24gb2YgdGhlIHZhbHVlLCBhbmQgY2F1c2VzIHRoZSBtb2R1bHVzIG9wZXJhdGlvbiB0byByZXR1cm4gYQovLyBkaWZmZXJlbnQgcmVzdWx0Lgp0eXBlIHVubWFyc2hhbFRlc3Qgc3RydWN0IHsKCXN0YXRlIHN0cmluZwoJc3VtICAgc3RyaW5nCn0KCnZhciBsYXJnZVVubWFyc2hhbFRlc3RzID0gW111bm1hcnNoYWxUZXN0ewoJLy8gRGF0YSBsZW5ndGg6IDdfMTAyXzQxNV83MzUKCXsKCQlzdGF0ZTogIm1kNVx4MDFceGE1XHhmN1x4ZjA9XHhkNlNceDg1XHhkOU1cbn1ceGMzXHUwNjAxXHg4OVx4ZTdAQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXFxdXl9gYWJjZGVmZ2hpamtsbW5vcHFyc3R1dlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDFceGE3VkN3IiwKCQlzdW06ICAgImNkZGVmY2Y3NGZmZWM3MDlhMGI0NWE2YTk4NzU2NGQ1IiwKCX0sCgkvLyBEYXRhIGxlbmd0aDogNl81NjVfNTQ0XzgyMwphbHl6ZXJ1dGlsLk11c3RFeHRyYWN0RG9jKGRvYywgIm1pbm1heCIpLAoJUmVxdWlyZXM6IFtdKmFuYWx5c2lzLkFuYWx5emVyewoJCWluc3BlY3QuQW5hbHl6ZXIsCgkJdHlwZWluZGV4YW5hbHl6ZXIuQW5hbHl6ZXIsCgl9LAoJUnVuOiBtaW5tYXgsCglVUkw6ICJodHRwczovL3BrZy5nby5kZXYvZ29sYW5nLm9yZy94L3Rvb2xzL2dvL2FuYWx5c2lzL3Bhc3Nlcy9tb2Rlcm5pemUjbWlubWF4IiwKfQoKLy8gVGhlIG1pbm1heCBwYXNzIHJlcGxhY2VzIGlmL2Vsc2Ugc3RhdGVtZW50cyB3aXRoIGNhbGxzIHRvIG1pbiBvciBtYXgsCi8vIGFuZCByZW1vdmVzIHVzZXItZGVmaW5lZCBtaW4vbWF4IGZ1bmN0aW9ucyB0aGF0IGFyZSBlcXVpdmFsZW50IHRvIGJ1aWx0LWlucy4KLy8KLy8gSWYvZWxzZSByZXBsYWNlbWVudCBwYXR0ZXJuczoKLy8KLy8gIDEuIGlmIGEgPCBiIHsgeCA9IGEgfSBlbHNlIHsgeCA9IGIgfSAgICAgICAgPT4gICAgICB4ID0gbWluKGEsIGIpCi8vICAyLiB4ID0gYTsgaWYgYSA8IGIgeyB4ID0gYiB9ICAgICAgICAgICAgICAgID0+ICAgICAgeCA9IG1heChhLCBiKQovLwovLyBQYXR0ZXJuIDEgcmVxdWlyZXMgdGhhdCBhIGlzIG5vdCBOYU4sIGFuZCBwYXR0ZXJuIDIgcmVxdWlyZXMgdGhhdCBiCi8vIGlzIG5vdCBOYW4uIFNpbmNlIHRoaXMgaXMgaGFyZCB0byBwcm92ZSwgd2UgcmVqZWN0IGZsb2F0aW5nLXBvaW50Ci8vIG51bWJlcnMuCi8vCi8vIEZ1bmN0aW9uIHJlbW92YWw6Ci8vIFVzZXItZGVmaW5lZCBtaW4vbWF4IGZ1bmN0aW9ucyBhcmUgc3VnZ2VzdGVkIGZvciByZW1vdmFsIGlmIHRoZXkgbWF5Ci8vIGJlIHNhZmVseSByZXBsYWNlZCBieSB0aGVpciBidWlsdC1pbiBuYW1lc2FrZS4KLy8KLy8gVmFyaWFudHM6Ci8vIC0gYWxsIGZvdXIgb3JkZXJlZCBjb21wYXJpc29ucwovLyAtICJ4IDo9IGEiIG9yICJ4ID0gYSIgb3IgInZhciB4ID0gYSIgaW4gcGF0dGVybiAyCi8vIC0gInggPCBiIiBvciAiYSA8IGIiIGluIHBhdHRlcm4gMgpmdW5jIG1pbm1heChwYXNzICphbmFseXNpcy5QYXNzKSAoYW55LCBlcnJvcikgewoJLy8gQ2hlY2sgZm9yIHVzZXItZGVmaW5lZCBtaW4vbWF4IGZ1bmN0aW9ucyB0aGF0IGNhbiBiZSByZW1vdmVkCgljaGVja1VzZXJEZWZpbmVkTWluTWF4KHBhc3MpCgoJLy8gY2hlY2sgaXMgY2FsbGVkIGZvciBhbGwgc3RhdGVtZW50cyBvZiB0aGlzIGZvcm06CgkvLyAgIGlmIGEgPCBiIHsgbGhzID0gcmhzIH0KCWNoZWNrIDo9IGZ1bmMoZmlsZSAqYXN0LkZpbGUsIGN1cklmU3RtdCBpbnNwZWN0b3IuQ3Vyc29yLCBjb21wYXJlICphc3QuQmluYXJ5RXhwcikgewoJCXZhciAoCgkJCWlmU3RtdCAgPSBjdXJJZlN0bXQuTm9kZSgpLigqYXN0LklmU3RtdCkKCQkJdGFzc2lnbiA9IGlmU3RtdC5Cb2R5Lkxpc3RbMF0uKCphc3QuQXNzaWduU3RtdCkKCQkJYSAgICAgICA9IGNvbXBhcmUuWAoJCQliICAgICAgID0gY29tcGFyZS5ZCgkJCWxocyAgICAgPSB0YXNzaWduLkxoc1swXQoJCQlyaHMgICAgID0gdGFzc2lnbi5SaHNbMF0KCQkJc2lnbiAgICA9IGlzSW5lcXVhbGl0eShjb21wYXJlLk9wKQoKCQkJLy8gY2FsbEFyZyBmb3JtYXRzIGEgY2FsbCBhcmd1bWVudCwgcHJlc2VydmluZyBjb21tZW50cyBmcm9tIFtzdGFydC1lbmQpLgoJCQljYWxsQXJnID0gZnVuYyhhcmcgYXN0LkV4cHIsIHN0YXJ0LCBlbmQgdG9rZW4uUG9zKSBzdHJpbmcgewoJCQkJY29tbWVudHMgOj0gYWxsQ29tbWVudHMoZmlsZSwgc3RhcnQsIGVuZCkKCQkJCXJldHVybiBjb25kKGFyZyA9PSBiLCAiLCAiLCAiIikgKyAvLyBzZWNvbmQgYXJndW1lbnQgbmVlZHMgYSBjb21tYQoJCQkJCWNvbmQoY29tbWVudHMgIT0gIiIsICJcbiIsICIiKSArIC8vIGNvbW1lbnRzIG5lZWQgdGhlaXIgb3duIGxpbmUKCQkJCQljb21tZW50cyArCgkJCQkJYXN0dXRpbC5Gb3JtYXQocGFzcy5Gc2V0LCBhcmcpCgkJCX0KCQkpCgoJCWlmIGZibG9jaywgb2sgOj0gaWZTcmUgaW5kaWNhdGVzIGEgZmFpbHVyZSB0byByZWdpc3RlcgoJLy8gd2l0aCB0aGUgbmV0cG9sbCBzeXN0ZW0uIFRoYXQgY2FuIGhhcHBlbiBmb3IKCS8vIGEgZmlsZSBkZXNjcmlwdG9yIHRoYXQgaXMgbm90IHN1cHBvcnRlZCBieQoJLy8gZXBvbGwva3F1ZXVlOyBmb3IgZXhhbXBsZSwgZGlzayBmaWxlcyBvbgoJLy8gTGludXggc3lzdGVtcy4gV2UgYXNzdW1lIHRoYXQgYW55IHJlYWwgZXJyb3IKCS8vIHdpbGwgc2hvdyB1cCBpbiBsYXRlciBJL08uCgkvLyBXZSBkbyByZXN0b3JlIHRoZSBibG9ja2luZyBiZWhhdmlvciBpZiBpdCB3YXMgc2V0IGJ5IHVzLgoJaWYgcG9sbEVyciA6PSBmLnBmZC5Jbml0KCJmaWxlIiwgcG9sbGFibGUpOyBwb2xsRXJyICE9IG5pbCAmJiBjbGVhck5vbkJsb2NrIHsKCQlpZiBlcnIgOj0gc3lzY2FsbC5TZXROb25ibG9jayhmZCwgZmFsc2UpOyBlcnIgPT0gbmlsIHsKCQkJZi5ub25ibG9jayA9IGZhbHNlCgkJfQoJfQoKCXJ1bnRpbWUuU2V0RmluYWxpemVyKGYuZmlsZSwgKCpmaWxlKS5jbG9zZSkKCXJldHVybiBmCn0KCmZ1bmMgc2lncGlwZSgpIC8vIGltcGxlbWVudGVkIGluIHBhY2thZ2UgcnVudGltZQoKLy8gZXBpcGVjaGVjayByYWlzZXMgU0lHUElQRSBpZiB3ZSBnZXQgYW4gRVBJUEUgZXJyb3Igb24gc3RhbmRhcmQKLy8gb3V0cHV0IG9yIHN0YW5kYXJkIGVycm9yLiBTZWUgdGhlIFNJR1BJUEUgZG9jcyBpbiBvcy9zaWduYWwsIGFuZAovLyBpc3N1ZSAxMTg0NS4KZnVuYyBlcGlwZWNoZWNrKGZpbGUgKkZpbGUsIGUgZXJyb3IpIHsKCWlmIGUgPT0gc3lzY2FsbC5FUElQRSAmJiBmaWxlLnN0ZG91dE9yRXJyIHsKCQlzaWdwaXBlKCkKCX0KfQoKLy8gRGV2TnVsbCBpcyB0aGUgbmFtZSBvZiB0aGUgb3BlcmF0aW5nIHN5c3RlbSdzIOKAnG51bGwgZGV2aWNlLuKAnQovLyBPbiBVbml4LWxpa2Ugc3lzdGVtcywgaXQgaXMgIi9kZXYvbnVsbCI7IG9uIFdpbmRvd3MsICJOVUwiLgpjb25zdCBEZXZOdWxsID0gIi9kZXYvbnVsbCIKCi8vIG9wZW5GaWxlTm9sb2cgaXMgdGhlIFVuaXggaW1wbGVtZW50YXRpb24gb2YgT3BlbkZpbGUuCi8vIENoYW5nZXMgaGVyZSBzaG91bGQgYmUgcmVmbGVjdGVkIGluIG9wZW5EaXJBdCBhbmQgb3BlbkRpck5vbG9nLCBpZiByZWxldmFudC4KZnVuYyBvcGVuRmlsZU5vbG9nKG5hbWUgc3RyaW5nLCBmbGFnIGludCwgcGVybSBGaWxlTW9kZSkgKCpGaWxlLCBlcnJvcikgewoJc2V0U3RpY2t5IDo9IGZhbHNlCglpZiAhc3VwcG9ydHNDcmVhdGVXaXRoU3RpY2t5Qml0ICYmIGZsYWcmT19DUkVBVEUgIT0gMCAmJiBwZXJtJk1vZGVTdGlja3kgIT0gMCB7CgkJaWYgXywgZXJyIDo9IFN0YXQobmFtZSk7IElzTm90RXhpc3QoZXJyKSB7CgkJCXNldFN0aWNreSA9IHRydWUKCQl9Cgl9CgoJdmFyICgKCQlyIGludAoJCXMgcG9sbC5TeXNGaWxlCgkJZSBlcnJvcgoJKQoJLy8gV2UgaGF2ZSB0byBjaGVjayBFSU5UUiBoZXJlLCBwZXIgaXNzdWVzIDExMTgwIGFuZCAzOTIzNy4KCWlnbm9yaW5nRUlOVFIoZnVuYygpIGVycm9yIHsKCQlyLCBzLCBlID0gb3BlbihuYW1lLCBmbGFnfHN5c2NhbGwuT19DTE9FWEVDLCBzeXNjYWxsTW9kZShwZXJtKSkKCQlyZXR1cm4gZQoJfSkKCWlmIGUgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCAmUGF0aEVycm9ye09wOiAib3BlbiIsIFBhdGg6IG5hbWUsIEVycjogZX0KCX0KCgkvLyBvcGVuKDIpIGl0c2VsZiB3b24ndCBoYW5kbGUgdGhlIHN0aWNreSBiaXQgb24gKkJTRCBhbmQgU29sYXJpcwoJaWYgc2V0U3RpY2t5IHsKCQlzZXRTdGlja3lCaXQobmFtZSkKCX0KCgkvLyBUaGVyZSdzIGEgcmFjZSBoZXJlIHdpdGggZm9yay9leGVjLCB3aGljaCB3ZSBhcmUKCS8vIGNvbnRlbnQgdG8gbGl2ZSB3aXRoLiBTZWUgLi4vc3lzY2FsbC9leGVjX3VuaXguZ28uCglpZiAhc3VwcG9ydHNDbG9zZU9uRXhlYyB7CgkJc3lzY2FsbC5DbG9zZU9uRXhlYyhyKQoJfQoKCWYgOj0gbmV3RmlsZShyLCA9IEVycm5vKDB4ZCkKCUVBRERSSU5VU0UgICAgICA9IEVycm5vKDB4MzApCglFQUREUk5PVEFWQUlMICAgPSBFcnJubygweDMxKQoJRUFGTk9TVVBQT1JUICAgID0gRXJybm8oMHgyZikKCUVBR0FJTiAgICAgICAgICA9IEVycm5vKDB4MjMpCglFQUxSRUFEWSAgICAgICAgPSBFcnJubygweDI1KQoJRUFVVEggICAgICAgICAgID0gRXJybm8oMHg1MCkKCUVCQURGICAgICAgICAgICA9IEVycm5vKDB4OSkKCUVCQURNU0cgICAgICAgICA9IEVycm5vKDB4NWMpCglFQkFEUlBDICAgICAgICAgPSBFcnJubygweDQ4KQoJRUJVU1kgICAgICAgICAgID0gRXJybm8oMHgxMCkKCUVDQU5DRUxFRCAgICAgICA9IEVycm5vKDB4NTgpCglFQ0hJTEQgICAgICAgICAgPSBFcnJubygweGEpCglFQ09OTkFCT1JURUQgICAgPSBFcnJubygweDM1KQoJRUNPTk5SRUZVU0VEICAgID0gRXJybm8oMHgzZCkKCUVDT05OUkVTRVQgICAgICA9IEVycm5vKDB4MzYpCglFREVBRExLICAgICAgICAgPSBFcnJubygweGIpCglFREVTVEFERFJSRVEgICAgPSBFcnJubygweDI3KQoJRURPTSAgICAgICAgICAgID0gRXJybm8oMHgyMSkKCUVEUVVPVCAgICAgICAgICA9IEVycm5vKDB4NDUpCglFRVhJU1QgICAgICAgICAgPSBFcnJubygweDExKQoJRUZBVUxUICAgICAgICAgID0gRXJybm8oMHhlKQoJRUZCSUcgICAgICAgICAgID0gRXJybm8oMHgxYikKCUVGVFlQRSAgICAgICAgICA9IEVycm5vKDB4NGYpCglFSE9TVERPV04gICAgICAgPSBFcnJubygweDQwKQoJRUhPU1RVTlJFQUNIICAgID0gRXJybm8oMHg0MSkKCUVJRFJNICAgICAgICAgICA9IEVycm5vKDB4NTkpCglFSUxTRVEgICAgICAgICAgPSBFcnJubygweDU0KQoJRUlOUFJPR1JFU1MgICAgID0gRXJybm8oMHgyNCkKCUVJTlRSICAgICAgICAgICA9IEVycm5vKDB4NCkKCUVJTlZBTCAgICAgICAgICA9IEVycm5vKDB4MTYpCglFSU8gICAgICAgICAgICAgPSBFcnJubygweDUpCglFSVBTRUMgICAgICAgICAgPSBFcnJubygweDUyKQoJRUlTQ09OTiAgICAgICAgID0gRXJybm8oMHgzOCkKCUVJU0RJUiAgICAgICAgICA9IEVycm5vKDB4MTUpCglFTEFTVCAgICAgICAgICAgPSBFcnJubygweDVmKQoJRUxPT1AgICAgICAgICAgID0gRXJybm8oMHgzZSkKCUVNRURJVU1UWVBFICAgICA9IEVycm5vKDB4NTYpCglFTUZJTEUgICAgICAgICAgPSBFcnJubygweDE4KQoJRU1MSU5LICAgICAgICAgID0gRXJybm8oMHgxZikKCUVNU0dTSVpFICAgICAgICA9IEVycm5vKDB4MjgpCglFTkFNRVRPT0xPTkcgICAgPSBFcnJubygweDNmKQoJRU5FRURBVVRIICAgICAgID0gRXJybm8oMHg1MSkKCUVORVRET1dOICAgICAgICA9IEVycm5vKDB4MzIpCglFTkVUUkVTRVQgICAgICAgPSBFcnJubygweDM0KQoJRU5FVFVOUkVBQ0ggICAgID0gRXJybm8oMHgzMykKCUVORklMRSAgICAgICAgICA9IEVycm5vKDB4MTcpCglFTk9BVFRSICAgICAgICAgPSBFcnJubygweDUzKQoJRU5PQlVGUyAgICAgICAgID0gRXJybm8oMHgzNykKCUVOT0RFViAgICAgICAgICA9IEVycm5vKDB4MTMpCglFTk9FTlQgICAgICAgICAgPSBFcnJubygweDIpCglFTk9FWEVDICAgICAgICAgPSBFcnJubygweDgpCglFTk9MQ0sgICAgICAgICAgPSBFcnJubygweDRkKQoJRU5PTUVESVVNICAgICAgID0gRXJybm8oMHg1NSkKCUVOT01FTSAgICAgICAgICA9IEVycm5vKDB4YykKCUVOT01TRyAgICAgICAgICA9IEVycm5vKDB4NWEpCglFTk9QUk9UT09QVCAgICAgPSBFcnJubygweDJhKQoJRU5PU1BDICAgICAgICAgID0gRXJybm8oMHgxYykKCUVOT1NZUyAgICAgICAgICA9IEVycm5vKDB4NGUpCglFTk9UQkxLICAgICAgICAgPSBFcnJubygweGYpCglFTk9UQ09OTiAgICAgICAgPSBFcnJubygweDM5KQoJRU5PVERJUiAgICAgICAgID0gRXJybm8oMHgxNCkKCUVOT1RFTVBUWSAgICAgICA9IEVycm5vKDB4NDIpCglFTk9UUkVDT1ZFUkFCTEUgPSBFcnJubygweDVkKQoJRU5PVFNPQ0sgICBsc2UsIGZhbHNlfSwKCQl7WzJdaW50ezEsIDJ9LCB0cnVlfSwKCQl7WzBdaW50e30sIGZhbHNlfSwKCQl7W11ieXRlKCJhYmMiKSwgdHJ1ZX0sCgkJe1tdYnl0ZSgiIiksIGZhbHNlfSwKCQl7bWFwW3N0cmluZ11pbnR7ImEiOiAxLCAiYiI6IDJ9LCB0cnVlfSwKCQl7bWFwW3N0cmluZ11pbnR7fSwgZmFsc2V9LAoJCXttYWtlKGNoYW4gaW50KSwgdHJ1ZX0sCgkJe25pbF9jaGFuLCBmYWxzZX0sCgkJe25ldyhpbnQpLCB0cnVlfSwKCQl7bmlsX3B0ciwgZmFsc2V9LAoJCXt1bnNhZmUuUG9pbnRlcihuZXcoaW50KSksIHRydWV9LAoJCXt1bnNhZmUuUG9pbnRlcihuaWxfcHRyKSwgZmFsc2V9LAoJfQoJZm9yIF8sIHRlc3RfY2FzZSA6PSByYW5nZSB0ZXN0cyB7CgkJZ290LCBfIDo9IElzVHJ1ZSh0ZXN0X2Nhc2UudikKCQlpZiBnb3QgIT0gdGVzdF9jYXNlLndhbnQgewoJCQl0LkZhdGFsZigiZXhwZWN0IHJlc3VsdCAldiwgZ290ICV2IiwgdGVzdF9jYXNlLndhbnQsIGdvdCkKCQl9Cgl9Cn0KCmZ1bmMgdGVzdEJhZEZ1bmNOYW1lKG5hbWUgc3RyaW5nLCB0ICp0ZXN0aW5nLlQpIHsKCXQuSGVscGVyKCkKCWRlZmVyIGZ1bmMoKSB7CgkJcmVjb3ZlcigpCgl9KCkKCU5ldygiWCIpLkZ1bmNzKAoJCUZ1bmNNYXB7CgkJCW5hbWU6IGZ1bmNOYW1lVGVzdEZ1bmMsCgkJfSwKCSkKCS8vIElmIHdlIGdldCBoZXJlLCB0aGUgbmFtZSBkaWQgbm90IGNhdXNlIGEgcGFuaWMsIHdoaWNoIGlzIGhvdyBGdW5jcwoJLy8gcmVwb3J0cyBhbiBlcnJvci4KCXQuRXJyb3JmKCIlcSBzdWNjZWVkZWQgaW5jb3JyZWN0bHkgYXMgZnVuY3Rpb24gbmFtZSIsIG5hbWUpCn0KCmZ1bmMgVGVzdEJsb2NrKHQgKnRlc3RpbmcuVCkgewoJY29uc3QgKAoJCWlucHV0ICAgPSBgYSh7e2Jsb2NrICJpbm5lciIgLn19YmFyKHt7Ln19KWJhent7ZW5kfX0pYmAKCQl3YW50ICAgID0gYGEoYmFyKGhlbGxvKWJheiliYAoJCW92ZXJsYXkgPSBge3tkZWZpbmUgImlubmVyIn19Zm9vKHt7Ln19KWJhcnt7ZW5kfX1gCgkJd2FudDIgICA9IGBhKGZvbyhnb29kYnllKWJhciliYAoJKQoJdG1wbCwgZXJyIDo9IE5ldygib3V0ZXIiKS5QYXJzZShpbnB1dCkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWwoZXJyKQoJfQoJdG1wbDIsIGVyciA6PSBNdXN0KHRtcGwuQ2xvbmUoKSkuUGFyc2Uob3ZlcmxheSkKCWlmIGVyciAhPSBuaWwgewoJCXQuRmF0YWwoZXJyKQoJfQoKCXZhciBidWYgc3RyaW5ncy5CdWlsZGVyCglpZiBlcnIgOj0gdG1wbC5FeGVjdXRlKCZidWYsICJoZWxsbyIpOyBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsKGVycikKCX0KCWlmIGdvdCA6PSBidWYuU3RyaW5nKCk7IGdvdCAhPSB3YW50IHsKCQl0LkVycm9yZigiZ290ICVxLCB3YW50ICVxIiwgZ290LCB3YW50KQoJfQoKCWJ1Zi5SZXNldCgpCglpZiBlcnIgOj0gdG1wbDIuRXhlY3V0ZSgmYnVmLCAiZ29vZGJ5ZSIpOyBlcnIgIT0gbmlsIHsKCQl0LkZhdGFsKGVycikKCX0KCWlmIGdvdCA6PSBidWYuU3RyaW5nKCk7IGdvdCAhPSB3YW50MiB7CgkJdC5FcnJvcmYoImdvdCAlcSwgd2FudCAlcSIsIGdvdCwgd2FudDIpCgl9Cn0KCmZ1bmMgVGVzdEV2YWxGaWVsZEVycm9ycyh0ICp0ZXN0aW5nLlQpIHsKCXRlc3RzIDo9IFtdc3RydWN0IHsKCQluYW1lLCBzcmMgc3RyaW5nCgkJdmFsdWUgICAgIGFueQoJCXdhbnQgICAgICBzdHJpbmcKCX17CgkJewoJCQkvLyBDaGVjayB0aGF0IGNhbGxpbmcgYW4gaW52YWxpZCBmaWVsZCBvbiBuaWwgcG9pbnRlcgoJCQkvLyBwcmludHMgYSBmaWVsZCBlcnJvciBpbnN0ZWFkIG9mIGEgZGlzdHJhY3RpbmcgbmlsCgkJCS8vIHBvaW50ZXIgZXJyb3IuIGh0dHBzOi8vZ29sYW5nLm9yZy9pc3N1ZS8xNTEyNQoJCQkiTWlzc2luZ0ZpZWxkT25OaWwiLAoJCQkie3suTWlzc2luZ0ZpZWxkfX0iLAoJCQkoKlQpKG5pbCksCgkJCSJjYW4ndCBldmFsdWF0ZSBmaWVsZCBNaXNzaW5nRmllbGQgaW4gdHlwZSAqdGVtcGxhdGUuVCIsCgkJcG9ydCBpbmxpbmVkIGZ1bmN0aW9ucy4KCglmcmFtZXMgOj0gW11kcml2ZXIuRnJhbWV7CgkJewoJCQlGdW5jOiBuYW1lLAoJCQlGaWxlOiBsZW50cnkuRmlsZS5OYW1lLAoJCQlMaW5lOiBsZW50cnkuTGluZSwKCQl9LAoJfQoKCXJldHVybiBmcmFtZXMKfQoKZnVuYyAoZiAqZmlsZSkgU3ltYm9scyhyICpyZWdleHAuUmVnZXhwLCBhZGRyIHVpbnQ2NCkgKFtdKmRyaXZlci5TeW0sIGVycm9yKSB7CglpZiBmLnN5bSA9PSBuaWwgewoJCXN5bSwgZXJyIDo9IGYuZmlsZS5TeW1ib2xzKCkKCQlpZiBlcnIgIT0gbmlsIHsKCQkJcmV0dXJuIG5pbCwgZXJyCgkJfQoJCWYuc3ltID0gc3ltCgl9Cgl2YXIgb3V0IFtdKmRyaXZlci5TeW0KCWZvciBfLCBzIDo9IHJhbmdlIGYuc3ltIHsKCQkvLyBJZ25vcmUgYSBzeW1ib2wgd2l0aCBhZGRyZXNzIDAgYW5kIHNpemUgMC4KCQkvLyBBbiBFTEYgU1RUX0ZJTEUgc3ltYm9sIHdpbGwgbG9vayBsaWtlIHRoYXQuCgkJaWYgcy5BZGRyID09IDAgJiYgcy5TaXplID09IDAgewoJCQljb250aW51ZQoJCX0KCQlpZiAociA9PSBuaWwgfHwgci5NYXRjaFN0cmluZyhzLk5hbWUpKSAmJiAoYWRkciA9PSAwIHx8IHMuQWRkciA8PSBhZGRyICYmIGFkZHIgPCBzLkFkZHIrdWludDY0KHMuU2l6ZSkpIHsKCQkJb3V0ID0gYXBwZW5kKG91dCwgJmRyaXZlci5TeW17CgkJCQlOYW1lOiAgW11zdHJpbmd7cy5OYW1lfSwKCQkJCUZpbGU6ICBmLm5hbWUsCgkJCQlTdGFydDogcy5BZGRyLAoJCQkJRW5kOiAgIHMuQWRkciArIHVpbnQ2NChzLlNpemUpIC0gMSwKCQkJfSkKCQl9Cgl9CglyZXR1cm4gb3V0LCBuaWwKfQoKZnVuYyAoZiAqZmlsZSkgQ2xvc2UoKSBlcnJvciB7CglmLmZpbGUuQ2xvc2UoKQoJcmV0dXJuIG5pbAp9CgovLyBuZXdVSSB3aWxsIGJlIHNldCBpbiByZWFkbGluZXVpLmdvIGluIHNvbWUgcGxhdGZvcm1zCi8vIGZvciBpbnRlcmFjdGl2ZSByZWFkbGluZSBmdW5jdGlvbmFsaXR5Lgp2YXIgbmV3VUkgPSBmdW5jKCkgZHJpdmVyLlVJIHsgcmV0dXJuIG5pbCB9Ci8vIENvcHlyaWdodCAyMDE3IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIHN0cmluZ3MKCmltcG9ydCAoCgkiaW50ZXJuYWwvYWJpIgoJImludGVybmFsL2J5dGVhbGciCgkidW5pY29kZS91dGY4IgoJInVuc2FmZSIKKQoKLy8gQSBCdWlsZGVyIGlzIHVzZWQgdG8gZWZmaWNpZW50bHkgYnVpbGQgYSBzdHJpbmcgdXNpbmcgW0J1aWxkZXIuV3JpdGVdIG1ldGhvZHMuCi8vIEl0IG1pbmltaXplcyBtZW1vcnkgY29weWluZy4gVGhlIHplcm8gdmFsdWUgaXMgcmVhZHkgdG8gdXNlLgovLyBEbyBub3QgY29weSBhIG5vbi16ZXJvIEJ1aWxkZXIuCnR5cGUgQnVpbGRlciBzdHJ1Y3QgewoJYWRkciAqQnVpbGRlciAvLyBvZiByZWNlaXZlciwgdG8gZGV0ZWN0IGNvcGllcyBieSB2YWx1ZQoKCS8vIEV4dGVybmFsIHVzZXJzIHNob3VsZCBuZXZlciBnZXQgZGlyZWN0IGFjY2VzcyB0byB0aGlzIGJ1ZmZlciwgc2luY2UKCS8vIHRoZSBzbGljZSBhdCBzb21lIHBvaW50IHdpbGwgYmUgY29udmVydGVkIHRvIGEgc3RyaW5nIHVzaW5nIHVuc2FmZSwgYWxzbwoJLy8gZGF0YSBiZXR3ZWVuIGxlbihidWYpIGFuZCBjYXAoYnVmKSBtaWdodCBiZSB1bmluaXRpYWxpemVkLgoJYnVmIFtdYnl0ZQp9CgovLyBjb3B5Q2hlY2sgaW1wbGVtZW50cyBhIGR5bmFtaWMgY2hlY2sgdG8gcHJldmVudCBtb2RpZmljYXRpb24gYWZ0ZXIKLy8gY29weWluZyBhIG5vbi16ZXJvIEJ1aWxkZXIsIHdoaWNoIHdvdWxkIGJlIHVuc2FmZSAoc2VlICMyNTkwNywgIzQ3Mjc2KS4KLy8KLy8gV2UgY2Fubm90IGFkZCBhIG5vQ29weSBmaWVsZCB0byBCdWlsZGVyLCB0byBjYXVzZSB2ZXQncyBjb3B5bCBtYWluCgppbXBvcnQgKAoJImJ5dGVzIgoJImZtdCIKCSJpby9pb3V0aWwiCgkibG9nIgoJIm9zIgoJIm9zL2V4ZWMiCgkicGF0aC9maWxlcGF0aCIKCSJzdHJpbmdzIgopCgpmdW5jIG1haW4oKSB7CglmLCBlcnIgOj0gaW91dGlsLlRlbXBGaWxlKCIiLCAiaXNzdWUyMjY2MC5nbyIpCglpZiBlcnIgIT0gbmlsIHsKCQlsb2cuRmF0YWwoZXJyKQoJfQoJZi5DbG9zZSgpCglkZWZlciBvcy5SZW1vdmUoZi5OYW1lKCkpCgoJLy8gcGF0aCBtdXN0IGFwcGVhciBpbiBlcnJvciBtZXNzYWdlcyBldmVuIGlmIHdlIHN0cmlwIHRoZW0gd2l0aCAtdHJpbXBhdGgKCXBhdGggOj0gZmlsZXBhdGguSm9pbigidXNlcnMiLCAieHh4IiwgImdvIikKCXZhciBzcmMgYnl0ZXMuQnVmZmVyCglmbXQuRnByaW50Zigmc3JjLCAiLy9saW5lICVzOjFcbiIsIGZpbGVwYXRoLkpvaW4ocGF0aCwgImZvby5nbyIpKQoKCWlmIGVyciA6PSBpb3V0aWwuV3JpdGVGaWxlKGYuTmFtZSgpLCBzcmMuQnl0ZXMoKSwgMDY2MCk7IGVyciAhPSBuaWwgewoJCWxvZy5GYXRhbChlcnIpCgl9CgoJb3V0LCBlcnIgOj0gZXhlYy5Db21tYW5kKCJnbyIsICJ0b29sIiwgImNvbXBpbGUiLCAiLXA9cCIsIGZtdC5TcHJpbnRmKCItdHJpbXBhdGg9JXMiLCBwYXRoKSwgZi5OYW1lKCkpLkNvbWJpbmVkT3V0cHV0KCkKCWlmIGVyciA9PSBuaWwgewoJCWxvZy5GYXRhbGYoImV4cGVjdGVkIGNvbXBpbGluZyAlcyB0byBmYWlsIiwgZi5OYW1lKCkpCgl9CgoJaWYgIXN0cmluZ3MuSGFzUHJlZml4KHN0cmluZyhvdXQpLCBwYXRoKSB7CgkJbG9nLkZhdGFsZigiZXhwZWN0ZWQgZnVsbCBwYXRoICglcykgaW4gZXJyb3IgbWVzc2FnZSwgZ290OlxuJXMiLCBwYXRoLCBvdXQpCgl9Cn0KLy8gQ29weXJpZ2h0IDIwMjAgVGhlIEdvIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCi8vIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCi8vIGxpY2Vuc2UgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZS4KCnBhY2thZ2UgcHJpbnRlcgoKaW1wb3J0ICgKCSJnby9idWlsZC9jb25zdHJhaW50IgoJInNsaWNlcyIKCSJ0ZXh0L3RhYndyaXRlciIKKQoKZnVuYyAocCAqcHJpbnRlcikgZml4R29CdWlsZExpbmVzKCkgewoJaWYgbGVuKHAuZ29CdWlsZCkrbGVuKHAucGx1c0J1aWxkKSA9PSAwIHsKCQlyZXR1cm4KCX0KCgkvLyBGaW5kIGxhdGVzdCBwb3NzaWJsZSBwbGFjZW1lbnQgb2YgLy9nbzpidWlsZCBhbmQgLy8gK2J1aWxkIGNvbW1lbnRzLgoJLy8gVGhhdCdzIGp1c3QgYWZ0ZXIgdGhlIGxhc3QgYmxhbmsgbGluZSBiZWZvcmUgd2UgZmluZCBhIG5vbi1jb21tZW50LgoJLy8gKFdlJ2xsIGFkZCBhbm90aGVyIGJsYW5rIGxpbmUgYWZ0ZXIgb3VyIGNvbW1lbnQgYmxvY2suKQoJLy8gV2hlbiB3ZSBzdGFydCBkcm9wcGluZyAvLyArYnVpbGQgY29tbWVudHMsIHdlIGNhbiBza2lwIG92ZXIgLyogKi8gY29tbWVudHMgdG9vLgoJLy8gTm90ZSB0aGF0IHdlIGFyZSBwcm9jZXNzaW5nIHRhYndyaXRlciBpbnB1dCwgc28gZXZlcnkgY29tbWVudAoJLy8gYmVnaW5zIGFuZCBlbmRzIHdpdGggYSB0YWJ3cml0ZXIuRXNjYXBlIGJ5dGUuCgkvLyBBbmQgc29tZSBuZXdsaW5lcyBoYXZlIHR1cm5lZCBpbnRvIFxmIGJ5dGVzLgoJaW5zZXJ0IDo9IDAKCWZvciBwb3MgOj0gMDsgOyB7CgkJLy8gU2tpcCBsZWFkaW5nIHNwYWNlIGF0IGJlZ2lubmluZyBvZiBsaW5lLgoJCWJsYW5rIDo9IHRydWUKCQlmb3IgcG9zIDwgbGVuKHAub3V0cHV0KSAmJiAocC5vdXRwdXRbcG9zXSA9PSAnICcgfHwgcC5vdXRwdXRbcG9zXSA9PSAnXHQnKSB7CgkJCXBvcysrCgkJfQoJCS8vIFNraXAgb3ZlciAvLyBjb21tZW50IGlmIGFueS4KCQlpZiBwb3MrMyA8IGxlbihwLm91dHB1dCkgJiYgcC5vdXRwdXRbcG9zXSA9PSB0YWJ3cml0ZXIuRXNjYXBlICYmIHAub3V0cHV0W3BvcysxXSA9PSAnLycgJiYgcGN0dXJlIG9mIGEga2V5Ci8vIGV2ZW4gaW4gdGhlIHByZXNlbmNlIG9mIGRvdHMgaW5zaWRlIGNvbXBvbmVudHMsIHVzZQovLyBbSGFuZGxlck9wdGlvbnMuUmVwbGFjZUF0dHJdIHRvIGVuY29kZSB0aGF0IGluZm9ybWF0aW9uIGluIHRoZSBrZXkuCi8vCi8vIEVhY2ggY2FsbCB0byBIYW5kbGUgcmVzdWx0cyBpbiBhIHNpbmdsZSBzZXJpYWxpemVkIGNhbGwgdG8KLy8gaW8uV3JpdGVyLldyaXRlLgpmdW5jIChoICpUZXh0SGFuZGxlcikgSGFuZGxlKF8gY29udGV4dC5Db250ZXh0LCByIFJlY29yZCkgZXJyb3IgewoJcmV0dXJuIGguY29tbW9uSGFuZGxlci5oYW5kbGUocikKfQoKZnVuYyBhcHBlbmRUZXh0VmFsdWUocyAqaGFuZGxlU3RhdGUsIHYgVmFsdWUpIGVycm9yIHsKCXN3aXRjaCB2LktpbmQoKSB7CgljYXNlIEtpbmRTdHJpbmc6CgkJcy5hcHBlbmRTdHJpbmcodi5zdHIoKSkKCWNhc2UgS2luZFRpbWU6CgkJcy5hcHBlbmRUaW1lKHYudGltZSgpKQoJY2FzZSBLaW5kQW55OgoJCWlmIHRtLCBvayA6PSB2LmFueS4oZW5jb2RpbmcuVGV4dE1hcnNoYWxlcik7IG9rIHsKCQkJZGF0YSwgZXJyIDo9IHRtLk1hcnNoYWxUZXh0KCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCQkJLy8gVE9ETzogYXZvaWQgdGhlIGNvbnZlcnNpb24gdG8gc3RyaW5nLgoJCQlzLmFwcGVuZFN0cmluZyhzdHJpbmcoZGF0YSkpCgkJCXJldHVybiBuaWwKCQl9CgkJaWYgYnMsIG9rIDo9IGJ5dGVTbGljZSh2LmFueSk7IG9rIHsKCQkJLy8gQXMgb2YgR28gMS4xOSwgdGhpcyBvbmx5IGFsbG9jYXRlcyBmb3Igc3RyaW5ncyBsb25nZXIgdGhhbiAzMiBieXRlcy4KCQkJcy5idWYuV3JpdGVTdHJpbmcoc3RyY29udi5RdW90ZShzdHJpbmcoYnMpKSkKCQkJcmV0dXJuIG5pbAoJCX0KCQlzLmFwcGVuZFN0cmluZyhmbXQuU3ByaW50ZigiJSt2Iiwgdi5BbnkoKSkpCglkZWZhdWx0OgoJCSpzLmJ1ZiA9IHYuYXBwZW5kKCpzLmJ1ZikKCX0KCXJldHVybiBuaWwKfQoKLy8gYnl0ZVNsaWNlIHJldHVybnMgaXRzIGFyZ3VtZW50IGFzIGEgW11ieXRlIGlmIHRoZSBhcmd1bWVudCdzCi8vIHVuZGVybHlpbmcgdHlwZSBpcyBbXWJ5dGUsIGFsb25nIHdpdGggYSBzZWNvbmQgcmV0dXJuIHZhbHVlIG9mIHRydWUuCi8vIE90aGVyd2lzZSBpdCByZXR1cm5zIG5pbCwgZmFsc2UuCmZ1bmMgYnl0ZVNsaWNlKGEgYW55KSAoW11ieXRlLCBib29sKSB7CglpZiBicywgb2sgOj0gYS4oW11ieXRlKTsgb2sgewoJCXJldHVybiBicywgdHJ1ZQoJfQoJLy8gTGlrZSBQcmludGYncyAlcywgd2UgYWxsb3cgYm90aCB0aGUgc2xpY2UgdHlwZSBhbmQgdGhlIGJ5dGUgZWxlbWVudCB0eXBlIHRvIGJlIG5hbWVkLgoJdCA6PSByZWZsZWN0LlR5cGVPZihhKQoJaWYgdCAhPSBuaWwgJiYgdC5LaW5kKCkgPT0gcmVmbGVjdC5TbGljZSAmJiB0LkVsZW0oKS5LaW5kKCkgPT0gcmVmbGVjdC5VaW50OCB7CgkJcmV0dXJuIHJlZmxlY3QuVmFsdWVPZihhKS5CeXRlcygpLCB0cnVlCgl9CglyZXR1cm4gbmlsLCBmYWxzZQp9CgpmdW5jIG5lZWRzUXVvdGluZyhzIHN0cmluZykgYm9vbCB7CglpZiBsZW4ocykgPT0gMCB7CgkJcmV0dXJuIHRydWUKCX0KCWZvciBpIDo9IDA7IGkgPCBsZW4ocyk7IHsKCQliIDo9IHNbaV0KCQlpZiBiIDwgdXRmOC5SdW5lU2VsZiB7CgkJCS8vIFF1b3RlIGFueXRoaW5nIGV4Y2VwdCBhIGJhY2tzbGFzaCB0aGF0IHdvdWxkIG5lZWQgcXVvdGluZyBpbiBhCgkJCS8vIEpTT04gc3RyaW5nLCBhcyB3ZWxsIGFzIHNwYWNlIGFuZCAnPScKCQkJaWYgYiAhPSAnXFwnICYmIChiID09ICcgJyB8fCBiID09ICc9JyB8fCAhc2FmZVNldFtiXSkgewoJCQkJcmV0dXJuIHRydWUKCQkJfQoJCQlpKysKCQkJY29udGludWUKCQl9CgkJciwgc2l6ZSA6PSB1dGY4LkRlY29kZVJ1bmVJblN0cmluZyhzW2k6XSkKCQlpZiByID09IHV0ZjguUnVuZUVycm9yIHx8IHVuaWNvZGUuSXNTcGFjZShyKSB8fCBwczE0MC90bHMxMyIKCSJjcnlwdG8vaW50ZXJuYWwvaW1wbCIKCSJjcnlwdG8vcmFuZCIKCV8gImVtYmVkIgoJImVuY29kaW5nL2JpbmFyeSIKCSJlcnJvcnMiCgkiZm10IgoJImhhc2giCgkiaW50ZXJuYWwvdGVzdGVudiIKCSJpbyIKCSJtYXRoL2JpZyIKCSJvcyIKCSJwYXRoL2ZpbGVwYXRoIgoJInN0cmluZ3MiCgkidGVzdGluZyIKKQoKdmFyIG5vUEFBUEFJID0gb3MuR2V0ZW52KCJHT05PUEFBUEFJIikgPT0gIjEiCgovLyBVc2UgdGhlIGNhcGFiaWxpdGllcywgY29uZmlndXJhdGlvbiBhbmQgY29tbWFuZHMgZm9yIHRoZSBlbnRyb3B5IHNvdXJjZS4KLy8gVGhpcyBpcyB1c2VkIHRvIHRlc3QgdGhlIHNlcGFyYXRlIGVudHJvcHkgc291cmNlIGluIGNyeXB0by9pbnRlcm5hbC9lbnRyb3B5Ci8vIHNpbmNlIHRoZSBhbGdvcml0aG0gbmFtZSBhbG9uZSBjYW4ndCBpbmRpY2F0ZSB3aGljaCB0byB0ZXN0Lgp2YXIgZW50cm9weVRlc3RpbmcgPSBvcy5HZXRlbnYoIkdPRU5UUk9QWVNPVVJDRUFDVlAiKSA9PSAiMSIKCmZ1bmMgVGVzdE1haW4obSAqdGVzdGluZy5NKSB7CglpZiBub1BBQVBBSSB7CgkJZm9yIF8sIHAgOj0gcmFuZ2UgaW1wbC5QYWNrYWdlcygpIHsKCQkJaW1wbC5TZWxlY3QocCwgIiIpCgkJfQoJfQoJaWYgb3MuR2V0ZW52KCJBQ1ZQX1dSQVBQRVIiKSA9PSAiMSIgewoJCXdyYXBwZXJNYWluKCkKCX0gZWxzZSB7CgkJb3MuRXhpdChtLlJ1bigpKQoJfQp9CgpmdW5jIHdyYXBwZXJNYWluKCkgewoJaWYgIWZpcHMxNDAuRW5hYmxlZCB7CgkJZm10LkZwcmludGxuKG9zLlN0ZGVyciwgIkFDVlAgd3JhcHBlciBtdXN0IGJlIHJ1biB3aXRoIEdPREVCVUc9ZmlwczE0MD1vbiIpCgkJb3MuRXhpdCgyKQoJfQoJaWYgZXJyIDo9IHByb2Nlc3NpbmdMb29wKGJ1ZmlvLk5ld1JlYWRlcihvcy5TdGRpbiksIG9zLlN0ZG91dCk7IGVyciAhPSBuaWwgewoJCWZtdC5GcHJpbnRmKG9zLlN0ZGVyciwgInByb2Nlc3NpbmcgZXJyb3I6ICV2XG4iLCBlcnIpCgkJb3MuRXhpdCgxKQoJfQp9Cgp0eXBlIHJlcXVlc3Qgc3RydWN0IHsKCW5hbWUgc3RyaW5nCglhcmdzIFtdW11ieXRlCn0KCnR5cGUgY29tbWFuZEhhbmRsZXIgZnVuYyhbXVtdYnl0ZSkgKFtdW11ieXRlLCBlcnJvcikKCnR5cGUgY29tbWFuZCBzdHJ1Y3QgewoJLy8gcmVxdWlyZWRBcmdzIGVuZm9yY2VzIHRoYXQgYW4gZXhhY3QgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgcHJvdmlkZWQgdG8gdGhlIGhhbmRsZXIuCglyZXF1aXJlZEFyZ3MgaW50CgloYW5kbGVyICAgICAgY29tbWFuZEhhbmRsZXIKfQoKdHlwZSBlY2RzYVNpZ1R5cGUgaW50Cgpjb25zdCAoCgllY2RzYVNpZ1R5cGVOb3JtYWwgZWNkc2FTaWdUeXBlID0gaW90YQoJZWNkc2FTaWdUeXBlRGV0ZXJtaW5pc3RpYwopCgp0eXBlIGFlc0RpcmVjdGlvbiBpbnQKCmNvbnN0ICgKCWFlc0VuY3J5cHQgYWVzRGlyZWN0aW9uID0gaW90YQoJYWVzRGVjcnlwdAopCgp2YXIgKAoKCS8vIFNlcGFyYXRlIGNhcGFiaWxpdGllcyBzcGVjaWZpYyB0byB0ZXN0aW5nIHRoZSBlbnRyb3B5IHNvdXJjZSdzIFNIQTItMzg0IGltcGxlbWVudGF0aW9uLgoJLy8gVGhpcyBpbXBsZW1lbnRhdGlvbiBkaWZmZXJzIGZyb20gdGhlIEZJUFMgbW9kdWxlJ3MgU0hBMi0zODQgaW4gaXRzIHN1cHBvcnRlZCBpbnB1dCBzaXplcy4KCS8vIFNldCB0aGUgR09FTlRST1BZU09VUkNFQUNWUCBlbnZpcm9ubWVudCB2YXJpYWJsZSB0byB1c2UgdGhlc2UgY2FwYWJpbGl0aWVzIGluIHBsYWNlIG9mCgkvLyBjYXBhYmlsaXRpZXNKc29uCgkvL2dvOmVtYmVkIGFjdnBfY2FwYWJpbGl0aWVzLmVudHJvcHkuanNvbgoJZW50cm9weUNhcGFiaWxpdGllc0pzb24gW11ieXRlCgoJLy8gY29tbWFuZHMgc2hvdWxkIHJlZmxlY3Qgd2hhdCBjb25maWcgc2F5cyB3ZSBzdXBwb3J0LiBFLmcuIGFkZGluZyBhIGNvbW1hbmQgaGVyZSB3aWxsIGJlIGEgTk9QCgkvLyB1bmxlc3MgdGhlIGNvbmZpZ3VyYXRpb24vZGdlbiBkb2VzIG5vdCB1bmRlcnN0YW5kIG1lbW9yeSBhcyBvdXRwdXQgYXMgb2Ygbm93IikKCX0KCXJlZ0luZm8gKz0gZml4ZWROYW1lCglyZXR1cm4gcmVnSW5mbywgbmlsCn0KCi8vIHNvcnRPcGVyYW5kIHNvcnRzIG9wLkluIGJ5IHB1dHRpbmcgaW1tZWRpYXRlcyBmaXJzdCwgdGhlbiB2cmVnLCBhbmQgbWFzayB0aGUgbGFzdC4KLy8gVE9ETzogdmVyaWZ5IHRoYXQgdGhpcyBpcyBhIHNhZmUgYXNzdW1wdGlvbiBvZiB0aGUgcHJvZyBzdHJ1Y3R1cmUuCi8vIGZyb20gbXkgb2JzZXJ2YXRpb24gbG9va3MgbGlrZSBpbiBhc20sIGltbXMgYXJlIGFsd2F5cyB0aGUgZmlyc3QsCi8vIG1hc2tzIGFyZSBhbHdheXMgdGhlIGxhc3QsIHdpdGggdnJlZyBpbiBiZXR3ZWVuLgpmdW5jIChvcCAqT3BlcmF0aW9uKSBzb3J0T3BlcmFuZCgpIHsKCXByaW9yaXR5IDo9IG1hcFtzdHJpbmddaW50eyJpbW1lZGlhdGUiOiAwLCAidnJlZyI6IDEsICJncmVnIjogMSwgIm1hc2siOiAyfQoJc29ydC5TbGljZVN0YWJsZShvcC5JbiwgZnVuYyhpLCBqIGludCkgYm9vbCB7CgkJcGkgOj0gcHJpb3JpdHlbb3AuSW5baV0uQ2xhc3NdCgkJcGogOj0gcHJpb3JpdHlbb3AuSW5bal0uQ2xhc3NdCgkJaWYgcGkgIT0gcGogewoJCQlyZXR1cm4gcGkgPCBwagoJCX0KCQlyZXR1cm4gb3AuSW5baV0uQXNtUG9zIDwgb3AuSW5bal0uQXNtUG9zCgl9KQp9CgovLyBhZGp1c3RBc20gYWRqdXN0cyB0aGUgYXNtIHRvIG1ha2UgaXQgYWxpZ24gd2l0aCBHbydzIGFzc2VtYmxlci4KZnVuYyAob3AgKk9wZXJhdGlvbikgYWRqdXN0QXNtKCkgewoJaWYgb3AuQXNtID09ICJWQ1ZUVFBEMkRRIiB8fCBvcC5Bc20gPT0gIlZDVlRUUEQyVURRIiB8fAoJCW9wLkFzbSA9PSAiVkNWVFFRMlBTIiB8fCBvcC5Bc20gPT0gIlZDVlRVUVEyUFMiIHx8CgkJb3AuQXNtID09ICJWQ1ZUUEQyUFMiIHsKCQlzd2l0Y2ggKm9wLkluWzBdLkJpdHMgewoJCWNhc2UgMTI4OgoJCQlvcC5Bc20gKz0gIlgiCgkJY2FzZSAyNTY6CgkJCW9wLkFzbSArPSAiWSIKCQl9Cgl9Cn0KCi8vIGdvTm9ybWFsVHlwZSByZXR1cm5zIHRoZSBHbyB0eXBlIG5hbWUgZm9yIHRoZSByZXN1bHQgb2YgYW4gT3AgdGhhdAovLyBkb2VzIG5vdCByZXR1cm4gYSB2ZWN0b3IsIGkuZS4sIHRoYXQgcmV0dXJucyBhIHJlc3VsdCBpbiBhIGdlbmVyYWwKLy8gcmVnaXN0ZXIuICBDdXJyZW50bHkgdGhlcmUncyBvbmx5IG9uZSBmYW1pbHkgb2YgT3BzIGluIEdvJ3Mgc2ltZCBsaWJyYXJ5Ci8vIHRoYXQgZG9lcyB0aGlzIChHZXRFbGVtKSwgYW5kIHNvIHRoaXMgaXMgc3BlY2lhbGl6ZWQgdG8gd29yayBmb3IgdGhhdCwKLy8gYnV0IHRoZSBwcm9ibGVtIChtaXNtYXRjaCBiZXR3ZW4gaGFyZHdhcmUgcmVnaXN0ZXIgd2lkdGggYW5kIEdvIHR5cGUKLy8gd2lkdGgpIHNlZW1zIGxpa2VseSB0byByZWN1ciBpZiB0aGVyZSBhcmUgYW55IG90aGVyIGNhc2VzLgpmdW5jIChvcCBPcGVyYXRpb24pIGdvTm9ybWFsVHlwZSgpIHN0cmluZyB7CglpZiBvcC5HbyA9PSAiR2V0RWxlbSIgewoJCS8vIEdldEVsZW0gcmV0dXJucyBhbiBlbGVtZW50IG9mIHRoZSB2ZWN0b3IgaW50byBhIGdlbmVyYWwgcmVnaXN0ZXIKCQkvLyBidXQgYXMgZmFyIGFzIHRoZSBoYXJkd2FyZSBpcyBjb25jZXJuZWQsIHRoYXQgcmVzdWx0IGlzIGVpdGhlciAzMgoJCS8vIG9yIDY0IGJpdHMgd2lkZSwgbm8gbWF0dGVyIHdoYXQgdGhlIHZlY3RvciBlbGVtZW50IHdpZHRoIGlzLgoJCS8vIFRoaXMgaXMgbm90ICJ3cm9uZyIgYnV0IGl0IGlzIG5vdCB0aGUgcmlnaHQgYW5zd2VyIGZvciBHbyBzb3VyY2UgY29kZS4KCQkvLyBUbyBnZXQgdGhlIEdvIHR5cGUgcmlnaHQsIGNvbWJpbmUgdGhlIGJhc2UgdHlwZSAoImludCIsICJ1aW50IiwgImZsb2F0IiksCgkJLy8gd2l0aCB0aGUgaW5wdXQgdmVjdG9yIGVsZW1lbnQgd2lkdGggaW4gYml0cyAoOCwxNiwzMiw2NCkuCgoJCWF0IDo9IDAgLy8gcHJvcGVyIHZhbGREV0FSRkFkZHJTZWN0aW9uT2Zmc2V0KHMgU3ltLCB0IGFueSwgb2ZzIGludDY0KQoJQWRkSW5kaXJlY3RUZXh0UmVmKHMgU3ltLCB0IGFueSkKCUN1cnJlbnRPZmZzZXQocyBTeW0pIGludDY0CglSZWNvcmREY2xSZWZlcmVuY2UoZnJvbSBTeW0sIHRvIFN5bSwgZGNsSWR4IGludCwgaW5sSW5kZXggaW50KQoJUmVjb3JkQ2hpbGREaWVPZmZzZXRzKHMgU3ltLCB2YXJzIFtdKlZhciwgb2Zmc2V0cyBbXWludDMyKQoJQWRkU3RyaW5nKHMgU3ltLCB2IHN0cmluZykKCUxvZ2YoZm9ybWF0IHN0cmluZywgYXJncyAuLi5hbnkpCn0KCi8vIEFwcGVuZFVsZWIxMjggYXBwZW5kcyB2IHRvIGIgdXNpbmcgRFdBUkYncyB1bnNpZ25lZCBMRUIxMjggZW5jb2RpbmcuCmZ1bmMgQXBwZW5kVWxlYjEyOChiIFtdYnl0ZSwgdiB1aW50NjQpIFtdYnl0ZSB7Cglmb3IgewoJCWMgOj0gdWludDgodiAmIDB4N2YpCgkJdiA+Pj0gNwoJCWlmIHYgIT0gMCB7CgkJCWMgfD0gMHg4MAoJCX0KCQliID0gYXBwZW5kKGIsIGMpCgkJaWYgYyYweDgwID09IDAgewoJCQlicmVhawoJCX0KCX0KCXJldHVybiBiCn0KCi8vIEFwcGVuZFNsZWIxMjggYXBwZW5kcyB2IHRvIGIgdXNpbmcgRFdBUkYncyBzaWduZWQgTEVCMTI4IGVuY29kaW5nLgpmdW5jIEFwcGVuZFNsZWIxMjgoYiBbXWJ5dGUsIHYgaW50NjQpIFtdYnl0ZSB7Cglmb3IgewoJCWMgOj0gdWludDgodiAmIDB4N2YpCgkJcyA6PSB1aW50OCh2ICYgMHg0MCkKCQl2ID4+PSA3CgkJaWYgKHYgIT0gLTEgfHwgcyA9PSAwKSAmJiAodiAhPSAwIHx8IHMgIT0gMCkgewoJCQljIHw9IDB4ODAKCQl9CgkJYiA9IGFwcGVuZChiLCBjKQoJCWlmIGMmMHg4MCA9PSAwIHsKCQkJYnJlYWsKCQl9Cgl9CglyZXR1cm4gYgp9CgovLyBzZXZlbmJpdHMgY29udGFpbnMgYWxsIHVuc2lnbmVkIHNldmVuIGJpdCBudW1iZXJzLCBpbmRleGVkIGJ5IHRoZWlyIHZhbHVlLgp2YXIgc2V2ZW5iaXRzID0gWy4uLl1ieXRlewoJMHgwMCwgMHgwMSwgMHgwMiwgMHgwMywgMHgwNCwgMHgwNSwgMHgwNiwgMHgwNywgMHgwOCwgMHgwOSwgMHgwYSwgMHgwYiwgMHgwYywgMHgwZCwgMHgwZSwgMHgwZiwKCTB4MTAsIDB4MTEsIDB4MTIsIDB4MTMsIDB4MTQsIDB4MTUsIDB4MTYsIDB4MTcsIDB4MTgsIDB4MTksIDB4MWEsIDB4MWIsIDB4MWMsIDB4MWQsIDB4MWUsIDB4MWYsCgkweDIwLCAweDIxLCAweDIyLCAweDIzLCAweDI0LCAweDI1LCAweDI2LCAweDI3LCAweDI4LCAweDI5LCAweDJhLCAweDJiLCAweDJjLCAweDJkLCAweDJlLCAweDJmLAoJMHgzMCwgMHgzMSwgMHgzMiwgMHgzMywgMHgzNCwgMHgzNSwgMHgzNiwgMHgzNywgMHgzOCwgMHgzOSwgMHgzYSwgMHgzYiwgMHgzYywgMHgzZCwgMHgzZSwgMHgzZiwKCTB4NDAsIDB4NDEsIDB4NDIsIDB4NDMsIDB4NDQsIDB4NDUsIDB4NDYsIDB4NDcsIDB4NDgsIDB4NDksIDB4NGEsIDB4NGIsIDB4NGMsIDB4NGQsIDB4NGUsIDB4NGYsCgkweDUwLCAweDUxLCAweDUyLCAweDUzLCAweDU0LCAweDU1LCAweDU2LCAweDU3LCAweDU4LCAweDU5LCAweDVhLCAweDViLCAweDVjLCAweDVkLCAweDVlLCAweDVmLAoJMHg2MCwgMHg2MSwgMHg2MiwgMHg2MywgMHg2NCwgMHg2NSwgMHg2NiwgMHg2NywgMHg2OCwgMHg2OSwgMHg2YSwgMHg2YiwgMHg2YywgMHg2ZCwgMHg2ZSwgMHg2ZiwKCTB4NzAsIDB4NzEsIDB4NzIsIDB4NzMsIDB4NzQsIDB4NzUsIDB4NzYsIDB4NzcsIDB4NzgsIDB4NzksIDB4N2EsIDB4N2IsIDB4N2MsIDB4N2QsIDB4N2UsIDB4N2YsCn0KCi8vIHNldmVuQml0VSByZXR1cm5zIHRoZSB1bnNpZ25lZCBMRUIxMjggZW5jb2Rpbmcgb2YgdiBpZiB2IGlzIHNldmVuIGJpdHMgYW5kIG5pbCBvdGhlcndpc2UuCi8vIFRoZSBjb250ZW50cyBvZiB0aGUgcmV0dXJuZWQgc2xpY2UgbXVzdCBub3QgYmUgbW9kaWZpZWQuCmZ1bmMgc2V2ZW5CaXRVKHYgaW50NjQpIFtdYnl0ZSB7CglpZiB1aW50NjQodikgPCB1aW50NjQobGVuKHNpKSkKCgkJY2FzZSBpci5QUEFSQU1PVVQ6CgkJCS8vIEFsbCByZXN1bHRzIGFyZSBsaXZlIGF0IGV2ZXJ5IHJldHVybiBwb2ludC4KCQkJLy8gTm90ZSB0aGF0IHRoaXMgcG9pbnQgaXMgYWZ0ZXIgZXNjYXBpbmcgcmV0dXJuIHZhbHVlcwoJCQkvLyBhcmUgY29waWVkIGJhY2sgdG8gdGhlIHN0YWNrIHVzaW5nIHRoZWlyIFBBVVRPSEVBUCByZWZlcmVuY2VzLgoJCQlsdi5jYWNoZS5yZXR1ZXZhciA9IGFwcGVuZChsdi5jYWNoZS5yZXR1ZXZhciwgaW50MzIoaSkpCgkJfQoJfQp9CgovLyBBIGxpdmVFZmZlY3QgaXMgYSBzZXQgb2YgZmxhZ3MgdGhhdCBkZXNjcmliZSBhbiBpbnN0cnVjdGlvbidzCi8vIGxpdmVuZXNzIGVmZmVjdHMgb24gYSB2YXJpYWJsZS4KLy8KLy8gVGhlIHBvc3NpYmxlIGZsYWdzIGFyZToKLy8KLy8JdWV2YXIgLSB1c2VkIGJ5IHRoZSBpbnN0cnVjdGlvbgovLwl2YXJraWxsIC0ga2lsbGVkIGJ5IHRoZSBpbnN0cnVjdGlvbiAoc2V0KQovLwovLyBBIGtpbGwgaGFwcGVucyBhZnRlciB0aGUgdXNlIChmb3IgYW4gaW5zdHJ1Y3Rpb24gdGhhdCB1cGRhdGVzIGEgdmFsdWUsIGZvciBleGFtcGxlKS4KdHlwZSBsaXZlRWZmZWN0IGludAoKY29uc3QgKAoJdWV2YXIgbGl2ZUVmZmVjdCA9IDEgPDwgaW90YQoJdmFya2lsbAopCgovLyB2YWx1ZUVmZmVjdHMgcmV0dXJucyB0aGUgaW5kZXggb2YgYSB2YXJpYWJsZSBpbiBsdi52YXJzIGFuZCB0aGUKLy8gbGl2ZW5lc3MgZWZmZWN0cyB2IGhhcyBvbiB0aGF0IHZhcmlhYmxlLgovLyBJZiB2IGRvZXMgbm90IGFmZmVjdCBhbnkgdHJhY2tlZCB2YXJpYWJsZXMsIGl0IHJldHVybnMgLTEsIDAuCmZ1bmMgKGx2ICpMaXZlbmVzcykgdmFsdWVFZmZlY3RzKHYgKnNzYS5WYWx1ZSkgKGludDMyLCBsaXZlRWZmZWN0KSB7CgluLCBlIDo9IGFmZmVjdGVkVmFyKHYpCglpZiBlID09IDAgfHwgbiA9PSBuaWwgeyAvLyBjaGVhcGVzdCBjaGVja3MgZmlyc3QKCQlyZXR1cm4gLTEsIDAKCX0KCS8vIEFsbG9jRnJhbWUgaGFzIGRyb3BwZWQgdW51c2VkIHZhcmlhYmxlcyBmcm9tCgkvLyBsdi5mbi5GdW5jLkRjbCwgYnV0IHRoZXkgbWlnaHQgc3RpbGwgYmUgcmVmZXJlbmNlZCBieQoJLy8gT3BWYXJGb28gcHNldWRvLW9wcy4gSWdub3JlIHRoZW0gdG8gcHJldmVudCAibG9zdCB0cmFjayBvZgoJLy8gdmFyaWFibGUiIElDRXMgKGlzc3VlIDE5NjMyKS4KCXN3aXRjaCB2Lk9wIHsKCWNhc2Ugc3NhLk9wVmFyRGVmLCBzc2EuT3BWYXJMaXZlLCBzc2EuT3BLZWVwQWxpdmU6CgkJaWYgIW4uVXNlZCgpIHsKCQkJcmV0dXJuIC0xLCAwCgkJfQoJfQoKCWlmIG4uQ2xhc3MgPT0gaXIuUFBBUkFNICYmICFuLkFkZHJ0YWtlbigpICYmIG4uVHlwZSgpLlNpemUoKSA+IGludDY0KHR5cGVzLlB0clNpemUpIHsKCQkvLyBPbmx5IGFnZ3JlZ2F0ZS10eXBlZCBhcmd1bWVudHMgdGhhdCBhcmUgbm90IGFkZHJlc3MtdGFrZW4gY2FuIGJlCgkJLy8gcGFydGlhbGx5IGxpdmUuCgkJbHYucGFydExpdmVBcmdzW25dID0gdHJ1ZQoJfQoKCXZhciBlZmZlY3QgbGl2ZUVmZmVjdAoJLy8gUmVhZCBpcyBhIHJlYWQsIG9idmlvdXNseS4KCS8vCgkvLyBBZGRyIGlzIGEgcmVhZCBhbHNvLCBhcyBhbnkgc3Vic2VxdWVudCBob2xkZXIgb2YgdGhlIHBvaW50ZXIgbXVzdCBiZSBhYmxlCgkvLyB0byBzZWUgYWxsIHRoZSB2YWx1ZXMgKGluY2x1ZGluZyBpbml0aWFsaXphdGlvbikgd3JpdHRlbiBzbyBmYXIuCgkvLyBUaGlzIGFsc28gcHJldmVudHMgYSB2YXJpYWJsZSBmcm9tICJjb21pbmcgYmFjayBmcm9tIHRoZSBkZWFkIiBhbmQgcHJlc2VudGluZwoJLy8gc3RhbGUgcG9pbnRlcnMgdG8gdGhlIGdhcmJhZ2UgY29sbGVjdG9yLiBTZWUgaXNzdWUgMjg0NDUuCglpZiBlJihzc2EuU3ltUmVhZHxzc2EuU3ltQWRkcikgIT0gMCB7CgkJZWZmZWN0IHw9IHVldmFyCgl9CglpZiBlJnNzYS5TeW1Xcml0ZSAhPSAwIHsKCQlpZiAhaXNmYXQobi5UeXBlKCkpIHx8IHYuciBfLCBmIDo9IHJhbmdlIGdvZmlsZXMgewoJCWYgOj0gbWtBYnMocC5EaXIsIGYpCgoJCS8vIEhhbmRsZSBvdmVybGF5cy4gQ29udmVydCBwYXRoIG5hbWVzIHVzaW5nIGZzeXMuQWN0dWFsCgkJLy8gc28gdGhlc2UgcGF0aHMgY2FuIGJlIGhhbmRlZCBkaXJlY3RseSB0byB0b29scy4KCQkvLyBEZWxldGVkIGZpbGVzIHdvbid0IHNob3cgdXAgaW4gd2hlbiBzY2FubmluZyBkaXJlY3RvcmllcyBlYXJsaWVyLAoJCS8vIHNvIEFjdHVhbCB3aWxsIG5ldmVyIHJldHVybiAiIiAobWVhbmluZyBhIGRlbGV0ZWQgZmlsZSkgaGVyZS4KCQkvLyBUT0RPKCMzOTk1OCk6IEhhbmRsZSBjYXNlcyB3aGVyZSB0aGUgcGFja2FnZSBkaXJlY3RvcnkKCQkvLyBkb2Vzbid0IGV4aXN0IG9uIGRpc2sgKHRoaXMgY2FuIGhhcHBlbiB3aGVuIGFsbCB0aGUgcGFja2FnZSdzCgkJLy8gZmlsZXMgYXJlIGluIGFuIG92ZXJsYXkpOiB0aGUgY29kZSBleHBlY3RzIHRoZSBwYWNrYWdlIGRpcmVjdG9yeQoJCS8vIHRvIGV4aXN0IGFuZCBydW5zIHNvbWUgdG9vbHMgaW4gdGhhdCBkaXJlY3RvcnkuCgkJLy8gVE9ETygjMzk5NTgpOiBQcm9jZXNzIHRoZSBvdmVybGF5cyB3aGVuIHRoZQoJCS8vIGdvZmlsZXMsIGNnb2ZpbGVzLCBjZmlsZXMsIHNmaWxlcywgYW5kIGN4eGZpbGVzIHZhcmlhYmxlcyBhcmUKCQkvLyBjcmVhdGVkIGluICgqQnVpbGRlcikuYnVpbGQuIERvaW5nIHRoYXQgcmVxdWlyZXMgcmV3cml0aW5nIHRoZQoJCS8vIGNvZGUgdGhhdCB1c2VzIHRob3NlIHZhbHVlcyB0byBleHBlY3QgYWJzb2x1dGUgcGF0aHMuCgkJYXJncyA9IGFwcGVuZChhcmdzLCBmc3lzLkFjdHVhbChmKSkKCX0KCW91dHB1dCwgZXJyID0gc2gucnVuT3V0KGJhc2UuQ3dkKCksIGNmZ0NoYW5nZWRFbnYsIGFyZ3MuLi4pCglyZXR1cm4gb2ZpbGUsIG91dHB1dCwgZXJyCn0KCi8vIGNvbXBpbGVyQ29uY3VycmVuY3kgcmV0dXJucyB0aGUgY29tcGlsZXIgY29uY3VycmVuY3kgbGV2ZWwgZm9yIGEgcGFja2FnZSBjb21waWxhdGlvbi4KLy8gVGhlIHJldHVybmVkIGZ1bmN0aW9uIG11c3QgYmUgY2FsbGVkIGFmdGVyIHRoZSBjb21waWxlIGZpbmlzaGVzLgpmdW5jIGNvbXBpbGVyQ29uY3VycmVuY3koKSAoaW50LCBmdW5jKCkpIHsKCS8vIERlY2lkZSBob3cgbWFueSBjb25jdXJyZW50IGJhY2tlbmQgY29tcGlsYXRpb25zIHRvIGFsbG93LgoJLy8KCS8vIElmIHdlIGFsbG93IHRvbyBtYW55LCBpbiB0aGVvcnkgd2UgbWlnaHQgZW5kIHVwIHdpdGggcCBjb25jdXJyZW50IHByb2Nlc3NlcywKCS8vIGVhY2ggd2l0aCBjIGNvbmN1cnJlbnQgYmFja2VuZCBjb21waWxlcywgYWxsIGZpZ2h0aW5nIG92ZXIgdGhlIHNhbWUgcmVzb3VyY2VzLgoJLy8gSG93ZXZlciwgaW4gcHJhY3RpY2UsIHRoYXQgc2VlbXMgbm90IHRvIGhhcHBlbiB0b28gbXVjaC4KCS8vIE1vc3QgYnVpbGQgZ3JhcGhzIGFyZSBzdXJwcmlzaW5nbHkgc2VyaWFsLCBzbyBwPT0xIGZvciBtdWNoIG9mIHRoZSBidWlsZC4KCS8vIEZ1cnRoZXJtb3JlLCBjb25jdXJyZW50IGJhY2tlbmQgY29tcGlsYXRpb24gaXMgb25seSBlbmFibGVkIGZvciBhIHBhcnQKCS8vIG9mIHRoZSBvdmVyYWxsIGNvbXBpbGVyIGV4ZWN1dGlvbiwgc28gYz09MSBmb3IgbXVjaCBvZiB0aGUgYnVpbGQuCgkvLyBTbyBkb24ndCB3b3JyeSB0b28gbXVjaCBhYm91dCB0aGF0IGludGVyYWN0aW9uIGZvciBub3cuCgkvLwoJLy8gQnV0IHRvIGtlZXAgdGhpbmdzIHJlYXNvbmFibGUsIHdlIG1haW50YWluIGEgY2FwIG9uIHRoZSB0b3RhbCBudW1iZXIgb2YKCS8vIGNvbmN1cnJlbnQgYmFja2VuZCBjb21waWxlcy4gKElmIHdlIGdhdmUgZWFjaCBjb21waWxlIGFjdGlvbiB0aGUgZnVsbCBHT01BWFBST0NTLCB3ZSBjb3VsZAoJLy8gcG90ZW50aWFsbHkgaGF2ZSBHT01BWFBST0NTXjIgcnVubmluZyBjb21waWxlIGdvcm91dGluZXMpIEluIHRoZSBwYXN0LCB3ZSdkIGxpbWl0CgkvL2VuKCJpcDYuYXJwYS4iKSkKCS8vIEFkZCBpdCwgaW4gcmV2ZXJzZSwgdG8gdGhlIGJ1ZmZlcgoJZm9yIGkgOj0gbGVuKGlwKSAtIDE7IGkgPj0gMDsgaS0tIHsKCQl2IDo9IGlwW2ldCgkJYnVmID0gYXBwZW5kKGJ1ZiwgaGV4RGlnaXRbdiYweEZdLAoJCQknLicsCgkJCWhleERpZ2l0W3Y+PjRdLAoJCQknLicpCgl9CgkvLyBBcHBlbmQgImlwNi5hcnBhLiIgYW5kIHJldHVybiAoYnVmIGFscmVhZHkgaGFzIHRoZSBmaW5hbCAuKQoJYnVmID0gYXBwZW5kKGJ1ZiwgImlwNi5hcnBhLiIuLi4pCglyZXR1cm4gc3RyaW5nKGJ1ZiksIG5pbAp9CgpmdW5jIGVxdWFsQVNDSUlOYW1lKHgsIHkgZG5zbWVzc2FnZS5OYW1lKSBib29sIHsKCWlmIHguTGVuZ3RoICE9IHkuTGVuZ3RoIHsKCQlyZXR1cm4gZmFsc2UKCX0KCWZvciBpIDo9IDA7IGkgPCBpbnQoeC5MZW5ndGgpOyBpKysgewoJCWEgOj0geC5EYXRhW2ldCgkJYiA6PSB5LkRhdGFbaV0KCQlpZiAnQScgPD0gYSAmJiBhIDw9ICdaJyB7CgkJCWEgKz0gMHgyMAoJCX0KCQlpZiAnQScgPD0gYiAmJiBiIDw9ICdaJyB7CgkJCWIgKz0gMHgyMAoJCX0KCQlpZiBhICE9IGIgewoJCQlyZXR1cm4gZmFsc2UKCQl9Cgl9CglyZXR1cm4gdHJ1ZQp9CgovLyBpc0RvbWFpbk5hbWUgY2hlY2tzIGlmIGEgc3RyaW5nIGlzIGEgcHJlc2VudGF0aW9uLWZvcm1hdCBkb21haW4gbmFtZQovLyAoY3VycmVudGx5IHJlc3RyaWN0ZWQgdG8gaG9zdG5hbWUtY29tcGF0aWJsZSAicHJlZmVycmVkIG5hbWUiIExESCBsYWJlbHMgYW5kCi8vIFNSVi1saWtlICJ1bmRlcnNjb3JlIGxhYmVscyI7IHNlZSBnb2xhbmcub3JnL2lzc3VlLzEyNDIxKS4KLy8KLy8gaXNEb21haW5OYW1lIHNob3VsZCBiZSBhbiBpbnRlcm5hbCBkZXRhaWwsCi8vIGJ1dCB3aWRlbHkgdXNlZCBwYWNrYWdlcyBhY2Nlc3MgaXQgdXNpbmcgbGlua25hbWUuCi8vIE5vdGFibGUgbWVtYmVycyBvZiB0aGUgaGFsbCBvZiBzaGFtZSBpbmNsdWRlOgovLyAgIC0gZ2l0aHViLmNvbS9zYWdlcm5ldC9zaW5nCi8vCi8vIERvIG5vdCByZW1vdmUgb3IgY2hhbmdlIHRoZSB0eXBlIHNpZ25hdHVyZS4KLy8gU2VlIGdvLmRldi9pc3N1ZS82NzQwMS4KLy8KLy9nbzpsaW5rbmFtZSBpc0RvbWFpbk5hbWUKZnVuYyBpc0RvbWFpbk5hbWUocyBzdHJpbmcpIGJvb2wgewoJLy8gVGhlIHJvb3QgZG9tYWluIG5hbWUgaXMgdmFsaWQuIFNlZSBnb2xhbmcub3JnL2lzc3VlLzQ1NzE1LgoJaWYgcyA9PSAiLiIgewoJCXJldHVybiB0cnVlCgl9CgoJLy8gU2VlIFJGQyAxMDM1LCBSRkMgMzY5Ni4KCS8vIFByZXNlbnRhdGlvbiBmb3JtYXQgaGFzIGRvdHMgYmVmb3JlIGV2ZXJ5IGxhYmVsIGV4Y2VwdCB0aGUgZmlyc3QsIGFuZCB0aGUKCS8vIHRlcm1pbmFsIGVtcHR5IGxhYmVsIGlzIG9wdGlvbmFsIGhlcmUgYmVjYXVzZSB3ZSBhc3N1bWUgZnVsbHktcXVhbGlmaWVkCgkvLyAoYWJzb2x1dGUpIGlucHV0LiBXZSBtdXN0IHRoZXJlZm9yZSByZXNlcnZlIHNwYWNlIGZvciB0aGUgZmlyc3QgYW5kIGxhc3QKCS8vIGxhYmVscycgbGVuZ3RoIG9jdGV0cyBpbiB3aXJlIGZvcm1hdCwgd2hlcmUgdGhleSBhcmUgbmVjZXNzYXJ5IGFuZCB0aGUKCS8vIG1heGltdW0gdG90YWwgbGVuZ3RoIGlzIDI1NS4KCS8vIFNvIG91ciBfZWZmZWN0aXZlXyBtYXhpbXVtIGlzIDI1MywgYnV0IDI1NCBpcyBub3QgcmVqZWN0ZWQgaWYgdGhlIGxhc3QKCS8vIGNoYXJhY3RlciBpcyBhIGRvdC4KCWwgOj0gbGVuKHMpCglpZiBsID09IDAgfHwgbCA+IDI1NCB8fCBsID09IDI1NCAmJiBzW2wtMV0gIT0gJy4nIHsKCQlyZXR1cm4gZmFsc2UKCX0KCglsYXN0IDo9IGJ5dGUoJy4nKQoJbm9uTnVtZXJpYyA6PSBmYWxzZSAvLyB0cnVlIG9uY2Ugd2UndmUgc2VlbiBhIGxldHRlciBvciBoeXBoZW4KCXBhcnRsZW4gOj0gMAoJZm9yIGkgOj0gMDsgaSA8IGxlbihzKTsgaSsrIHsKCQljIDo9IHNbaV0KCQlzd2l0Y2ggewoJCWRlZmF1bHQ6CgkJCXJlKGNoYW4gc3RydWN0e30pCgloYW5kbGVyIDo9IGZ1bmModyBodHRwLlJlc3BvbnNlV3JpdGVyLCByZXEgKmh0dHAuUmVxdWVzdCkgewoJCWhhbmRsZXJDYWxscy5BZGQoMSkKCQk8LXJlcXVlc3RjCgl9CglfLCBjYyA6PSBuZXdDbGllbnRDb25uVGVzdCh0LCBtb2RlLCBoYW5kbGVyLCBvcHRGYWtlTmV0LCBmdW5jKHMgKmh0dHAuU2VydmVyKSB7CgkJcy5IVFRQMiA9ICZodHRwLkhUVFAyQ29uZmlnewoJCQlNYXhDb25jdXJyZW50U3RyZWFtczogMywKCQl9Cgl9KQoKCWF2YWlsYWJsZSA6PSBjYy5BdmFpbGFibGUoKQoJdmFyIHJlc3BvbnNlcyBhdG9taWMuSW50NjQKCWNvbnN0IGV4dHJhID0gMgoJZm9yIHJhbmdlIGF2YWlsYWJsZSArIGV4dHJhIHsKCQlnbyBmdW5jKCkgewoJCQlyZXEsIF8gOj0gaHR0cC5OZXdSZXF1ZXN0KCJHRVQiLCBtb2RlLlNjaGVtZSgpKyI6Ly9leGFtcGxlLnRsZC8iLCBuaWwpCgkJCXJlc3AsIGVyciA6PSBjYy5Sb3VuZFRyaXAocmVxKQoJCQlyZXNwb25zZXMuQWRkKDEpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJdC5FcnJvcmYoIlJvdW5kVHJpcDogJXYiLCBlcnIpCgkJCQlyZXR1cm4KCQkJfQoJCQlyZXNwLkJvZHkuQ2xvc2UoKQoJCX0oKQoJfQoKCXN5bmN0ZXN0LldhaXQoKQoJaWYgZ290LCB3YW50IDo9IGludChoYW5kbGVyQ2FsbHMuTG9hZCgpKSwgYXZhaWxhYmxlOyBnb3QgIT0gd2FudCB7CgkJdC5FcnJvcmYoImdvdCAldiBoYW5kbGVyIGNhbGxzLCB3YW50ICV2IiwgZ290LCB3YW50KQoJfQoJaWYgZ290LCB3YW50IDo9IGludChyZXNwb25zZXMuTG9hZCgpKSwgMDsgZ290ICE9IHdhbnQgewoJCXQuRXJyb3JmKCJnb3QgJXYgcmVzcG9uc2VzLCB3YW50ICV2IiwgZ290LCB3YW50KQoJfQoKCWZvciBpIDo9IHJhbmdlIGF2YWlsYWJsZSArIGV4dHJhIHsKCQlyZXF1ZXN0YyA8LSBzdHJ1Y3R7fXt9CgkJc3luY3Rlc3QuV2FpdCgpCgkJaWYgZ290LCB3YW50IDo9IGludChyZXNwb25zZXMuTG9hZCgpKSwgaSsxOyBnb3QgIT0gd2FudCB7CgkJCXQuRXJyb3JmKCJnb3QgJXYgcmVzcG9uc2VzLCB3YW50ICV2IiwgZ290LCB3YW50KQoJCX0KCX0KfQovLyBjZ28gLWdvZGVmcyAtLSAtZnNpZ25lZC1jaGFyIHR5cGVzX29wZW5ic2QuZ28gfCBnbyBydW4gbWtwb3N0LmdvCi8vIENvZGUgZ2VuZXJhdGVkIGJ5IHRoZSBjb21tYW5kIGFib3ZlOyBzZWUgUkVBRE1FLm1kLiBETyBOT1QgRURJVC4KCi8vZ286YnVpbGQgYXJtICYmIG9wZW5ic2QKCnBhY2thZ2UgdW5peAoKY29uc3QgKAoJU2l6ZW9mUHRyICAgICAgPSAweDQKCVNpemVvZlNob3J0ICAgID0gMHgyCglTaXplb2ZJbnQgICAgICA9IDB4NAoJU2l6ZW9mTG9uZyAgICAgPSAweDQKCVNpemVvZkxvbmdMb25nID0gMHg4CikKCnR5cGUgKAoJX0Nfc2hvcnQgICAgIGludDE2CglfQ19pbnQgICAgICAgaW50MzIKCV9DX2xvbmcgICAgICBpbnQzMgoJX0NfbG9uZ19sb25nIGludDY0CikKCnR5cGUgVGltZXNwZWMgc3RydWN0IHsKCVNlYyAgaW50NjQKCU5zZWMgaW50MzIKCV8gICAgWzRdYnl0ZQp9Cgp0eXBlIFRpbWV2YWwgc3RydWN0IHsKCVNlYyAgaW50NjQKCVVzZWMgaW50MzIKCV8gICAgWzRdYnl0ZQp9Cgp0eXBlIFJ1c2FnZSBzdHJ1Y3QgewoJVXRpbWUgICAgVGltZXZhbAoJU3RpbWUgICAgVGltZXZhbAoJTWF4cnNzICAgaW50MzIKCUl4cnNzICAgIGludDMyCglJZHJzcyAgICBpbnQzMgoJSXNyc3MgICAgaW50MzIKCU1pbmZsdCAgIGludDMyCglNYWpmbHQgICBpbnQzMgoJTnN3YXAgICAgaW50MzIKCUluYmxvY2sgIGludDMyCglPdWJsb2NrICBpbnQzMgoJTXNnc25kICAgaW50MzIKCU1zZ3JjdiAgIGludDMyCglOc2lnbmFscyBpbnQzMgoJTnZjc3cgICAgaW50MzIKCU5pdmNzdyAgIGludDMyCn0KCnR5cGUgUmxpbWl0IHN0cnVjdCB7CglDdXIgdWludDY0CglNYXggdWludDY0Cn0KCnR5cGUgX0dpZF90IHVpbnQzMgoKdHlwZSBTdGF0X3Qgc3RydWN0IHsKCU1vZGUgICAgdWluNDBkZXBzL2J5dGVvcmRlciIKCSJjcnlwdG8vaW50ZXJuYWwvZmlwczE0MGRlcHMvZ29kZWJ1ZyIKCSJpbyIKCSJ1bnNhZmUiCikKCi8vIFZlcmlmaWVkIGlzIHNldCB3aGVuIHZlcmlmaWNhdGlvbiBzdWNjZWVkZWQuIEl0IGNhbiBiZSBleHBlY3RlZCB0byBhbHdheXMgYmUKLy8gdHJ1ZSB3aGVuIFtmaXBzMTQwLkVuYWJsZWRdIGlzIHRydWUsIG9yIGluaXQgd291bGQgaGF2ZSBwYW5pY2tlZC4KdmFyIFZlcmlmaWVkIGJvb2wKCi8vIExpbmtpbmZvIGhvbGRzIHRoZSBnbzpmaXBzaW5mbyBzeW1ib2wgcHJlcGFyZWQgYnkgdGhlIGxpbmtlci4KLy8gU2VlIGNtZC9saW5rL2ludGVybmFsL2xkL2ZpcHMuZ28gZm9yIGRldGFpbHMuCi8vCi8vZ286bGlua25hbWUgTGlua2luZm8gZ286Zmlwc2luZm8KdmFyIExpbmtpbmZvIHN0cnVjdCB7CglNYWdpYyBbMTZdYnl0ZQoJU3VtICAgWzMyXWJ5dGUKCVNlbGYgIHVpbnRwdHIKCVNlY3RzIFs0XXN0cnVjdCB7CgkJLy8gTm90ZTogVGhlc2UgbXVzdCBiZSB1bnNhZmUuUG9pbnRlciwgbm90IHVpbnRwdHIsCgkJLy8gb3IgZWxzZSBjaGVja3B0ciBwYW5pY3MgYWJvdXQgdHVybmluZyB1aW50cHRycwoJCS8vIGludG8gcG9pbnRlcnMgaW50byB0aGUgZGF0YSBzZWdtZW50IGR1cmluZwoJCS8vIGdvIHRlc3QgLXJhY2UuCgkJU3RhcnQgdW5zYWZlLlBvaW50ZXIKCQlFbmQgICB1bnNhZmUuUG9pbnRlcgoJfQp9CgovLyAiXHhmZiIrZmlwc01hZ2ljIGlzIHRoZSBleHBlY3RlZCBsaW5raW5mby5NYWdpYy4KLy8gV2UgYXZvaWQgd3JpdGluZyB0aGF0IGV4cGxpY2l0bHkgc28gdGhhdCB0aGUgc3RyaW5nIGRvZXMgbm90IGFwcGVhcgovLyBlbHNld2hlcmUgaW4gbm9ybWFsIGJpbmFyaWVzLCBqdXN0IGFzIGEgcHJlY2F1dGlvbi4KY29uc3QgZmlwc01hZ2ljID0gIiBHbyBmaXBzaW5mbyBceGZmXHgwMCIKCnZhciB6ZXJvU3VtIFszMl1ieXRlCgpmdW5jIGluaXQoKSB7CglpZiAhZmlwczE0MC5FbmFibGVkIHsKCQlyZXR1cm4KCX0KCglpZiBlcnIgOj0gZmlwczE0MC5TdXBwb3J0ZWQoKTsgZXJyICE9IG5pbCB7CgkJcGFuaWMoImZpcHMxNDA6ICIgKyBlcnIuRXJyb3IoKSkKCX0KCglpZiBMaW5raW5mby5NYWdpY1swXSAhPSAweGZmIHx8IHN0cmluZyhMaW5raW5mby5NYWdpY1sxOl0pICE9IGZpcHNNYWdpYyB8fCBMaW5raW5mby5TdW0gPT0gemVyb1N1bSB7CgkJcGFuaWMoImZpcHMxNDA6IG5vIHZlcmlmaWNhdGlvbiBjaGVja3N1bSBmb3VuZCIpCgl9CgoJaCA6PSBobWFjLk5ldyhzaGEyNTYuTmV3LCBtYWtlKFtdYnl0ZSwgMzIpKQoJdyA6PSBpby5Xcml0ZXIoaCkKCgkvKgoJCS8vIFVuY29tbWVudCBmb3IgZGVidWdnaW5nLgoJCS8vIENvbW1lbnRlZCAoYXMgb3Bwb3NlZCB0byBhIGNvbnN0IGJvb2wgZmxhZykKCQkvLyB0byBhdm9pZCBpbXBvcnQgIm9zIiBpbiBkZWZhdWx0IGJ1aWxkcy4KCQlmLCBlcnIgOj0gb3MuQ3JlYXRlKCJmaXBzY2hlY2subyIpCgkJaWYgZXJyICE9IG5pbCB7CgkJCXBhbmljKGVycikKCQl9CgkJdyA9IGlvLk11bHRpV3JpdGVyKGgsIGYpCgkqLwoKCXcuV3JpdGUoW11ieXRlKCJnbyBmaXBzIG9iamVjdCB2MVxuIikpCgoJdmFyIG5idWYgWzhdYnl0ZQoJZm9yIF8sIHNlY3QgOj0gcmFuZ2UgTGlua2luZm8uU2VjdHMgewoJCW4gOj0gdWludHB0cihzZWN0LkVuZCkgLSB1aW50cHRyKHNlY3QuU3RhcnQpCgkJYnl0ZW9yZGVyLkJFUHV0VWludDY0KG5idWZbOl0sIHVpbnQ2NChuKSkKCQl3LldyaXRlKG5idWZbOl0pCgkJdy5Xcml0ZSh1bnNhZmUuU2xpY2UoKCpieXRlKShzZWN0LlN0YXJ0KSwgbikpCgl9CglzdW0gOj0gaC5TdW0obmlsKQoKCWlmIFszMl1ieXRlKHN1bSkgIT0gTGlua2luZm8uU3VtIHsKCQlwYW5pYygiZmlwczE0MDogdmVyaWZpY2F0aW9uIG1pc21hdGNoIikKCX0KCgkvLyAiVGhlIHRlbXBvcmFyeSB2YWx1ZShzKSBnZW5lcmF0ZWQgZHVyaW5nIHRoZSBpbnRlZ3JpdHkgdGVzdCBvZmwoMHgxOCkKCVNJR1hGU1ogICA9IHN5c2NhbGwuU2lnbmFsKDB4MTkpCikKCi8vIEVycm9yIHRhYmxlCnZhciBlcnJvckxpc3QgPSBbLi4uXXN0cnVjdCB7CgludW0gIHN5c2NhbGwuRXJybm8KCW5hbWUgc3RyaW5nCglkZXNjIHN0cmluZwp9ewoJezEsICJFUEVSTSIsICJvcGVyYXRpb24gbm90IHBlcm1pdHRlZCJ9LAoJezIsICJFTk9FTlQiLCAibm8gc3VjaCBmaWxlIG9yIGRpcmVjdG9yeSJ9LAoJezMsICJFU1JDSCIsICJubyBzdWNoIHByb2Nlc3MifSwKCXs0LCAiRUlOVFIiLCAiaW50ZXJydXB0ZWQgc3lzdGVtIGNhbGwifSwKCXs1LCAiRUlPIiwgImlucHV0L291dHB1dCBlcnJvciJ9LAoJezYsICJFTlhJTyIsICJubyBzdWNoIGRldmljZSBvciBhZGRyZXNzIn0sCgl7NywgIkUyQklHIiwgImFyZ3VtZW50IGxpc3QgdG9vIGxvbmcifSwKCXs4LCAiRU5PRVhFQyIsICJleGVjIGZvcm1hdCBlcnJvciJ9LAoJezksICJFQkFERiIsICJiYWQgZmlsZSBkZXNjcmlwdG9yIn0sCgl7MTAsICJFQ0hJTEQiLCAibm8gY2hpbGQgcHJvY2Vzc2VzIn0sCgl7MTEsICJFQUdBSU4iLCAicmVzb3VyY2UgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUifSwKCXsxMiwgIkVOT01FTSIsICJjYW5ub3QgYWxsb2NhdGUgbWVtb3J5In0sCgl7MTMsICJFQUNDRVMiLCAicGVybWlzc2lvbiBkZW5pZWQifSwKCXsxNCwgIkVGQVVMVCIsICJiYWQgYWRkcmVzcyJ9LAoJezE1LCAiRU5PVEJMSyIsICJibG9jayBkZXZpY2UgcmVxdWlyZWQifSwKCXsxNiwgIkVCVVNZIiwgImRldmljZSBvciByZXNvdXJjZSBidXN5In0sCgl7MTcsICJFRVhJU1QiLCAiZmlsZSBleGlzdHMifSwKCXsxOCwgIkVYREVWIiwgImludmFsaWQgY3Jvc3MtZGV2aWNlIGxpbmsifSwKCXsxOSwgIkVOT0RFViIsICJubyBzdWNoIGRldmljZSJ9LAoJezIwLCAiRU5PVERJUiIsICJub3QgYSBkaXJlY3RvcnkifSwKCXsyMSwgIkVJU0RJUiIsICJpcyBhIGRpcmVjdG9yeSJ9LAoJezIyLCAiRUlOVkFMIiwgImludmFsaWQgYXJndW1lbnQifSwKCXsyMywgIkVORklMRSIsICJ0b28gbWFueSBvcGVuIGZpbGVzIGluIHN5c3RlbSJ9LAoJezI0LCAiRU1GSUxFIiwgInRvbyBtYW55IG9wZW4gZmlsZXMifSwKCXsyNSwgIkVOT1RUWSIsICJpbmFwcHJvcHJpYXRlIGlvY3RsIGZvciBkZXZpY2UifSwKCXsyNiwgIkVUWFRCU1kiLCAidGV4dCBmaWxlIGJ1c3kifSwKCXsyNywgIkVGQklHIiwgImZpbGUgdG9vIGxhcmdlIn0sCgl7MjgsICJFTk9TUEMiLCAibm8gc3BhY2UgbGVmdCBvbiBkZXZpY2UifSwKCXsyOSwgIkVTUElQRSIsICJpbGxlZ2FsIHNlZWsifSwKCXszMCwgIkVST0ZTIiwgInJlYWQtb25seSBmaWxlIHN5c3RlbSJ9LAoJezMxLCAiRU1MSU5LIiwgInRvbyBtYW55IGxpbmtzIn0sCgl7MzIsICJFUElQRSIsICJicm9rZW4gcGlwZSJ9LAoJezMzLCAiRURPTSIsICJudW1lcmljYWwgYXJndW1lbnQgb3V0IG9mIGRvbWFpbiJ9LAoJezM0LCAiRVJBTkdFIiwgIm51bWVyaWNhbCByZXN1bHQgb3V0IG9mIHJhbmdlIn0sCgl7MzUsICJFREVBRExLIiwgInJlc291cmNlIGRlYWRsb2NrIGF2b2lkZWQifSwKCXszNiwgIkVOQU1FVE9PTE9ORyIsICJmaWxlIG5hbWUgdG9vIGxvbmcifSwKCXszNywgIkVOT0xDSyIsICJubyBsb2NrcyBhdmFpbGFibGUifSwKCXszOCwgIkVOT1NZUyIsICJmdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQifSwKCXszOSwgIkVOT1RFTVBUWSIsICJkaXJlY3Rvcnkgbm90IGVtcHR5In0sCgl7NDAsICJFTE9PUCIsICJ0b28gbWFueSBsZXZlbHMgb2Ygc3ltYm9saWMgbGlua3MifSwKCXs0MiwgIkVOT01TRyIsICJubyBtZXNzYWdlIG9mIGRlc2lyZWQgdHlwZSJ9LAoJezQzLCAiRUlEUk0iLCAiaWRlbnRpZmllciByZW1vdmVkIn0sCgl7NDQsICJFQ0hSTkciLCAiY2hhbm5lbCBudW1iZXIgb3V0IG9mIHJhbmdlIn0sCgl7NDUsICJFTDJOU1lOQyIsICJsZXZlbCAyIG5vdCBzeW5jaHJvbml6ZWQifSwKCXs0NiwgIkVMM0ggRy4gVGhlIHNlY29uZCBvbmUKLy8gbXVsdGlwbGVzIG9mIFsy4oG2XUcsIHRoZSB0aGlyZCBvbmUgb2YgWzLCucKyXUcsIGFuZCBzbyBvbiwgd2hlcmUgZWFjaCBzdWNjZXNzaXZlCi8vIHRhYmxlIGlzIHRoZSBwcmV2aW91cyB0YWJsZSBkb3VibGVkIHNpeCB0aW1lcy4gU2l4IGlzIHRoZSB3aWR0aCBvZiB0aGUKLy8gc2xpZGluZyB3aW5kb3cgdXNlZCBpbiBTY2FsYXJCYXNlTXVsdCwgYW5kIGhhdmluZyBlYWNoIHRhYmxlIGFscmVhZHkKLy8gcHJlLWRvdWJsZWQgbGV0cyB1cyBhdm9pZCB0aGUgZG91YmxpbmdzIGJldHdlZW4gd2luZG93cyBlbnRpcmVseS4gVGhpcyB0YWJsZQovLyBhbGlhc2VzIGludG8gcDI1NlByZWNvbXB1dGVkRW1iZWQuCnZhciBwMjU2R2VuZXJhdG9yVGFibGVzICpbNDNdcDI1NkFmZmluZVRhYmxlCgpmdW5jIGluaXQoKSB7CglwMjU2R2VuZXJhdG9yVGFibGVzUHRyIDo9IHVuc2FmZS5Qb2ludGVyKCZwMjU2UHJlY29tcHV0ZWRFbWJlZCkKCWlmIGNwdS5CaWdFbmRpYW4gewoJCXZhciBuZXdUYWJsZSBbNDMgKiAzMiAqIDIgKiA0XXVpbnQ2NAoJCWZvciBpLCB4IDo9IHJhbmdlICgqWzQzICogMzIgKiAyICogNF1bOF1ieXRlKShwMjU2R2VuZXJhdG9yVGFibGVzUHRyKSB7CgkJCW5ld1RhYmxlW2ldID0gYnl0ZW9yZGVyLkxFVWludDY0KHhbOl0pCgkJfQoJCXAyNTZHZW5lcmF0b3JUYWJsZXNQdHIgPSB1bnNhZmUuUG9pbnRlcigmbmV3VGFibGUpCgl9CglwMjU2R2VuZXJhdG9yVGFibGVzID0gKCpbNDNdcDI1NkFmZmluZVRhYmxlKShwMjU2R2VuZXJhdG9yVGFibGVzUHRyKQp9CgpmdW5jIGJvb3RoVzYoaW4gdWludDY0KSAodWludDgsIGludCkgewoJcyA6PSBeKChpbiA+PiA2KSAtIDEpCglkIDo9ICgxIDw8IDcpIC0gaW4gLSAxCglkID0gKGQgJiBzKSB8IChpbiAmIChecykpCglkID0gKGQgPj4gMSkgKyAoZCAmIDEpCglyZXR1cm4gdWludDgoZCksIGludChzICYgMSkKfQoKLy8gU2NhbGFyQmFzZU11bHQgc2V0cyBwID0gc2NhbGFyICogZ2VuZXJhdG9yLCB3aGVyZSBzY2FsYXIgaXMgYSAzMi1ieXRlIGJpZwovLyBlbmRpYW4gdmFsdWUsIGFuZCByZXR1cm5zIHIuIElmIHNjYWxhciBpcyBub3QgMzIgYnl0ZXMgbG9uZywgU2NhbGFyQmFzZU11bHQKLy8gcmV0dXJucyBhbiBlcnJvciBhbmQgdGhlIHJlY2VpdmVyIGlzIHVuY2hhbmdlZC4KZnVuYyAocCAqUDI1NlBvaW50KSBTY2FsYXJCYXNlTXVsdChzY2FsYXIgW11ieXRlKSAoKlAyNTZQb2ludCwgZXJyb3IpIHsKCS8vIFRoaXMgZnVuY3Rpb24gd29ya3MgbGlrZSBTY2FsYXJNdWx0IGFib3ZlLCBidXQgdGhlIHRhYmxlIGlzIGZpeGVkIGFuZAoJLy8gInByZS1kb3VibGVkIiBmb3IgZWFjaCBpdGVyYXRpb24sIHNvIGluc3RlYWQgb2YgZG91Ymxpbmcgd2UgbW92ZSB0byB0aGUKCS8vIG5leHQgdGFibGUgYXQgZWFjaCBpdGVyYXRpb24uCgoJcywgZXJyIDo9IG5ldyhwMjU2T3JkRWxlbWVudCkuU2V0Qnl0ZXMoc2NhbGFyKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIG5pbCwgZXJyCgl9CgoJLy8gU3RhcnQgc2Nhbm5pbmcgdGhlIHdpbmRvdyBmcm9tIHRoZSBtb3N0IHNpZ25pZmljYW50IGJpdHMuIFdlIG1vdmUgYnkKCS8vIDYgYml0cyBhdCBhIHRpbWUgYW5kIG5lZWQgdG8gZmluaXNoIGF0IC0xLCBzbyAtMSArIDYgKiA0MiA9IDI1MS4KCWluZGV4IDo9IDI1MQoKCXNlbCwgc2lnbiA6PSBib290aFc2KHMuUnNoKGluZGV4KSkKCS8vIHNpZ24gaXMgYWx3YXlzIHplcm8gYmVjYXVzZSB0aGUgYm9vdGhXNiBpbnB1dCBoZXJlIGlzIGF0CgkvLyBtb3N0IGZpdmUgYml0cyBsb25nLCBzbyB0aGUgdG9wIGJpdCBpcyBuZXZlciBzZXQuCglfID0gc2lnbgoKCXQgOj0gJnAyNTZBZmZpbmVQb2ludHt9Cgl0YWJsZSA6PSAmcDI1NkdlbmVyYXRvclRhYmxlc1soaW5kZXgrMSkvNl0KCXRhYmxlLlNlbGVjdCh0LCBzZWwpCgoJLy8gU2VsZWN0J3Mgb3V0cHV0IGlzIHVuZGVmaW5lZCBpZiB0MDA3IFZpdGEgTnVvdmEgSG9sZGluZ3MgTGltaXRlZCAod3d3LnZpdGFudW92YS5jb20pCi8vCVBvcnRpb25zIENvcHlyaWdodCDCqSAyMDA0LDIwMDYgQnJ1Y2UgRWxsaXMKLy8JUG9ydGlvbnMgQ29weXJpZ2h0IMKpIDIwMDUtMjAwNyBDIEggRm9yc3l0aCAoZm9yc3l0aEB0ZXJ6YXJpbWEubmV0KQovLwlSZXZpc2lvbnMgQ29weXJpZ2h0IMKpIDIwMDAtMjAwNyBMdWNlbnQgVGVjaG5vbG9naWVzIEluYy4gYW5kIG90aGVycwovLwlQb3J0aW9ucyBDb3B5cmlnaHQgwqkgMjAwOSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8KLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQovLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAovLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci8vCi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgovLwovLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgovLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRQovLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCi8vIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4KLy8gVEhFIFNPRlRXQVJFLgoKcGFja2FnZSBtaXBzNjQKCmltcG9ydCAoCgkiY21kL2ludGVybmFsL29iamFiaSIKCSJjbWQvaW50ZXJuYWwvc3lzIgoJImNtZC9saW5rL2ludGVybmFsL2xkIgoJImNtZC9saW5rL2ludGVybmFsL2xvYWRlciIKCSJjbWQvbGluay9pbnRlcm5hbC9zeW0iCgkiZGVidWcvZWxmIgopCgp2YXIgKAoJLy8gZHRPZmZzZXRzIGNvbnRhaW5zIG9mZnNldHMgZm9yIGVudHJpZXMgd2l0aGluIHRoZSAuZHluYW1pYyBzZWN0aW9uLgoJLy8gVGhlc2UgYXJlIHVzZWQgdG8gZml4IHVwIHN5bWJvbCB2YWx1ZXMgb25jZSB0aGV5IGFyZSBrbm93bi4KCWR0T2Zmc2V0cyBtYXBbZWxmLkR5blRhZ11pbnQ2NAoKCS8vIGR5blN5bUNvdW50IGNvbnRhaW5zIHRoZSBudW1iZXIgb2YgZW50cmllcyBpbiB0aGUgLmR5bnN5bSBzZWN0aW9uLgoJLy8gVGhpcyBpcyB1c2VkIHRvIHBvcHVsYXRlIHRoZSBEVF9NSVBTX1NZTVRBQk5PIGVudHJ5IGluIHRoZSAuZHluYW1pYwoJLy8gc2VjdGlvbi4KCWR5blN5bUNvdW50IHVpbnQ2NAoKCS8vIGdvdExvY2FsQ291bnQgY29udGFpbnMgdGhlIG51bWJlciBvZiBsb2NhbCBnbG9iYWwgb2Zmc2V0IHRhYmxlCgkvLy5mdWxsTmFtZShwYXJlbnQsIHRjLm5hbWUpOyBnb3QgIT0gdGMud2FudCB7CgkJCXQuRXJyb3JmKCIlZDolczogZ290ICVxOyB3YW50ICVxIiwgaSwgdGMubmFtZSwgZ290LCB0Yy53YW50KQoJCX0KCX0KfQoKZnVuYyBGdXp6TmFtaW5nKGYgKkYpIHsKCWZvciBfLCB0YyA6PSByYW5nZSBuYW1pbmdUZXN0Q2FzZXMgewoJCWYuQWRkKHRjLm5hbWUpCgl9CglwYXJlbnQgOj0gJmNvbW1vbntuYW1lOiAieCIsIGxldmVsOiAxfQoJdmFyIG0gKm1hdGNoZXIKCXZhciBzZWVuIG1hcFtzdHJpbmddc3RyaW5nCglyZXNldCA6PSBmdW5jKCkgewoJCW0gPSBhbGxNYXRjaGVyKCkKCQlzZWVuID0gbWFrZShtYXBbc3RyaW5nXXN0cmluZykKCX0KCXJlc2V0KCkKCglmLkZ1enooZnVuYyh0ICpULCBzdWJuYW1lIHN0cmluZykgewoJCWlmIGxlbihzdWJuYW1lKSA+IDEwIHsKCQkJLy8gTG9uZyBuYW1lcyBhdHRyYWN0IHRoZSBPT00ga2lsbGVyLgoJCQl0LlNraXAoKQoJCX0KCQluYW1lIDo9IG0udW5pcXVlKHBhcmVudC5uYW1lLCBzdWJuYW1lKQoJCWlmICFzdHJpbmdzLkNvbnRhaW5zKG5hbWUsICIvIitzdWJuYW1lKSB7CgkJCXQuRXJyb3JmKCJuYW1lICVxIGRvZXMgbm90IGNvbnRhaW4gc3VibmFtZSAlcSIsIG5hbWUsIHN1Ym5hbWUpCgkJfQoJCWlmIHByZXYsIG9rIDo9IHNlZW5bbmFtZV07IG9rIHsKCQkJdC5FcnJvcmYoIm5hbWUgJXEgZ2VuZXJhdGVkIGJ5IGJvdGggJXEgYW5kICVxIiwgbmFtZSwgcHJldiwgc3VibmFtZSkKCQl9CgkJaWYgbGVuKHNlZW4pID4gMWU2IHsKCQkJLy8gRnJlZSB1cCBtZW1vcnkuCgkJCXJlc2V0KCkKCQl9CgkJc2VlbltuYW1lXSA9IHN1Ym5hbWUKCX0pCn0KCi8vIEdvU3RyaW5nIHJldHVybnMgYSBzdHJpbmcgdGhhdCBpcyBtb3JlIHJlYWRhYmxlIHRoYW4gdGhlIGRlZmF1bHQsIHdoaWNoIG1ha2VzCi8vIGl0IGVhc2llciB0byByZWFkIHRlc3QgZXJyb3JzLgpmdW5jIChtIGFsdGVybmF0aW9uTWF0Y2gpIEdvU3RyaW5nKCkgc3RyaW5nIHsKCXMgOj0gbWFrZShbXXN0cmluZywgbGVuKG0pKQoJZm9yIGksIG0gOj0gcmFuZ2UgbSB7CgkJc1tpXSA9IGZtdC5TcHJpbnRmKCIlI3YiLCBtKQoJfQoJcmV0dXJuIGZtdC5TcHJpbnRmKCIoJXMpIiwgc3RyaW5ncy5Kb2luKHMsICIgfCAiKSkKfQovLyBDb3B5cmlnaHQgMjAyMCBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKcGFja2FnZSBtb2Rsb2FkCgppbXBvcnQgKAoJImNvbnRleHQiCgkiZXJyb3JzIgoJIm9zIgoJInNvcnQiCgoJImNtZC9nby9pbnRlcm5hbC9nb3ZlciIKCSJjbWQvZ28vaW50ZXJuYWwvbW9kZmV0Y2giCgkiY21kL2dvL2ludGVybmFsL21vZGZldGNoL2NvZGVob3N0IgoKCSJnb2xhbmcub3JnL3gvbW9kL21vZHVsZSIKKQoKLy8gY21wVmVyc2lvbiBpbXBsZW1lbnRzIHRoZSBjb21wYXJpc29uIGZvciB2ZXJzaW9ucyBpbiB0aGUgbW9kdWxlIGxvYWRlci4KLy8KLy8gSXQgaXMgY29uc2lzdGVudCB3aXRoIGdvdmVyLk1vZENvbXBhcmUgZXhjZXB0IHRoYXQgYXMgYSBzcGVjaWFsIGNhc2UsCi8vIHRoZSB2ZXJzaW9uICIiIGlzIGNvbnNpZGVyZWQgaGlnaGVyIHRoYW4gYWxsIG90aGVyIHZlcnNpb25zLgovLyBUaGUgbWFpbiBtb2R1bGUgKGFsc28ga25vd24gYXMgdGhlIHRhcmdldCkgaGFzIG5vIHZlcnNpb24gYW5kIG11c3QgYmUgY2hvc2VuCi8vIG92ZXIgb3RoZXIgdmVyc2lvbnMgb2YgdGhlIHNhbWUgbW9kdWxlIGluIHRoZSBtb2R1bGUgZGVwZW5kZW5jeSBncmFwaC4KZnVuYyBjbXBWZXJzaW9uKHAgc3RyaW5nLCB2MSwgdjIgc3RyaW5nKSBpbnQgewoJaWYgdjIgPT0gIiIgewoJCWlmIHYxID09ICIiIHsKCQkJcmV0dXJuIDAKCQl9CgkJcmV0dXJuIC0xCgl9CglpZiBlbnQgbGluZSwgZXhjbHVkaW5nIHRoZSB0cmFpbGluZyBuZXdsaW5lLgovLwovLyBJZiBbci5uZXh0XSByZXR1cm5lZCBlcnJJbmNvbXBsZXRlTGluZSwgdGhlbiB0aGlzIHJldHVybnMgb25seSB0aGUgYmVnaW5uaW5nCi8vIG9mIHRoZSBsaW5lLgovLwovLyBQcmVjb25kaXRpb25zOiBbci5uZXh0XSBpcyBjYWxsZWQgcHJpb3IgdG8gdGhlIGZpcnN0IGNhbGwgdG8gbGluZS4KLy8KLy8gUG9zdGNvbmRpdGlvbnM6IFRoZSBjYWxsZXIgbXVzdCBub3Qga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgcmV0dXJuZWQgc2xpY2UuCmZ1bmMgKHIgKmxpbmVSZWFkZXIpIGxpbmUoKSBbXWJ5dGUgewoJaWYgci5uZXdsaW5lIDwgMCB7CgkJLy8gSW5jb21wbGV0ZSBsaW5lCgkJcmV0dXJuIHIuc2NyYXRjaFs6ci5uXQoJfQoJLy8gQ29tcGxldGUgbGluZS4KCXJldHVybiByLnNjcmF0Y2hbOnIubmV3bGluZV0KfQovLyBDb2RlIGdlbmVyYXRlZCBieSBjZ28sIHRoZW4gbWFudWFsbHkgY29udmVydGVkIGludG8gYXBwcm9wcmlhdGUgbmFtaW5nIGFuZCBjb2RlCi8vIGZvciB0aGUgR28gcnVudGltZS4KLy8gZ28gdG9vbCBjZ28gLWdvZGVmcyBkZWZzX2ZyZWVic2QuZ28KCnBhY2thZ2UgcnVudGltZQoKaW1wb3J0ICJ1bnNhZmUiCgpjb25zdCAoCglfTkJCWSAgICAgICAgICAgID0gMHg4CglfQ1RMX01BWE5BTUUgICAgID0gMHgxOAoJX0NQVV9MRVZFTF9XSElDSCA9IDB4MwoJX0NQVV9XSElDSF9QSUQgICA9IDB4MgopCgpjb25zdCAoCglfRUlOVFIgICAgID0gMHg0CglfRUZBVUxUICAgID0gMHhlCglfRUFHQUlOICAgID0gMHgyMwoJX0VUSU1FRE9VVCA9IDB4M2MKCglfT19XUk9OTFkgICA9IDB4MQoJX09fTk9OQkxPQ0sgPSAweDQKCV9PX0NSRUFUICAgID0gMHgyMDAKCV9PX1RSVU5DICAgID0gMHg0MDAKCV9PX0NMT0VYRUMgID0gMHgxMDAwMDAKCglfUFJPVF9OT05FICA9IDB4MAoJX1BST1RfUkVBRCAgPSAweDEKCV9QUk9UX1dSSVRFID0gMHgyCglfUFJPVF9FWEVDICA9IDB4NAoKCV9NQVBfQU5PTiAgICA9IDB4MTAwMAoJX01BUF9TSEFSRUQgID0gMHgxCglfTUFQX1BSSVZBVEUgPSAweDIKCV9NQVBfRklYRUQgICA9IDB4MTAKCglfTUFEVl9ET05UTkVFRCA9IDB4NAoJX01BRFZfRlJFRSAgICAgPSAweDUKCglfU0FfU0lHSU5GTyA9IDB4NDAKCV9TQV9SRVNUQVJUID0gMHgyCglfU0FfT05TVEFDSyA9IDB4MQoKCV9DTE9DS19NT05PVE9OSUMgPSAweDQKCV9DTE9DS19SRUFMVElNRSAgPSAweDAKCglfVU1UWF9PUF9XQUlUX1VJTlQgICAgICAgICA9IDB4YgoJX1VNVFhfT1BfV0FJVF9VSU5UX1BSSVZBVEUgPSAweGYKCV9VTVRYX09QX1dBS0UgICAgICAgICAgICAgID0gMHgzCglfVU1UWF9PUF9XQUtFX1BSSVZBVEUgICAgICA9IDB4MTAKCglfU0lHSFVQICAgID0gMHgxCglfU0lHSU5UICAgID0gMHgyCglfU0lHUVVJVCAgID0gMHgzCglfU0lHSUxMICAgID0gMHg0CglfU0lHVFJBUCAgID0gMHg1CglfU0lHQUJSVCAgID0gMHg2CglfU0lHRU1UICAgID0gMHg3CglfU0lHRlBFICAgID0gMHg4CglfU0lHS0lMTCAgID0gMHg5CglfU0lHQlVTICAgID0gMHhhCglfU0lHU0VHViAgID0gMHhiCglfU0lHU1lTICAgID0gMHhjCglfU0lHUElQRSAgID0gMHhkCglfU0lHQUxSTSAgID0gMHhlCglfU0lHVEVSTSAgID0gMHhmCglfU0lHVVJHICAgID0gMHgxMAoJX1NJR1NUT1AgICA9IDB4MTEKCV9TSUdUU1RQICAgPSAweDEyCglfU0lHQ09OVCAgID0gMHgxMwoJX1NJR0NITEQgICA9IDB4MTQKCV9TSUdUVElOICAgPSAweDE1CglfU0lHVFRPVSAgID0gMHgxNgoJX1NJR0lPICAgICA9IDB4MTcKCV9TSUdYQ1BVICAgPSAweDE4CglfU0lHWEZTWiAgID0gMHgxOQoJX1NJR1ZUQUxSTSA9IDB4MWEKCV9TSUdQUk9GICAgPSAweDFiCglfU0lHV0lOQ0ggID0gMHgxYwoJX1NJR0lORk8gICA9IDB4MWQKCV9TSUdVU1IxICAgPSAweDFlCglfU0lHVVNSMiAgID0gMHgxZgoKCV9GUEVfSU5URElWdHRlci4KLy8gVGhlIG9ubHkgaW50ZXJmYWNlIG1ldGhvZCB0byBsb29rIGZvciBpcyAiRm9ybWF0KFN0YXRlLCBydW5lKSIuCmZ1bmMgaXNGb3JtYXR0ZXIodHlwIHR5cGVzLlR5cGUpIGJvb2wgewoJLy8gSWYgdGhlIHR5cGUgaXMgYW4gaW50ZXJmYWNlLCB0aGUgdmFsdWUgaXQgaG9sZHMgbWlnaHQgc2F0aXNmeSBmbXQuRm9ybWF0dGVyLgoJaWYgXywgb2sgOj0gdHlwLlVuZGVybHlpbmcoKS4oKnR5cGVzLkludGVyZmFjZSk7IG9rIHsKCQkvLyBEb24ndCBhc3N1bWUgdHlwZSBwYXJhbWV0ZXJzIGNvdWxkIGJlIGZvcm1hdHRlcnMuIFdpdGggdGhlIGdyZWF0ZXIKCQkvLyBleHByZXNzaXZlbmVzcyBvZiBjb25zdHJhaW50IGludGVyZmFjZSBzeW50YXggd2UgZXhwZWN0IG1vcmUgdHlwZSBzYWZldHkKCQkvLyB3aGVuIHVzaW5nIHR5cGUgcGFyYW1ldGVycy4KCQlpZiAhdHlwZXBhcmFtcy5Jc1R5cGVQYXJhbSh0eXApIHsKCQkJcmV0dXJuIHRydWUKCQl9Cgl9CglvYmosIF8sIF8gOj0gdHlwZXMuTG9va3VwRmllbGRPck1ldGhvZCh0eXAsIGZhbHNlLCBuaWwsICJGb3JtYXQiKQoJZm4sIG9rIDo9IG9iai4oKnR5cGVzLkZ1bmMpCglpZiAhb2sgewoJCXJldHVybiBmYWxzZQoJfQoJc2lnIDo9IGZuLlR5cGUoKS4oKnR5cGVzLlNpZ25hdHVyZSkKCXJldHVybiBzaWcuUGFyYW1zKCkuTGVuKCkgPT0gMiAmJgoJCXNpZy5SZXN1bHRzKCkuTGVuKCkgPT0gMCAmJgoJCXR5cGVzaW50ZXJuYWwuSXNUeXBlTmFtZWQoc2lnLlBhcmFtcygpLkF0KDApLlR5cGUoKSwgImZtdCIsICJTdGF0ZSIpICYmCgkJdHlwZXMuSWRlbnRpY2FsKHNpZy5QYXJhbXMoKS5BdCgxKS5UeXBlKCksIHR5cGVzLlR5cFt0eXBlcy5SdW5lXSkKfQoKLy8gY2hlY2tQcmludGYgY2hlY2tzIGEgY2FsbCB0byBhIGZvcm1hdHRlZCBwcmludCByb3V0aW5lIHN1Y2ggYXMgUHJpbnRmLgpmdW5jIGNoZWNrUHJpbnRmKHBhc3MgKmFuYWx5c2lzLlBhc3MsIGZpbGVWZXJzaW9uIHN0cmluZywga2luZCBLaW5kLCBjYWxsICphc3QuQ2FsbEV4cHIsIG5hbWUgc3RyaW5nKSB7CglpZHggOj0gZm9ybWF0U3RyaW5nSW5kZXgocGFzcywgY2FsbCkKCWlmIGlkeCA8IDAgfHwgaWR4ID49IGxlbihjYWxsLkFyZ3MpIHsKCQlyZXR1cm4KCX0KCWZvcm1hdEFyZyA6PSBjYWxsLkFyZ3NbaWR4XQoJZm9ybWF0LCBvayA6PSBzdHJpbmdDb25zdGFudEV4cHIocGFzcywgZm9ybWF0QXJnKQoJaWYgIW9rIHsKCQkvLyBGb3JtYXQgc3RyaW5nIGFyZ3VtZW50IGlzIG5vbi1jb25zdGFudC4KCgkJLy8gSXQgaXMgYSBjb21tb24gbWlzdGFrZSB0byBjYWxsIGZtdC5QcmludGYobXNnKSB3aXRoIGEKCQkvLyBub24tY29uc3RhbnQgZm9ybWF0IHN0cmluZyBhbmQgbm8gYXJndW1lbnRzOgoJCS8vIGlmIG1zZyBjb250YWlucyAiJSIsIG1pc2Zvcm1hdHRpbmcgb2NjdXJzLgoJCS8vIFJlcG9ydCB0aGUgcHJvYmxlbSBhbmQgc3VnZ2VzdCBhIGZpeDogZm10LlByaW50ZigiJXMiLCBtc2cpLgoJCS8vCgkJLy8gSG93ZXZlciwgYXMgZGVzY3JpYmVkIGluIGdvbGFuZy9nbyM3MTQ4NSwgdGhpcyBhbmFseXNpcyBjYW4gcHJvZHVjZSBhCgkJLy8gc2lnbmlmaWNhbnQgbnVtYmVyIG9mIGRpYWdub3N0aWNzIGluIGV4aXN0aW5nIGNvZGUsIGFuZCB0aGUgYnVncyBpdAoJCS8vIGZpbmRzIGFyZSBzb21ldGltZXMgdW5saWtlbHkgb3IgaW5jb25zZXF1ZW50aWFsLCBhbmQgbWF5IG5vdCBiZSB3b3J0aAoJCS8vIGZpeGluZyBmb3Igc29tZSB1c2Vycy4gR2F0aW5nIG9uIGxhbmd1YWdlIHZlcnNpb24gYWxsb3dzIHVzIHRvIGF2b2lkCgkJLy8gYnJlYWtpbmcgZXhpc3RpbmcgdGVzdHMgYW5kIENJIHNjcmlwdHMuCgkJaWYgaWR4ID09IGxlbihjYWxsLkFyZ3MpLTEgJiYKCQkJZmlsZVZlcnNpb24gIT0gIiIgJiYgLy8gZmFpbCBvcGVuCgkJCXZlcnNpb25zLkF0TGVhc3QoZmlsZVZlcnNpb24sIHZlcnNpb25zLkdvMV8yNCkgewoKCQkJcGFzcy5SZXBvciAgICAgLy8gcmVjb3JkIGhlcmUgYmVjYXVzZSB3ZSBkaWRuJ3QgdXNlIHRoZSB1c3VhbCBleHByIGV2YWx1YXRvcnMKCQkJaiA9IGsKCQl9Cgl9CgoJLy8gY2hlY2sgYXJndW1lbnRzCglpZiBsZW4oYXJncykgPiAwIHsKCQljb250ZXh0IDo9IGNoZWNrLnNwcmludGYoImFyZ3VtZW50IHRvICVzIiwgY2FsbC5GdW4pCgkJZm9yIGksIGEgOj0gcmFuZ2UgYXJncyB7CgkJCWNoZWNrLmFzc2lnbm1lbnQoYSwgc2lnUGFyYW1zLnZhcnNbaV0udHlwLCBjb250ZXh0KQoJCX0KCX0KCglyZXR1cm4KfQoKdmFyIGNnb1ByZWZpeGVzID0gWy4uLl1zdHJpbmd7CgkiX0NpY29uc3RfIiwKCSJfQ2Zjb25zdF8iLAoJIl9Dc2NvbnN0XyIsCgkiX0N0eXBlXyIsCgkiX0N2YXJfIiwgLy8gYWN0dWFsbHkgYSBwb2ludGVyIHRvIHRoZSB2YXIKCSJfQ2ZwdmFyX2ZwXyIsCgkiX0NmdW5jXyIsCgkiX0NtYWNyb18iLCAvLyBmdW5jdGlvbiB0byBldmFsdWF0ZSB0aGUgZXhwYW5kZWQgZXhwcmVzc2lvbgp9CgpmdW5jIChjaGVjayAqQ2hlY2tlcikgc2VsZWN0b3IoeCAqb3BlcmFuZCwgZSAqc3ludGF4LlNlbGVjdG9yRXhwciwgd2FudFR5cGUgYm9vbCkgewoJLy8gdGhlc2UgbXVzdCBiZSBkZWNsYXJlZCBiZWZvcmUgdGhlICJnb3RvIEVycm9yIiBzdGF0ZW1lbnRzCgl2YXIgKAoJCW9iaiAgICAgIE9iamVjdAoJCWluZGV4ICAgIFtdaW50CgkJaW5kaXJlY3QgYm9vbAoJKQoKCXNlbCA6PSBlLlNlbC5WYWx1ZQoJLy8gSWYgdGhlIGlkZW50aWZpZXIgcmVmZXJzIHRvIGEgcGFja2FnZSwgaGFuZGxlIGV2ZXJ5dGhpbmcgaGVyZQoJLy8gc28gd2UgZG9uJ3QgbmVlZCBhICJwYWNrYWdlIiBtb2RlIGZvciBvcGVyYW5kczogcGFja2FnZSBuYW1lcwoJLy8gY2FuIG9ubHkgYXBwZWFyIGluIHF1YWxpZmllZCBpZGVudGlmaWVycyB3aGljaCBhcmUgbWFwcGVkIHRvCgkvLyBzZWxlY3RvciBleHByZXNzaW9ucy4KCWlmIGlkZW50LCBvayA6PSBlLlguKCpzeW50YXguTmFtZSk7IG9rIHsKCQlvYmogOj0gY2hlY2subG9va3VwKGlkZW50LlZhbHVlKQoJCWlmIHBuYW1lLCBfIDo9IG9iai4oKlBrZ05hbWUpOyBwbmFtZSAhPSBuaWwgewoJCQlhc3NlcnQocG5hbWUucGtnID09IGNoZWNrLnBrZykKCQkJY2hlY2sucmVjb3JkVXNlKGlkZW50LCBwbmFtZSkKCQkJY2hlY2sudXNlZFBrZ05hbWVzW3BuYW1lXSA9IHRydWUKCQkJcGtnIDo9IHBuYW1lLmltcG9ydGVkCgoJCQl2YXIgZXhwIE9iamVjdAoJCQlmdW5jTW9kZSA6PSB2YWx1ZQoJCQlpZiBwa2cuY2dvIHsKCQkJCS8vIGNnbyBzcGVjaWFsIGNhc2VzIEMubWFsbG9jOiBpdCdzCgkJCQkvLyByZXdyaXR0ZW4gdG8gX0NNYWxsb2MgYW5kIGRvZXMgbm90CgkJCQkvLyBzdXBwb3J0IHR3by1yZXN1bHQgY2FsbHMuCgkJCQlpZiBzZWwgPT0gIm1hbGxvYyIgewoJCQkJCXNlbCA9ICJfQ01hbGxvYyIKCQkJCX0gZWxzZSB7CgkJCQkJZnVuY01vZGUgPSBjZ29mdW5jCgkJCQl9CgkJCQlmb3IgXywgcHJlZml4IDo9IHJhbmdlIGNnb1ByZWZpeGVzIHsKCQkJCQkvLyBjZ28gb2JqZWN0cyBhcmUgcGFydCBvZiB0aGUgY3VycmVudCBwYWNrYWdlIChpbiBmaWxlCgkJCQkJLy8gX2Nnb19nb3R5cGVzLmdvKS4gVXNlIHJlZ3VsYXIgbG9va3VwLgoJCQkJCWV4cCA9IGNoZWNrLmxvb2t1cChwcmVmaXggKyBzZWwpCgkJCQkJaWYgZXhwICE9IG5pbCB7CgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJfQoJCQkJaWYgZXhwID09IG5pbCB7CgkJCQkJaWYgaXNWYWxpZE5hbWUoc2VsKSB7CgkJCQkJCWNoZWNrLmVycm9yZihlLlNlbCwgVW5kZWNsYXJlZEltcG9ydGVkTmFtZSwgInVuZGVmaW5lZDogJXMiLCBzeW50YXguRXhwcihlKSkgLy8gY2FzdCB0byBzeW50YXguRXhwciB0byBzaWxlbmNlIHZldAoJCQkJCX0KCQkJCQlnb3RvIEVycm9yCgkJCQl9CgkJCQljaGVjay5vYmpEZWNsKGV4cCkKCQkJfSBlbHNlIHsKCQkJCWV4cCA9IHBrZy5zY29wZS5Mb29rdXAoc2VsKQpieSBleHBsaWNpdGx5IGluc3RhbnRpYXRpbmcgdGhlIHNpZ25hdHVyZS4gVGhpcwoJCS8vIGVuc3VyZXMgdGhhdCB3ZSByZWNvcmQgYWNjdXJhdGUgdHlwZSBpbmZvcm1hdGlvbiBmb3Igc2lnLCBldmVuIGlmIHRoZXJlCgkJLy8gaXMgYW4gZXJyb3IgY2hlY2tpbmcgaXRzIGFyZ3VtZW50cyAoZm9yIGV4YW1wbGUsIGlmIGFuIGluY29ycmVjdCBudW1iZXIKCQkvLyBvZiBhcmd1bWVudHMgaXMgc3VwcGxpZWQpLgoJCWlmIGdvdCA9PSB3YW50ICYmIHdhbnQgPiAwIHsKCQkJY2hlY2sudmVyaWZ5VmVyc2lvbmYoaW5zdCwgZ28xXzE4LCAiZnVuY3Rpb24gaW5zdGFudGlhdGlvbiIpCgkJCXNpZyA9IGNoZWNrLmluc3RhbnRpYXRlU2lnbmF0dXJlKGluc3QuUG9zKCksIGluc3QsIHNpZywgdGFyZ3MsIHhsaXN0KQoJCQkvLyB0YXJncyBoYXZlIGJlZW4gY29uc3VtZWQ7IHByb2NlZWQgd2l0aCBjaGVja2luZyBhcmd1bWVudHMgb2YgdGhlCgkJCS8vIG5vbi1nZW5lcmljIHNpZ25hdHVyZS4KCQkJdGFyZ3MgPSBuaWwKCQkJeGxpc3QgPSBuaWwKCQl9Cgl9CgoJLy8gZXZhbHVhdGUgYXJndW1lbnRzCglhcmdzLCBhdGFyZ3MgOj0gY2hlY2suZ2VuZXJpY0V4cHJMaXN0KGNhbGwuQXJnTGlzdCkKCXNpZyA9IGNoZWNrLmFyZ3VtZW50cyhjYWxsLCBzaWcsIHRhcmdzLCB4bGlzdCwgYXJncywgYXRhcmdzKQoKCWlmIHdhc0dlbmVyaWMgJiYgc2lnLlR5cGVQYXJhbXMoKS5MZW4oKSA9PSAwIHsKCQkvLyB1cGRhdGUgdGhlIHJlY29yZGVkIHR5cGUgb2YgY2FsbC5GdW4gdG8gaXRzIGluc3RhbnRpYXRlZCB0eXBlCgkJY2hlY2sucmVjb3JkVHlwZUFuZFZhbHVlKGNhbGwuRnVuLCB2YWx1ZSwgc2lnLCBuaWwpCgl9CgoJLy8gZGV0ZXJtaW5lIHJlc3VsdAoJc3dpdGNoIHNpZy5yZXN1bHRzLkxlbigpIHsKCWNhc2UgMDoKCQl4Lm1vZGUgPSBub3ZhbHVlCgljYXNlIDE6CgkJaWYgY2dvY2FsbCB7CgkJCXgubW9kZSA9IGNvbW1hZXJyCgkJfSBlbHNlIHsKCQkJeC5tb2RlID0gdmFsdWUKCQl9CgkJdHlwIDo9IHNpZy5yZXN1bHRzLnZhcnNbMF0udHlwIC8vIHVucGFjayB0dXBsZQoJCS8vIFdlIGNhbm5vdCByZXR1cm4gYSB2YWx1ZSBvZiBhbiBpbmNvbXBsZXRlIHR5cGU7IG1ha2Ugc3VyZSBpdCdzIGNvbXBsZXRlLgoJCWlmICFjaGVjay5pc0NvbXBsZXRlKHR5cCkgewoJCQl4Lm1vZGUgPSBpbnZhbGlkCgkJCXguZXhwciA9IGNhbGwKCQkJcmV0dXJuIHN0YXRlbWVudAoJCX0KCQl4LnR5cCA9IHR5cAoJZGVmYXVsdDoKCQl4Lm1vZGUgPSB2YWx1ZQoJCXgudHlwID0gc2lnLnJlc3VsdHMKCX0KCXguZXhwciA9IGNhbGwKCWNoZWNrLmhhc0NhbGxPclJlY3YgPSB0cnVlCgoJLy8gaWYgdHlwZSBpbmZlcmVuY2UgZmFpbGVkLCBhIHBhcmFtZXRlcml6ZWQgcmVzdWx0IG11c3QgYmUgaW52YWxpZGF0ZWQKCS8vIChvcGVyYW5kcyBjYW5ub3QgaGF2ZSBhIHBhcmFtZXRlcml6ZWQgdHlwZSkKCWlmIHgubW9kZSA9PSB2YWx1ZSAmJiBzaWcuVHlwZVBhcmFtcygpLkxlbigpID4gMCAmJiBpc1BhcmFtZXRlcml6ZWQoc2lnLlR5cGVQYXJhbXMoKS5saXN0KCksIHgudHlwKSB7CgkJeC5tb2RlID0gaW52YWxpZAoJfQoKCXJldHVybiBzdGF0ZW1lbnQKfQoKLy8gZXhwckxpc3QgZXZhbHVhdGVzIGEgbGlzdCBvZiBleHByZXNzaW9ucyBhbmQgcmV0dXJucyB0aGUgY29ycmVzcG9uZGluZyBvcGVyYW5kcy4KLy8gQSBzaW5nbGUtZWxlbWVudCBleHByZXNzaW9uIGxpc3QgbWF5IGV2YWx1YXRlIHRvIG11bHRpcGxlIG9wZXJhbmRzLgpmdW5jIChjaGVjayAqQ2hlY2tlcikgZXhwckxpc3QoZWxpc3QgW11zeW50YXguRXhwcikgKHhsaXN0IFtdKm9wZXJhbmQpIHsKCWlmIG4gOj0gbGVuKGVsaXN0KTsgbiA9PSAxIHsKCQl4bGlzdCwgXyA9IGNoZWNrLm11bHRpRXhwcihlbGlzdFswXSwgZmFsc2UpCgl9IGVsc2UgaWYgbiA+IDEgewoJCS8vIG11bHRpcGxlIChwb3NzaWJseSBpbnZhbGlkKSB2YWx1ZXMKCQl4dGVzdHMuCi8vIFNlZSB0ZXN0ZGF0YS9zY3JpcHQvUkVBRE1FIGZvciBhbiBvdmVydmlldy4KCi8vZ286Z2VuZXJhdGUgZ28gdGVzdCBjbWQvZ28gLXYgLXJ1bj1UZXN0U2NyaXB0L1JFQURNRSAtLWZpeHJlYWRtZQoKcGFja2FnZSBtYWluX3Rlc3QKCmltcG9ydCAoCgkiYnVmaW8iCgkiYnl0ZXMiCgkiY29udGV4dCIKCV8gImVtYmVkIgoJImZsYWciCgkiaW50ZXJuYWwvdGVzdGVudiIKCSJpbnRlcm5hbC90eHRhciIKCSJuZXQvdXJsIgoJIm9zIgoJInBhdGgvZmlsZXBhdGgiCgkicnVudGltZSIKCSJzdHJpbmdzIgoJInRlc3RpbmciCgkidGltZSIKCgkiY21kL2dvL2ludGVybmFsL2NmZyIKCSJjbWQvZ28vaW50ZXJuYWwvZ292ZXIiCgkiY21kL2dvL2ludGVybmFsL3Zjd2ViL3Zjc3Rlc3QiCgkiY21kL2ludGVybmFsL3NjcmlwdCIKCSJjbWQvaW50ZXJuYWwvc2NyaXB0L3NjcmlwdHRlc3QiCgoJImdvbGFuZy5vcmcveC90ZWxlbWV0cnkvY291bnRlci9jb3VudGVydGVzdCIKKQoKdmFyIHRlc3RTdW0gPSBmbGFnLlN0cmluZygidGVzdHN1bSIsICIiLCBgbWF5IGJlIHRpZHksIGxpc3RtLCBvciBsaXN0YWxsLiBJZiBzZXQsIFRlc3RTY3JpcHQgZ2VuZXJhdGVzIGEgZ28uc3VtIGZpbGUgYXQgdGhlIGJlZ2lubmluZyBvZiBlYWNoIHRlc3QgYW5kIHVwZGF0ZXMgdGVzdCBmaWxlcyBpZiB0aGV5IHBhc3MuYCkKCi8vIFRlc3RTY3JpcHQgcnVucyB0aGUgdGVzdHMgaW4gdGVzdGRhdGEvc2NyaXB0LyoudHh0LgpmdW5jIFRlc3RTY3JpcHQodCAqdGVzdGluZy5UKSB7Cgl0ZXN0ZW52Lk11c3RIYXZlR29CdWlsZCh0KQoJdGVzdGVudi5Ta2lwSWZTaG9ydEFuZFNsb3codCkKCglpZiB0ZXN0aW5nLlNob3J0KCkgJiYgcnVudGltZS5HT09TID09ICJwbGFuOSIgewoJCXQuU2tpcGYoInNraXBwaW5nIHRlc3QgaW4gLXNob3J0IG1vZGUgb24gJXMiLCBydW50aW1lLkdPT1MpCgl9CgoJc3J2LCBlcnIgOj0gdmNzdGVzdC5OZXdTZXJ2ZXIoKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9Cgl0LkNsZWFudXAoZnVuYygpIHsKCQlpZiBlcnIgOj0gc3J2LkNsb3NlKCk7IGVyciAhPSBuaWwgewoJCQl0LkZhdGFsKGVycikKCQl9Cgl9KQoJY2VydEZpbGUsIGVyciA6PSBzcnYuV3JpdGVDZXJ0aWZpY2F0ZUZpbGUoKQoJaWYgZXJyICE9IG5pbCB7CgkJdC5GYXRhbChlcnIpCgl9CgoJU3RhcnRQcm94eSgpCgoJdmFyICgKCQljdHggICAgICAgICA9IGNvbnRleHQuQmFja2dyb3VuZCgpCgkJZ3JhY2VQZXJpb2QgPSAxMDAgKiB0aW1lLk1pbGxpc2Vjb25kCgkpCglpZiBkZWFkbGluZSwgb2sgOj0gdC5EZWFkbGluZSgpOyBvayB7CgkJdGltZW91dCA6PSB0aW1lLlVudGlsKGRlYWRsaW5lKQoKCQkvLyBJZiB0aW1lIGFsbG93cywgaW5jcmVhc2UgdGhlIHRlcm1pbmF0aW9uIGdyYWNlIHBlcmlvZCB0byA1JSBvZiB0aGUKCQkvLyByZW1haW5pbmcgdGltZS4KCQlpZiBncCA6PSB0aW1lb3V0IC8gMjA7IGdwID4gZ3JhY2VQZXJpb2QgewoJCQlncmFjZVBlcmlvZCA9IGdwCgkJfQoKCQkvLyBXaGVuIHdlIHJ1biBjb21tYW5kcyB0aGF0IGV4ZWN1dGUgc3VicHJvY2Vzc2VzLCB3ZSB3YW50IHRvIHJlc2VydmUgdHdvCgkJLy8gZ3JhY2UgcGVyaW9kcyB0byBjbGVhbiB1cC4gV2Ugd2lsbCBzZW5kIHRoZSBmaXJzdCB0ZXJtaW5hdGlvbiBzaWduYWwgd2hlbgoJCS8vIHRoZSBjb250ZXh0IGV4cGlyZXMsIHRoZW4gd2FpdCBvbmUgZ3JhY2UgcGVyaW9kIGZvciB0aGUgcHJvY2VzcyB0bwoJCS8vIHByb2R1Y2Ugd2hhdGV2ZXIgdXNlZnVsIG91dHB1dCBpdCBjYW4gKHN1Y2ggYXMgYSBzdGFjayB0cmFjZSkuIEFmdGVyIHRoZQoJCS8vIGZpcnN0IGdyYWNlIHBlcmlvZCBleHBpcmVzLCB3ZSdsbCBlc2NhbGF0ZSB0byBvcy5LaWxsLCBsZWF2aW5nIHRoZSBzZWNvbmQKCQkvLyBncmFjZSBwZXJpb2QgZm9yIHRoZSB0ZXN0IGZ1bmN0aW9uIHRvIHJlY29yZCBpdHMgb3V0cHV0IGJlZm9yZUtleSBzdHJ1Y3QgewoJZWxsaXB0aWMuQ3VydmUKCgkvLyBYLCBZIGFyZSB0aGUgY29vcmRpbmF0ZXMgb2YgdGhlIHB1YmxpYyBrZXkgcG9pbnQuCgkvLwoJLy8gRGVwcmVjYXRlZDogbW9kaWZ5aW5nIHRoZSByYXcgY29vcmRpbmF0ZXMgY2FuIHByb2R1Y2UgaW52YWxpZCBrZXlzLCBhbmQgbWF5CgkvLyBpbnZhbGlkYXRlIGludGVybmFsIG9wdGltaXphdGlvbnM7IG1vcmVvdmVyLCBbYmlnLkludF0gbWV0aG9kcyBhcmUgbm90CgkvLyBzdWl0YWJsZSBmb3Igb3BlcmF0aW5nIG9uIGNyeXB0b2dyYXBoaWMgdmFsdWVzLiBUbyBlbmNvZGUgYW5kIGRlY29kZQoJLy8gUHVibGljS2V5IHZhbHVlcywgdXNlIFtQdWJsaWNLZXkuQnl0ZXNdIGFuZCBbUGFyc2VVbmNvbXByZXNzZWRQdWJsaWNLZXldCgkvLyBvciBbY3J5cHRvL3g1MDkuTWFyc2hhbFBLSVhQdWJsaWNLZXldIGFuZCBbY3J5cHRvL3g1MDkuUGFyc2VQS0lYUHVibGljS2V5XS4KCS8vIEZvciBFQ0RILCB1c2UgW2NyeXB0by9lY2RoXS4gRm9yIGxvd2VyLWxldmVsIGVsbGlwdGljIGN1cnZlIG9wZXJhdGlvbnMsCgkvLyB1c2UgYSB0aGlyZC1wYXJ0eSBtb2R1bGUgbGlrZSBmaWxpcHBvLmlvL25pc3RlYy4KCVgsIFkgKmJpZy5JbnQKfQoKLy8gQW55IG1ldGhvZHMgaW1wbGVtZW50ZWQgb24gUHVibGljS2V5IG1pZ2h0IG5lZWQgdG8gYWxzbyBiZSBpbXBsZW1lbnRlZCBvbgovLyBQcml2YXRlS2V5LCBhcyB0aGUgbGF0dGVyIGVtYmVkcyB0aGUgZm9ybWVyIGFuZCB3aWxsIGV4cG9zZSBpdHMgbWV0aG9kcy4KCi8vIEVDREggcmV0dXJucyBrIGFzIGEgW2VjZGguUHVibGljS2V5XS4gSXQgcmV0dXJucyBhbiBlcnJvciBpZiB0aGUga2V5IGlzCi8vIGludmFsaWQgYWNjb3JkaW5nIHRvIHRoZSBkZWZpbml0aW9uIG9mIFtlY2RoLkN1cnZlLk5ld1B1YmxpY0tleV0sIG9yIGlmIHRoZQovLyBDdXJ2ZSBpcyBub3Qgc3VwcG9ydGVkIGJ5IGNyeXB0by9lY2RoLgpmdW5jIChwdWIgKlB1YmxpY0tleSkgRUNESCgpICgqZWNkaC5QdWJsaWNLZXksIGVycm9yKSB7CgljIDo9IGN1cnZlVG9FQ0RIKHB1Yi5DdXJ2ZSkKCWlmIGMgPT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnJvcnMuTmV3KCJlY2RzYTogdW5zdXBwb3J0ZWQgY3VydmUgYnkgY3J5cHRvL2VjZGgiKQoJfQoJaywgZXJyIDo9IHB1Yi5CeXRlcygpCglpZiBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gbmlsLCBlcnIKCX0KCXJldHVybiBjLk5ld1B1YmxpY0tleShrKQp9CgovLyBFcXVhbCByZXBvcnRzIHdoZXRoZXIgcHViIGFuZCB4IGhhdmUgdGhlIHNhbWUgdmFsdWUuCi8vCi8vIFR3byBrZXlzIGFyZSBvbmx5IGNvbnNpZGVyZWQgdG8gaGF2ZSB0aGUgc2FtZSB2YWx1ZSBpZiB0aGV5IGhhdmUgdGhlIHNhbWUgQ3VydmUgdmFsdWUuCi8vIE5vdGUgdGhhdCBmb3IgZXhhbXBsZSBbZWxsaXB0aWMuUDI1Nl0gYW5kIGVsbGlwdGljLlAyNTYoKS5QYXJhbXMoKSBhcmUgZGlmZmVyZW50Ci8vIHZhbHVlcywgYXMgdGhlIGxhdHRlciBpcyBhIGdlbmVyaWMgbm90IGNvbnN0YW50IHRpbWUgaW1wbGVtZW50YXRpb24uCmZ1bmMgKHB1YiAqUHVibGljS2V5KSBFcXVhbCh4IGNyeXB0by5QdWJsaWNLZXkpIGJvb2wgewoJeHgsIG9rIDo9IHguKCpQdWJsaWNLZXkpCglpZiAhb2sgewoJCXJldHVybiBmYWxzZQoJfQoJcmV0dXJuIGJpZ0ludEVxdWFsKHB1Yi5YLCB4eC5YKSAmJiBiaWdJbnRFcXVhbChwdWIuWSwgeHguWSkgJiYKCQkvLyBTdGFuZGFyZCBsaWJyYXJ5IEN1cnZlIGltcGxlbWVudGF0aW9ucyBhcmUgc2luZ2xldG9ucywgc28gdGhpcyBjaGVjawoJCS8vIHdpbGwgd29yayBmb3IgdGhvc2UuIE90aGVyIEN1cnZlcyBtaWdodCBiZSBlcXVpdmFsZW50IGV2ZW4gaWYgbm90CgkJLy8gc2luZ2xldG9ucywgYnV0IHRoZXJlIGlzIG5vIGRlZmluaXRpdmUgd2F5IHRvIGNoZWNrIGZvciB0aGF0LCBhbmQKCQkvLyBiZXR0ZXIgdG8gZXJyIG9uIHRoZSBzaWRlIG9mIHNhZmV0eS4KCQlkcmVzcyBhbHJlYWR5IGluIHVzZSIsCgk0OTogImNhbid0IGFzc2lnbiByZXF1ZXN0ZWQgYWRkcmVzcyIsCgk1MDogIm5ldHdvcmsgaXMgZG93biIsCgk1MTogIm5ldHdvcmsgaXMgdW5yZWFjaGFibGUiLAoJNTI6ICJuZXR3b3JrIGRyb3BwZWQgY29ubmVjdGlvbiBvbiByZXNldCIsCgk1MzogInNvZnR3YXJlIGNhdXNlZCBjb25uZWN0aW9uIGFib3J0IiwKCTU0OiAiY29ubmVjdGlvbiByZXNldCBieSBwZWVyIiwKCTU1OiAibm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZSIsCgk1NjogInNvY2tldCBpcyBhbHJlYWR5IGNvbm5lY3RlZCIsCgk1NzogInNvY2tldCBpcyBub3QgY29ubmVjdGVkIiwKCTU4OiAiY2FuJ3Qgc2VuZCBhZnRlciBzb2NrZXQgc2h1dGRvd24iLAoJNTk6ICJ0b28gbWFueSByZWZlcmVuY2VzOiBjYW4ndCBzcGxpY2UiLAoJNjA6ICJjb25uZWN0aW9uIHRpbWVkIG91dCIsCgk2MTogImNvbm5lY3Rpb24gcmVmdXNlZCIsCgk2MjogInRvbyBtYW55IGxldmVscyBvZiBzeW1ib2xpYyBsaW5rcyIsCgk2MzogImZpbGUgbmFtZSB0b28gbG9uZyIsCgk2NDogImhvc3QgaXMgZG93biIsCgk2NTogIm5vIHJvdXRlIHRvIGhvc3QiLAoJNjY6ICJkaXJlY3Rvcnkgbm90IGVtcHR5IiwKCTY3OiAidG9vIG1hbnkgcHJvY2Vzc2VzIiwKCTY4OiAidG9vIG1hbnkgdXNlcnMiLAoJNjk6ICJkaXNjIHF1b3RhIGV4Y2VlZGVkIiwKCTcwOiAic3RhbGUgTkZTIGZpbGUgaGFuZGxlIiwKCTcxOiAidG9vIG1hbnkgbGV2ZWxzIG9mIHJlbW90ZSBpbiBwYXRoIiwKCTcyOiAiUlBDIHN0cnVjdCBpcyBiYWQiLAoJNzM6ICJSUEMgdmVyc2lvbiB3cm9uZyIsCgk3NDogIlJQQyBwcm9nLiBub3QgYXZhaWwiLAoJNzU6ICJwcm9ncmFtIHZlcnNpb24gd3JvbmciLAoJNzY6ICJiYWQgcHJvY2VkdXJlIGZvciBwcm9ncmFtIiwKCTc3OiAibm8gbG9ja3MgYXZhaWxhYmxlIiwKCTc4OiAiZnVuY3Rpb24gbm90IGltcGxlbWVudGVkIiwKCTc5OiAiaW5hcHByb3ByaWF0ZSBmaWxlIHR5cGUgb3IgZm9ybWF0IiwKCTgwOiAiYXV0aGVudGljYXRpb24gZXJyb3IiLAoJODE6ICJuZWVkIGF1dGhlbnRpY2F0b3IiLAoJODI6ICJpZGVudGlmaWVyIHJlbW92ZWQiLAoJODM6ICJubyBtZXNzYWdlIG9mIGRlc2lyZWQgdHlwZSIsCgk4NDogInZhbHVlIHRvbyBsYXJnZSB0byBiZSBzdG9yZWQgaW4gZGF0YSB0eXBlIiwKCTg1OiAiaWxsZWdhbCBieXRlIHNlcXVlbmNlIiwKCTg2OiAibm90IHN1cHBvcnRlZCIsCgk4NzogIm9wZXJhdGlvbiBDYW5jZWxlZCIsCgk4ODogImJhZCBvciBDb3JydXB0IG1lc3NhZ2UiLAoJODk6ICJubyBtZXNzYWdlIGF2YWlsYWJsZSIsCgk5MDogIm5vIFNUUkVBTSByZXNvdXJjZXMiLAoJOTE6ICJub3QgYSBTVFJFQU0iLAoJOTI6ICJTVFJFQU0gaW9jdGwgdGltZW91dCIsCgk5MzogImF0dHJpYnV0ZSBub3QgZm91bmQiLAoJOTQ6ICJtdWx0aWhvcCBhdHRlbXB0ZWQiLAoJOTU6ICJsaW5rIGhhcyBiZWVuIHNldmVyZWQiLAoJOTY6ICJwcm90b2NvbCBlcnJvciIsCn0KCi8vIFNpZ25hbCB0YWJsZQp2YXIgc2lnbmFscyA9IFsuLi5dc3RyaW5newoJMTogICJoYW5ndXAiLAoJMjogICJpbnRlcnJ1cHQiLAoJMzogICJxdWl0IiwKCTQ6ICAiaWxsZWdhbCBpbnN0cnVjdGlvbiIsCgk1OiAgInRyYWNlL0JQVCB0cmFwIiwKCTY6ICAiYWJvcnQgdHJhcCIsCgk3OiAgIkVNVCB0cmFwIiwKCTg6ICAiZmxvYXRpbmcgcG9pbnQgZXhjZXB0aW9uIiwKCTk6ICAia2lsbGVkIiwKCTEwOiAiYnVzIGVycm9yIiwKCTExOiAic2VnbWVudGF0aW9uIGZhdWx0IiwKCTEyOiAiYmFkIHN5c3RlbSBjYWxsIiwKCTEzOiAiYnJva2VuIHBpcGUiLAoJMTQ6ICJhbGFybSBjbG9jayIsCgkxNTogInRlcm1pbmF0ZWQiLAoJMTY6ICJ1cmdlbnQgSS9PIGNvbmRpdGlvbiIsCgkxNzogInN0b3BwZWQgKHNpZ25hbCkiLAoJMTg6ICJzdG9wcGVkIiwKCTE5OiAiY29udGludWVkIiwKCTIwOiAiY2hpbGQgZXhpdGVkdW5kcyBvZiBjb25zaWRlcmluZyBldmVyeSB0aHJlc2hvbGQuCgkvLyBJZiB3ZSBydW4gYSB0aHJlc2hvbGQgU3RhYmxlIHRpbWVzIGluIGEgcm93IHdpdGhvdXQgc2VlaW5nIG1vcmUKCS8vIHRoYW4gYSAxJSBpbXByb3ZlbWVudCBpbiB0aGUgb2JzZXJ2ZWQgbWluaW11bSwgbW92ZSBvbiB0byB0aGUgbmV4dCBvbmUuCgkvLyBBZnRlciB3ZSBydW4gQ29udmVyZ2VkIHJvdW5kcyAobm90IG5lY2Vzc2FyaWx5IGluIGEgcm93KQoJLy8gd2l0aG91dCBzZWVpbmcgYW55IHRocmVzaG9sZCBpbXByb3ZlIGJ5IG1vcmUgdGhhbiAxJSwgc3RvcC4KCWNvbnN0ICgKCQlNYXhSb3VuZHMgPSAxNjAwCgkJU3RhYmxlICAgID0gMjAKCQlDb252ZXJnZWQgPSAyMDAKCSkKCglmb3IgaSwgc2l6ZSA6PSByYW5nZSBzaXplcyB7CgkJYiA6PSBiZW5jaChzaXplKQoJCXNhbWUgOj0gMAoJCWZvciByYW5nZSBNYXhSb3VuZHMgewoJCQliZXR0ZXIgOj0gZmFsc2UKCQkJZm9yIGosIHRocmVzaG9sZCA6PSByYW5nZSB0aHJlc2hvbGRzIHsKCQkJCS8vIE5vIHBvaW50IGlmIHRocmVzaG9sZCBpcyBmYXIgYmV5b25kIHNpemUKCQkJCWlmIGZhbHNlICYmIHRocmVzaG9sZCA+IHNpemUrMipzaXplU3RlcCB7CgkJCQkJY29udGludWUKCQkJCX0KCgkJCQkvLyBCYXNpY1NxciBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgcmVjdXJzaXZlIHRocmVzaG9sZHM6IGl0IGVpdGhlciBhcHBsaWVzIG9yIG5vdCwKCQkJCS8vIHdpdGhvdXQgYW55IHF1ZXN0aW9uIG9mIHJlY3Vyc2l2ZSBzdWJwcm9ibGVtcy4gT25seSB0cnkgdGhlIHRocmVzaG9sZHMKCQkJCS8vCXNpemUtMSwgc2l6ZSwgc2l6ZSsxLCBzaXplKzIKCQkJCS8vIHRvIGdldCB0d28gZGF0YSBwb2ludHMgdXNpbmcgYmFzaWMgbXVsdGlwbGljYXRpb24gYW5kIHR3byB1c2luZyBiYXNpYyBzcXVhcmluZy4KCQkJCS8vIFRoaXMgYXZvaWRzIGdhdGhlcmluZyBtYW55IHJlZHVuZGFudCBkYXRhIHBvaW50cy4KCQkJCS8vIChUaGUgb3RoZXJzIGhhdmUgcmVkdW5kYW50IGRhdGEgcG9pbnRzIGFzIHdlbGwsIGJ1dCBmb3IgdGhlbSB0aGUgbWF0aCBpcyBsZXNzIHRyaXZpYWwKCQkJCS8vIGFuZCBiZXN0IG5vdCBkdXBsaWNhdGVkIGluIHRoZSBjYWxpYnJhdGlvbiBjb2RlLikKCQkJCWlmIGZhbHNlICYmIG5hbWUgPT0gImJhc2ljU3FyIiAmJiAodGhyZXNob2xkIDwgc2l6ZS0xIHx8IHRocmVzaG9sZCA+IHNpemUrMykgewoJCQkJCWNvbnRpbnVlCgkJCQl9CgoJCQkJc2V0KHRocmVzaG9sZCkKCQkJCWIoKSAvLyB3YXJtIHVwCgkJCQliKCkKCQkJCXRtaW4gOj0gdGltZXNbaV1bal0KCQkJCWZvciBrIDo9IDA7IGsgPCBTdGFibGU7IGsrKyB7CgkJCQkJc3RhcnQgOj0gdGltZS5Ob3coKQoJCQkJCWIoKQoJCQkJCXQgOj0gZmxvYXQ2NCh0aW1lLlNpbmNlKHN0YXJ0KSkKCQkJCQlpZiB0IDwgdG1pbiB7CgkJCQkJCWlmIHQgPCB0bWluKjk5LzEwMCB7CgkJCQkJCQliZXR0ZXIgPSB0cnVlCgkJCQkJCQlrID0gMAoJCQkJCQl9CgkJCQkJCXRtaW4gPSB0CgkJCQkJfQoJCQkJfQoJCQkJdGltZXNbaV1bal0gPSB0bWluCgkJCX0KCQkJaWYgIWJldHRlciB7CgkJCQlpZiBzYW1lKys7IHNhbWUgPj0gQ29udmVyZ2VkIHsKCQkJCQlicmVhawoJCQkJfQoJCQl9CgkJfQoKCQlmbXQuUHJpbnRmKCIlc1xuIiwgY3N2KGZtdC5TcHJpbnQoc2l6ZSksIHRpbWVzW2ldKSkKCX0KCgkvLyBGb3IgZWFjaCBzaXplLCBub3JtYWxpemUgdGltaW5ncyBieSB0aGUgbWluaW11bSBhY2hpZXZlZCBmb3IgdGhhdCBzaXplLgoJZm10LlByaW50ZigiJXNcbiIsIGNzdigic2l6ZSBcXCB0aHJlc2hvbGQiLCB0aHJlc2hvbGRzKSkKCW5vcm1zIDo9IG1ha2UoW11bXWZsb2F0NjQsIGxlbihzaXplcykpCglmb3IgaSwgdGltZXMgOj0gcmFuZ2UgdGltZXMgewoJCW0gOj0gbWluKDFlMTAwLCBzbGljZXMuTWluKHRpbWVzKSkgLy8gbWFrZSBmaW5pdGUgc28gZGl2aWRlIHByZXNlcnZlcyBpbmYgdgkJaWYgbGJsLktleSA9PSBrZXkgewoJCQlyZXR1cm4gbGJsLlZhbHVlLCB0cnVlCgkJfQoJfQoJcmV0dXJuICIiLCBmYWxzZQp9CgovLyBGb3JMYWJlbHMgaW52b2tlcyBmIHdpdGggZWFjaCBsYWJlbCBzZXQgb24gdGhlIGNvbnRleHQuCi8vIFRoZSBmdW5jdGlvbiBmIHNob3VsZCByZXR1cm4gdHJ1ZSB0byBjb250aW51ZSBpdGVyYXRpb24gb3IgZmFsc2UgdG8gc3RvcCBpdGVyYXRpb24gZWFybHkuCmZ1bmMgRm9yTGFiZWxzKGN0eCBjb250ZXh0LkNvbnRleHQsIGYgZnVuYyhrZXksIHZhbHVlIHN0cmluZykgYm9vbCkgewoJY3R4TGFiZWxzIDo9IGxhYmVsVmFsdWUoY3R4KQoJZm9yIF8sIGxibCA6PSByYW5nZSBjdHhMYWJlbHMuU2V0Lkxpc3QgewoJCWlmICFmKGxibC5LZXksIGxibC5WYWx1ZSkgewoJCQlicmVhawoJCX0KCX0KfQovLyBDb3B5cmlnaHQgMjAwOSBUaGUgR28gQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KLy8gVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUKLy8gbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlLgoKLy8gUGFja2FnZSBleHB2YXIgcHJvdmlkZXMgYSBzdGFuZGFyZGl6ZWQgaW50ZXJmYWNlIHRvIHB1YmxpYyB2YXJpYWJsZXMsIHN1Y2gKLy8gYXMgb3BlcmF0aW9uIGNvdW50ZXJzIGluIHNlcnZlcnMuIEl0IGV4cG9zZXMgdGhlc2UgdmFyaWFibGVzIHZpYSBIVFRQIGF0Ci8vIC9kZWJ1Zy92YXJzIGluIEpTT04gZm9ybWF0LiBBcyBvZiBHbyAxLjIyLCB0aGUgL2RlYnVnL3ZhcnMgcmVxdWVzdCBtdXN0Ci8vIHVzZSBHRVQuCi8vCi8vIE9wZXJhdGlvbnMgdG8gc2V0IG9yIG1vZGlmeSB0aGVzZSBwdWJsaWMgdmFyaWFibGVzIGFyZSBhdG9taWMuCi8vCi8vIEluIGFkZGl0aW9uIHRvIGFkZGluZyB0aGUgSFRUUCBoYW5kbGVyLCB0aGlzIHBhY2thZ2UgcmVnaXN0ZXJzIHRoZQovLyBmb2xsb3dpbmcgdmFyaWFibGVzOgovLwovLwljbWRsaW5lICAgb3MuQXJncwovLwltZW1zdGF0cyAgcnVudGltZS5NZW1zdGF0cwovLwovLyBUaGUgcGFja2FnZSBpcyBzb21ldGltZXMgb25seSBpbXBvcnRlZCBmb3IgdGhlIHNpZGUgZWZmZWN0IG9mCi8vIHJlZ2lzdGVyaW5nIGl0cyBIVFRQIGhhbmRsZXIgYW5kIHRoZSBhYm92ZSB2YXJpYWJsZXMuIFRvIHVzZSBpdAovLyB0aGlzIHdheSwgbGluayB0aGlzIHBhY2thZ2UgaW50byB5b3VyIHByb2dyYW06Ci8vCi8vCWltcG9ydCBfICJleHB2YXIiCnBhY2thZ2UgZXhwdmFyCgppbXBvcnQgKAoJImVuY29kaW5nL2pzb24iCgkiaW50ZXJuYWwvZ29kZWJ1ZyIKCSJsb2ciCgkibWF0aCIKCSJuZXQvaHR0cCIKCSJvcyIKCSJydW50aW1lIgoJInNsaWNlcyIKCSJzdHJjb252IgoJInN5bmMiCgkic3luYy9hdG9taWMiCgkidW5pY29kZS91dGY4IgopCgovLyBWYXIgaXMgYW4gYWJzdHJhY3QgdHlwZSBmb3IgYWxsIGV4cG9ydGVkIHZhcmlhYmxlcy4KdHlwZSBWYXIgaW50ZXJmYWNlIHsKCS8vIFN0cmluZyByZXR1cm5zIGEgdmFsaWQgSlNPTiB2YWx1ZSBmb3IgdGhlIHZhcmlhYmxlLgoJLy8gVHlwZXMgd2l0aCBTdHJpbmcgbWV0aG9kcyB0aGF0IGRvIG5vdCByZXR1cm4gdmFsaWQgSlNPTgoJLy8gKHN1Y2ggYXMgdGltZS5UaW1lKSBtdXN0IG5vdCBiZSB1c2VkIGFzIGEgVmFyLgoJU3RyaW5nKCkgc3RyaW5nCn0KCnR5cGUganNvblZhciBpbnRlcmZhY2UgewoJLy8gYXBwZW5kSlNPTiBhcHBlbmRzIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZWNlaXZlciB0byBiLgoJYXBwZW5kSlNPTihiIFtdYnl0ZSkgW11ieXRlCn0KCi8vIEludCBpcyBhIDY0LWJpdCBpbnRlZ2VyIHZhcmlhYmxlIHRoYXQgc2F0aXNmaWVzIHRoZSBbVmFyXSBpbnRlcmZhY2UuCnR5cGUgSW50IHN0cnVjdCB7CglpIGF0b21pYy5JbnQ2NAp9CgpmdW5jICh2ICpJbnQpIFZhbHVlKCkgaW50NjQgewoJcmV0dXJuIHYuaS5Mb2FkKCkKfQoKZi8vIENvcHlyaWdodCAyMDE1IFRoZSBHbyBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLyBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZQovLyBsaWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuCgpwYWNrYWdlIHNzYQoKLy8gbGF5b3V0IG9yZGVycyBiYXNpYyBibG9ja3MgaW4gZiB3aXRoIHRoZSBnb2FsIG9mIG1pbmltaXppbmcgY29udHJvbCBmbG93IGluc3RydWN0aW9ucy4KLy8gQWZ0ZXIgdGhpcyBwaGFzZSByZXR1cm5zLCB0aGUgb3JkZXIgb2YgZi5CbG9ja3MgbWF0dGVycyBhbmQgaXMgdGhlIG9yZGVyCi8vIGluIHdoaWNoIHRob3NlIGJsb2NrcyB3aWxsIGFwcGVhciBpbiB0aGUgYXNzZW1ibHkgb3V0cHV0LgpmdW5jIGxheW91dChmICpGdW5jKSB7CglmLkJsb2NrcyA9IGxheW91dE9yZGVyKGYpCn0KCi8vIFJlZ2lzdGVyIGFsbG9jYXRpb24gbWF5IHVzZSBhIGRpZmZlcmVudCBvcmRlciB3aGljaCBoYXMgY29uc3RyYWludHMKLy8gaW1wb3NlZCBieSB0aGUgbGluZWFyLXNjYW4gYWxnb3JpdGhtLgpmdW5jIGxheW91dFJlZ2FsbG9jT3JkZXIoZiAqRnVuYykgW10qQmxvY2sgewoJLy8gcmVtbmFudCBvZiBhbiBleHBlcmltZW50OyBwZXJoYXBzIHRoZXJlIHdpbGwgYmUgYW5vdGhlci4KCXJldHVybiBmLkJsb2Nrcwp9CgpmdW5jIGxheW91dE9yZGVyKGYgKkZ1bmMpIFtdKkJsb2NrIHsKCW9yZGVyIDo9IG1ha2UoW10qQmxvY2ssIDAsIGYuTnVtQmxvY2tzKCkpCglzY2hlZHVsZWQgOj0gZi5DYWNoZS5hbGxvY0Jvb2xTbGljZShmLk51bUJsb2NrcygpKQoJZGVmZXIgZi5DYWNoZS5mcmVlQm9vbFNsaWNlKHNjaGVkdWxlZCkKCWlkVG9CbG9jayA6PSBmLkNhY2hlLmFsbG9jQmxvY2tTbGljZShmLk51bUJsb2NrcygpKQoJZGVmZXIgZi5DYWNoZS5mcmVlQmxvY2tTbGljZShpZFRvQmxvY2spCglpbmRlZ3JlZSA6PSBmLkNhY2hlLmFsbG9jSW50U2xpY2UoZi5OdW1CbG9ja3MoKSkKCWRlZmVyIGYuQ2FjaGUuZnJlZUludFNsaWNlKGluZGVncmVlKQoJcG9zZGVncmVlIDo9IGYubmV3U3BhcnNlU2V0KGYuTnVtQmxvY2tzKCkpIC8vIGJsb2NrcyB3aXRoIHBvc2l0aXZlIHJlbWFpbmluZyBkZWdyZWUKCWRlZmVyIGYucmV0U3BhcnNlU2V0KHBvc2RlZ3JlZSkKCS8vIGJsb2NrcyB3aXRoIHplcm8gcmVtYWluaW5nIGRlZ3JlZS4gVXNlIHNsaWNlIHRvIHNpbXVsYXRlIGEgTElGTyBxdWV1ZSB0byBpbXBsZW1lbnQKCS8vIHRoZSBkZXB0aC1maXJzdCB0b3BvbG9neSBzb3J0aW5nIGFsZ29yaXRobS4KCXZhciB6ZXJvZGVncmVlIFtdSUQKCS8vIExJRk8gcXVldWUuIFRyYWNrIHRoZSBzdWNjZXNzb3IgYmxvY2tzIG9mIHRoZSBzY2hlZHVsZWQgYmxvY2sgc28gdGhhdCB3aGVuIHdlCgkvLyBlbmNvdW50ZXIgbG9vcHMsIHdlIGNob29zZSB0byBzY2hlZHVsZSB0aGUgc3VjY2Vzc29yIGJsb2NrIG9mIHRoZSBtb3N0IHJlY2VudGx5CgkvLyBzY2hlZHVsZWQgYmxvY2suCgl2YXIgc3VjY3MgW11JRAoJZXhpdCA6PSBmLm5ld1NwYXJzZVNldChmLk51bUJsb2NrcygpKSAvLyBleGl0IGJsb2NrcwoJZGVmZXIgZi5yZXRTcGFyc2VTZXQoZXhpdCkKCgkvLyBQb3B1bGF0ZSBpZFRvQmxvY2sgYW5kIGZpbmQgZXhpdCBibG9ja3MuCglmb3IgXywgYiA6PSByYW5nZSBmLkJsb2NrcyB7CgkJaWRUb0Jsb2NrW2IuSURdID0gYgoJCWlmIGIuS2luZCA9PSBCbG9ja0V4aXQgewoJCQlleGl0LmFkZChiLklEKQoJCX0KCX0KCgkvLyBFeHBhbmQgZXhpdCB0byBpbmNsdWRlIGJsb2NrcyBwb3N0LWRvbWluYXRlZCBieSBleGl0IGI=';

let cachedDictionary: Buffer | null = null;

export function getGoDictionary(): Buffer {
  if (!cachedDictionary) {
    cachedDictionary = Buffer.from(DICTIONARY_BASE64, 'base64');
  }
  return cachedDictionary;
}

export const GO_DICTIONARY_META: DictionaryMeta = {
  name: 'Go Dictionary',
  version: '2.0.0',
  description: 'Trained ZSTD dictionary optimized for Go code compression',
  frameworks: ["go","gin","echo"],
  sizeBytes: 524288,
  patternCount: 0, // Trained dictionary - patterns are internal
  trainedOn: ['sample go files'],
};
